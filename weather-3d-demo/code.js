(()=>{
    var e = {
        247: function(e) {
            e.exports = function(e) {
                var t = {};
                function i(r) {
                    if (t[r])
                        return t[r].exports;
                    var n = t[r] = {
                        i: r,
                        l: !1,
                        exports: {}
                    };
                    return e[r].call(n.exports, n, n.exports, i),
                    n.l = !0,
                    n.exports
                }
                return i.m = e,
                i.c = t,
                i.d = function(e, t, r) {
                    i.o(e, t) || Object.defineProperty(e, t, {
                        enumerable: !0,
                        get: r
                    })
                }
                ,
                i.r = function(e) {
                    "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
                        value: "Module"
                    }),
                    Object.defineProperty(e, "__esModule", {
                        value: !0
                    })
                }
                ,
                i.t = function(e, t) {
                    if (1 & t && (e = i(e)),
                    8 & t)
                        return e;
                    if (4 & t && "object" == typeof e && e && e.__esModule)
                        return e;
                    var r = Object.create(null);
                    if (i.r(r),
                    Object.defineProperty(r, "default", {
                        enumerable: !0,
                        value: e
                    }),
                    2 & t && "string" != typeof e)
                        for (var n in e)
                            i.d(r, n, function(t) {
                                return e[t]
                            }
                            .bind(null, n));
                    return r
                }
                ,
                i.n = function(e) {
                    var t = e && e.__esModule ? function() {
                        return e.default
                    }
                    : function() {
                        return e
                    }
                    ;
                    return i.d(t, "a", t),
                    t
                }
                ,
                i.o = function(e, t) {
                    return Object.prototype.hasOwnProperty.call(e, t)
                }
                ,
                i.p = "",
                i(i.s = 3)
            }([function(e, t, i) {
                "use strict";
                function r(e) {
                    return (r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                        return typeof e
                    }
                    : function(e) {
                        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                    }
                    )(e)
                }
                var n, a = "object" === ("undefined" == typeof Reflect ? "undefined" : r(Reflect)) ? Reflect : null, o = a && "function" == typeof a.apply ? a.apply : function(e, t, i) {
                    return Function.prototype.apply.call(e, t, i)
                }
                ;
                n = a && "function" == typeof a.ownKeys ? a.ownKeys : Object.getOwnPropertySymbols ? function(e) {
                    return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))
                }
                : function(e) {
                    return Object.getOwnPropertyNames(e)
                }
                ;
                var s = Number.isNaN || function(e) {
                    return e != e
                }
                ;
                function l() {
                    l.init.call(this)
                }
                e.exports = l,
                e.exports.once = function(e, t) {
                    return new Promise((function(i, r) {
                        function n(i) {
                            e.removeListener(t, a),
                            r(i)
                        }
                        function a() {
                            "function" == typeof e.removeListener && e.removeListener("error", n),
                            i([].slice.call(arguments))
                        }
                        y(e, t, a, {
                            once: !0
                        }),
                        "error" !== t && function(e, t, i) {
                            "function" == typeof e.on && y(e, "error", t, {
                                once: !0
                            })
                        }(e, n)
                    }
                    ))
                }
                ,
                l.EventEmitter = l,
                l.prototype._events = void 0,
                l.prototype._eventsCount = 0,
                l.prototype._maxListeners = void 0;
                var u = 10;
                function c(e) {
                    if ("function" != typeof e)
                        throw new TypeError('The "listener" argument must be of type Function. Received type ' + r(e))
                }
                function h(e) {
                    return void 0 === e._maxListeners ? l.defaultMaxListeners : e._maxListeners
                }
                function p(e, t, i, r) {
                    var n, a, o, s;
                    if (c(i),
                    void 0 === (a = e._events) ? (a = e._events = Object.create(null),
                    e._eventsCount = 0) : (void 0 !== a.newListener && (e.emit("newListener", t, i.listener ? i.listener : i),
                    a = e._events),
                    o = a[t]),
                    void 0 === o)
                        o = a[t] = i,
                        ++e._eventsCount;
                    else if ("function" == typeof o ? o = a[t] = r ? [i, o] : [o, i] : r ? o.unshift(i) : o.push(i),
                    (n = h(e)) > 0 && o.length > n && !o.warned) {
                        o.warned = !0;
                        var l = new Error("Possible EventEmitter memory leak detected. " + o.length + " " + String(t) + " listeners added. Use emitter.setMaxListeners() to increase limit");
                        l.name = "MaxListenersExceededWarning",
                        l.emitter = e,
                        l.type = t,
                        l.count = o.length,
                        s = l,
                        console && console.warn && console.warn(s)
                    }
                    return e
                }
                function f() {
                    if (!this.fired)
                        return this.target.removeListener(this.type, this.wrapFn),
                        this.fired = !0,
                        0 === arguments.length ? this.listener.call(this.target) : this.listener.apply(this.target, arguments)
                }
                function d(e, t, i) {
                    var r = {
                        fired: !1,
                        wrapFn: void 0,
                        target: e,
                        type: t,
                        listener: i
                    }
                      , n = f.bind(r);
                    return n.listener = i,
                    r.wrapFn = n,
                    n
                }
                function m(e, t, i) {
                    var r = e._events;
                    if (void 0 === r)
                        return [];
                    var n = r[t];
                    return void 0 === n ? [] : "function" == typeof n ? i ? [n.listener || n] : [n] : i ? function(e) {
                        for (var t = new Array(e.length), i = 0; i < t.length; ++i)
                            t[i] = e[i].listener || e[i];
                        return t
                    }(n) : g(n, n.length)
                }
                function v(e) {
                    var t = this._events;
                    if (void 0 !== t) {
                        var i = t[e];
                        if ("function" == typeof i)
                            return 1;
                        if (void 0 !== i)
                            return i.length
                    }
                    return 0
                }
                function g(e, t) {
                    for (var i = new Array(t), r = 0; r < t; ++r)
                        i[r] = e[r];
                    return i
                }
                function y(e, t, i, n) {
                    if ("function" == typeof e.on)
                        n.once ? e.once(t, i) : e.on(t, i);
                    else {
                        if ("function" != typeof e.addEventListener)
                            throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type ' + r(e));
                        e.addEventListener(t, (function r(a) {
                            n.once && e.removeEventListener(t, r),
                            i(a)
                        }
                        ))
                    }
                }
                Object.defineProperty(l, "defaultMaxListeners", {
                    enumerable: !0,
                    get: function() {
                        return u
                    },
                    set: function(e) {
                        if ("number" != typeof e || e < 0 || s(e))
                            throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + e + ".");
                        u = e
                    }
                }),
                l.init = function() {
                    void 0 !== this._events && this._events !== Object.getPrototypeOf(this)._events || (this._events = Object.create(null),
                    this._eventsCount = 0),
                    this._maxListeners = this._maxListeners || void 0
                }
                ,
                l.prototype.setMaxListeners = function(e) {
                    if ("number" != typeof e || e < 0 || s(e))
                        throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + e + ".");
                    return this._maxListeners = e,
                    this
                }
                ,
                l.prototype.getMaxListeners = function() {
                    return h(this)
                }
                ,
                l.prototype.emit = function(e) {
                    for (var t = [], i = 1; i < arguments.length; i++)
                        t.push(arguments[i]);
                    var r = "error" === e
                      , n = this._events;
                    if (void 0 !== n)
                        r = r && void 0 === n.error;
                    else if (!r)
                        return !1;
                    if (r) {
                        var a;
                        if (t.length > 0 && (a = t[0]),
                        a instanceof Error)
                            throw a;
                        var s = new Error("Unhandled error." + (a ? " (" + a.message + ")" : ""));
                        throw s.context = a,
                        s
                    }
                    var l = n[e];
                    if (void 0 === l)
                        return !1;
                    if ("function" == typeof l)
                        o(l, this, t);
                    else {
                        var u = l.length
                          , c = g(l, u);
                        for (i = 0; i < u; ++i)
                            o(c[i], this, t)
                    }
                    return !0
                }
                ,
                l.prototype.addListener = function(e, t) {
                    return p(this, e, t, !1)
                }
                ,
                l.prototype.on = l.prototype.addListener,
                l.prototype.prependListener = function(e, t) {
                    return p(this, e, t, !0)
                }
                ,
                l.prototype.once = function(e, t) {
                    return c(t),
                    this.on(e, d(this, e, t)),
                    this
                }
                ,
                l.prototype.prependOnceListener = function(e, t) {
                    return c(t),
                    this.prependListener(e, d(this, e, t)),
                    this
                }
                ,
                l.prototype.removeListener = function(e, t) {
                    var i, r, n, a, o;
                    if (c(t),
                    void 0 === (r = this._events))
                        return this;
                    if (void 0 === (i = r[e]))
                        return this;
                    if (i === t || i.listener === t)
                        0 == --this._eventsCount ? this._events = Object.create(null) : (delete r[e],
                        r.removeListener && this.emit("removeListener", e, i.listener || t));
                    else if ("function" != typeof i) {
                        for (n = -1,
                        a = i.length - 1; a >= 0; a--)
                            if (i[a] === t || i[a].listener === t) {
                                o = i[a].listener,
                                n = a;
                                break
                            }
                        if (n < 0)
                            return this;
                        0 === n ? i.shift() : function(e, t) {
                            for (; t + 1 < e.length; t++)
                                e[t] = e[t + 1];
                            e.pop()
                        }(i, n),
                        1 === i.length && (r[e] = i[0]),
                        void 0 !== r.removeListener && this.emit("removeListener", e, o || t)
                    }
                    return this
                }
                ,
                l.prototype.off = l.prototype.removeListener,
                l.prototype.removeAllListeners = function(e) {
                    var t, i, r;
                    if (void 0 === (i = this._events))
                        return this;
                    if (void 0 === i.removeListener)
                        return 0 === arguments.length ? (this._events = Object.create(null),
                        this._eventsCount = 0) : void 0 !== i[e] && (0 == --this._eventsCount ? this._events = Object.create(null) : delete i[e]),
                        this;
                    if (0 === arguments.length) {
                        var n, a = Object.keys(i);
                        for (r = 0; r < a.length; ++r)
                            "removeListener" !== (n = a[r]) && this.removeAllListeners(n);
                        return this.removeAllListeners("removeListener"),
                        this._events = Object.create(null),
                        this._eventsCount = 0,
                        this
                    }
                    if ("function" == typeof (t = i[e]))
                        this.removeListener(e, t);
                    else if (void 0 !== t)
                        for (r = t.length - 1; r >= 0; r--)
                            this.removeListener(e, t[r]);
                    return this
                }
                ,
                l.prototype.listeners = function(e) {
                    return m(this, e, !0)
                }
                ,
                l.prototype.rawListeners = function(e) {
                    return m(this, e, !1)
                }
                ,
                l.listenerCount = function(e, t) {
                    return "function" == typeof e.listenerCount ? e.listenerCount(t) : v.call(e, t)
                }
                ,
                l.prototype.listenerCount = v,
                l.prototype.eventNames = function() {
                    return this._eventsCount > 0 ? n(this._events) : []
                }
            }
            , function(e, t, i) {
                "use strict";
                e.exports = function(e, t, i, r) {
                    try {
                        try {
                            var n;
                            try {
                                n = new window.Blob([e])
                            } catch (t) {
                                (n = new (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder)).append(e),
                                n = n.getBlob()
                            }
                            var a = window.URL || window.webkitURL
                              , o = a.createObjectURL(n)
                              , s = new window[t](o,i);
                            return a.revokeObjectURL(o),
                            s
                        } catch (r) {
                            return new window[t]("data:application/javascript,".concat(encodeURIComponent(e)),i)
                        }
                    } catch (e) {
                        if (!r)
                            throw Error("Inline worker is not supported");
                        return new window[t](r,i)
                    }
                }
            }
            , , function(e, t, i) {
                "use strict";
                function r(e) {
                    var t;
                    return "vec4(" + (e[0] / 255).toFixed(3) + "," + (e[1] / 255).toFixed(3) + "," + (e[2] / 255).toFixed(3) + "," + ((null !== (t = e[3]) && void 0 !== t ? t : 255) / 255).toFixed(3) + ")"
                }
                function n(e) {
                    return 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + e * Math.PI / 360)) / 360
                }
                function a(e, t) {
                    return [e / 360, n(t)]
                }
                i.r(t),
                i.d(t, "ColoringFragmentBase", (function() {
                    return u
                }
                )),
                i.d(t, "GradientColoringFragment", (function() {
                    return h
                }
                )),
                i.d(t, "OpacityColoringFragment", (function() {
                    return p
                }
                )),
                i.d(t, "CutoffPickingMode", (function() {
                    return to
                }
                )),
                i.d(t, "VolumeLayer", (function() {
                    return oo
                }
                ));
                var o, s = 2 * Math.PI * 6378137, l = (o = function(e, t) {
                    return (o = Object.setPrototypeOf || {
                        __proto__: []
                    }instanceof Array && function(e, t) {
                        e.__proto__ = t
                    }
                    || function(e, t) {
                        for (var i in t)
                            Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i])
                    }
                    )(e, t)
                }
                ,
                function(e, t) {
                    if ("function" != typeof t && null !== t)
                        throw new TypeError("Class extends value " + String(t) + " is not a constructor or null");
                    function i() {
                        this.constructor = e
                    }
                    o(e, t),
                    e.prototype = null === t ? Object.create(t) : (i.prototype = t.prototype,
                    new i)
                }
                ), u = function() {
                    function e(e, t) {
                        var i, r;
                        this.u = e,
                        this.v = t,
                        this.v.min = null !== (i = this.v.min) && void 0 !== i ? i : 0,
                        this.v.max = null !== (r = this.v.max) && void 0 !== r ? r : 1
                    }
                    return e.prototype.codeValue = function(e) {
                        return (e - this.v.min) / (this.v.max - this.v.min)
                    }
                    ,
                    e.prototype.decodeValue = function(e) {
                        return this.v.min + e * (this.v.max - this.v.min)
                    }
                    ,
                    e.prototype.decodeChannel = function(e) {
                        if (this.v.channel.length > 1) {
                            var t = this.decodeValue(e[this.v.channel[0]])
                              , i = this.decodeValue(e[this.v.channel[1]]);
                            return [t, i, Math.sqrt(t * t + i * i)]
                        }
                        return this.decodeValue(e[this.v.channel])
                    }
                    ,
                    e.prototype.getBlendCode = function(e) {
                        return "vec4 " + e + "(vec4 d,vec4 data){" + this.u + "d.rgb=(d.rgb*d.a*(1.-c.a)+c.rgb*c.a)/(d.a*(1.-c.a)+c.a);d.a=d.a+c.a*(1.-d.a);return d;}"
                    }
                    ,
                    e.prototype.getCode = function(e) {
                        return "vec4 " + e + "(vec4 data){" + this.u + "return c;}"
                    }
                    ,
                    e
                }();
                function c(e) {
                    var t = e.channel
                      , i = void 0 === t ? "r" : t
                      , r = e.min
                      , n = void 0 === r ? 0 : r
                      , a = e.max
                      , o = void 0 === a ? 1 : a
                      , s = n.toFixed(5) + "+data." + i + "*" + (o - n).toFixed(5);
                    return i.length > 1 && (s = "length(" + s + ")"),
                    "float v=" + s + ";"
                }
                for (var h = function(e) {
                    function t(t) {
                        for (var i, n, a = t.decode, o = t.stops || [{
                            value: a.min,
                            color: [0, 0, 0, 0]
                        }, {
                            value: a.max,
                            color: [255, 255, 255, 255]
                        }], s = null === (i = t.smooth) || void 0 === i || i, l = null !== (n = t.opacity) && void 0 !== n ? n : 1, u = c(a), h = 0; h < o.length; h++) {
                            var p = o[h];
                            0 == h && (u += "vec4 c=" + r(p.color) + ";");
                            var f = p.value.toFixed(5)
                              , d = r(p.color);
                            if (s && h + 1 < o.length) {
                                var m = o[h + 1].value.toFixed(5);
                                u += "if(v>=" + f + "&&v<" + m + ")c=mix(" + d + "," + r(o[h + 1].color) + ",smoothstep(" + f + "," + m + ",v));"
                            } else
                                u += "if(v>=" + f + ")c=" + d + ";"
                        }
                        return u += "c.a*=" + l.toFixed(3) + ";",
                        e.call(this, u, a) || this
                    }
                    return l(t, e),
                    t
                }(u), p = function(e) {
                    function t(t) {
                        var i, n = t.decode, a = t.color || [255, 255, 255], o = null !== (i = t.opacity) && void 0 !== i ? i : 1, s = c(n);
                        return s += "vec4 c=" + r(a) + ";c.a*=v*" + o.toFixed(3) + ";",
                        e.call(this, s, n) || this
                    }
                    return l(t, e),
                    t
                }(u), f = [], d = 0; d < 256; d++)
                    f[d] = (d < 16 ? "0" : "") + d.toString(16);
                var m = 1234567
                  , v = {
                    DEG2RAD: Math.PI / 180,
                    RAD2DEG: 180 / Math.PI,
                    generateUUID: function() {
                        var e = 4294967295 * Math.random() | 0
                          , t = 4294967295 * Math.random() | 0
                          , i = 4294967295 * Math.random() | 0
                          , r = 4294967295 * Math.random() | 0;
                        return (f[255 & e] + f[e >> 8 & 255] + f[e >> 16 & 255] + f[e >> 24 & 255] + "-" + f[255 & t] + f[t >> 8 & 255] + "-" + f[t >> 16 & 15 | 64] + f[t >> 24 & 255] + "-" + f[63 & i | 128] + f[i >> 8 & 255] + "-" + f[i >> 16 & 255] + f[i >> 24 & 255] + f[255 & r] + f[r >> 8 & 255] + f[r >> 16 & 255] + f[r >> 24 & 255]).toUpperCase()
                    },
                    clamp: function(e, t, i) {
                        return Math.max(t, Math.min(i, e))
                    },
                    euclideanModulo: function(e, t) {
                        return (e % t + t) % t
                    },
                    mapLinear: function(e, t, i, r, n) {
                        return r + (e - t) * (n - r) / (i - t)
                    },
                    lerp: function(e, t, i) {
                        return (1 - i) * e + i * t
                    },
                    smoothstep: function(e, t, i) {
                        return e <= t ? 0 : e >= i ? 1 : (e = (e - t) / (i - t)) * e * (3 - 2 * e)
                    },
                    smootherstep: function(e, t, i) {
                        return e <= t ? 0 : e >= i ? 1 : (e = (e - t) / (i - t)) * e * e * (e * (6 * e - 15) + 10)
                    },
                    randInt: function(e, t) {
                        return e + Math.floor(Math.random() * (t - e + 1))
                    },
                    randFloat: function(e, t) {
                        return e + Math.random() * (t - e)
                    },
                    randFloatSpread: function(e) {
                        return e * (.5 - Math.random())
                    },
                    seededRandom: function(e) {
                        return void 0 !== e && (m = e % 2147483647),
                        ((m = 16807 * m % 2147483647) - 1) / 2147483646
                    },
                    degToRad: function(e) {
                        return e * v.DEG2RAD
                    },
                    radToDeg: function(e) {
                        return e * v.RAD2DEG
                    },
                    isPowerOfTwo: function(e) {
                        return 0 == (e & e - 1) && 0 !== e
                    },
                    ceilPowerOfTwo: function(e) {
                        return Math.pow(2, Math.ceil(Math.log(e) / Math.LN2))
                    },
                    floorPowerOfTwo: function(e) {
                        return Math.pow(2, Math.floor(Math.log(e) / Math.LN2))
                    },
                    setQuaternionFromProperEuler: function(e, t, i, r, n) {
                        var a = Math.cos
                          , o = Math.sin
                          , s = a(i / 2)
                          , l = o(i / 2)
                          , u = a((t + r) / 2)
                          , c = o((t + r) / 2)
                          , h = a((t - r) / 2)
                          , p = o((t - r) / 2)
                          , f = a((r - t) / 2)
                          , d = o((r - t) / 2);
                        switch (n) {
                        case "XYX":
                            e.set(s * c, l * h, l * p, s * u);
                            break;
                        case "YZY":
                            e.set(l * p, s * c, l * h, s * u);
                            break;
                        case "ZXZ":
                            e.set(l * h, l * p, s * c, s * u);
                            break;
                        case "XZX":
                            e.set(s * c, l * d, l * f, s * u);
                            break;
                        case "YXY":
                            e.set(l * f, s * c, l * d, s * u);
                            break;
                        case "ZYZ":
                            e.set(l * d, l * f, s * c, s * u);
                            break;
                        default:
                            console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: " + n)
                        }
                    }
                };
                function g(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function y(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var _ = function() {
                    function e() {
                        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
                          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
                          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
                        g(this, e),
                        Object.defineProperty(this, "isQuaternion", {
                            value: !0
                        }),
                        this._x = t,
                        this._y = i,
                        this._z = r,
                        this._w = n
                    }
                    var t, i, r;
                    return t = e,
                    r = [{
                        key: "slerp",
                        value: function(e, t, i, r) {
                            return i.copy(e).slerp(t, r)
                        }
                    }, {
                        key: "slerpFlat",
                        value: function(e, t, i, r, n, a, o) {
                            var s = i[r + 0]
                              , l = i[r + 1]
                              , u = i[r + 2]
                              , c = i[r + 3]
                              , h = n[a + 0]
                              , p = n[a + 1]
                              , f = n[a + 2]
                              , d = n[a + 3];
                            if (c !== d || s !== h || l !== p || u !== f) {
                                var m = 1 - o
                                  , v = s * h + l * p + u * f + c * d
                                  , g = v >= 0 ? 1 : -1
                                  , y = 1 - v * v;
                                if (y > Number.EPSILON) {
                                    var _ = Math.sqrt(y)
                                      , x = Math.atan2(_, v * g);
                                    m = Math.sin(m * x) / _,
                                    o = Math.sin(o * x) / _
                                }
                                var b = o * g;
                                if (s = s * m + h * b,
                                l = l * m + p * b,
                                u = u * m + f * b,
                                c = c * m + d * b,
                                m === 1 - o) {
                                    var w = 1 / Math.sqrt(s * s + l * l + u * u + c * c);
                                    s *= w,
                                    l *= w,
                                    u *= w,
                                    c *= w
                                }
                            }
                            e[t] = s,
                            e[t + 1] = l,
                            e[t + 2] = u,
                            e[t + 3] = c
                        }
                    }, {
                        key: "multiplyQuaternionsFlat",
                        value: function(e, t, i, r, n, a) {
                            var o = i[r]
                              , s = i[r + 1]
                              , l = i[r + 2]
                              , u = i[r + 3]
                              , c = n[a]
                              , h = n[a + 1]
                              , p = n[a + 2]
                              , f = n[a + 3];
                            return e[t] = o * f + u * c + s * p - l * h,
                            e[t + 1] = s * f + u * h + l * c - o * p,
                            e[t + 2] = l * f + u * p + o * h - s * c,
                            e[t + 3] = u * f - o * c - s * h - l * p,
                            e
                        }
                    }],
                    (i = [{
                        key: "x",
                        get: function() {
                            return this._x
                        },
                        set: function(e) {
                            this._x = e,
                            this._onChangeCallback()
                        }
                    }, {
                        key: "y",
                        get: function() {
                            return this._y
                        },
                        set: function(e) {
                            this._y = e,
                            this._onChangeCallback()
                        }
                    }, {
                        key: "z",
                        get: function() {
                            return this._z
                        },
                        set: function(e) {
                            this._z = e,
                            this._onChangeCallback()
                        }
                    }, {
                        key: "w",
                        get: function() {
                            return this._w
                        },
                        set: function(e) {
                            this._w = e,
                            this._onChangeCallback()
                        }
                    }, {
                        key: "set",
                        value: function(e, t, i, r) {
                            return this._x = e,
                            this._y = t,
                            this._z = i,
                            this._w = r,
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return new this.constructor(this._x,this._y,this._z,this._w)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this._x = e.x,
                            this._y = e.y,
                            this._z = e.z,
                            this._w = e.w,
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "setFromEuler",
                        value: function(e, t) {
                            if (!e || !e.isEuler)
                                throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");
                            var i = e._x
                              , r = e._y
                              , n = e._z
                              , a = e._order
                              , o = Math.cos
                              , s = Math.sin
                              , l = o(i / 2)
                              , u = o(r / 2)
                              , c = o(n / 2)
                              , h = s(i / 2)
                              , p = s(r / 2)
                              , f = s(n / 2);
                            switch (a) {
                            case "XYZ":
                                this._x = h * u * c + l * p * f,
                                this._y = l * p * c - h * u * f,
                                this._z = l * u * f + h * p * c,
                                this._w = l * u * c - h * p * f;
                                break;
                            case "YXZ":
                                this._x = h * u * c + l * p * f,
                                this._y = l * p * c - h * u * f,
                                this._z = l * u * f - h * p * c,
                                this._w = l * u * c + h * p * f;
                                break;
                            case "ZXY":
                                this._x = h * u * c - l * p * f,
                                this._y = l * p * c + h * u * f,
                                this._z = l * u * f + h * p * c,
                                this._w = l * u * c - h * p * f;
                                break;
                            case "ZYX":
                                this._x = h * u * c - l * p * f,
                                this._y = l * p * c + h * u * f,
                                this._z = l * u * f - h * p * c,
                                this._w = l * u * c + h * p * f;
                                break;
                            case "YZX":
                                this._x = h * u * c + l * p * f,
                                this._y = l * p * c + h * u * f,
                                this._z = l * u * f - h * p * c,
                                this._w = l * u * c - h * p * f;
                                break;
                            case "XZY":
                                this._x = h * u * c - l * p * f,
                                this._y = l * p * c - h * u * f,
                                this._z = l * u * f + h * p * c,
                                this._w = l * u * c + h * p * f;
                                break;
                            default:
                                console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: " + a)
                            }
                            return !1 !== t && this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "setFromAxisAngle",
                        value: function(e, t) {
                            var i = t / 2
                              , r = Math.sin(i);
                            return this._x = e.x * r,
                            this._y = e.y * r,
                            this._z = e.z * r,
                            this._w = Math.cos(i),
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "setFromRotationMatrix",
                        value: function(e) {
                            var t = e.elements
                              , i = t[0]
                              , r = t[4]
                              , n = t[8]
                              , a = t[1]
                              , o = t[5]
                              , s = t[9]
                              , l = t[2]
                              , u = t[6]
                              , c = t[10]
                              , h = i + o + c;
                            if (h > 0) {
                                var p = .5 / Math.sqrt(h + 1);
                                this._w = .25 / p,
                                this._x = (u - s) * p,
                                this._y = (n - l) * p,
                                this._z = (a - r) * p
                            } else if (i > o && i > c) {
                                var f = 2 * Math.sqrt(1 + i - o - c);
                                this._w = (u - s) / f,
                                this._x = .25 * f,
                                this._y = (r + a) / f,
                                this._z = (n + l) / f
                            } else if (o > c) {
                                var d = 2 * Math.sqrt(1 + o - i - c);
                                this._w = (n - l) / d,
                                this._x = (r + a) / d,
                                this._y = .25 * d,
                                this._z = (s + u) / d
                            } else {
                                var m = 2 * Math.sqrt(1 + c - i - o);
                                this._w = (a - r) / m,
                                this._x = (n + l) / m,
                                this._y = (s + u) / m,
                                this._z = .25 * m
                            }
                            return this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "setFromUnitVectors",
                        value: function(e, t) {
                            var i = e.dot(t) + 1;
                            return i < 1e-6 ? (i = 0,
                            Math.abs(e.x) > Math.abs(e.z) ? (this._x = -e.y,
                            this._y = e.x,
                            this._z = 0,
                            this._w = i) : (this._x = 0,
                            this._y = -e.z,
                            this._z = e.y,
                            this._w = i)) : (this._x = e.y * t.z - e.z * t.y,
                            this._y = e.z * t.x - e.x * t.z,
                            this._z = e.x * t.y - e.y * t.x,
                            this._w = i),
                            this.normalize()
                        }
                    }, {
                        key: "angleTo",
                        value: function(e) {
                            return 2 * Math.acos(Math.abs(v.clamp(this.dot(e), -1, 1)))
                        }
                    }, {
                        key: "rotateTowards",
                        value: function(e, t) {
                            var i = this.angleTo(e);
                            if (0 === i)
                                return this;
                            var r = Math.min(1, t / i);
                            return this.slerp(e, r),
                            this
                        }
                    }, {
                        key: "identity",
                        value: function() {
                            return this.set(0, 0, 0, 1)
                        }
                    }, {
                        key: "invert",
                        value: function() {
                            return this.conjugate()
                        }
                    }, {
                        key: "conjugate",
                        value: function() {
                            return this._x *= -1,
                            this._y *= -1,
                            this._z *= -1,
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "dot",
                        value: function(e) {
                            return this._x * e._x + this._y * e._y + this._z * e._z + this._w * e._w
                        }
                    }, {
                        key: "lengthSq",
                        value: function() {
                            return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w
                        }
                    }, {
                        key: "length",
                        value: function() {
                            return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w)
                        }
                    }, {
                        key: "normalize",
                        value: function() {
                            var e = this.length();
                            return 0 === e ? (this._x = 0,
                            this._y = 0,
                            this._z = 0,
                            this._w = 1) : (e = 1 / e,
                            this._x = this._x * e,
                            this._y = this._y * e,
                            this._z = this._z * e,
                            this._w = this._w * e),
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "multiply",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
                            this.multiplyQuaternions(e, t)) : this.multiplyQuaternions(this, e)
                        }
                    }, {
                        key: "premultiply",
                        value: function(e) {
                            return this.multiplyQuaternions(e, this)
                        }
                    }, {
                        key: "multiplyQuaternions",
                        value: function(e, t) {
                            var i = e._x
                              , r = e._y
                              , n = e._z
                              , a = e._w
                              , o = t._x
                              , s = t._y
                              , l = t._z
                              , u = t._w;
                            return this._x = i * u + a * o + r * l - n * s,
                            this._y = r * u + a * s + n * o - i * l,
                            this._z = n * u + a * l + i * s - r * o,
                            this._w = a * u - i * o - r * s - n * l,
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "slerp",
                        value: function(e, t) {
                            if (0 === t)
                                return this;
                            if (1 === t)
                                return this.copy(e);
                            var i = this._x
                              , r = this._y
                              , n = this._z
                              , a = this._w
                              , o = a * e._w + i * e._x + r * e._y + n * e._z;
                            if (o < 0 ? (this._w = -e._w,
                            this._x = -e._x,
                            this._y = -e._y,
                            this._z = -e._z,
                            o = -o) : this.copy(e),
                            o >= 1)
                                return this._w = a,
                                this._x = i,
                                this._y = r,
                                this._z = n,
                                this;
                            var s = 1 - o * o;
                            if (s <= Number.EPSILON) {
                                var l = 1 - t;
                                return this._w = l * a + t * this._w,
                                this._x = l * i + t * this._x,
                                this._y = l * r + t * this._y,
                                this._z = l * n + t * this._z,
                                this.normalize(),
                                this._onChangeCallback(),
                                this
                            }
                            var u = Math.sqrt(s)
                              , c = Math.atan2(u, o)
                              , h = Math.sin((1 - t) * c) / u
                              , p = Math.sin(t * c) / u;
                            return this._w = a * h + this._w * p,
                            this._x = i * h + this._x * p,
                            this._y = r * h + this._y * p,
                            this._z = n * h + this._z * p,
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e._x === this._x && e._y === this._y && e._z === this._z && e._w === this._w
                        }
                    }, {
                        key: "fromArray",
                        value: function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return this._x = e[t],
                            this._y = e[t + 1],
                            this._z = e[t + 2],
                            this._w = e[t + 3],
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "toArray",
                        value: function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
                              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return e[t] = this._x,
                            e[t + 1] = this._y,
                            e[t + 2] = this._z,
                            e[t + 3] = this._w,
                            e
                        }
                    }, {
                        key: "fromBufferAttribute",
                        value: function(e, t) {
                            return this._x = e.getX(t),
                            this._y = e.getY(t),
                            this._z = e.getZ(t),
                            this._w = e.getW(t),
                            this
                        }
                    }, {
                        key: "_onChange",
                        value: function(e) {
                            return this._onChangeCallback = e,
                            this
                        }
                    }, {
                        key: "_onChangeCallback",
                        value: function() {}
                    }]) && y(t.prototype, i),
                    r && y(t, r),
                    e
                }();
                function x(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function b(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var w = function() {
                    function e() {
                        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
                          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;
                        x(this, e),
                        Object.defineProperty(this, "isVector3", {
                            value: !0
                        }),
                        this.x = t,
                        this.y = i,
                        this.z = r
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e, t, i) {
                            return void 0 === i && (i = this.z),
                            this.x = e,
                            this.y = t,
                            this.z = i,
                            this
                        }
                    }, {
                        key: "setScalar",
                        value: function(e) {
                            return this.x = e,
                            this.y = e,
                            this.z = e,
                            this
                        }
                    }, {
                        key: "setX",
                        value: function(e) {
                            return this.x = e,
                            this
                        }
                    }, {
                        key: "setY",
                        value: function(e) {
                            return this.y = e,
                            this
                        }
                    }, {
                        key: "setZ",
                        value: function(e) {
                            return this.z = e,
                            this
                        }
                    }, {
                        key: "setComponent",
                        value: function(e, t) {
                            switch (e) {
                            case 0:
                                this.x = t;
                                break;
                            case 1:
                                this.y = t;
                                break;
                            case 2:
                                this.z = t;
                                break;
                            default:
                                throw new Error("index is out of range: " + e)
                            }
                            return this
                        }
                    }, {
                        key: "getComponent",
                        value: function(e) {
                            switch (e) {
                            case 0:
                                return this.x;
                            case 1:
                                return this.y;
                            case 2:
                                return this.z;
                            default:
                                throw new Error("index is out of range: " + e)
                            }
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return new this.constructor(this.x,this.y,this.z)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this.x = e.x,
                            this.y = e.y,
                            this.z = e.z,
                            this
                        }
                    }, {
                        key: "add",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
                            this.addVectors(e, t)) : (this.x += e.x,
                            this.y += e.y,
                            this.z += e.z,
                            this)
                        }
                    }, {
                        key: "addScalar",
                        value: function(e) {
                            return this.x += e,
                            this.y += e,
                            this.z += e,
                            this
                        }
                    }, {
                        key: "addVectors",
                        value: function(e, t) {
                            return this.x = e.x + t.x,
                            this.y = e.y + t.y,
                            this.z = e.z + t.z,
                            this
                        }
                    }, {
                        key: "addScaledVector",
                        value: function(e, t) {
                            return this.x += e.x * t,
                            this.y += e.y * t,
                            this.z += e.z * t,
                            this
                        }
                    }, {
                        key: "sub",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
                            this.subVectors(e, t)) : (this.x -= e.x,
                            this.y -= e.y,
                            this.z -= e.z,
                            this)
                        }
                    }, {
                        key: "subScalar",
                        value: function(e) {
                            return this.x -= e,
                            this.y -= e,
                            this.z -= e,
                            this
                        }
                    }, {
                        key: "subVectors",
                        value: function(e, t) {
                            return this.x = e.x - t.x,
                            this.y = e.y - t.y,
                            this.z = e.z - t.z,
                            this
                        }
                    }, {
                        key: "multiply",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),
                            this.multiplyVectors(e, t)) : (this.x *= e.x,
                            this.y *= e.y,
                            this.z *= e.z,
                            this)
                        }
                    }, {
                        key: "multiplyScalar",
                        value: function(e) {
                            return this.x *= e,
                            this.y *= e,
                            this.z *= e,
                            this
                        }
                    }, {
                        key: "multiplyVectors",
                        value: function(e, t) {
                            return this.x = e.x * t.x,
                            this.y = e.y * t.y,
                            this.z = e.z * t.z,
                            this
                        }
                    }, {
                        key: "applyEuler",
                        value: function(e) {
                            return e && e.isEuler || console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),
                            this.applyQuaternion(M.setFromEuler(e))
                        }
                    }, {
                        key: "applyAxisAngle",
                        value: function(e, t) {
                            return this.applyQuaternion(M.setFromAxisAngle(e, t))
                        }
                    }, {
                        key: "applyMatrix3",
                        value: function(e) {
                            var t = this.x
                              , i = this.y
                              , r = this.z
                              , n = e.elements;
                            return this.x = n[0] * t + n[3] * i + n[6] * r,
                            this.y = n[1] * t + n[4] * i + n[7] * r,
                            this.z = n[2] * t + n[5] * i + n[8] * r,
                            this
                        }
                    }, {
                        key: "applyNormalMatrix",
                        value: function(e) {
                            return this.applyMatrix3(e).normalize()
                        }
                    }, {
                        key: "applyMatrix4",
                        value: function(e) {
                            var t = this.x
                              , i = this.y
                              , r = this.z
                              , n = e.elements
                              , a = 1 / (n[3] * t + n[7] * i + n[11] * r + n[15]);
                            return this.x = (n[0] * t + n[4] * i + n[8] * r + n[12]) * a,
                            this.y = (n[1] * t + n[5] * i + n[9] * r + n[13]) * a,
                            this.z = (n[2] * t + n[6] * i + n[10] * r + n[14]) * a,
                            this
                        }
                    }, {
                        key: "applyQuaternion",
                        value: function(e) {
                            var t = this.x
                              , i = this.y
                              , r = this.z
                              , n = e.x
                              , a = e.y
                              , o = e.z
                              , s = e.w
                              , l = s * t + a * r - o * i
                              , u = s * i + o * t - n * r
                              , c = s * r + n * i - a * t
                              , h = -n * t - a * i - o * r;
                            return this.x = l * s + h * -n + u * -o - c * -a,
                            this.y = u * s + h * -a + c * -n - l * -o,
                            this.z = c * s + h * -o + l * -a - u * -n,
                            this
                        }
                    }, {
                        key: "project",
                        value: function(e) {
                            return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)
                        }
                    }, {
                        key: "unproject",
                        value: function(e) {
                            return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)
                        }
                    }, {
                        key: "transformDirection",
                        value: function(e) {
                            var t = this.x
                              , i = this.y
                              , r = this.z
                              , n = e.elements;
                            return this.x = n[0] * t + n[4] * i + n[8] * r,
                            this.y = n[1] * t + n[5] * i + n[9] * r,
                            this.z = n[2] * t + n[6] * i + n[10] * r,
                            this.normalize()
                        }
                    }, {
                        key: "divide",
                        value: function(e) {
                            return this.x /= e.x,
                            this.y /= e.y,
                            this.z /= e.z,
                            this
                        }
                    }, {
                        key: "divideScalar",
                        value: function(e) {
                            return this.multiplyScalar(1 / e)
                        }
                    }, {
                        key: "min",
                        value: function(e) {
                            return this.x = Math.min(this.x, e.x),
                            this.y = Math.min(this.y, e.y),
                            this.z = Math.min(this.z, e.z),
                            this
                        }
                    }, {
                        key: "max",
                        value: function(e) {
                            return this.x = Math.max(this.x, e.x),
                            this.y = Math.max(this.y, e.y),
                            this.z = Math.max(this.z, e.z),
                            this
                        }
                    }, {
                        key: "clamp",
                        value: function(e, t) {
                            return this.x = Math.max(e.x, Math.min(t.x, this.x)),
                            this.y = Math.max(e.y, Math.min(t.y, this.y)),
                            this.z = Math.max(e.z, Math.min(t.z, this.z)),
                            this
                        }
                    }, {
                        key: "clampScalar",
                        value: function(e, t) {
                            return this.x = Math.max(e, Math.min(t, this.x)),
                            this.y = Math.max(e, Math.min(t, this.y)),
                            this.z = Math.max(e, Math.min(t, this.z)),
                            this
                        }
                    }, {
                        key: "clampLength",
                        value: function(e, t) {
                            var i = this.length();
                            return this.divideScalar(i || 1).multiplyScalar(Math.max(e, Math.min(t, i)))
                        }
                    }, {
                        key: "floor",
                        value: function() {
                            return this.x = Math.floor(this.x),
                            this.y = Math.floor(this.y),
                            this.z = Math.floor(this.z),
                            this
                        }
                    }, {
                        key: "ceil",
                        value: function() {
                            return this.x = Math.ceil(this.x),
                            this.y = Math.ceil(this.y),
                            this.z = Math.ceil(this.z),
                            this
                        }
                    }, {
                        key: "round",
                        value: function() {
                            return this.x = Math.round(this.x),
                            this.y = Math.round(this.y),
                            this.z = Math.round(this.z),
                            this
                        }
                    }, {
                        key: "roundToZero",
                        value: function() {
                            return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x),
                            this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y),
                            this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z),
                            this
                        }
                    }, {
                        key: "negate",
                        value: function() {
                            return this.x = -this.x,
                            this.y = -this.y,
                            this.z = -this.z,
                            this
                        }
                    }, {
                        key: "dot",
                        value: function(e) {
                            return this.x * e.x + this.y * e.y + this.z * e.z
                        }
                    }, {
                        key: "lengthSq",
                        value: function() {
                            return this.x * this.x + this.y * this.y + this.z * this.z
                        }
                    }, {
                        key: "length",
                        value: function() {
                            return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
                        }
                    }, {
                        key: "manhattanLength",
                        value: function() {
                            return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z)
                        }
                    }, {
                        key: "normalize",
                        value: function() {
                            return this.divideScalar(this.length() || 1)
                        }
                    }, {
                        key: "setLength",
                        value: function(e) {
                            return this.normalize().multiplyScalar(e)
                        }
                    }, {
                        key: "lerp",
                        value: function(e, t) {
                            return this.x += (e.x - this.x) * t,
                            this.y += (e.y - this.y) * t,
                            this.z += (e.z - this.z) * t,
                            this
                        }
                    }, {
                        key: "lerpVectors",
                        value: function(e, t, i) {
                            return this.x = e.x + (t.x - e.x) * i,
                            this.y = e.y + (t.y - e.y) * i,
                            this.z = e.z + (t.z - e.z) * i,
                            this
                        }
                    }, {
                        key: "cross",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),
                            this.crossVectors(e, t)) : this.crossVectors(this, e)
                        }
                    }, {
                        key: "crossVectors",
                        value: function(e, t) {
                            var i = e.x
                              , r = e.y
                              , n = e.z
                              , a = t.x
                              , o = t.y
                              , s = t.z;
                            return this.x = r * s - n * o,
                            this.y = n * a - i * s,
                            this.z = i * o - r * a,
                            this
                        }
                    }, {
                        key: "projectOnVector",
                        value: function(e) {
                            var t = e.lengthSq();
                            if (0 === t)
                                return this.set(0, 0, 0);
                            var i = e.dot(this) / t;
                            return this.copy(e).multiplyScalar(i)
                        }
                    }, {
                        key: "projectOnPlane",
                        value: function(e) {
                            return S.copy(this).projectOnVector(e),
                            this.sub(S)
                        }
                    }, {
                        key: "reflect",
                        value: function(e) {
                            return this.sub(S.copy(e).multiplyScalar(2 * this.dot(e)))
                        }
                    }, {
                        key: "angleTo",
                        value: function(e) {
                            var t = Math.sqrt(this.lengthSq() * e.lengthSq());
                            if (0 === t)
                                return Math.PI / 2;
                            var i = this.dot(e) / t;
                            return Math.acos(v.clamp(i, -1, 1))
                        }
                    }, {
                        key: "distanceTo",
                        value: function(e) {
                            return Math.sqrt(this.distanceToSquared(e))
                        }
                    }, {
                        key: "distanceToSquared",
                        value: function(e) {
                            var t = this.x - e.x
                              , i = this.y - e.y
                              , r = this.z - e.z;
                            return t * t + i * i + r * r
                        }
                    }, {
                        key: "manhattanDistanceTo",
                        value: function(e) {
                            return Math.abs(this.x - e.x) + Math.abs(this.y - e.y) + Math.abs(this.z - e.z)
                        }
                    }, {
                        key: "setFromSpherical",
                        value: function(e) {
                            return this.setFromSphericalCoords(e.radius, e.phi, e.theta)
                        }
                    }, {
                        key: "setFromSphericalCoords",
                        value: function(e, t, i) {
                            var r = Math.sin(t) * e;
                            return this.x = r * Math.sin(i),
                            this.y = Math.cos(t) * e,
                            this.z = r * Math.cos(i),
                            this
                        }
                    }, {
                        key: "setFromCylindrical",
                        value: function(e) {
                            return this.setFromCylindricalCoords(e.radius, e.theta, e.y)
                        }
                    }, {
                        key: "setFromCylindricalCoords",
                        value: function(e, t, i) {
                            return this.x = e * Math.sin(t),
                            this.y = i,
                            this.z = e * Math.cos(t),
                            this
                        }
                    }, {
                        key: "setFromMatrixPosition",
                        value: function(e) {
                            var t = e.elements;
                            return this.x = t[12],
                            this.y = t[13],
                            this.z = t[14],
                            this
                        }
                    }, {
                        key: "setFromMatrixScale",
                        value: function(e) {
                            var t = this.setFromMatrixColumn(e, 0).length()
                              , i = this.setFromMatrixColumn(e, 1).length()
                              , r = this.setFromMatrixColumn(e, 2).length();
                            return this.x = t,
                            this.y = i,
                            this.z = r,
                            this
                        }
                    }, {
                        key: "setFromMatrixColumn",
                        value: function(e, t) {
                            return this.fromArray(e.elements, 4 * t)
                        }
                    }, {
                        key: "setFromMatrix3Column",
                        value: function(e, t) {
                            return this.fromArray(e.elements, 3 * t)
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e.x === this.x && e.y === this.y && e.z === this.z
                        }
                    }, {
                        key: "fromArray",
                        value: function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return this.x = e[t],
                            this.y = e[t + 1],
                            this.z = e[t + 2],
                            this
                        }
                    }, {
                        key: "toArray",
                        value: function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
                              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return e[t] = this.x,
                            e[t + 1] = this.y,
                            e[t + 2] = this.z,
                            e
                        }
                    }, {
                        key: "fromBufferAttribute",
                        value: function(e, t, i) {
                            return void 0 !== i && console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),
                            this.x = e.getX(t),
                            this.y = e.getY(t),
                            this.z = e.getZ(t),
                            this
                        }
                    }, {
                        key: "random",
                        value: function() {
                            return this.x = Math.random(),
                            this.y = Math.random(),
                            this.z = Math.random(),
                            this
                        }
                    }]) && b(t.prototype, i),
                    e
                }()
                  , S = new w
                  , M = new _;
                function T(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function E(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var A = function() {
                    function e() {
                        T(this, e),
                        Object.defineProperty(this, "isMatrix4", {
                            value: !0
                        }),
                        this.elements = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
                        arguments.length > 0 && console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m) {
                            var v = this.elements;
                            return v[0] = e,
                            v[4] = t,
                            v[8] = i,
                            v[12] = r,
                            v[1] = n,
                            v[5] = a,
                            v[9] = o,
                            v[13] = s,
                            v[2] = l,
                            v[6] = u,
                            v[10] = c,
                            v[14] = h,
                            v[3] = p,
                            v[7] = f,
                            v[11] = d,
                            v[15] = m,
                            this
                        }
                    }, {
                        key: "identity",
                        value: function() {
                            return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return (new e).fromArray(this.elements)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            var t = this.elements
                              , i = e.elements;
                            return t[0] = i[0],
                            t[1] = i[1],
                            t[2] = i[2],
                            t[3] = i[3],
                            t[4] = i[4],
                            t[5] = i[5],
                            t[6] = i[6],
                            t[7] = i[7],
                            t[8] = i[8],
                            t[9] = i[9],
                            t[10] = i[10],
                            t[11] = i[11],
                            t[12] = i[12],
                            t[13] = i[13],
                            t[14] = i[14],
                            t[15] = i[15],
                            this
                        }
                    }, {
                        key: "copyPosition",
                        value: function(e) {
                            var t = this.elements
                              , i = e.elements;
                            return t[12] = i[12],
                            t[13] = i[13],
                            t[14] = i[14],
                            this
                        }
                    }, {
                        key: "extractBasis",
                        value: function(e, t, i) {
                            return e.setFromMatrixColumn(this, 0),
                            t.setFromMatrixColumn(this, 1),
                            i.setFromMatrixColumn(this, 2),
                            this
                        }
                    }, {
                        key: "makeBasis",
                        value: function(e, t, i) {
                            return this.set(e.x, t.x, i.x, 0, e.y, t.y, i.y, 0, e.z, t.z, i.z, 0, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "extractRotation",
                        value: function(e) {
                            var t = this.elements
                              , i = e.elements
                              , r = 1 / P.setFromMatrixColumn(e, 0).length()
                              , n = 1 / P.setFromMatrixColumn(e, 1).length()
                              , a = 1 / P.setFromMatrixColumn(e, 2).length();
                            return t[0] = i[0] * r,
                            t[1] = i[1] * r,
                            t[2] = i[2] * r,
                            t[3] = 0,
                            t[4] = i[4] * n,
                            t[5] = i[5] * n,
                            t[6] = i[6] * n,
                            t[7] = 0,
                            t[8] = i[8] * a,
                            t[9] = i[9] * a,
                            t[10] = i[10] * a,
                            t[11] = 0,
                            t[12] = 0,
                            t[13] = 0,
                            t[14] = 0,
                            t[15] = 1,
                            this
                        }
                    }, {
                        key: "makeRotationFromEuler",
                        value: function(e) {
                            e && e.isEuler || console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
                            var t = this.elements
                              , i = e.x
                              , r = e.y
                              , n = e.z
                              , a = Math.cos(i)
                              , o = Math.sin(i)
                              , s = Math.cos(r)
                              , l = Math.sin(r)
                              , u = Math.cos(n)
                              , c = Math.sin(n);
                            if ("XYZ" === e.order) {
                                var h = a * u
                                  , p = a * c
                                  , f = o * u
                                  , d = o * c;
                                t[0] = s * u,
                                t[4] = -s * c,
                                t[8] = l,
                                t[1] = p + f * l,
                                t[5] = h - d * l,
                                t[9] = -o * s,
                                t[2] = d - h * l,
                                t[6] = f + p * l,
                                t[10] = a * s
                            } else if ("YXZ" === e.order) {
                                var m = s * u
                                  , v = s * c
                                  , g = l * u
                                  , y = l * c;
                                t[0] = m + y * o,
                                t[4] = g * o - v,
                                t[8] = a * l,
                                t[1] = a * c,
                                t[5] = a * u,
                                t[9] = -o,
                                t[2] = v * o - g,
                                t[6] = y + m * o,
                                t[10] = a * s
                            } else if ("ZXY" === e.order) {
                                var _ = s * u
                                  , x = s * c
                                  , b = l * u
                                  , w = l * c;
                                t[0] = _ - w * o,
                                t[4] = -a * c,
                                t[8] = b + x * o,
                                t[1] = x + b * o,
                                t[5] = a * u,
                                t[9] = w - _ * o,
                                t[2] = -a * l,
                                t[6] = o,
                                t[10] = a * s
                            } else if ("ZYX" === e.order) {
                                var S = a * u
                                  , M = a * c
                                  , T = o * u
                                  , E = o * c;
                                t[0] = s * u,
                                t[4] = T * l - M,
                                t[8] = S * l + E,
                                t[1] = s * c,
                                t[5] = E * l + S,
                                t[9] = M * l - T,
                                t[2] = -l,
                                t[6] = o * s,
                                t[10] = a * s
                            } else if ("YZX" === e.order) {
                                var A = a * s
                                  , P = a * l
                                  , C = o * s
                                  , L = o * l;
                                t[0] = s * u,
                                t[4] = L - A * c,
                                t[8] = C * c + P,
                                t[1] = c,
                                t[5] = a * u,
                                t[9] = -o * u,
                                t[2] = -l * u,
                                t[6] = P * c + C,
                                t[10] = A - L * c
                            } else if ("XZY" === e.order) {
                                var I = a * s
                                  , k = a * l
                                  , z = o * s
                                  , D = o * l;
                                t[0] = s * u,
                                t[4] = -c,
                                t[8] = l * u,
                                t[1] = I * c + D,
                                t[5] = a * u,
                                t[9] = k * c - z,
                                t[2] = z * c - k,
                                t[6] = o * u,
                                t[10] = D * c + I
                            }
                            return t[3] = 0,
                            t[7] = 0,
                            t[11] = 0,
                            t[12] = 0,
                            t[13] = 0,
                            t[14] = 0,
                            t[15] = 1,
                            this
                        }
                    }, {
                        key: "makeRotationFromQuaternion",
                        value: function(e) {
                            return this.compose(L, e, I)
                        }
                    }, {
                        key: "lookAt",
                        value: function(e, t, i) {
                            var r = this.elements;
                            return D.subVectors(e, t),
                            0 === D.lengthSq() && (D.z = 1),
                            D.normalize(),
                            k.crossVectors(i, D),
                            0 === k.lengthSq() && (1 === Math.abs(i.z) ? D.x += 1e-4 : D.z += 1e-4,
                            D.normalize(),
                            k.crossVectors(i, D)),
                            k.normalize(),
                            z.crossVectors(D, k),
                            r[0] = k.x,
                            r[4] = z.x,
                            r[8] = D.x,
                            r[1] = k.y,
                            r[5] = z.y,
                            r[9] = D.y,
                            r[2] = k.z,
                            r[6] = z.z,
                            r[10] = D.z,
                            this
                        }
                    }, {
                        key: "multiply",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),
                            this.multiplyMatrices(e, t)) : this.multiplyMatrices(this, e)
                        }
                    }, {
                        key: "premultiply",
                        value: function(e) {
                            return this.multiplyMatrices(e, this)
                        }
                    }, {
                        key: "multiplyMatrices",
                        value: function(e, t) {
                            var i = e.elements
                              , r = t.elements
                              , n = this.elements
                              , a = i[0]
                              , o = i[4]
                              , s = i[8]
                              , l = i[12]
                              , u = i[1]
                              , c = i[5]
                              , h = i[9]
                              , p = i[13]
                              , f = i[2]
                              , d = i[6]
                              , m = i[10]
                              , v = i[14]
                              , g = i[3]
                              , y = i[7]
                              , _ = i[11]
                              , x = i[15]
                              , b = r[0]
                              , w = r[4]
                              , S = r[8]
                              , M = r[12]
                              , T = r[1]
                              , E = r[5]
                              , A = r[9]
                              , P = r[13]
                              , C = r[2]
                              , L = r[6]
                              , I = r[10]
                              , k = r[14]
                              , z = r[3]
                              , D = r[7]
                              , R = r[11]
                              , O = r[15];
                            return n[0] = a * b + o * T + s * C + l * z,
                            n[4] = a * w + o * E + s * L + l * D,
                            n[8] = a * S + o * A + s * I + l * R,
                            n[12] = a * M + o * P + s * k + l * O,
                            n[1] = u * b + c * T + h * C + p * z,
                            n[5] = u * w + c * E + h * L + p * D,
                            n[9] = u * S + c * A + h * I + p * R,
                            n[13] = u * M + c * P + h * k + p * O,
                            n[2] = f * b + d * T + m * C + v * z,
                            n[6] = f * w + d * E + m * L + v * D,
                            n[10] = f * S + d * A + m * I + v * R,
                            n[14] = f * M + d * P + m * k + v * O,
                            n[3] = g * b + y * T + _ * C + x * z,
                            n[7] = g * w + y * E + _ * L + x * D,
                            n[11] = g * S + y * A + _ * I + x * R,
                            n[15] = g * M + y * P + _ * k + x * O,
                            this
                        }
                    }, {
                        key: "multiplyScalar",
                        value: function(e) {
                            var t = this.elements;
                            return t[0] *= e,
                            t[4] *= e,
                            t[8] *= e,
                            t[12] *= e,
                            t[1] *= e,
                            t[5] *= e,
                            t[9] *= e,
                            t[13] *= e,
                            t[2] *= e,
                            t[6] *= e,
                            t[10] *= e,
                            t[14] *= e,
                            t[3] *= e,
                            t[7] *= e,
                            t[11] *= e,
                            t[15] *= e,
                            this
                        }
                    }, {
                        key: "determinant",
                        value: function() {
                            var e = this.elements
                              , t = e[0]
                              , i = e[4]
                              , r = e[8]
                              , n = e[12]
                              , a = e[1]
                              , o = e[5]
                              , s = e[9]
                              , l = e[13]
                              , u = e[2]
                              , c = e[6]
                              , h = e[10]
                              , p = e[14];
                            return e[3] * (+n * s * c - r * l * c - n * o * h + i * l * h + r * o * p - i * s * p) + e[7] * (+t * s * p - t * l * h + n * a * h - r * a * p + r * l * u - n * s * u) + e[11] * (+t * l * c - t * o * p - n * a * c + i * a * p + n * o * u - i * l * u) + e[15] * (-r * o * u - t * s * c + t * o * h + r * a * c - i * a * h + i * s * u)
                        }
                    }, {
                        key: "transpose",
                        value: function() {
                            var e, t = this.elements;
                            return e = t[1],
                            t[1] = t[4],
                            t[4] = e,
                            e = t[2],
                            t[2] = t[8],
                            t[8] = e,
                            e = t[6],
                            t[6] = t[9],
                            t[9] = e,
                            e = t[3],
                            t[3] = t[12],
                            t[12] = e,
                            e = t[7],
                            t[7] = t[13],
                            t[13] = e,
                            e = t[11],
                            t[11] = t[14],
                            t[14] = e,
                            this
                        }
                    }, {
                        key: "setPosition",
                        value: function(e, t, i) {
                            var r = this.elements;
                            return e.isVector3 ? (r[12] = e.x,
                            r[13] = e.y,
                            r[14] = e.z) : (r[12] = e,
                            r[13] = t,
                            r[14] = i),
                            this
                        }
                    }, {
                        key: "invert",
                        value: function() {
                            var e = this.elements
                              , t = e[0]
                              , i = e[1]
                              , r = e[2]
                              , n = e[3]
                              , a = e[4]
                              , o = e[5]
                              , s = e[6]
                              , l = e[7]
                              , u = e[8]
                              , c = e[9]
                              , h = e[10]
                              , p = e[11]
                              , f = e[12]
                              , d = e[13]
                              , m = e[14]
                              , v = e[15]
                              , g = c * m * l - d * h * l + d * s * p - o * m * p - c * s * v + o * h * v
                              , y = f * h * l - u * m * l - f * s * p + a * m * p + u * s * v - a * h * v
                              , _ = u * d * l - f * c * l + f * o * p - a * d * p - u * o * v + a * c * v
                              , x = f * c * s - u * d * s - f * o * h + a * d * h + u * o * m - a * c * m
                              , b = t * g + i * y + r * _ + n * x;
                            if (0 === b)
                                return this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
                            var w = 1 / b;
                            return e[0] = g * w,
                            e[1] = (d * h * n - c * m * n - d * r * p + i * m * p + c * r * v - i * h * v) * w,
                            e[2] = (o * m * n - d * s * n + d * r * l - i * m * l - o * r * v + i * s * v) * w,
                            e[3] = (c * s * n - o * h * n - c * r * l + i * h * l + o * r * p - i * s * p) * w,
                            e[4] = y * w,
                            e[5] = (u * m * n - f * h * n + f * r * p - t * m * p - u * r * v + t * h * v) * w,
                            e[6] = (f * s * n - a * m * n - f * r * l + t * m * l + a * r * v - t * s * v) * w,
                            e[7] = (a * h * n - u * s * n + u * r * l - t * h * l - a * r * p + t * s * p) * w,
                            e[8] = _ * w,
                            e[9] = (f * c * n - u * d * n - f * i * p + t * d * p + u * i * v - t * c * v) * w,
                            e[10] = (a * d * n - f * o * n + f * i * l - t * d * l - a * i * v + t * o * v) * w,
                            e[11] = (u * o * n - a * c * n - u * i * l + t * c * l + a * i * p - t * o * p) * w,
                            e[12] = x * w,
                            e[13] = (u * d * r - f * c * r + f * i * h - t * d * h - u * i * m + t * c * m) * w,
                            e[14] = (f * o * r - a * d * r - f * i * s + t * d * s + a * i * m - t * o * m) * w,
                            e[15] = (a * c * r - u * o * r + u * i * s - t * c * s - a * i * h + t * o * h) * w,
                            this
                        }
                    }, {
                        key: "scale",
                        value: function(e) {
                            var t = this.elements
                              , i = e.x
                              , r = e.y
                              , n = e.z;
                            return t[0] *= i,
                            t[4] *= r,
                            t[8] *= n,
                            t[1] *= i,
                            t[5] *= r,
                            t[9] *= n,
                            t[2] *= i,
                            t[6] *= r,
                            t[10] *= n,
                            t[3] *= i,
                            t[7] *= r,
                            t[11] *= n,
                            this
                        }
                    }, {
                        key: "getMaxScaleOnAxis",
                        value: function() {
                            var e = this.elements
                              , t = e[0] * e[0] + e[1] * e[1] + e[2] * e[2]
                              , i = e[4] * e[4] + e[5] * e[5] + e[6] * e[6]
                              , r = e[8] * e[8] + e[9] * e[9] + e[10] * e[10];
                            return Math.sqrt(Math.max(t, i, r))
                        }
                    }, {
                        key: "makeTranslation",
                        value: function(e, t, i) {
                            return this.set(1, 0, 0, e, 0, 1, 0, t, 0, 0, 1, i, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "makeRotationX",
                        value: function(e) {
                            var t = Math.cos(e)
                              , i = Math.sin(e);
                            return this.set(1, 0, 0, 0, 0, t, -i, 0, 0, i, t, 0, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "makeRotationY",
                        value: function(e) {
                            var t = Math.cos(e)
                              , i = Math.sin(e);
                            return this.set(t, 0, i, 0, 0, 1, 0, 0, -i, 0, t, 0, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "makeRotationZ",
                        value: function(e) {
                            var t = Math.cos(e)
                              , i = Math.sin(e);
                            return this.set(t, -i, 0, 0, i, t, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "makeRotationAxis",
                        value: function(e, t) {
                            var i = Math.cos(t)
                              , r = Math.sin(t)
                              , n = 1 - i
                              , a = e.x
                              , o = e.y
                              , s = e.z
                              , l = n * a
                              , u = n * o;
                            return this.set(l * a + i, l * o - r * s, l * s + r * o, 0, l * o + r * s, u * o + i, u * s - r * a, 0, l * s - r * o, u * s + r * a, n * s * s + i, 0, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "makeScale",
                        value: function(e, t, i) {
                            return this.set(e, 0, 0, 0, 0, t, 0, 0, 0, 0, i, 0, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "makeShear",
                        value: function(e, t, i) {
                            return this.set(1, t, i, 0, e, 1, i, 0, e, t, 1, 0, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "compose",
                        value: function(e, t, i) {
                            var r = this.elements
                              , n = t._x
                              , a = t._y
                              , o = t._z
                              , s = t._w
                              , l = n + n
                              , u = a + a
                              , c = o + o
                              , h = n * l
                              , p = n * u
                              , f = n * c
                              , d = a * u
                              , m = a * c
                              , v = o * c
                              , g = s * l
                              , y = s * u
                              , _ = s * c
                              , x = i.x
                              , b = i.y
                              , w = i.z;
                            return r[0] = (1 - (d + v)) * x,
                            r[1] = (p + _) * x,
                            r[2] = (f - y) * x,
                            r[3] = 0,
                            r[4] = (p - _) * b,
                            r[5] = (1 - (h + v)) * b,
                            r[6] = (m + g) * b,
                            r[7] = 0,
                            r[8] = (f + y) * w,
                            r[9] = (m - g) * w,
                            r[10] = (1 - (h + d)) * w,
                            r[11] = 0,
                            r[12] = e.x,
                            r[13] = e.y,
                            r[14] = e.z,
                            r[15] = 1,
                            this
                        }
                    }, {
                        key: "decompose",
                        value: function(e, t, i) {
                            var r = this.elements
                              , n = P.set(r[0], r[1], r[2]).length()
                              , a = P.set(r[4], r[5], r[6]).length()
                              , o = P.set(r[8], r[9], r[10]).length();
                            this.determinant() < 0 && (n = -n),
                            e.x = r[12],
                            e.y = r[13],
                            e.z = r[14],
                            C.copy(this);
                            var s = 1 / n
                              , l = 1 / a
                              , u = 1 / o;
                            return C.elements[0] *= s,
                            C.elements[1] *= s,
                            C.elements[2] *= s,
                            C.elements[4] *= l,
                            C.elements[5] *= l,
                            C.elements[6] *= l,
                            C.elements[8] *= u,
                            C.elements[9] *= u,
                            C.elements[10] *= u,
                            t.setFromRotationMatrix(C),
                            i.x = n,
                            i.y = a,
                            i.z = o,
                            this
                        }
                    }, {
                        key: "makePerspective",
                        value: function(e, t, i, r, n, a) {
                            void 0 === a && console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
                            var o = this.elements
                              , s = 2 * n / (t - e)
                              , l = 2 * n / (i - r)
                              , u = (t + e) / (t - e)
                              , c = (i + r) / (i - r)
                              , h = -(a + n) / (a - n)
                              , p = -2 * a * n / (a - n);
                            return o[0] = s,
                            o[4] = 0,
                            o[8] = u,
                            o[12] = 0,
                            o[1] = 0,
                            o[5] = l,
                            o[9] = c,
                            o[13] = 0,
                            o[2] = 0,
                            o[6] = 0,
                            o[10] = h,
                            o[14] = p,
                            o[3] = 0,
                            o[7] = 0,
                            o[11] = -1,
                            o[15] = 0,
                            this
                        }
                    }, {
                        key: "makeOrthographic",
                        value: function(e, t, i, r, n, a) {
                            var o = this.elements
                              , s = 1 / (t - e)
                              , l = 1 / (i - r)
                              , u = 1 / (a - n)
                              , c = (t + e) * s
                              , h = (i + r) * l
                              , p = (a + n) * u;
                            return o[0] = 2 * s,
                            o[4] = 0,
                            o[8] = 0,
                            o[12] = -c,
                            o[1] = 0,
                            o[5] = 2 * l,
                            o[9] = 0,
                            o[13] = -h,
                            o[2] = 0,
                            o[6] = 0,
                            o[10] = -2 * u,
                            o[14] = -p,
                            o[3] = 0,
                            o[7] = 0,
                            o[11] = 0,
                            o[15] = 1,
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            for (var t = this.elements, i = e.elements, r = 0; r < 16; r++)
                                if (t[r] !== i[r])
                                    return !1;
                            return !0
                        }
                    }, {
                        key: "fromArray",
                        value: function(e) {
                            for (var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, i = 0; i < 16; i++)
                                this.elements[i] = e[i + t];
                            return this
                        }
                    }, {
                        key: "toArray",
                        value: function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
                              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                              , i = this.elements;
                            return e[t] = i[0],
                            e[t + 1] = i[1],
                            e[t + 2] = i[2],
                            e[t + 3] = i[3],
                            e[t + 4] = i[4],
                            e[t + 5] = i[5],
                            e[t + 6] = i[6],
                            e[t + 7] = i[7],
                            e[t + 8] = i[8],
                            e[t + 9] = i[9],
                            e[t + 10] = i[10],
                            e[t + 11] = i[11],
                            e[t + 12] = i[12],
                            e[t + 13] = i[13],
                            e[t + 14] = i[14],
                            e[t + 15] = i[15],
                            e
                        }
                    }]) && E(t.prototype, i),
                    e
                }()
                  , P = new w
                  , C = new A
                  , L = new w(0,0,0)
                  , I = new w(1,1,1)
                  , k = new w
                  , z = new w
                  , D = new w;
                function R() {}
                function O(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function B(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                Object.assign(R.prototype, {
                    addEventListener: function(e, t) {
                        void 0 === this._listeners && (this._listeners = {});
                        var i = this._listeners;
                        void 0 === i[e] && (i[e] = []),
                        -1 === i[e].indexOf(t) && i[e].push(t)
                    },
                    hasEventListener: function(e, t) {
                        if (void 0 === this._listeners)
                            return !1;
                        var i = this._listeners;
                        return void 0 !== i[e] && -1 !== i[e].indexOf(t)
                    },
                    removeEventListener: function(e, t) {
                        if (void 0 !== this._listeners) {
                            var i = this._listeners[e];
                            if (void 0 !== i) {
                                var r = i.indexOf(t);
                                -1 !== r && i.splice(r, 1)
                            }
                        }
                    },
                    dispatchEvent: function(e) {
                        if (void 0 !== this._listeners) {
                            var t = this._listeners[e.type];
                            if (void 0 !== t) {
                                e.target = this;
                                for (var i = t.slice(0), r = 0, n = i.length; r < n; r++)
                                    i[r].call(this, e)
                            }
                        }
                    }
                });
                var F = function() {
                    function e() {
                        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
                          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
                          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : e.DefaultOrder;
                        O(this, e),
                        Object.defineProperty(this, "isEuler", {
                            value: !0
                        }),
                        this._x = t,
                        this._y = i,
                        this._z = r,
                        this._order = n
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "x",
                        get: function() {
                            return this._x
                        },
                        set: function(e) {
                            this._x = e,
                            this._onChangeCallback()
                        }
                    }, {
                        key: "y",
                        get: function() {
                            return this._y
                        },
                        set: function(e) {
                            this._y = e,
                            this._onChangeCallback()
                        }
                    }, {
                        key: "z",
                        get: function() {
                            return this._z
                        },
                        set: function(e) {
                            this._z = e,
                            this._onChangeCallback()
                        }
                    }, {
                        key: "order",
                        get: function() {
                            return this._order
                        },
                        set: function(e) {
                            this._order = e,
                            this._onChangeCallback()
                        }
                    }, {
                        key: "set",
                        value: function(e, t, i, r) {
                            return this._x = e,
                            this._y = t,
                            this._z = i,
                            this._order = r || this._order,
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return new this.constructor(this._x,this._y,this._z,this._order)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this._x = e._x,
                            this._y = e._y,
                            this._z = e._z,
                            this._order = e._order,
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "setFromRotationMatrix",
                        value: function(e, t, i) {
                            var r = v.clamp
                              , n = e.elements
                              , a = n[0]
                              , o = n[4]
                              , s = n[8]
                              , l = n[1]
                              , u = n[5]
                              , c = n[9]
                              , h = n[2]
                              , p = n[6]
                              , f = n[10];
                            switch (t = t || this._order) {
                            case "XYZ":
                                this._y = Math.asin(r(s, -1, 1)),
                                Math.abs(s) < .9999999 ? (this._x = Math.atan2(-c, f),
                                this._z = Math.atan2(-o, a)) : (this._x = Math.atan2(p, u),
                                this._z = 0);
                                break;
                            case "YXZ":
                                this._x = Math.asin(-r(c, -1, 1)),
                                Math.abs(c) < .9999999 ? (this._y = Math.atan2(s, f),
                                this._z = Math.atan2(l, u)) : (this._y = Math.atan2(-h, a),
                                this._z = 0);
                                break;
                            case "ZXY":
                                this._x = Math.asin(r(p, -1, 1)),
                                Math.abs(p) < .9999999 ? (this._y = Math.atan2(-h, f),
                                this._z = Math.atan2(-o, u)) : (this._y = 0,
                                this._z = Math.atan2(l, a));
                                break;
                            case "ZYX":
                                this._y = Math.asin(-r(h, -1, 1)),
                                Math.abs(h) < .9999999 ? (this._x = Math.atan2(p, f),
                                this._z = Math.atan2(l, a)) : (this._x = 0,
                                this._z = Math.atan2(-o, u));
                                break;
                            case "YZX":
                                this._z = Math.asin(r(l, -1, 1)),
                                Math.abs(l) < .9999999 ? (this._x = Math.atan2(-c, u),
                                this._y = Math.atan2(-h, a)) : (this._x = 0,
                                this._y = Math.atan2(s, f));
                                break;
                            case "XZY":
                                this._z = Math.asin(-r(o, -1, 1)),
                                Math.abs(o) < .9999999 ? (this._x = Math.atan2(p, u),
                                this._y = Math.atan2(s, a)) : (this._x = Math.atan2(-c, f),
                                this._y = 0);
                                break;
                            default:
                                console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: " + t)
                            }
                            return this._order = t,
                            !1 !== i && this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "setFromQuaternion",
                        value: function(e, t, i) {
                            return N.makeRotationFromQuaternion(e),
                            this.setFromRotationMatrix(N, t, i)
                        }
                    }, {
                        key: "setFromVector3",
                        value: function(e, t) {
                            return this.set(e.x, e.y, e.z, t || this._order)
                        }
                    }, {
                        key: "reorder",
                        value: function(e) {
                            return U.setFromEuler(this),
                            this.setFromQuaternion(U, e)
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e._x === this._x && e._y === this._y && e._z === this._z && e._order === this._order
                        }
                    }, {
                        key: "fromArray",
                        value: function(e) {
                            return this._x = e[0],
                            this._y = e[1],
                            this._z = e[2],
                            void 0 !== e[3] && (this._order = e[3]),
                            this._onChangeCallback(),
                            this
                        }
                    }, {
                        key: "toArray",
                        value: function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
                              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return e[t] = this._x,
                            e[t + 1] = this._y,
                            e[t + 2] = this._z,
                            e[t + 3] = this._order,
                            e
                        }
                    }, {
                        key: "toVector3",
                        value: function(e) {
                            return e ? e.set(this._x, this._y, this._z) : new w(this._x,this._y,this._z)
                        }
                    }, {
                        key: "_onChange",
                        value: function(e) {
                            return this._onChangeCallback = e,
                            this
                        }
                    }, {
                        key: "_onChangeCallback",
                        value: function() {}
                    }]) && B(t.prototype, i),
                    e
                }();
                F.DefaultOrder = "XYZ",
                F.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"];
                var N = new A
                  , U = new _;
                function V(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var G = function() {
                    function e() {
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, e),
                        this.mask = 1
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e) {
                            this.mask = 1 << e | 0
                        }
                    }, {
                        key: "enable",
                        value: function(e) {
                            this.mask |= 1 << e | 0
                        }
                    }, {
                        key: "enableAll",
                        value: function() {
                            this.mask = -1
                        }
                    }, {
                        key: "toggle",
                        value: function(e) {
                            this.mask ^= 1 << e | 0
                        }
                    }, {
                        key: "disable",
                        value: function(e) {
                            this.mask &= ~(1 << e | 0)
                        }
                    }, {
                        key: "disableAll",
                        value: function() {
                            this.mask = 0
                        }
                    }, {
                        key: "test",
                        value: function(e) {
                            return 0 != (this.mask & e.mask)
                        }
                    }]) && V(t.prototype, i),
                    e
                }();
                function j(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function H(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var q = function() {
                    function e() {
                        j(this, e),
                        Object.defineProperty(this, "isMatrix3", {
                            value: !0
                        }),
                        this.elements = [1, 0, 0, 0, 1, 0, 0, 0, 1],
                        arguments.length > 0 && console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e, t, i, r, n, a, o, s, l) {
                            var u = this.elements;
                            return u[0] = e,
                            u[1] = r,
                            u[2] = o,
                            u[3] = t,
                            u[4] = n,
                            u[5] = s,
                            u[6] = i,
                            u[7] = a,
                            u[8] = l,
                            this
                        }
                    }, {
                        key: "identity",
                        value: function() {
                            return this.set(1, 0, 0, 0, 1, 0, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return (new this.constructor).fromArray(this.elements)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            var t = this.elements
                              , i = e.elements;
                            return t[0] = i[0],
                            t[1] = i[1],
                            t[2] = i[2],
                            t[3] = i[3],
                            t[4] = i[4],
                            t[5] = i[5],
                            t[6] = i[6],
                            t[7] = i[7],
                            t[8] = i[8],
                            this
                        }
                    }, {
                        key: "extractBasis",
                        value: function(e, t, i) {
                            return e.setFromMatrix3Column(this, 0),
                            t.setFromMatrix3Column(this, 1),
                            i.setFromMatrix3Column(this, 2),
                            this
                        }
                    }, {
                        key: "setFromMatrix4",
                        value: function(e) {
                            var t = e.elements;
                            return this.set(t[0], t[4], t[8], t[1], t[5], t[9], t[2], t[6], t[10]),
                            this
                        }
                    }, {
                        key: "multiply",
                        value: function(e) {
                            return this.multiplyMatrices(this, e)
                        }
                    }, {
                        key: "premultiply",
                        value: function(e) {
                            return this.multiplyMatrices(e, this)
                        }
                    }, {
                        key: "multiplyMatrices",
                        value: function(e, t) {
                            var i = e.elements
                              , r = t.elements
                              , n = this.elements
                              , a = i[0]
                              , o = i[3]
                              , s = i[6]
                              , l = i[1]
                              , u = i[4]
                              , c = i[7]
                              , h = i[2]
                              , p = i[5]
                              , f = i[8]
                              , d = r[0]
                              , m = r[3]
                              , v = r[6]
                              , g = r[1]
                              , y = r[4]
                              , _ = r[7]
                              , x = r[2]
                              , b = r[5]
                              , w = r[8];
                            return n[0] = a * d + o * g + s * x,
                            n[3] = a * m + o * y + s * b,
                            n[6] = a * v + o * _ + s * w,
                            n[1] = l * d + u * g + c * x,
                            n[4] = l * m + u * y + c * b,
                            n[7] = l * v + u * _ + c * w,
                            n[2] = h * d + p * g + f * x,
                            n[5] = h * m + p * y + f * b,
                            n[8] = h * v + p * _ + f * w,
                            this
                        }
                    }, {
                        key: "multiplyScalar",
                        value: function(e) {
                            var t = this.elements;
                            return t[0] *= e,
                            t[3] *= e,
                            t[6] *= e,
                            t[1] *= e,
                            t[4] *= e,
                            t[7] *= e,
                            t[2] *= e,
                            t[5] *= e,
                            t[8] *= e,
                            this
                        }
                    }, {
                        key: "determinant",
                        value: function() {
                            var e = this.elements
                              , t = e[0]
                              , i = e[1]
                              , r = e[2]
                              , n = e[3]
                              , a = e[4]
                              , o = e[5]
                              , s = e[6]
                              , l = e[7]
                              , u = e[8];
                            return t * a * u - t * o * l - i * n * u + i * o * s + r * n * l - r * a * s
                        }
                    }, {
                        key: "invert",
                        value: function() {
                            var e = this.elements
                              , t = e[0]
                              , i = e[1]
                              , r = e[2]
                              , n = e[3]
                              , a = e[4]
                              , o = e[5]
                              , s = e[6]
                              , l = e[7]
                              , u = e[8]
                              , c = u * a - o * l
                              , h = o * s - u * n
                              , p = l * n - a * s
                              , f = t * c + i * h + r * p;
                            if (0 === f)
                                return this.set(0, 0, 0, 0, 0, 0, 0, 0, 0);
                            var d = 1 / f;
                            return e[0] = c * d,
                            e[1] = (r * l - u * i) * d,
                            e[2] = (o * i - r * a) * d,
                            e[3] = h * d,
                            e[4] = (u * t - r * s) * d,
                            e[5] = (r * n - o * t) * d,
                            e[6] = p * d,
                            e[7] = (i * s - l * t) * d,
                            e[8] = (a * t - i * n) * d,
                            this
                        }
                    }, {
                        key: "transpose",
                        value: function() {
                            var e, t = this.elements;
                            return e = t[1],
                            t[1] = t[3],
                            t[3] = e,
                            e = t[2],
                            t[2] = t[6],
                            t[6] = e,
                            e = t[5],
                            t[5] = t[7],
                            t[7] = e,
                            this
                        }
                    }, {
                        key: "getNormalMatrix",
                        value: function(e) {
                            return this.setFromMatrix4(e).copy(this).invert().transpose()
                        }
                    }, {
                        key: "transposeIntoArray",
                        value: function(e) {
                            var t = this.elements;
                            return e[0] = t[0],
                            e[1] = t[3],
                            e[2] = t[6],
                            e[3] = t[1],
                            e[4] = t[4],
                            e[5] = t[7],
                            e[6] = t[2],
                            e[7] = t[5],
                            e[8] = t[8],
                            this
                        }
                    }, {
                        key: "setUvTransform",
                        value: function(e, t, i, r, n, a, o) {
                            var s = Math.cos(n)
                              , l = Math.sin(n);
                            return this.set(i * s, i * l, -i * (s * a + l * o) + a + e, -r * l, r * s, -r * (-l * a + s * o) + o + t, 0, 0, 1),
                            this
                        }
                    }, {
                        key: "scale",
                        value: function(e, t) {
                            var i = this.elements;
                            return i[0] *= e,
                            i[3] *= e,
                            i[6] *= e,
                            i[1] *= t,
                            i[4] *= t,
                            i[7] *= t,
                            this
                        }
                    }, {
                        key: "rotate",
                        value: function(e) {
                            var t = Math.cos(e)
                              , i = Math.sin(e)
                              , r = this.elements
                              , n = r[0]
                              , a = r[3]
                              , o = r[6]
                              , s = r[1]
                              , l = r[4]
                              , u = r[7];
                            return r[0] = t * n + i * s,
                            r[3] = t * a + i * l,
                            r[6] = t * o + i * u,
                            r[1] = -i * n + t * s,
                            r[4] = -i * a + t * l,
                            r[7] = -i * o + t * u,
                            this
                        }
                    }, {
                        key: "translate",
                        value: function(e, t) {
                            var i = this.elements;
                            return i[0] += e * i[2],
                            i[3] += e * i[5],
                            i[6] += e * i[8],
                            i[1] += t * i[2],
                            i[4] += t * i[5],
                            i[7] += t * i[8],
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            for (var t = this.elements, i = e.elements, r = 0; r < 9; r++)
                                if (t[r] !== i[r])
                                    return !1;
                            return !0
                        }
                    }, {
                        key: "fromArray",
                        value: function(e) {
                            for (var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, i = 0; i < 9; i++)
                                this.elements[i] = e[i + t];
                            return this
                        }
                    }, {
                        key: "toArray",
                        value: function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
                              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                              , i = this.elements;
                            return e[t] = i[0],
                            e[t + 1] = i[1],
                            e[t + 2] = i[2],
                            e[t + 3] = i[3],
                            e[t + 4] = i[4],
                            e[t + 5] = i[5],
                            e[t + 6] = i[6],
                            e[t + 7] = i[7],
                            e[t + 8] = i[8],
                            e
                        }
                    }]) && H(t.prototype, i),
                    e
                }()
                  , W = 0
                  , Z = new w
                  , X = new _
                  , Y = new A
                  , K = new w
                  , J = new w
                  , Q = new w
                  , $ = new _
                  , ee = new w(1,0,0)
                  , te = new w(0,1,0)
                  , ie = new w(0,0,1)
                  , re = {
                    type: "added"
                }
                  , ne = {
                    type: "removed"
                };
                function ae() {
                    Object.defineProperty(this, "id", {
                        value: W++
                    }),
                    this.uuid = v.generateUUID(),
                    this.name = "",
                    this.type = "Object3D",
                    this.parent = null,
                    this.children = [],
                    this.up = ae.DefaultUp.clone();
                    var e = new w
                      , t = new F
                      , i = new _
                      , r = new w(1,1,1);
                    t._onChange((function() {
                        i.setFromEuler(t, !1)
                    }
                    )),
                    i._onChange((function() {
                        t.setFromQuaternion(i, void 0, !1)
                    }
                    )),
                    Object.defineProperties(this, {
                        position: {
                            configurable: !0,
                            enumerable: !0,
                            value: e
                        },
                        rotation: {
                            configurable: !0,
                            enumerable: !0,
                            value: t
                        },
                        quaternion: {
                            configurable: !0,
                            enumerable: !0,
                            value: i
                        },
                        scale: {
                            configurable: !0,
                            enumerable: !0,
                            value: r
                        },
                        modelViewMatrix: {
                            value: new A
                        },
                        normalMatrix: {
                            value: new q
                        }
                    }),
                    this.matrix = new A,
                    this.matrixWorld = new A,
                    this.matrixAutoUpdate = ae.DefaultMatrixAutoUpdate,
                    this.matrixWorldNeedsUpdate = !1,
                    this.layers = new G,
                    this.visible = !0,
                    this.castShadow = !1,
                    this.receiveShadow = !1,
                    this.frustumCulled = !0,
                    this.renderOrder = 0,
                    this.animations = [],
                    this.userData = {}
                }
                function oe() {
                    ae.call(this),
                    this.type = "Camera",
                    this.matrixWorldInverse = new A,
                    this.projectionMatrix = new A,
                    this.projectionMatrixInverse = new A
                }
                function se(e) {
                    return (se = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                        return typeof e
                    }
                    : function(e) {
                        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                    }
                    )(e)
                }
                function le(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                function ue(e, t, i) {
                    return (ue = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function(e, t, i) {
                        var r = function(e, t) {
                            for (; !Object.prototype.hasOwnProperty.call(e, t) && null !== (e = fe(e)); )
                                ;
                            return e
                        }(e, t);
                        if (r) {
                            var n = Object.getOwnPropertyDescriptor(r, t);
                            return n.get ? n.get.call(i) : n.value
                        }
                    }
                    )(e, t, i || e)
                }
                function ce(e, t) {
                    return (ce = Object.setPrototypeOf || function(e, t) {
                        return e.__proto__ = t,
                        e
                    }
                    )(e, t)
                }
                function he(e, t) {
                    return !t || "object" !== se(t) && "function" != typeof t ? pe(e) : t
                }
                function pe(e) {
                    if (void 0 === e)
                        throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }
                function fe(e) {
                    return (fe = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                        return e.__proto__ || Object.getPrototypeOf(e)
                    }
                    )(e)
                }
                ae.DefaultUp = new w(0,1,0),
                ae.DefaultMatrixAutoUpdate = !0,
                ae.prototype = Object.assign(Object.create(R.prototype), {
                    constructor: ae,
                    isObject3D: !0,
                    onBeforeRender: function() {},
                    onAfterRender: function() {},
                    applyMatrix4: function(e) {
                        this.matrixAutoUpdate && this.updateMatrix(),
                        this.matrix.premultiply(e),
                        this.matrix.decompose(this.position, this.quaternion, this.scale)
                    },
                    applyQuaternion: function(e) {
                        return this.quaternion.premultiply(e),
                        this
                    },
                    setRotationFromAxisAngle: function(e, t) {
                        this.quaternion.setFromAxisAngle(e, t)
                    },
                    setRotationFromEuler: function(e) {
                        this.quaternion.setFromEuler(e, !0)
                    },
                    setRotationFromMatrix: function(e) {
                        this.quaternion.setFromRotationMatrix(e)
                    },
                    setRotationFromQuaternion: function(e) {
                        this.quaternion.copy(e)
                    },
                    rotateOnAxis: function(e, t) {
                        return X.setFromAxisAngle(e, t),
                        this.quaternion.multiply(X),
                        this
                    },
                    rotateOnWorldAxis: function(e, t) {
                        return X.setFromAxisAngle(e, t),
                        this.quaternion.premultiply(X),
                        this
                    },
                    rotateX: function(e) {
                        return this.rotateOnAxis(ee, e)
                    },
                    rotateY: function(e) {
                        return this.rotateOnAxis(te, e)
                    },
                    rotateZ: function(e) {
                        return this.rotateOnAxis(ie, e)
                    },
                    translateOnAxis: function(e, t) {
                        return Z.copy(e).applyQuaternion(this.quaternion),
                        this.position.add(Z.multiplyScalar(t)),
                        this
                    },
                    translateX: function(e) {
                        return this.translateOnAxis(ee, e)
                    },
                    translateY: function(e) {
                        return this.translateOnAxis(te, e)
                    },
                    translateZ: function(e) {
                        return this.translateOnAxis(ie, e)
                    },
                    localToWorld: function(e) {
                        return e.applyMatrix4(this.matrixWorld)
                    },
                    worldToLocal: function(e) {
                        return e.applyMatrix4(Y.copy(this.matrixWorld).invert())
                    },
                    lookAt: function(e, t, i) {
                        e.isVector3 ? K.copy(e) : K.set(e, t, i);
                        var r = this.parent;
                        this.updateWorldMatrix(!0, !1),
                        J.setFromMatrixPosition(this.matrixWorld),
                        this.isCamera || this.isLight ? Y.lookAt(J, K, this.up) : Y.lookAt(K, J, this.up),
                        this.quaternion.setFromRotationMatrix(Y),
                        r && (Y.extractRotation(r.matrixWorld),
                        X.setFromRotationMatrix(Y),
                        this.quaternion.premultiply(X.invert()))
                    },
                    add: function(e) {
                        if (arguments.length > 1) {
                            for (var t = 0; t < arguments.length; t++)
                                this.add(arguments[t]);
                            return this
                        }
                        return e === this ? (console.error("THREE.Object3D.add: object can't be added as a child of itself.", e),
                        this) : (e && e.isObject3D ? (null !== e.parent && e.parent.remove(e),
                        e.parent = this,
                        this.children.push(e),
                        e.dispatchEvent(re)) : console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.", e),
                        this)
                    },
                    remove: function(e) {
                        if (arguments.length > 1) {
                            for (var t = 0; t < arguments.length; t++)
                                this.remove(arguments[t]);
                            return this
                        }
                        var i = this.children.indexOf(e);
                        return -1 !== i && (e.parent = null,
                        this.children.splice(i, 1),
                        e.dispatchEvent(ne)),
                        this
                    },
                    clear: function() {
                        for (var e = 0; e < this.children.length; e++) {
                            var t = this.children[e];
                            t.parent = null,
                            t.dispatchEvent(ne)
                        }
                        return this.children.length = 0,
                        this
                    },
                    attach: function(e) {
                        return this.updateWorldMatrix(!0, !1),
                        Y.copy(this.matrixWorld).invert(),
                        null !== e.parent && (e.parent.updateWorldMatrix(!0, !1),
                        Y.multiply(e.parent.matrixWorld)),
                        e.applyMatrix4(Y),
                        e.updateWorldMatrix(!1, !1),
                        this.add(e),
                        this
                    },
                    getObjectById: function(e) {
                        return this.getObjectByProperty("id", e)
                    },
                    getObjectByName: function(e) {
                        return this.getObjectByProperty("name", e)
                    },
                    getObjectByProperty: function(e, t) {
                        if (this[e] === t)
                            return this;
                        for (var i = 0, r = this.children.length; i < r; i++) {
                            var n = this.children[i].getObjectByProperty(e, t);
                            if (void 0 !== n)
                                return n
                        }
                    },
                    getWorldPosition: function(e) {
                        return void 0 === e && (console.warn("THREE.Object3D: .getWorldPosition() target is now required"),
                        e = new w),
                        this.updateWorldMatrix(!0, !1),
                        e.setFromMatrixPosition(this.matrixWorld)
                    },
                    getWorldQuaternion: function(e) {
                        return void 0 === e && (console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),
                        e = new _),
                        this.updateWorldMatrix(!0, !1),
                        this.matrixWorld.decompose(J, e, Q),
                        e
                    },
                    getWorldScale: function(e) {
                        return void 0 === e && (console.warn("THREE.Object3D: .getWorldScale() target is now required"),
                        e = new w),
                        this.updateWorldMatrix(!0, !1),
                        this.matrixWorld.decompose(J, $, e),
                        e
                    },
                    getWorldDirection: function(e) {
                        void 0 === e && (console.warn("THREE.Object3D: .getWorldDirection() target is now required"),
                        e = new w),
                        this.updateWorldMatrix(!0, !1);
                        var t = this.matrixWorld.elements;
                        return e.set(t[8], t[9], t[10]).normalize()
                    },
                    raycast: function() {},
                    traverse: function(e) {
                        e(this);
                        for (var t = this.children, i = 0, r = t.length; i < r; i++)
                            t[i].traverse(e)
                    },
                    traverseVisible: function(e) {
                        if (!1 !== this.visible) {
                            e(this);
                            for (var t = this.children, i = 0, r = t.length; i < r; i++)
                                t[i].traverseVisible(e)
                        }
                    },
                    traverseAncestors: function(e) {
                        var t = this.parent;
                        null !== t && (e(t),
                        t.traverseAncestors(e))
                    },
                    updateMatrix: function() {
                        this.matrix.compose(this.position, this.quaternion, this.scale),
                        this.matrixWorldNeedsUpdate = !0
                    },
                    updateMatrixWorld: function(e) {
                        this.matrixAutoUpdate && this.updateMatrix(),
                        (this.matrixWorldNeedsUpdate || e) && (null === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix),
                        this.matrixWorldNeedsUpdate = !1,
                        e = !0);
                        for (var t = this.children, i = 0, r = t.length; i < r; i++)
                            t[i].updateMatrixWorld(e)
                    },
                    updateWorldMatrix: function(e, t) {
                        var i = this.parent;
                        if (!0 === e && null !== i && i.updateWorldMatrix(!0, !1),
                        this.matrixAutoUpdate && this.updateMatrix(),
                        null === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix),
                        !0 === t)
                            for (var r = this.children, n = 0, a = r.length; n < a; n++)
                                r[n].updateWorldMatrix(!1, !0)
                    },
                    toJSON: function(e) {
                        var t = void 0 === e || "string" == typeof e
                          , i = {};
                        t && (e = {
                            geometries: {},
                            materials: {},
                            textures: {},
                            images: {},
                            shapes: {},
                            skeletons: {},
                            animations: {}
                        },
                        i.metadata = {
                            version: 4.5,
                            type: "Object",
                            generator: "Object3D.toJSON"
                        });
                        var r = {};
                        function n(t, i) {
                            return void 0 === t[i.uuid] && (t[i.uuid] = i.toJSON(e)),
                            i.uuid
                        }
                        if (r.uuid = this.uuid,
                        r.type = this.type,
                        "" !== this.name && (r.name = this.name),
                        !0 === this.castShadow && (r.castShadow = !0),
                        !0 === this.receiveShadow && (r.receiveShadow = !0),
                        !1 === this.visible && (r.visible = !1),
                        !1 === this.frustumCulled && (r.frustumCulled = !1),
                        0 !== this.renderOrder && (r.renderOrder = this.renderOrder),
                        "{}" !== JSON.stringify(this.userData) && (r.userData = this.userData),
                        r.layers = this.layers.mask,
                        r.matrix = this.matrix.toArray(),
                        !1 === this.matrixAutoUpdate && (r.matrixAutoUpdate = !1),
                        this.isInstancedMesh && (r.type = "InstancedMesh",
                        r.count = this.count,
                        r.instanceMatrix = this.instanceMatrix.toJSON()),
                        this.isMesh || this.isLine || this.isPoints) {
                            r.geometry = n(e.geometries, this.geometry);
                            var a = this.geometry.parameters;
                            if (void 0 !== a && void 0 !== a.shapes) {
                                var o = a.shapes;
                                if (Array.isArray(o))
                                    for (var s = 0, l = o.length; s < l; s++) {
                                        var u = o[s];
                                        n(e.shapes, u)
                                    }
                                else
                                    n(e.shapes, o)
                            }
                        }
                        if (this.isSkinnedMesh && (r.bindMode = this.bindMode,
                        r.bindMatrix = this.bindMatrix.toArray(),
                        void 0 !== this.skeleton && (n(e.skeletons, this.skeleton),
                        r.skeleton = this.skeleton.uuid)),
                        void 0 !== this.material)
                            if (Array.isArray(this.material)) {
                                for (var c = [], h = 0, p = this.material.length; h < p; h++)
                                    c.push(n(e.materials, this.material[h]));
                                r.material = c
                            } else
                                r.material = n(e.materials, this.material);
                        if (this.children.length > 0) {
                            r.children = [];
                            for (var f = 0; f < this.children.length; f++)
                                r.children.push(this.children[f].toJSON(e).object)
                        }
                        if (this.animations.length > 0) {
                            r.animations = [];
                            for (var d = 0; d < this.animations.length; d++) {
                                var m = this.animations[d];
                                r.animations.push(n(e.animations, m))
                            }
                        }
                        if (t) {
                            var v = S(e.geometries)
                              , g = S(e.materials)
                              , y = S(e.textures)
                              , _ = S(e.images)
                              , x = S(e.shapes)
                              , b = S(e.skeletons)
                              , w = S(e.animations);
                            v.length > 0 && (i.geometries = v),
                            g.length > 0 && (i.materials = g),
                            y.length > 0 && (i.textures = y),
                            _.length > 0 && (i.images = _),
                            x.length > 0 && (i.shapes = x),
                            b.length > 0 && (i.skeletons = b),
                            w.length > 0 && (i.animations = w)
                        }
                        return i.object = r,
                        i;
                        function S(e) {
                            var t = [];
                            for (var i in e) {
                                var r = e[i];
                                delete r.metadata,
                                t.push(r)
                            }
                            return t
                        }
                    },
                    clone: function(e) {
                        return (new this.constructor).copy(this, e)
                    },
                    copy: function(e) {
                        var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                        if (this.name = e.name,
                        this.up.copy(e.up),
                        this.position.copy(e.position),
                        this.rotation.order = e.rotation.order,
                        this.quaternion.copy(e.quaternion),
                        this.scale.copy(e.scale),
                        this.matrix.copy(e.matrix),
                        this.matrixWorld.copy(e.matrixWorld),
                        this.matrixAutoUpdate = e.matrixAutoUpdate,
                        this.matrixWorldNeedsUpdate = e.matrixWorldNeedsUpdate,
                        this.layers.mask = e.layers.mask,
                        this.visible = e.visible,
                        this.castShadow = e.castShadow,
                        this.receiveShadow = e.receiveShadow,
                        this.frustumCulled = e.frustumCulled,
                        this.renderOrder = e.renderOrder,
                        this.userData = JSON.parse(JSON.stringify(e.userData)),
                        !0 === t)
                            for (var i = 0; i < e.children.length; i++) {
                                var r = e.children[i];
                                this.add(r.clone())
                            }
                        return this
                    }
                }),
                oe.prototype = Object.assign(Object.create(ae.prototype), {
                    constructor: oe,
                    isCamera: !0,
                    copy: function(e, t) {
                        return ae.prototype.copy.call(this, e, t),
                        this.matrixWorldInverse.copy(e.matrixWorldInverse),
                        this.projectionMatrix.copy(e.projectionMatrix),
                        this.projectionMatrixInverse.copy(e.projectionMatrixInverse),
                        this
                    },
                    getWorldDirection: function(e) {
                        void 0 === e && (console.warn("THREE.Camera: .getWorldDirection() target is now required"),
                        e = new w),
                        this.updateWorldMatrix(!0, !1);
                        var t = this.matrixWorld.elements;
                        return e.set(-t[8], -t[9], -t[10]).normalize()
                    },
                    updateMatrixWorld: function(e) {
                        ae.prototype.updateMatrixWorld.call(this, e),
                        this.matrixWorldInverse.copy(this.matrixWorld).invert()
                    },
                    updateWorldMatrix: function(e, t) {
                        ae.prototype.updateWorldMatrix.call(this, e, t),
                        this.matrixWorldInverse.copy(this.matrixWorld).invert()
                    },
                    clone: function() {
                        return (new this.constructor).copy(this)
                    }
                });
                var de = function(e) {
                    !function(e, t) {
                        if ("function" != typeof t && null !== t)
                            throw new TypeError("Super expression must either be null or a function");
                        e.prototype = Object.create(t && t.prototype, {
                            constructor: {
                                value: e,
                                writable: !0,
                                configurable: !0
                            }
                        }),
                        t && ce(e, t)
                    }(n, e);
                    var t, i, r = function(e) {
                        var t = function() {
                            if ("undefined" == typeof Reflect || !Reflect.construct)
                                return !1;
                            if (Reflect.construct.sham)
                                return !1;
                            if ("function" == typeof Proxy)
                                return !0;
                            try {
                                return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}
                                ))),
                                !0
                            } catch (e) {
                                return !1
                            }
                        }();
                        return function() {
                            var i, r = fe(e);
                            if (t) {
                                var n = fe(this).constructor;
                                i = Reflect.construct(r, arguments, n)
                            } else
                                i = r.apply(this, arguments);
                            return he(this, i)
                        }
                    }(n);
                    function n() {
                        var e;
                        return function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, n),
                        e = r.call(this),
                        Object.defineProperty(pe(e), "isScene", {
                            value: !0
                        }),
                        e.type = "Scene",
                        e.background = null,
                        e.environment = null,
                        e.fog = null,
                        e.overrideMaterial = null,
                        e.autoUpdate = !0,
                        "undefined" != typeof __THREE_DEVTOOLS__ && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{
                            detail: pe(e)
                        })),
                        e
                    }
                    return t = n,
                    (i = [{
                        key: "copy",
                        value: function(e, t) {
                            return ue(fe(n.prototype), "copy", this).call(this, e, t),
                            null !== e.background && (this.background = e.background.clone()),
                            null !== e.environment && (this.environment = e.environment.clone()),
                            null !== e.fog && (this.fog = e.fog.clone()),
                            null !== e.overrideMaterial && (this.overrideMaterial = e.overrideMaterial.clone()),
                            this.autoUpdate = e.autoUpdate,
                            this.matrixAutoUpdate = e.matrixAutoUpdate,
                            this
                        }
                    }, {
                        key: "toJSON",
                        value: function(e) {
                            var t = ue(fe(n.prototype), "toJSON", this).call(this, e);
                            return null !== this.background && (t.object.background = this.background.toJSON(e)),
                            null !== this.environment && (t.object.environment = this.environment.toJSON(e)),
                            null !== this.fog && (t.object.fog = this.fog.toJSON()),
                            t
                        }
                    }]) && le(t.prototype, i),
                    n
                }(ae)
                  , me = 100
                  , ve = 1e3
                  , ge = 1001
                  , ye = 1002
                  , _e = 1003
                  , xe = 1006
                  , be = 1008
                  , we = 1009
                  , Se = 1012
                  , Me = 1014
                  , Te = 1015
                  , Ee = 1016
                  , Ae = 1020
                  , Pe = 1022
                  , Ce = 1023
                  , Le = 1026
                  , Ie = 1027
                  , ke = 3e3
                  , ze = 7680
                  , De = "300 es"
                  , Re = 0;
                function Oe() {
                    Object.defineProperty(this, "id", {
                        value: Re++
                    }),
                    this.uuid = v.generateUUID(),
                    this.name = "",
                    this.type = "Material",
                    this.fog = !0,
                    this.blending = 1,
                    this.side = 0,
                    this.flatShading = !1,
                    this.vertexColors = !1,
                    this.opacity = 1,
                    this.transparent = !1,
                    this.blendSrc = 204,
                    this.blendDst = 205,
                    this.blendEquation = me,
                    this.blendSrcAlpha = null,
                    this.blendDstAlpha = null,
                    this.blendEquationAlpha = null,
                    this.depthFunc = 3,
                    this.depthTest = !0,
                    this.depthWrite = !0,
                    this.stencilWriteMask = 255,
                    this.stencilFunc = 519,
                    this.stencilRef = 0,
                    this.stencilFuncMask = 255,
                    this.stencilFail = ze,
                    this.stencilZFail = ze,
                    this.stencilZPass = ze,
                    this.stencilWrite = !1,
                    this.clippingPlanes = null,
                    this.clipIntersection = !1,
                    this.clipShadows = !1,
                    this.shadowSide = null,
                    this.colorWrite = !0,
                    this.precision = null,
                    this.polygonOffset = !1,
                    this.polygonOffsetFactor = 0,
                    this.polygonOffsetUnits = 0,
                    this.dithering = !1,
                    this.alphaTest = 0,
                    this.premultipliedAlpha = !1,
                    this.visible = !0,
                    this.toneMapped = !0,
                    this.userData = {},
                    this.version = 0
                }
                function Be(e) {
                    var t = {};
                    for (var i in e)
                        for (var r in t[i] = {},
                        e[i]) {
                            var n = e[i][r];
                            n && (n.isColor || n.isMatrix3 || n.isMatrix4 || n.isVector2 || n.isVector3 || n.isVector4 || n.isTexture) ? t[i][r] = n.clone() : Array.isArray(n) ? t[i][r] = n.slice() : t[i][r] = n
                        }
                    return t
                }
                function Fe(e) {
                    for (var t = {}, i = 0; i < e.length; i++) {
                        var r = Be(e[i]);
                        for (var n in r)
                            t[n] = r[n]
                    }
                    return t
                }
                Oe.prototype = Object.assign(Object.create(R.prototype), {
                    constructor: Oe,
                    isMaterial: !0,
                    onBeforeCompile: function() {},
                    customProgramCacheKey: function() {
                        return this.onBeforeCompile.toString()
                    },
                    setValues: function(e) {
                        if (void 0 !== e)
                            for (var t in e) {
                                var i = e[t];
                                if (void 0 !== i)
                                    if ("shading" !== t) {
                                        var r = this[t];
                                        void 0 !== r ? r && r.isColor ? r.set(i) : r && r.isVector3 && i && i.isVector3 ? r.copy(i) : this[t] = i : console.warn("THREE." + this.type + ": '" + t + "' is not a property of this material.")
                                    } else
                                        console.warn("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead."),
                                        this.flatShading = 1 === i;
                                else
                                    console.warn("THREE.Material: '" + t + "' parameter is undefined.")
                            }
                    },
                    toJSON: function(e) {
                        var t = void 0 === e || "string" == typeof e;
                        t && (e = {
                            textures: {},
                            images: {}
                        });
                        var i = {
                            metadata: {
                                version: 4.5,
                                type: "Material",
                                generator: "Material.toJSON"
                            }
                        };
                        function r(e) {
                            var t = [];
                            for (var i in e) {
                                var r = e[i];
                                delete r.metadata,
                                t.push(r)
                            }
                            return t
                        }
                        if (i.uuid = this.uuid,
                        i.type = this.type,
                        "" !== this.name && (i.name = this.name),
                        this.color && this.color.isColor && (i.color = this.color.getHex()),
                        void 0 !== this.roughness && (i.roughness = this.roughness),
                        void 0 !== this.metalness && (i.metalness = this.metalness),
                        this.sheen && this.sheen.isColor && (i.sheen = this.sheen.getHex()),
                        this.emissive && this.emissive.isColor && (i.emissive = this.emissive.getHex()),
                        this.emissiveIntensity && 1 !== this.emissiveIntensity && (i.emissiveIntensity = this.emissiveIntensity),
                        this.specular && this.specular.isColor && (i.specular = this.specular.getHex()),
                        void 0 !== this.shininess && (i.shininess = this.shininess),
                        void 0 !== this.clearcoat && (i.clearcoat = this.clearcoat),
                        void 0 !== this.clearcoatRoughness && (i.clearcoatRoughness = this.clearcoatRoughness),
                        this.clearcoatMap && this.clearcoatMap.isTexture && (i.clearcoatMap = this.clearcoatMap.toJSON(e).uuid),
                        this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture && (i.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON(e).uuid),
                        this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture && (i.clearcoatNormalMap = this.clearcoatNormalMap.toJSON(e).uuid,
                        i.clearcoatNormalScale = this.clearcoatNormalScale.toArray()),
                        this.map && this.map.isTexture && (i.map = this.map.toJSON(e).uuid),
                        this.matcap && this.matcap.isTexture && (i.matcap = this.matcap.toJSON(e).uuid),
                        this.alphaMap && this.alphaMap.isTexture && (i.alphaMap = this.alphaMap.toJSON(e).uuid),
                        this.lightMap && this.lightMap.isTexture && (i.lightMap = this.lightMap.toJSON(e).uuid),
                        this.aoMap && this.aoMap.isTexture && (i.aoMap = this.aoMap.toJSON(e).uuid,
                        i.aoMapIntensity = this.aoMapIntensity),
                        this.bumpMap && this.bumpMap.isTexture && (i.bumpMap = this.bumpMap.toJSON(e).uuid,
                        i.bumpScale = this.bumpScale),
                        this.normalMap && this.normalMap.isTexture && (i.normalMap = this.normalMap.toJSON(e).uuid,
                        i.normalMapType = this.normalMapType,
                        i.normalScale = this.normalScale.toArray()),
                        this.displacementMap && this.displacementMap.isTexture && (i.displacementMap = this.displacementMap.toJSON(e).uuid,
                        i.displacementScale = this.displacementScale,
                        i.displacementBias = this.displacementBias),
                        this.roughnessMap && this.roughnessMap.isTexture && (i.roughnessMap = this.roughnessMap.toJSON(e).uuid),
                        this.metalnessMap && this.metalnessMap.isTexture && (i.metalnessMap = this.metalnessMap.toJSON(e).uuid),
                        this.emissiveMap && this.emissiveMap.isTexture && (i.emissiveMap = this.emissiveMap.toJSON(e).uuid),
                        this.specularMap && this.specularMap.isTexture && (i.specularMap = this.specularMap.toJSON(e).uuid),
                        this.envMap && this.envMap.isTexture && (i.envMap = this.envMap.toJSON(e).uuid,
                        i.reflectivity = this.reflectivity,
                        i.refractionRatio = this.refractionRatio,
                        void 0 !== this.combine && (i.combine = this.combine),
                        void 0 !== this.envMapIntensity && (i.envMapIntensity = this.envMapIntensity)),
                        this.gradientMap && this.gradientMap.isTexture && (i.gradientMap = this.gradientMap.toJSON(e).uuid),
                        void 0 !== this.size && (i.size = this.size),
                        void 0 !== this.sizeAttenuation && (i.sizeAttenuation = this.sizeAttenuation),
                        1 !== this.blending && (i.blending = this.blending),
                        !0 === this.flatShading && (i.flatShading = this.flatShading),
                        0 !== this.side && (i.side = this.side),
                        this.vertexColors && (i.vertexColors = !0),
                        this.opacity < 1 && (i.opacity = this.opacity),
                        !0 === this.transparent && (i.transparent = this.transparent),
                        i.depthFunc = this.depthFunc,
                        i.depthTest = this.depthTest,
                        i.depthWrite = this.depthWrite,
                        i.stencilWrite = this.stencilWrite,
                        i.stencilWriteMask = this.stencilWriteMask,
                        i.stencilFunc = this.stencilFunc,
                        i.stencilRef = this.stencilRef,
                        i.stencilFuncMask = this.stencilFuncMask,
                        i.stencilFail = this.stencilFail,
                        i.stencilZFail = this.stencilZFail,
                        i.stencilZPass = this.stencilZPass,
                        this.rotation && 0 !== this.rotation && (i.rotation = this.rotation),
                        !0 === this.polygonOffset && (i.polygonOffset = !0),
                        0 !== this.polygonOffsetFactor && (i.polygonOffsetFactor = this.polygonOffsetFactor),
                        0 !== this.polygonOffsetUnits && (i.polygonOffsetUnits = this.polygonOffsetUnits),
                        this.linewidth && 1 !== this.linewidth && (i.linewidth = this.linewidth),
                        void 0 !== this.dashSize && (i.dashSize = this.dashSize),
                        void 0 !== this.gapSize && (i.gapSize = this.gapSize),
                        void 0 !== this.scale && (i.scale = this.scale),
                        !0 === this.dithering && (i.dithering = !0),
                        this.alphaTest > 0 && (i.alphaTest = this.alphaTest),
                        !0 === this.premultipliedAlpha && (i.premultipliedAlpha = this.premultipliedAlpha),
                        !0 === this.wireframe && (i.wireframe = this.wireframe),
                        this.wireframeLinewidth > 1 && (i.wireframeLinewidth = this.wireframeLinewidth),
                        "round" !== this.wireframeLinecap && (i.wireframeLinecap = this.wireframeLinecap),
                        "round" !== this.wireframeLinejoin && (i.wireframeLinejoin = this.wireframeLinejoin),
                        !0 === this.morphTargets && (i.morphTargets = !0),
                        !0 === this.morphNormals && (i.morphNormals = !0),
                        !0 === this.skinning && (i.skinning = !0),
                        !1 === this.visible && (i.visible = !1),
                        !1 === this.toneMapped && (i.toneMapped = !1),
                        "{}" !== JSON.stringify(this.userData) && (i.userData = this.userData),
                        t) {
                            var n = r(e.textures)
                              , a = r(e.images);
                            n.length > 0 && (i.textures = n),
                            a.length > 0 && (i.images = a)
                        }
                        return i
                    },
                    clone: function() {
                        return (new this.constructor).copy(this)
                    },
                    copy: function(e) {
                        this.name = e.name,
                        this.fog = e.fog,
                        this.blending = e.blending,
                        this.side = e.side,
                        this.flatShading = e.flatShading,
                        this.vertexColors = e.vertexColors,
                        this.opacity = e.opacity,
                        this.transparent = e.transparent,
                        this.blendSrc = e.blendSrc,
                        this.blendDst = e.blendDst,
                        this.blendEquation = e.blendEquation,
                        this.blendSrcAlpha = e.blendSrcAlpha,
                        this.blendDstAlpha = e.blendDstAlpha,
                        this.blendEquationAlpha = e.blendEquationAlpha,
                        this.depthFunc = e.depthFunc,
                        this.depthTest = e.depthTest,
                        this.depthWrite = e.depthWrite,
                        this.stencilWriteMask = e.stencilWriteMask,
                        this.stencilFunc = e.stencilFunc,
                        this.stencilRef = e.stencilRef,
                        this.stencilFuncMask = e.stencilFuncMask,
                        this.stencilFail = e.stencilFail,
                        this.stencilZFail = e.stencilZFail,
                        this.stencilZPass = e.stencilZPass,
                        this.stencilWrite = e.stencilWrite;
                        var t = e.clippingPlanes
                          , i = null;
                        if (null !== t) {
                            var r = t.length;
                            i = new Array(r);
                            for (var n = 0; n !== r; ++n)
                                i[n] = t[n].clone()
                        }
                        return this.clippingPlanes = i,
                        this.clipIntersection = e.clipIntersection,
                        this.clipShadows = e.clipShadows,
                        this.shadowSide = e.shadowSide,
                        this.colorWrite = e.colorWrite,
                        this.precision = e.precision,
                        this.polygonOffset = e.polygonOffset,
                        this.polygonOffsetFactor = e.polygonOffsetFactor,
                        this.polygonOffsetUnits = e.polygonOffsetUnits,
                        this.dithering = e.dithering,
                        this.alphaTest = e.alphaTest,
                        this.premultipliedAlpha = e.premultipliedAlpha,
                        this.visible = e.visible,
                        this.toneMapped = e.toneMapped,
                        this.userData = JSON.parse(JSON.stringify(e.userData)),
                        this
                    },
                    dispose: function() {
                        this.dispatchEvent({
                            type: "dispose"
                        })
                    }
                }),
                Object.defineProperty(Oe.prototype, "needsUpdate", {
                    set: function(e) {
                        !0 === e && this.version++
                    }
                });
                var Ne = {
                    clone: Be,
                    merge: Fe
                };
                function Ue(e) {
                    Oe.call(this),
                    this.type = "ShaderMaterial",
                    this.defines = {},
                    this.uniforms = {},
                    this.vertexShader = "void main(){gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",
                    this.fragmentShader = "void main(){gl_FragColor=vec4(1.0,0.0,0.0,1.0);}",
                    this.linewidth = 1,
                    this.wireframe = !1,
                    this.wireframeLinewidth = 1,
                    this.fog = !1,
                    this.lights = !1,
                    this.clipping = !1,
                    this.skinning = !1,
                    this.morphTargets = !1,
                    this.morphNormals = !1,
                    this.extensions = {
                        derivatives: !1,
                        fragDepth: !1,
                        drawBuffers: !1,
                        shaderTextureLOD: !1
                    },
                    this.defaultAttributeValues = {
                        color: [1, 1, 1],
                        uv: [0, 0],
                        uv2: [0, 0]
                    },
                    this.index0AttributeName = void 0,
                    this.uniformsNeedUpdate = !1,
                    this.glslVersion = null,
                    void 0 !== e && (void 0 !== e.attributes && console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),
                    this.setValues(e))
                }
                function Ve(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                Ue.prototype = Object.create(Oe.prototype),
                Ue.prototype.constructor = Ue,
                Ue.prototype.isShaderMaterial = !0,
                Ue.prototype.copy = function(e) {
                    return Oe.prototype.copy.call(this, e),
                    this.fragmentShader = e.fragmentShader,
                    this.vertexShader = e.vertexShader,
                    this.uniforms = Be(e.uniforms),
                    this.defines = Object.assign({}, e.defines),
                    this.wireframe = e.wireframe,
                    this.wireframeLinewidth = e.wireframeLinewidth,
                    this.lights = e.lights,
                    this.clipping = e.clipping,
                    this.skinning = e.skinning,
                    this.morphTargets = e.morphTargets,
                    this.morphNormals = e.morphNormals,
                    this.extensions = Object.assign({}, e.extensions),
                    this.glslVersion = e.glslVersion,
                    this
                }
                ,
                Ue.prototype.toJSON = function(e) {
                    var t = Oe.prototype.toJSON.call(this, e);
                    for (var i in t.glslVersion = this.glslVersion,
                    t.uniforms = {},
                    this.uniforms) {
                        var r = this.uniforms[i].value;
                        r && r.isTexture ? t.uniforms[i] = {
                            type: "t",
                            value: r.toJSON(e).uuid
                        } : r && r.isColor ? t.uniforms[i] = {
                            type: "c",
                            value: r.getHex()
                        } : r && r.isVector2 ? t.uniforms[i] = {
                            type: "v2",
                            value: r.toArray()
                        } : r && r.isVector3 ? t.uniforms[i] = {
                            type: "v3",
                            value: r.toArray()
                        } : r && r.isVector4 ? t.uniforms[i] = {
                            type: "v4",
                            value: r.toArray()
                        } : r && r.isMatrix3 ? t.uniforms[i] = {
                            type: "m3",
                            value: r.toArray()
                        } : r && r.isMatrix4 ? t.uniforms[i] = {
                            type: "m4",
                            value: r.toArray()
                        } : t.uniforms[i] = {
                            value: r
                        }
                    }
                    Object.keys(this.defines).length > 0 && (t.defines = this.defines),
                    t.vertexShader = this.vertexShader,
                    t.fragmentShader = this.fragmentShader;
                    var n = {};
                    for (var a in this.extensions)
                        !0 === this.extensions[a] && (n[a] = !0);
                    return Object.keys(n).length > 0 && (t.extensions = n),
                    t
                }
                ;
                var Ge = function() {
                    function e(t, i) {
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, e),
                        Object.defineProperty(this, "isBox3", {
                            value: !0
                        }),
                        this.min = void 0 !== t ? t : new w(1 / 0,1 / 0,1 / 0),
                        this.max = void 0 !== i ? i : new w(-1 / 0,-1 / 0,-1 / 0)
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e, t) {
                            return this.min.copy(e),
                            this.max.copy(t),
                            this
                        }
                    }, {
                        key: "setFromArray",
                        value: function(e) {
                            for (var t = 1 / 0, i = 1 / 0, r = 1 / 0, n = -1 / 0, a = -1 / 0, o = -1 / 0, s = 0, l = e.length; s < l; s += 3) {
                                var u = e[s]
                                  , c = e[s + 1]
                                  , h = e[s + 2];
                                u < t && (t = u),
                                c < i && (i = c),
                                h < r && (r = h),
                                u > n && (n = u),
                                c > a && (a = c),
                                h > o && (o = h)
                            }
                            return this.min.set(t, i, r),
                            this.max.set(n, a, o),
                            this
                        }
                    }, {
                        key: "setFromBufferAttribute",
                        value: function(e) {
                            for (var t = 1 / 0, i = 1 / 0, r = 1 / 0, n = -1 / 0, a = -1 / 0, o = -1 / 0, s = 0, l = e.count; s < l; s++) {
                                var u = e.getX(s)
                                  , c = e.getY(s)
                                  , h = e.getZ(s);
                                u < t && (t = u),
                                c < i && (i = c),
                                h < r && (r = h),
                                u > n && (n = u),
                                c > a && (a = c),
                                h > o && (o = h)
                            }
                            return this.min.set(t, i, r),
                            this.max.set(n, a, o),
                            this
                        }
                    }, {
                        key: "setFromPoints",
                        value: function(e) {
                            this.makeEmpty();
                            for (var t = 0, i = e.length; t < i; t++)
                                this.expandByPoint(e[t]);
                            return this
                        }
                    }, {
                        key: "setFromCenterAndSize",
                        value: function(e, t) {
                            var i = qe.copy(t).multiplyScalar(.5);
                            return this.min.copy(e).sub(i),
                            this.max.copy(e).add(i),
                            this
                        }
                    }, {
                        key: "setFromObject",
                        value: function(e) {
                            return this.makeEmpty(),
                            this.expandByObject(e)
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return (new this.constructor).copy(this)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this.min.copy(e.min),
                            this.max.copy(e.max),
                            this
                        }
                    }, {
                        key: "makeEmpty",
                        value: function() {
                            return this.min.x = this.min.y = this.min.z = 1 / 0,
                            this.max.x = this.max.y = this.max.z = -1 / 0,
                            this
                        }
                    }, {
                        key: "isEmpty",
                        value: function() {
                            return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z
                        }
                    }, {
                        key: "getCenter",
                        value: function(e) {
                            return void 0 === e && (console.warn("THREE.Box3: .getCenter() target is now required"),
                            e = new w),
                            this.isEmpty() ? e.set(0, 0, 0) : e.addVectors(this.min, this.max).multiplyScalar(.5)
                        }
                    }, {
                        key: "getSize",
                        value: function(e) {
                            return void 0 === e && (console.warn("THREE.Box3: .getSize() target is now required"),
                            e = new w),
                            this.isEmpty() ? e.set(0, 0, 0) : e.subVectors(this.max, this.min)
                        }
                    }, {
                        key: "expandByPoint",
                        value: function(e) {
                            return this.min.min(e),
                            this.max.max(e),
                            this
                        }
                    }, {
                        key: "expandByVector",
                        value: function(e) {
                            return this.min.sub(e),
                            this.max.add(e),
                            this
                        }
                    }, {
                        key: "expandByScalar",
                        value: function(e) {
                            return this.min.addScalar(-e),
                            this.max.addScalar(e),
                            this
                        }
                    }, {
                        key: "expandByObject",
                        value: function(e) {
                            e.updateWorldMatrix(!1, !1);
                            var t = e.geometry;
                            void 0 !== t && (null === t.boundingBox && t.computeBoundingBox(),
                            We.copy(t.boundingBox),
                            We.applyMatrix4(e.matrixWorld),
                            this.union(We));
                            for (var i = e.children, r = 0, n = i.length; r < n; r++)
                                this.expandByObject(i[r]);
                            return this
                        }
                    }, {
                        key: "containsPoint",
                        value: function(e) {
                            return !(e.x < this.min.x || e.x > this.max.x || e.y < this.min.y || e.y > this.max.y || e.z < this.min.z || e.z > this.max.z)
                        }
                    }, {
                        key: "containsBox",
                        value: function(e) {
                            return this.min.x <= e.min.x && e.max.x <= this.max.x && this.min.y <= e.min.y && e.max.y <= this.max.y && this.min.z <= e.min.z && e.max.z <= this.max.z
                        }
                    }, {
                        key: "getParameter",
                        value: function(e, t) {
                            return void 0 === t && (console.warn("THREE.Box3: .getParameter() target is now required"),
                            t = new w),
                            t.set((e.x - this.min.x) / (this.max.x - this.min.x), (e.y - this.min.y) / (this.max.y - this.min.y), (e.z - this.min.z) / (this.max.z - this.min.z))
                        }
                    }, {
                        key: "intersectsBox",
                        value: function(e) {
                            return !(e.max.x < this.min.x || e.min.x > this.max.x || e.max.y < this.min.y || e.min.y > this.max.y || e.max.z < this.min.z || e.min.z > this.max.z)
                        }
                    }, {
                        key: "intersectsSphere",
                        value: function(e) {
                            return this.clampPoint(e.center, qe),
                            qe.distanceToSquared(e.center) <= e.radius * e.radius
                        }
                    }, {
                        key: "intersectsPlane",
                        value: function(e) {
                            var t, i;
                            return e.normal.x > 0 ? (t = e.normal.x * this.min.x,
                            i = e.normal.x * this.max.x) : (t = e.normal.x * this.max.x,
                            i = e.normal.x * this.min.x),
                            e.normal.y > 0 ? (t += e.normal.y * this.min.y,
                            i += e.normal.y * this.max.y) : (t += e.normal.y * this.max.y,
                            i += e.normal.y * this.min.y),
                            e.normal.z > 0 ? (t += e.normal.z * this.min.z,
                            i += e.normal.z * this.max.z) : (t += e.normal.z * this.max.z,
                            i += e.normal.z * this.min.z),
                            t <= -e.constant && i >= -e.constant
                        }
                    }, {
                        key: "intersectsTriangle",
                        value: function(e) {
                            if (this.isEmpty())
                                return !1;
                            this.getCenter($e),
                            et.subVectors(this.max, $e),
                            Ze.subVectors(e.a, $e),
                            Xe.subVectors(e.b, $e),
                            Ye.subVectors(e.c, $e),
                            Ke.subVectors(Xe, Ze),
                            Je.subVectors(Ye, Xe),
                            Qe.subVectors(Ze, Ye);
                            var t = [0, -Ke.z, Ke.y, 0, -Je.z, Je.y, 0, -Qe.z, Qe.y, Ke.z, 0, -Ke.x, Je.z, 0, -Je.x, Qe.z, 0, -Qe.x, -Ke.y, Ke.x, 0, -Je.y, Je.x, 0, -Qe.y, Qe.x, 0];
                            return !!je(t, Ze, Xe, Ye, et) && !!je(t = [1, 0, 0, 0, 1, 0, 0, 0, 1], Ze, Xe, Ye, et) && (tt.crossVectors(Ke, Je),
                            je(t = [tt.x, tt.y, tt.z], Ze, Xe, Ye, et))
                        }
                    }, {
                        key: "clampPoint",
                        value: function(e, t) {
                            return void 0 === t && (console.warn("THREE.Box3: .clampPoint() target is now required"),
                            t = new w),
                            t.copy(e).clamp(this.min, this.max)
                        }
                    }, {
                        key: "distanceToPoint",
                        value: function(e) {
                            return qe.copy(e).clamp(this.min, this.max).sub(e).length()
                        }
                    }, {
                        key: "getBoundingSphere",
                        value: function(e) {
                            return void 0 === e && console.error("THREE.Box3: .getBoundingSphere() target is now required"),
                            this.getCenter(e.center),
                            e.radius = .5 * this.getSize(qe).length(),
                            e
                        }
                    }, {
                        key: "intersect",
                        value: function(e) {
                            return this.min.max(e.min),
                            this.max.min(e.max),
                            this.isEmpty() && this.makeEmpty(),
                            this
                        }
                    }, {
                        key: "union",
                        value: function(e) {
                            return this.min.min(e.min),
                            this.max.max(e.max),
                            this
                        }
                    }, {
                        key: "applyMatrix4",
                        value: function(e) {
                            return this.isEmpty() || (He[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(e),
                            He[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(e),
                            He[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(e),
                            He[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(e),
                            He[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(e),
                            He[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(e),
                            He[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(e),
                            He[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(e),
                            this.setFromPoints(He)),
                            this
                        }
                    }, {
                        key: "translate",
                        value: function(e) {
                            return this.min.add(e),
                            this.max.add(e),
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e.min.equals(this.min) && e.max.equals(this.max)
                        }
                    }]) && Ve(t.prototype, i),
                    e
                }();
                function je(e, t, i, r, n) {
                    for (var a = 0, o = e.length - 3; a <= o; a += 3) {
                        it.fromArray(e, a);
                        var s = n.x * Math.abs(it.x) + n.y * Math.abs(it.y) + n.z * Math.abs(it.z)
                          , l = t.dot(it)
                          , u = i.dot(it)
                          , c = r.dot(it);
                        if (Math.max(-Math.max(l, u, c), Math.min(l, u, c)) > s)
                            return !1
                    }
                    return !0
                }
                var He = [new w, new w, new w, new w, new w, new w, new w, new w]
                  , qe = new w
                  , We = new Ge
                  , Ze = new w
                  , Xe = new w
                  , Ye = new w
                  , Ke = new w
                  , Je = new w
                  , Qe = new w
                  , $e = new w
                  , et = new w
                  , tt = new w
                  , it = new w;
                function rt(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function nt(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var at = function() {
                    function e() {
                        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
                          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                          , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
                          , n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
                        rt(this, e),
                        Object.defineProperty(this, "isVector4", {
                            value: !0
                        }),
                        this.x = t,
                        this.y = i,
                        this.z = r,
                        this.w = n
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "width",
                        get: function() {
                            return this.z
                        },
                        set: function(e) {
                            this.z = e
                        }
                    }, {
                        key: "height",
                        get: function() {
                            return this.w
                        },
                        set: function(e) {
                            this.w = e
                        }
                    }, {
                        key: "set",
                        value: function(e, t, i, r) {
                            return this.x = e,
                            this.y = t,
                            this.z = i,
                            this.w = r,
                            this
                        }
                    }, {
                        key: "setScalar",
                        value: function(e) {
                            return this.x = e,
                            this.y = e,
                            this.z = e,
                            this.w = e,
                            this
                        }
                    }, {
                        key: "setX",
                        value: function(e) {
                            return this.x = e,
                            this
                        }
                    }, {
                        key: "setY",
                        value: function(e) {
                            return this.y = e,
                            this
                        }
                    }, {
                        key: "setZ",
                        value: function(e) {
                            return this.z = e,
                            this
                        }
                    }, {
                        key: "setW",
                        value: function(e) {
                            return this.w = e,
                            this
                        }
                    }, {
                        key: "setComponent",
                        value: function(e, t) {
                            switch (e) {
                            case 0:
                                this.x = t;
                                break;
                            case 1:
                                this.y = t;
                                break;
                            case 2:
                                this.z = t;
                                break;
                            case 3:
                                this.w = t;
                                break;
                            default:
                                throw new Error("index is out of range: " + e)
                            }
                            return this
                        }
                    }, {
                        key: "getComponent",
                        value: function(e) {
                            switch (e) {
                            case 0:
                                return this.x;
                            case 1:
                                return this.y;
                            case 2:
                                return this.z;
                            case 3:
                                return this.w;
                            default:
                                throw new Error("index is out of range: " + e)
                            }
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return new this.constructor(this.x,this.y,this.z,this.w)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this.x = e.x,
                            this.y = e.y,
                            this.z = e.z,
                            this.w = void 0 !== e.w ? e.w : 1,
                            this
                        }
                    }, {
                        key: "add",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
                            this.addVectors(e, t)) : (this.x += e.x,
                            this.y += e.y,
                            this.z += e.z,
                            this.w += e.w,
                            this)
                        }
                    }, {
                        key: "addScalar",
                        value: function(e) {
                            return this.x += e,
                            this.y += e,
                            this.z += e,
                            this.w += e,
                            this
                        }
                    }, {
                        key: "addVectors",
                        value: function(e, t) {
                            return this.x = e.x + t.x,
                            this.y = e.y + t.y,
                            this.z = e.z + t.z,
                            this.w = e.w + t.w,
                            this
                        }
                    }, {
                        key: "addScaledVector",
                        value: function(e, t) {
                            return this.x += e.x * t,
                            this.y += e.y * t,
                            this.z += e.z * t,
                            this.w += e.w * t,
                            this
                        }
                    }, {
                        key: "sub",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
                            this.subVectors(e, t)) : (this.x -= e.x,
                            this.y -= e.y,
                            this.z -= e.z,
                            this.w -= e.w,
                            this)
                        }
                    }, {
                        key: "subScalar",
                        value: function(e) {
                            return this.x -= e,
                            this.y -= e,
                            this.z -= e,
                            this.w -= e,
                            this
                        }
                    }, {
                        key: "subVectors",
                        value: function(e, t) {
                            return this.x = e.x - t.x,
                            this.y = e.y - t.y,
                            this.z = e.z - t.z,
                            this.w = e.w - t.w,
                            this
                        }
                    }, {
                        key: "multiplyScalar",
                        value: function(e) {
                            return this.x *= e,
                            this.y *= e,
                            this.z *= e,
                            this.w *= e,
                            this
                        }
                    }, {
                        key: "applyMatrix4",
                        value: function(e) {
                            var t = this.x
                              , i = this.y
                              , r = this.z
                              , n = this.w
                              , a = e.elements;
                            return this.x = a[0] * t + a[4] * i + a[8] * r + a[12] * n,
                            this.y = a[1] * t + a[5] * i + a[9] * r + a[13] * n,
                            this.z = a[2] * t + a[6] * i + a[10] * r + a[14] * n,
                            this.w = a[3] * t + a[7] * i + a[11] * r + a[15] * n,
                            this
                        }
                    }, {
                        key: "divideScalar",
                        value: function(e) {
                            return this.multiplyScalar(1 / e)
                        }
                    }, {
                        key: "setAxisAngleFromQuaternion",
                        value: function(e) {
                            this.w = 2 * Math.acos(e.w);
                            var t = Math.sqrt(1 - e.w * e.w);
                            return t < 1e-4 ? (this.x = 1,
                            this.y = 0,
                            this.z = 0) : (this.x = e.x / t,
                            this.y = e.y / t,
                            this.z = e.z / t),
                            this
                        }
                    }, {
                        key: "setAxisAngleFromRotationMatrix",
                        value: function(e) {
                            var t, i, r, n, a = .01, o = .1, s = e.elements, l = s[0], u = s[4], c = s[8], h = s[1], p = s[5], f = s[9], d = s[2], m = s[6], v = s[10];
                            if (Math.abs(u - h) < a && Math.abs(c - d) < a && Math.abs(f - m) < a) {
                                if (Math.abs(u + h) < o && Math.abs(c + d) < o && Math.abs(f + m) < o && Math.abs(l + p + v - 3) < o)
                                    return this.set(1, 0, 0, 0),
                                    this;
                                t = Math.PI;
                                var g = (l + 1) / 2
                                  , y = (p + 1) / 2
                                  , _ = (v + 1) / 2
                                  , x = (u + h) / 4
                                  , b = (c + d) / 4
                                  , w = (f + m) / 4;
                                return g > y && g > _ ? g < a ? (i = 0,
                                r = .707106781,
                                n = .707106781) : (r = x / (i = Math.sqrt(g)),
                                n = b / i) : y > _ ? y < a ? (i = .707106781,
                                r = 0,
                                n = .707106781) : (i = x / (r = Math.sqrt(y)),
                                n = w / r) : _ < a ? (i = .707106781,
                                r = .707106781,
                                n = 0) : (i = b / (n = Math.sqrt(_)),
                                r = w / n),
                                this.set(i, r, n, t),
                                this
                            }
                            var S = Math.sqrt((m - f) * (m - f) + (c - d) * (c - d) + (h - u) * (h - u));
                            return Math.abs(S) < .001 && (S = 1),
                            this.x = (m - f) / S,
                            this.y = (c - d) / S,
                            this.z = (h - u) / S,
                            this.w = Math.acos((l + p + v - 1) / 2),
                            this
                        }
                    }, {
                        key: "min",
                        value: function(e) {
                            return this.x = Math.min(this.x, e.x),
                            this.y = Math.min(this.y, e.y),
                            this.z = Math.min(this.z, e.z),
                            this.w = Math.min(this.w, e.w),
                            this
                        }
                    }, {
                        key: "max",
                        value: function(e) {
                            return this.x = Math.max(this.x, e.x),
                            this.y = Math.max(this.y, e.y),
                            this.z = Math.max(this.z, e.z),
                            this.w = Math.max(this.w, e.w),
                            this
                        }
                    }, {
                        key: "clamp",
                        value: function(e, t) {
                            return this.x = Math.max(e.x, Math.min(t.x, this.x)),
                            this.y = Math.max(e.y, Math.min(t.y, this.y)),
                            this.z = Math.max(e.z, Math.min(t.z, this.z)),
                            this.w = Math.max(e.w, Math.min(t.w, this.w)),
                            this
                        }
                    }, {
                        key: "clampScalar",
                        value: function(e, t) {
                            return this.x = Math.max(e, Math.min(t, this.x)),
                            this.y = Math.max(e, Math.min(t, this.y)),
                            this.z = Math.max(e, Math.min(t, this.z)),
                            this.w = Math.max(e, Math.min(t, this.w)),
                            this
                        }
                    }, {
                        key: "clampLength",
                        value: function(e, t) {
                            var i = this.length();
                            return this.divideScalar(i || 1).multiplyScalar(Math.max(e, Math.min(t, i)))
                        }
                    }, {
                        key: "floor",
                        value: function() {
                            return this.x = Math.floor(this.x),
                            this.y = Math.floor(this.y),
                            this.z = Math.floor(this.z),
                            this.w = Math.floor(this.w),
                            this
                        }
                    }, {
                        key: "ceil",
                        value: function() {
                            return this.x = Math.ceil(this.x),
                            this.y = Math.ceil(this.y),
                            this.z = Math.ceil(this.z),
                            this.w = Math.ceil(this.w),
                            this
                        }
                    }, {
                        key: "round",
                        value: function() {
                            return this.x = Math.round(this.x),
                            this.y = Math.round(this.y),
                            this.z = Math.round(this.z),
                            this.w = Math.round(this.w),
                            this
                        }
                    }, {
                        key: "roundToZero",
                        value: function() {
                            return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x),
                            this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y),
                            this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z),
                            this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w),
                            this
                        }
                    }, {
                        key: "negate",
                        value: function() {
                            return this.x = -this.x,
                            this.y = -this.y,
                            this.z = -this.z,
                            this.w = -this.w,
                            this
                        }
                    }, {
                        key: "dot",
                        value: function(e) {
                            return this.x * e.x + this.y * e.y + this.z * e.z + this.w * e.w
                        }
                    }, {
                        key: "lengthSq",
                        value: function() {
                            return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
                        }
                    }, {
                        key: "length",
                        value: function() {
                            return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)
                        }
                    }, {
                        key: "manhattanLength",
                        value: function() {
                            return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w)
                        }
                    }, {
                        key: "normalize",
                        value: function() {
                            return this.divideScalar(this.length() || 1)
                        }
                    }, {
                        key: "setLength",
                        value: function(e) {
                            return this.normalize().multiplyScalar(e)
                        }
                    }, {
                        key: "lerp",
                        value: function(e, t) {
                            return this.x += (e.x - this.x) * t,
                            this.y += (e.y - this.y) * t,
                            this.z += (e.z - this.z) * t,
                            this.w += (e.w - this.w) * t,
                            this
                        }
                    }, {
                        key: "lerpVectors",
                        value: function(e, t, i) {
                            return this.x = e.x + (t.x - e.x) * i,
                            this.y = e.y + (t.y - e.y) * i,
                            this.z = e.z + (t.z - e.z) * i,
                            this.w = e.w + (t.w - e.w) * i,
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e.x === this.x && e.y === this.y && e.z === this.z && e.w === this.w
                        }
                    }, {
                        key: "fromArray",
                        value: function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return this.x = e[t],
                            this.y = e[t + 1],
                            this.z = e[t + 2],
                            this.w = e[t + 3],
                            this
                        }
                    }, {
                        key: "toArray",
                        value: function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
                              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return e[t] = this.x,
                            e[t + 1] = this.y,
                            e[t + 2] = this.z,
                            e[t + 3] = this.w,
                            e
                        }
                    }, {
                        key: "fromBufferAttribute",
                        value: function(e, t, i) {
                            return void 0 !== i && console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),
                            this.x = e.getX(t),
                            this.y = e.getY(t),
                            this.z = e.getZ(t),
                            this.w = e.getW(t),
                            this
                        }
                    }, {
                        key: "random",
                        value: function() {
                            return this.x = Math.random(),
                            this.y = Math.random(),
                            this.z = Math.random(),
                            this.w = Math.random(),
                            this
                        }
                    }]) && nt(t.prototype, i),
                    e
                }();
                function ot(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function st(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var lt = function() {
                    function e() {
                        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
                          , i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                        ot(this, e),
                        Object.defineProperty(this, "isVector2", {
                            value: !0
                        }),
                        this.x = t,
                        this.y = i
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "width",
                        get: function() {
                            return this.x
                        },
                        set: function(e) {
                            this.x = e
                        }
                    }, {
                        key: "height",
                        get: function() {
                            return this.y
                        },
                        set: function(e) {
                            this.y = e
                        }
                    }, {
                        key: "set",
                        value: function(e, t) {
                            return this.x = e,
                            this.y = t,
                            this
                        }
                    }, {
                        key: "setScalar",
                        value: function(e) {
                            return this.x = e,
                            this.y = e,
                            this
                        }
                    }, {
                        key: "setX",
                        value: function(e) {
                            return this.x = e,
                            this
                        }
                    }, {
                        key: "setY",
                        value: function(e) {
                            return this.y = e,
                            this
                        }
                    }, {
                        key: "setComponent",
                        value: function(e, t) {
                            switch (e) {
                            case 0:
                                this.x = t;
                                break;
                            case 1:
                                this.y = t;
                                break;
                            default:
                                throw new Error("index is out of range: " + e)
                            }
                            return this
                        }
                    }, {
                        key: "getComponent",
                        value: function(e) {
                            switch (e) {
                            case 0:
                                return this.x;
                            case 1:
                                return this.y;
                            default:
                                throw new Error("index is out of range: " + e)
                            }
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return new this.constructor(this.x,this.y)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this.x = e.x,
                            this.y = e.y,
                            this
                        }
                    }, {
                        key: "add",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
                            this.addVectors(e, t)) : (this.x += e.x,
                            this.y += e.y,
                            this)
                        }
                    }, {
                        key: "addScalar",
                        value: function(e) {
                            return this.x += e,
                            this.y += e,
                            this
                        }
                    }, {
                        key: "addVectors",
                        value: function(e, t) {
                            return this.x = e.x + t.x,
                            this.y = e.y + t.y,
                            this
                        }
                    }, {
                        key: "addScaledVector",
                        value: function(e, t) {
                            return this.x += e.x * t,
                            this.y += e.y * t,
                            this
                        }
                    }, {
                        key: "sub",
                        value: function(e, t) {
                            return void 0 !== t ? (console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
                            this.subVectors(e, t)) : (this.x -= e.x,
                            this.y -= e.y,
                            this)
                        }
                    }, {
                        key: "subScalar",
                        value: function(e) {
                            return this.x -= e,
                            this.y -= e,
                            this
                        }
                    }, {
                        key: "subVectors",
                        value: function(e, t) {
                            return this.x = e.x - t.x,
                            this.y = e.y - t.y,
                            this
                        }
                    }, {
                        key: "multiply",
                        value: function(e) {
                            return this.x *= e.x,
                            this.y *= e.y,
                            this
                        }
                    }, {
                        key: "multiplyScalar",
                        value: function(e) {
                            return this.x *= e,
                            this.y *= e,
                            this
                        }
                    }, {
                        key: "divide",
                        value: function(e) {
                            return this.x /= e.x,
                            this.y /= e.y,
                            this
                        }
                    }, {
                        key: "divideScalar",
                        value: function(e) {
                            return this.multiplyScalar(1 / e)
                        }
                    }, {
                        key: "applyMatrix3",
                        value: function(e) {
                            var t = this.x
                              , i = this.y
                              , r = e.elements;
                            return this.x = r[0] * t + r[3] * i + r[6],
                            this.y = r[1] * t + r[4] * i + r[7],
                            this
                        }
                    }, {
                        key: "min",
                        value: function(e) {
                            return this.x = Math.min(this.x, e.x),
                            this.y = Math.min(this.y, e.y),
                            this
                        }
                    }, {
                        key: "max",
                        value: function(e) {
                            return this.x = Math.max(this.x, e.x),
                            this.y = Math.max(this.y, e.y),
                            this
                        }
                    }, {
                        key: "clamp",
                        value: function(e, t) {
                            return this.x = Math.max(e.x, Math.min(t.x, this.x)),
                            this.y = Math.max(e.y, Math.min(t.y, this.y)),
                            this
                        }
                    }, {
                        key: "clampScalar",
                        value: function(e, t) {
                            return this.x = Math.max(e, Math.min(t, this.x)),
                            this.y = Math.max(e, Math.min(t, this.y)),
                            this
                        }
                    }, {
                        key: "clampLength",
                        value: function(e, t) {
                            var i = this.length();
                            return this.divideScalar(i || 1).multiplyScalar(Math.max(e, Math.min(t, i)))
                        }
                    }, {
                        key: "floor",
                        value: function() {
                            return this.x = Math.floor(this.x),
                            this.y = Math.floor(this.y),
                            this
                        }
                    }, {
                        key: "ceil",
                        value: function() {
                            return this.x = Math.ceil(this.x),
                            this.y = Math.ceil(this.y),
                            this
                        }
                    }, {
                        key: "round",
                        value: function() {
                            return this.x = Math.round(this.x),
                            this.y = Math.round(this.y),
                            this
                        }
                    }, {
                        key: "roundToZero",
                        value: function() {
                            return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x),
                            this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y),
                            this
                        }
                    }, {
                        key: "negate",
                        value: function() {
                            return this.x = -this.x,
                            this.y = -this.y,
                            this
                        }
                    }, {
                        key: "dot",
                        value: function(e) {
                            return this.x * e.x + this.y * e.y
                        }
                    }, {
                        key: "cross",
                        value: function(e) {
                            return this.x * e.y - this.y * e.x
                        }
                    }, {
                        key: "lengthSq",
                        value: function() {
                            return this.x * this.x + this.y * this.y
                        }
                    }, {
                        key: "length",
                        value: function() {
                            return Math.sqrt(this.x * this.x + this.y * this.y)
                        }
                    }, {
                        key: "manhattanLength",
                        value: function() {
                            return Math.abs(this.x) + Math.abs(this.y)
                        }
                    }, {
                        key: "normalize",
                        value: function() {
                            return this.divideScalar(this.length() || 1)
                        }
                    }, {
                        key: "angle",
                        value: function() {
                            return Math.atan2(-this.y, -this.x) + Math.PI
                        }
                    }, {
                        key: "distanceTo",
                        value: function(e) {
                            return Math.sqrt(this.distanceToSquared(e))
                        }
                    }, {
                        key: "distanceToSquared",
                        value: function(e) {
                            var t = this.x - e.x
                              , i = this.y - e.y;
                            return t * t + i * i
                        }
                    }, {
                        key: "manhattanDistanceTo",
                        value: function(e) {
                            return Math.abs(this.x - e.x) + Math.abs(this.y - e.y)
                        }
                    }, {
                        key: "setLength",
                        value: function(e) {
                            return this.normalize().multiplyScalar(e)
                        }
                    }, {
                        key: "lerp",
                        value: function(e, t) {
                            return this.x += (e.x - this.x) * t,
                            this.y += (e.y - this.y) * t,
                            this
                        }
                    }, {
                        key: "lerpVectors",
                        value: function(e, t, i) {
                            return this.x = e.x + (t.x - e.x) * i,
                            this.y = e.y + (t.y - e.y) * i,
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e.x === this.x && e.y === this.y
                        }
                    }, {
                        key: "fromArray",
                        value: function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return this.x = e[t],
                            this.y = e[t + 1],
                            this
                        }
                    }, {
                        key: "toArray",
                        value: function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
                              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return e[t] = this.x,
                            e[t + 1] = this.y,
                            e
                        }
                    }, {
                        key: "fromBufferAttribute",
                        value: function(e, t, i) {
                            return void 0 !== i && console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),
                            this.x = e.getX(t),
                            this.y = e.getY(t),
                            this
                        }
                    }, {
                        key: "rotateAround",
                        value: function(e, t) {
                            var i = Math.cos(t)
                              , r = Math.sin(t)
                              , n = this.x - e.x
                              , a = this.y - e.y;
                            return this.x = n * i - a * r + e.x,
                            this.y = n * r + a * i + e.y,
                            this
                        }
                    }, {
                        key: "random",
                        value: function() {
                            return this.x = Math.random(),
                            this.y = Math.random(),
                            this
                        }
                    }]) && st(t.prototype, i),
                    e
                }();
                function ut(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var ct = {
                    aliceblue: 15792383,
                    antiquewhite: 16444375,
                    aqua: 65535,
                    aquamarine: 8388564,
                    azure: 15794175,
                    beige: 16119260,
                    bisque: 16770244,
                    black: 0,
                    blanchedalmond: 16772045,
                    blue: 255,
                    blueviolet: 9055202,
                    brown: 10824234,
                    burlywood: 14596231,
                    cadetblue: 6266528,
                    chartreuse: 8388352,
                    chocolate: 13789470,
                    coral: 16744272,
                    cornflowerblue: 6591981,
                    cornsilk: 16775388,
                    crimson: 14423100,
                    cyan: 65535,
                    darkblue: 139,
                    darkcyan: 35723,
                    darkgoldenrod: 12092939,
                    darkgray: 11119017,
                    darkgreen: 25600,
                    darkgrey: 11119017,
                    darkkhaki: 12433259,
                    darkmagenta: 9109643,
                    darkolivegreen: 5597999,
                    darkorange: 16747520,
                    darkorchid: 10040012,
                    darkred: 9109504,
                    darksalmon: 15308410,
                    darkseagreen: 9419919,
                    darkslateblue: 4734347,
                    darkslategray: 3100495,
                    darkslategrey: 3100495,
                    darkturquoise: 52945,
                    darkviolet: 9699539,
                    deeppink: 16716947,
                    deepskyblue: 49151,
                    dimgray: 6908265,
                    dimgrey: 6908265,
                    dodgerblue: 2003199,
                    firebrick: 11674146,
                    floralwhite: 16775920,
                    forestgreen: 2263842,
                    fuchsia: 16711935,
                    gainsboro: 14474460,
                    ghostwhite: 16316671,
                    gold: 16766720,
                    goldenrod: 14329120,
                    gray: 8421504,
                    green: 32768,
                    greenyellow: 11403055,
                    grey: 8421504,
                    honeydew: 15794160,
                    hotpink: 16738740,
                    indianred: 13458524,
                    indigo: 4915330,
                    ivory: 16777200,
                    khaki: 15787660,
                    lavender: 15132410,
                    lavenderblush: 16773365,
                    lawngreen: 8190976,
                    lemonchiffon: 16775885,
                    lightblue: 11393254,
                    lightcoral: 15761536,
                    lightcyan: 14745599,
                    lightgoldenrodyellow: 16448210,
                    lightgray: 13882323,
                    lightgreen: 9498256,
                    lightgrey: 13882323,
                    lightpink: 16758465,
                    lightsalmon: 16752762,
                    lightseagreen: 2142890,
                    lightskyblue: 8900346,
                    lightslategray: 7833753,
                    lightslategrey: 7833753,
                    lightsteelblue: 11584734,
                    lightyellow: 16777184,
                    lime: 65280,
                    limegreen: 3329330,
                    linen: 16445670,
                    magenta: 16711935,
                    maroon: 8388608,
                    mediumaquamarine: 6737322,
                    mediumblue: 205,
                    mediumorchid: 12211667,
                    mediumpurple: 9662683,
                    mediumseagreen: 3978097,
                    mediumslateblue: 8087790,
                    mediumspringgreen: 64154,
                    mediumturquoise: 4772300,
                    mediumvioletred: 13047173,
                    midnightblue: 1644912,
                    mintcream: 16121850,
                    mistyrose: 16770273,
                    moccasin: 16770229,
                    navajowhite: 16768685,
                    navy: 128,
                    oldlace: 16643558,
                    olive: 8421376,
                    olivedrab: 7048739,
                    orange: 16753920,
                    orangered: 16729344,
                    orchid: 14315734,
                    palegoldenrod: 15657130,
                    palegreen: 10025880,
                    paleturquoise: 11529966,
                    palevioletred: 14381203,
                    papayawhip: 16773077,
                    peachpuff: 16767673,
                    peru: 13468991,
                    pink: 16761035,
                    plum: 14524637,
                    powderblue: 11591910,
                    purple: 8388736,
                    rebeccapurple: 6697881,
                    red: 16711680,
                    rosybrown: 12357519,
                    royalblue: 4286945,
                    saddlebrown: 9127187,
                    salmon: 16416882,
                    sandybrown: 16032864,
                    seagreen: 3050327,
                    seashell: 16774638,
                    sienna: 10506797,
                    silver: 12632256,
                    skyblue: 8900331,
                    slateblue: 6970061,
                    slategray: 7372944,
                    slategrey: 7372944,
                    snow: 16775930,
                    springgreen: 65407,
                    steelblue: 4620980,
                    tan: 13808780,
                    teal: 32896,
                    thistle: 14204888,
                    tomato: 16737095,
                    turquoise: 4251856,
                    violet: 15631086,
                    wheat: 16113331,
                    white: 16777215,
                    whitesmoke: 16119285,
                    yellow: 16776960,
                    yellowgreen: 10145074
                }
                  , ht = {
                    h: 0,
                    s: 0,
                    l: 0
                }
                  , pt = {
                    h: 0,
                    s: 0,
                    l: 0
                };
                function ft(e, t, i) {
                    return i < 0 && (i += 1),
                    i > 1 && (i -= 1),
                    i < 1 / 6 ? e + 6 * (t - e) * i : i < .5 ? t : i < 2 / 3 ? e + 6 * (t - e) * (2 / 3 - i) : e
                }
                function dt(e) {
                    return e < .04045 ? .0773993808 * e : Math.pow(.9478672986 * e + .0521327014, 2.4)
                }
                function mt(e) {
                    return e < .0031308 ? 12.92 * e : 1.055 * Math.pow(e, .41666) - .055
                }
                var vt = function() {
                    function e(t, i, r) {
                        return function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, e),
                        Object.defineProperty(this, "isColor", {
                            value: !0
                        }),
                        void 0 === i && void 0 === r ? this.set(t) : this.setRGB(t, i, r)
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e) {
                            return e && e.isColor ? this.copy(e) : "number" == typeof e ? this.setHex(e) : "string" == typeof e && this.setStyle(e),
                            this
                        }
                    }, {
                        key: "setScalar",
                        value: function(e) {
                            return this.r = e,
                            this.g = e,
                            this.b = e,
                            this
                        }
                    }, {
                        key: "setHex",
                        value: function(e) {
                            return e = Math.floor(e),
                            this.r = (e >> 16 & 255) / 255,
                            this.g = (e >> 8 & 255) / 255,
                            this.b = (255 & e) / 255,
                            this
                        }
                    }, {
                        key: "setRGB",
                        value: function(e, t, i) {
                            return this.r = e,
                            this.g = t,
                            this.b = i,
                            this
                        }
                    }, {
                        key: "setHSL",
                        value: function(e, t, i) {
                            if (e = v.euclideanModulo(e, 1),
                            t = v.clamp(t, 0, 1),
                            i = v.clamp(i, 0, 1),
                            0 === t)
                                this.r = this.g = this.b = i;
                            else {
                                var r = i <= .5 ? i * (1 + t) : i + t - i * t
                                  , n = 2 * i - r;
                                this.r = ft(n, r, e + 1 / 3),
                                this.g = ft(n, r, e),
                                this.b = ft(n, r, e - 1 / 3)
                            }
                            return this
                        }
                    }, {
                        key: "setStyle",
                        value: function(e) {
                            function t(t) {
                                void 0 !== t && parseFloat(t) < 1 && console.warn("THREE.Color: Alpha component of " + e + " will be ignored.")
                            }
                            var i;
                            if (i = /^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)) {
                                var r, n = i[1], a = i[2];
                                switch (n) {
                                case "rgb":
                                case "rgba":
                                    if (r = /^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))
                                        return this.r = Math.min(255, parseInt(r[1], 10)) / 255,
                                        this.g = Math.min(255, parseInt(r[2], 10)) / 255,
                                        this.b = Math.min(255, parseInt(r[3], 10)) / 255,
                                        t(r[4]),
                                        this;
                                    if (r = /^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))
                                        return this.r = Math.min(100, parseInt(r[1], 10)) / 100,
                                        this.g = Math.min(100, parseInt(r[2], 10)) / 100,
                                        this.b = Math.min(100, parseInt(r[3], 10)) / 100,
                                        t(r[4]),
                                        this;
                                    break;
                                case "hsl":
                                case "hsla":
                                    if (r = /^(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)) {
                                        var o = parseFloat(r[1]) / 360
                                          , s = parseInt(r[2], 10) / 100
                                          , l = parseInt(r[3], 10) / 100;
                                        return t(r[4]),
                                        this.setHSL(o, s, l)
                                    }
                                }
                            } else if (i = /^\#([A-Fa-f\d]+)$/.exec(e)) {
                                var u = i[1]
                                  , c = u.length;
                                if (3 === c)
                                    return this.r = parseInt(u.charAt(0) + u.charAt(0), 16) / 255,
                                    this.g = parseInt(u.charAt(1) + u.charAt(1), 16) / 255,
                                    this.b = parseInt(u.charAt(2) + u.charAt(2), 16) / 255,
                                    this;
                                if (6 === c)
                                    return this.r = parseInt(u.charAt(0) + u.charAt(1), 16) / 255,
                                    this.g = parseInt(u.charAt(2) + u.charAt(3), 16) / 255,
                                    this.b = parseInt(u.charAt(4) + u.charAt(5), 16) / 255,
                                    this
                            }
                            return e && e.length > 0 ? this.setColorName(e) : this
                        }
                    }, {
                        key: "setColorName",
                        value: function(e) {
                            var t = ct[e];
                            return void 0 !== t ? this.setHex(t) : console.warn("THREE.Color: Unknown color " + e),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return new this.constructor(this.r,this.g,this.b)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this.r = e.r,
                            this.g = e.g,
                            this.b = e.b,
                            this
                        }
                    }, {
                        key: "copyGammaToLinear",
                        value: function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 2;
                            return this.r = Math.pow(e.r, t),
                            this.g = Math.pow(e.g, t),
                            this.b = Math.pow(e.b, t),
                            this
                        }
                    }, {
                        key: "copyLinearToGamma",
                        value: function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 2
                              , i = t > 0 ? 1 / t : 1;
                            return this.r = Math.pow(e.r, i),
                            this.g = Math.pow(e.g, i),
                            this.b = Math.pow(e.b, i),
                            this
                        }
                    }, {
                        key: "convertGammaToLinear",
                        value: function(e) {
                            return this.copyGammaToLinear(this, e),
                            this
                        }
                    }, {
                        key: "convertLinearToGamma",
                        value: function(e) {
                            return this.copyLinearToGamma(this, e),
                            this
                        }
                    }, {
                        key: "copySRGBToLinear",
                        value: function(e) {
                            return this.r = dt(e.r),
                            this.g = dt(e.g),
                            this.b = dt(e.b),
                            this
                        }
                    }, {
                        key: "copyLinearToSRGB",
                        value: function(e) {
                            return this.r = mt(e.r),
                            this.g = mt(e.g),
                            this.b = mt(e.b),
                            this
                        }
                    }, {
                        key: "convertSRGBToLinear",
                        value: function() {
                            return this.copySRGBToLinear(this),
                            this
                        }
                    }, {
                        key: "convertLinearToSRGB",
                        value: function() {
                            return this.copyLinearToSRGB(this),
                            this
                        }
                    }, {
                        key: "getHex",
                        value: function() {
                            return 255 * this.r << 16 ^ 255 * this.g << 8 ^ 255 * this.b << 0
                        }
                    }, {
                        key: "getHexString",
                        value: function() {
                            return ("000000" + this.getHex().toString(16)).slice(-6)
                        }
                    }, {
                        key: "getHSL",
                        value: function(e) {
                            void 0 === e && (console.warn("THREE.Color: .getHSL() target is now required"),
                            e = {
                                h: 0,
                                s: 0,
                                l: 0
                            });
                            var t, i, r = this.r, n = this.g, a = this.b, o = Math.max(r, n, a), s = Math.min(r, n, a), l = (s + o) / 2;
                            if (s === o)
                                t = 0,
                                i = 0;
                            else {
                                var u = o - s;
                                switch (i = l <= .5 ? u / (o + s) : u / (2 - o - s),
                                o) {
                                case r:
                                    t = (n - a) / u + (n < a ? 6 : 0);
                                    break;
                                case n:
                                    t = (a - r) / u + 2;
                                    break;
                                case a:
                                    t = (r - n) / u + 4
                                }
                                t /= 6
                            }
                            return e.h = t,
                            e.s = i,
                            e.l = l,
                            e
                        }
                    }, {
                        key: "getStyle",
                        value: function() {
                            return "rgb(" + (255 * this.r | 0) + "," + (255 * this.g | 0) + "," + (255 * this.b | 0) + ")"
                        }
                    }, {
                        key: "offsetHSL",
                        value: function(e, t, i) {
                            return this.getHSL(ht),
                            ht.h += e,
                            ht.s += t,
                            ht.l += i,
                            this.setHSL(ht.h, ht.s, ht.l),
                            this
                        }
                    }, {
                        key: "add",
                        value: function(e) {
                            return this.r += e.r,
                            this.g += e.g,
                            this.b += e.b,
                            this
                        }
                    }, {
                        key: "addColors",
                        value: function(e, t) {
                            return this.r = e.r + t.r,
                            this.g = e.g + t.g,
                            this.b = e.b + t.b,
                            this
                        }
                    }, {
                        key: "addScalar",
                        value: function(e) {
                            return this.r += e,
                            this.g += e,
                            this.b += e,
                            this
                        }
                    }, {
                        key: "sub",
                        value: function(e) {
                            return this.r = Math.max(0, this.r - e.r),
                            this.g = Math.max(0, this.g - e.g),
                            this.b = Math.max(0, this.b - e.b),
                            this
                        }
                    }, {
                        key: "multiply",
                        value: function(e) {
                            return this.r *= e.r,
                            this.g *= e.g,
                            this.b *= e.b,
                            this
                        }
                    }, {
                        key: "multiplyScalar",
                        value: function(e) {
                            return this.r *= e,
                            this.g *= e,
                            this.b *= e,
                            this
                        }
                    }, {
                        key: "lerp",
                        value: function(e, t) {
                            return this.r += (e.r - this.r) * t,
                            this.g += (e.g - this.g) * t,
                            this.b += (e.b - this.b) * t,
                            this
                        }
                    }, {
                        key: "lerpHSL",
                        value: function(e, t) {
                            this.getHSL(ht),
                            e.getHSL(pt);
                            var i = v.lerp(ht.h, pt.h, t)
                              , r = v.lerp(ht.s, pt.s, t)
                              , n = v.lerp(ht.l, pt.l, t);
                            return this.setHSL(i, r, n),
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e.r === this.r && e.g === this.g && e.b === this.b
                        }
                    }, {
                        key: "fromArray",
                        value: function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return this.r = e[t],
                            this.g = e[t + 1],
                            this.b = e[t + 2],
                            this
                        }
                    }, {
                        key: "toArray",
                        value: function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
                              , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return e[t] = this.r,
                            e[t + 1] = this.g,
                            e[t + 2] = this.b,
                            e
                        }
                    }, {
                        key: "fromBufferAttribute",
                        value: function(e, t) {
                            return this.r = e.getX(t),
                            this.g = e.getY(t),
                            this.b = e.getZ(t),
                            !0 === e.normalized && (this.r /= 255,
                            this.g /= 255,
                            this.b /= 255),
                            this
                        }
                    }, {
                        key: "toJSON",
                        value: function() {
                            return this.getHex()
                        }
                    }]) && ut(t.prototype, i),
                    e
                }();
                vt.NAMES = ct,
                vt.prototype.r = 1,
                vt.prototype.g = 1,
                vt.prototype.b = 1;
                var gt = new w
                  , yt = new lt;
                function _t(e, t, i) {
                    if (Array.isArray(e))
                        throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
                    this.name = "",
                    this.array = e,
                    this.itemSize = t,
                    this.count = void 0 !== e ? e.length / t : 0,
                    this.normalized = !0 === i,
                    this.usage = 35044,
                    this.updateRange = {
                        offset: 0,
                        count: -1
                    },
                    this.version = 0
                }
                function xt(e, t, i) {
                    _t.call(this, new Int8Array(e), t, i)
                }
                function bt(e, t, i) {
                    _t.call(this, new Uint8Array(e), t, i)
                }
                function wt(e, t, i) {
                    _t.call(this, new Uint8ClampedArray(e), t, i)
                }
                function St(e, t, i) {
                    _t.call(this, new Int16Array(e), t, i)
                }
                function Mt(e, t, i) {
                    _t.call(this, new Uint16Array(e), t, i)
                }
                function Tt(e, t, i) {
                    _t.call(this, new Int32Array(e), t, i)
                }
                function Et(e, t, i) {
                    _t.call(this, new Uint32Array(e), t, i)
                }
                function At(e, t, i) {
                    _t.call(this, new Uint16Array(e), t, i)
                }
                function Pt(e, t, i) {
                    _t.call(this, new Float32Array(e), t, i)
                }
                function Ct(e, t, i) {
                    _t.call(this, new Float64Array(e), t, i)
                }
                function Lt(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                Object.defineProperty(_t.prototype, "needsUpdate", {
                    set: function(e) {
                        !0 === e && this.version++
                    }
                }),
                Object.assign(_t.prototype, {
                    isBufferAttribute: !0,
                    onUploadCallback: function() {},
                    setUsage: function(e) {
                        return this.usage = e,
                        this
                    },
                    copy: function(e) {
                        return this.name = e.name,
                        this.array = new e.array.constructor(e.array),
                        this.itemSize = e.itemSize,
                        this.count = e.count,
                        this.normalized = e.normalized,
                        this.usage = e.usage,
                        this
                    },
                    copyAt: function(e, t, i) {
                        e *= this.itemSize,
                        i *= t.itemSize;
                        for (var r = 0, n = this.itemSize; r < n; r++)
                            this.array[e + r] = t.array[i + r];
                        return this
                    },
                    copyArray: function(e) {
                        return this.array.set(e),
                        this
                    },
                    copyColorsArray: function(e) {
                        for (var t = this.array, i = 0, r = 0, n = e.length; r < n; r++) {
                            var a = e[r];
                            void 0 === a && (console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined", r),
                            a = new vt),
                            t[i++] = a.r,
                            t[i++] = a.g,
                            t[i++] = a.b
                        }
                        return this
                    },
                    copyVector2sArray: function(e) {
                        for (var t = this.array, i = 0, r = 0, n = e.length; r < n; r++) {
                            var a = e[r];
                            void 0 === a && (console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined", r),
                            a = new lt),
                            t[i++] = a.x,
                            t[i++] = a.y
                        }
                        return this
                    },
                    copyVector3sArray: function(e) {
                        for (var t = this.array, i = 0, r = 0, n = e.length; r < n; r++) {
                            var a = e[r];
                            void 0 === a && (console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined", r),
                            a = new w),
                            t[i++] = a.x,
                            t[i++] = a.y,
                            t[i++] = a.z
                        }
                        return this
                    },
                    copyVector4sArray: function(e) {
                        for (var t = this.array, i = 0, r = 0, n = e.length; r < n; r++) {
                            var a = e[r];
                            void 0 === a && (console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined", r),
                            a = new at),
                            t[i++] = a.x,
                            t[i++] = a.y,
                            t[i++] = a.z,
                            t[i++] = a.w
                        }
                        return this
                    },
                    applyMatrix3: function(e) {
                        if (2 === this.itemSize)
                            for (var t = 0, i = this.count; t < i; t++)
                                yt.fromBufferAttribute(this, t),
                                yt.applyMatrix3(e),
                                this.setXY(t, yt.x, yt.y);
                        else if (3 === this.itemSize)
                            for (var r = 0, n = this.count; r < n; r++)
                                gt.fromBufferAttribute(this, r),
                                gt.applyMatrix3(e),
                                this.setXYZ(r, gt.x, gt.y, gt.z);
                        return this
                    },
                    applyMatrix4: function(e) {
                        for (var t = 0, i = this.count; t < i; t++)
                            gt.x = this.getX(t),
                            gt.y = this.getY(t),
                            gt.z = this.getZ(t),
                            gt.applyMatrix4(e),
                            this.setXYZ(t, gt.x, gt.y, gt.z);
                        return this
                    },
                    applyNormalMatrix: function(e) {
                        for (var t = 0, i = this.count; t < i; t++)
                            gt.x = this.getX(t),
                            gt.y = this.getY(t),
                            gt.z = this.getZ(t),
                            gt.applyNormalMatrix(e),
                            this.setXYZ(t, gt.x, gt.y, gt.z);
                        return this
                    },
                    transformDirection: function(e) {
                        for (var t = 0, i = this.count; t < i; t++)
                            gt.x = this.getX(t),
                            gt.y = this.getY(t),
                            gt.z = this.getZ(t),
                            gt.transformDirection(e),
                            this.setXYZ(t, gt.x, gt.y, gt.z);
                        return this
                    },
                    set: function(e) {
                        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                        return this.array.set(e, t),
                        this
                    },
                    getX: function(e) {
                        return this.array[e * this.itemSize]
                    },
                    setX: function(e, t) {
                        return this.array[e * this.itemSize] = t,
                        this
                    },
                    getY: function(e) {
                        return this.array[e * this.itemSize + 1]
                    },
                    setY: function(e, t) {
                        return this.array[e * this.itemSize + 1] = t,
                        this
                    },
                    getZ: function(e) {
                        return this.array[e * this.itemSize + 2]
                    },
                    setZ: function(e, t) {
                        return this.array[e * this.itemSize + 2] = t,
                        this
                    },
                    getW: function(e) {
                        return this.array[e * this.itemSize + 3]
                    },
                    setW: function(e, t) {
                        return this.array[e * this.itemSize + 3] = t,
                        this
                    },
                    setXY: function(e, t, i) {
                        return e *= this.itemSize,
                        this.array[e + 0] = t,
                        this.array[e + 1] = i,
                        this
                    },
                    setXYZ: function(e, t, i, r) {
                        return e *= this.itemSize,
                        this.array[e + 0] = t,
                        this.array[e + 1] = i,
                        this.array[e + 2] = r,
                        this
                    },
                    setXYZW: function(e, t, i, r, n) {
                        return e *= this.itemSize,
                        this.array[e + 0] = t,
                        this.array[e + 1] = i,
                        this.array[e + 2] = r,
                        this.array[e + 3] = n,
                        this
                    },
                    onUpload: function(e) {
                        return this.onUploadCallback = e,
                        this
                    },
                    clone: function() {
                        return new this.constructor(this.array,this.itemSize).copy(this)
                    },
                    toJSON: function() {
                        return {
                            itemSize: this.itemSize,
                            type: this.array.constructor.name,
                            array: Array.prototype.slice.call(this.array),
                            normalized: this.normalized
                        }
                    }
                }),
                xt.prototype = Object.create(_t.prototype),
                xt.prototype.constructor = xt,
                bt.prototype = Object.create(_t.prototype),
                bt.prototype.constructor = bt,
                wt.prototype = Object.create(_t.prototype),
                wt.prototype.constructor = wt,
                St.prototype = Object.create(_t.prototype),
                St.prototype.constructor = St,
                Mt.prototype = Object.create(_t.prototype),
                Mt.prototype.constructor = Mt,
                Tt.prototype = Object.create(_t.prototype),
                Tt.prototype.constructor = Tt,
                Et.prototype = Object.create(_t.prototype),
                Et.prototype.constructor = Et,
                At.prototype = Object.create(_t.prototype),
                At.prototype.constructor = At,
                At.prototype.isFloat16BufferAttribute = !0,
                Pt.prototype = Object.create(_t.prototype),
                Pt.prototype.constructor = Pt,
                Ct.prototype = Object.create(_t.prototype),
                Ct.prototype.constructor = Ct;
                var It = new Ge
                  , kt = function() {
                    function e(t, i) {
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, e),
                        this.center = void 0 !== t ? t : new w,
                        this.radius = void 0 !== i ? i : -1
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e, t) {
                            return this.center.copy(e),
                            this.radius = t,
                            this
                        }
                    }, {
                        key: "setFromPoints",
                        value: function(e, t) {
                            var i = this.center;
                            void 0 !== t ? i.copy(t) : It.setFromPoints(e).getCenter(i);
                            for (var r = 0, n = 0, a = e.length; n < a; n++)
                                r = Math.max(r, i.distanceToSquared(e[n]));
                            return this.radius = Math.sqrt(r),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return (new this.constructor).copy(this)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this.center.copy(e.center),
                            this.radius = e.radius,
                            this
                        }
                    }, {
                        key: "isEmpty",
                        value: function() {
                            return this.radius < 0
                        }
                    }, {
                        key: "makeEmpty",
                        value: function() {
                            return this.center.set(0, 0, 0),
                            this.radius = -1,
                            this
                        }
                    }, {
                        key: "containsPoint",
                        value: function(e) {
                            return e.distanceToSquared(this.center) <= this.radius * this.radius
                        }
                    }, {
                        key: "distanceToPoint",
                        value: function(e) {
                            return e.distanceTo(this.center) - this.radius
                        }
                    }, {
                        key: "intersectsSphere",
                        value: function(e) {
                            var t = this.radius + e.radius;
                            return e.center.distanceToSquared(this.center) <= t * t
                        }
                    }, {
                        key: "intersectsBox",
                        value: function(e) {
                            return e.intersectsSphere(this)
                        }
                    }, {
                        key: "intersectsPlane",
                        value: function(e) {
                            return Math.abs(e.distanceToPoint(this.center)) <= this.radius
                        }
                    }, {
                        key: "clampPoint",
                        value: function(e, t) {
                            var i = this.center.distanceToSquared(e);
                            return void 0 === t && (console.warn("THREE.Sphere: .clampPoint() target is now required"),
                            t = new w),
                            t.copy(e),
                            i > this.radius * this.radius && (t.sub(this.center).normalize(),
                            t.multiplyScalar(this.radius).add(this.center)),
                            t
                        }
                    }, {
                        key: "getBoundingBox",
                        value: function(e) {
                            return void 0 === e && (console.warn("THREE.Sphere: .getBoundingBox() target is now required"),
                            e = new Ge),
                            this.isEmpty() ? (e.makeEmpty(),
                            e) : (e.set(this.center, this.center),
                            e.expandByScalar(this.radius),
                            e)
                        }
                    }, {
                        key: "applyMatrix4",
                        value: function(e) {
                            return this.center.applyMatrix4(e),
                            this.radius = this.radius * e.getMaxScaleOnAxis(),
                            this
                        }
                    }, {
                        key: "translate",
                        value: function(e) {
                            return this.center.add(e),
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e.center.equals(this.center) && e.radius === this.radius
                        }
                    }]) && Lt(t.prototype, i),
                    e
                }();
                function zt(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var Dt = function() {
                    function e() {
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, e),
                        this.vertices = [],
                        this.normals = [],
                        this.colors = [],
                        this.uvs = [],
                        this.uvs2 = [],
                        this.groups = [],
                        this.morphTargets = {},
                        this.skinWeights = [],
                        this.skinIndices = [],
                        this.boundingBox = null,
                        this.boundingSphere = null,
                        this.verticesNeedUpdate = !1,
                        this.normalsNeedUpdate = !1,
                        this.colorsNeedUpdate = !1,
                        this.uvsNeedUpdate = !1,
                        this.groupsNeedUpdate = !1
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "computeGroups",
                        value: function(e) {
                            var t, i, r = [], n = void 0, a = e.faces;
                            for (i = 0; i < a.length; i++) {
                                var o = a[i];
                                o.materialIndex !== n && (n = o.materialIndex,
                                void 0 !== t && (t.count = 3 * i - t.start,
                                r.push(t)),
                                t = {
                                    start: 3 * i,
                                    materialIndex: n
                                })
                            }
                            void 0 !== t && (t.count = 3 * i - t.start,
                            r.push(t)),
                            this.groups = r
                        }
                    }, {
                        key: "fromGeometry",
                        value: function(e) {
                            var t, i = e.faces, r = e.vertices, n = e.faceVertexUvs, a = n[0] && n[0].length > 0, o = n[1] && n[1].length > 0, s = e.morphTargets, l = s.length;
                            if (l > 0) {
                                t = [];
                                for (var u = 0; u < l; u++)
                                    t[u] = {
                                        name: s[u].name,
                                        data: []
                                    };
                                this.morphTargets.position = t
                            }
                            var c, h = e.morphNormals, p = h.length;
                            if (p > 0) {
                                c = [];
                                for (var f = 0; f < p; f++)
                                    c[f] = {
                                        name: h[f].name,
                                        data: []
                                    };
                                this.morphTargets.normal = c
                            }
                            var d = e.skinIndices
                              , m = e.skinWeights
                              , v = d.length === r.length
                              , g = m.length === r.length;
                            r.length > 0 && 0 === i.length && console.error("THREE.DirectGeometry: Faceless geometries are not supported.");
                            for (var y = 0; y < i.length; y++) {
                                var _ = i[y];
                                this.vertices.push(r[_.a], r[_.b], r[_.c]);
                                var x = _.vertexNormals;
                                if (3 === x.length)
                                    this.normals.push(x[0], x[1], x[2]);
                                else {
                                    var b = _.normal;
                                    this.normals.push(b, b, b)
                                }
                                var w = _.vertexColors;
                                if (3 === w.length)
                                    this.colors.push(w[0], w[1], w[2]);
                                else {
                                    var S = _.color;
                                    this.colors.push(S, S, S)
                                }
                                if (!0 === a) {
                                    var M = n[0][y];
                                    void 0 !== M ? this.uvs.push(M[0], M[1], M[2]) : (console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ", y),
                                    this.uvs.push(new lt, new lt, new lt))
                                }
                                if (!0 === o) {
                                    var T = n[1][y];
                                    void 0 !== T ? this.uvs2.push(T[0], T[1], T[2]) : (console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ", y),
                                    this.uvs2.push(new lt, new lt, new lt))
                                }
                                for (var E = 0; E < l; E++) {
                                    var A = s[E].vertices;
                                    t[E].data.push(A[_.a], A[_.b], A[_.c])
                                }
                                for (var P = 0; P < p; P++) {
                                    var C = h[P].vertexNormals[y];
                                    c[P].data.push(C.a, C.b, C.c)
                                }
                                v && this.skinIndices.push(d[_.a], d[_.b], d[_.c]),
                                g && this.skinWeights.push(m[_.a], m[_.b], m[_.c])
                            }
                            return this.computeGroups(e),
                            this.verticesNeedUpdate = e.verticesNeedUpdate,
                            this.normalsNeedUpdate = e.normalsNeedUpdate,
                            this.colorsNeedUpdate = e.colorsNeedUpdate,
                            this.uvsNeedUpdate = e.uvsNeedUpdate,
                            this.groupsNeedUpdate = e.groupsNeedUpdate,
                            null !== e.boundingSphere && (this.boundingSphere = e.boundingSphere.clone()),
                            null !== e.boundingBox && (this.boundingBox = e.boundingBox.clone()),
                            this
                        }
                    }]) && zt(t.prototype, i),
                    e
                }();
                function Rt(e) {
                    if (0 === e.length)
                        return -1 / 0;
                    for (var t = e[0], i = 1, r = e.length; i < r; ++i)
                        e[i] > t && (t = e[i]);
                    return t
                }
                Int8Array,
                Uint8Array,
                "undefined" != typeof Uint8ClampedArray ? Uint8ClampedArray : Uint8Array,
                Int16Array,
                Uint16Array,
                Int32Array,
                Uint32Array,
                Float32Array,
                Float64Array;
                var Ot = 1
                  , Bt = new A
                  , Ft = new ae
                  , Nt = new w
                  , Ut = new Ge
                  , Vt = new Ge
                  , Gt = new w;
                function jt() {
                    Object.defineProperty(this, "id", {
                        value: Ot += 2
                    }),
                    this.uuid = v.generateUUID(),
                    this.name = "",
                    this.type = "BufferGeometry",
                    this.index = null,
                    this.attributes = {},
                    this.morphAttributes = {},
                    this.morphTargetsRelative = !1,
                    this.groups = [],
                    this.boundingBox = null,
                    this.boundingSphere = null,
                    this.drawRange = {
                        start: 0,
                        count: 1 / 0
                    },
                    this.userData = {}
                }
                function Ht(e) {
                    return (Ht = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                        return typeof e
                    }
                    : function(e) {
                        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                    }
                    )(e)
                }
                function qt(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function Wt(e, t) {
                    return (Wt = Object.setPrototypeOf || function(e, t) {
                        return e.__proto__ = t,
                        e
                    }
                    )(e, t)
                }
                function Zt(e, t) {
                    return !t || "object" !== Ht(t) && "function" != typeof t ? Xt(e) : t
                }
                function Xt(e) {
                    if (void 0 === e)
                        throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }
                function Yt(e) {
                    return (Yt = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                        return e.__proto__ || Object.getPrototypeOf(e)
                    }
                    )(e)
                }
                jt.prototype = Object.assign(Object.create(R.prototype), {
                    constructor: jt,
                    isBufferGeometry: !0,
                    getIndex: function() {
                        return this.index
                    },
                    setIndex: function(e) {
                        return Array.isArray(e) ? this.index = new (Rt(e) > 65535 ? Et : Mt)(e,1) : this.index = e,
                        this
                    },
                    getAttribute: function(e) {
                        return this.attributes[e]
                    },
                    setAttribute: function(e, t) {
                        return this.attributes[e] = t,
                        this
                    },
                    deleteAttribute: function(e) {
                        return delete this.attributes[e],
                        this
                    },
                    hasAttribute: function(e) {
                        return void 0 !== this.attributes[e]
                    },
                    addGroup: function(e, t) {
                        var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;
                        this.groups.push({
                            start: e,
                            count: t,
                            materialIndex: i
                        })
                    },
                    clearGroups: function() {
                        this.groups = []
                    },
                    setDrawRange: function(e, t) {
                        this.drawRange.start = e,
                        this.drawRange.count = t
                    },
                    applyMatrix4: function(e) {
                        var t = this.attributes.position;
                        void 0 !== t && (t.applyMatrix4(e),
                        t.needsUpdate = !0);
                        var i = this.attributes.normal;
                        if (void 0 !== i) {
                            var r = (new q).getNormalMatrix(e);
                            i.applyNormalMatrix(r),
                            i.needsUpdate = !0
                        }
                        var n = this.attributes.tangent;
                        return void 0 !== n && (n.transformDirection(e),
                        n.needsUpdate = !0),
                        null !== this.boundingBox && this.computeBoundingBox(),
                        null !== this.boundingSphere && this.computeBoundingSphere(),
                        this
                    },
                    rotateX: function(e) {
                        return Bt.makeRotationX(e),
                        this.applyMatrix4(Bt),
                        this
                    },
                    rotateY: function(e) {
                        return Bt.makeRotationY(e),
                        this.applyMatrix4(Bt),
                        this
                    },
                    rotateZ: function(e) {
                        return Bt.makeRotationZ(e),
                        this.applyMatrix4(Bt),
                        this
                    },
                    translate: function(e, t, i) {
                        return Bt.makeTranslation(e, t, i),
                        this.applyMatrix4(Bt),
                        this
                    },
                    scale: function(e, t, i) {
                        return Bt.makeScale(e, t, i),
                        this.applyMatrix4(Bt),
                        this
                    },
                    lookAt: function(e) {
                        return Ft.lookAt(e),
                        Ft.updateMatrix(),
                        this.applyMatrix4(Ft.matrix),
                        this
                    },
                    center: function() {
                        return this.computeBoundingBox(),
                        this.boundingBox.getCenter(Nt).negate(),
                        this.translate(Nt.x, Nt.y, Nt.z),
                        this
                    },
                    setFromObject: function(e) {
                        var t = e.geometry;
                        if (e.isPoints || e.isLine) {
                            var i = new Pt(3 * t.vertices.length,3)
                              , r = new Pt(3 * t.colors.length,3);
                            if (this.setAttribute("position", i.copyVector3sArray(t.vertices)),
                            this.setAttribute("color", r.copyColorsArray(t.colors)),
                            t.lineDistances && t.lineDistances.length === t.vertices.length) {
                                var n = new Pt(t.lineDistances.length,1);
                                this.setAttribute("lineDistance", n.copyArray(t.lineDistances))
                            }
                            null !== t.boundingSphere && (this.boundingSphere = t.boundingSphere.clone()),
                            null !== t.boundingBox && (this.boundingBox = t.boundingBox.clone())
                        } else
                            e.isMesh && t && t.isGeometry && this.fromGeometry(t);
                        return this
                    },
                    setFromPoints: function(e) {
                        for (var t = [], i = 0, r = e.length; i < r; i++) {
                            var n = e[i];
                            t.push(n.x, n.y, n.z || 0)
                        }
                        return this.setAttribute("position", new Pt(t,3)),
                        this
                    },
                    updateFromObject: function(e) {
                        var t = e.geometry;
                        if (e.isMesh) {
                            var i = t.__directGeometry;
                            if (!0 === t.elementsNeedUpdate && (i = void 0,
                            t.elementsNeedUpdate = !1),
                            void 0 === i)
                                return this.fromGeometry(t);
                            i.verticesNeedUpdate = t.verticesNeedUpdate,
                            i.normalsNeedUpdate = t.normalsNeedUpdate,
                            i.colorsNeedUpdate = t.colorsNeedUpdate,
                            i.uvsNeedUpdate = t.uvsNeedUpdate,
                            i.groupsNeedUpdate = t.groupsNeedUpdate,
                            t.verticesNeedUpdate = !1,
                            t.normalsNeedUpdate = !1,
                            t.colorsNeedUpdate = !1,
                            t.uvsNeedUpdate = !1,
                            t.groupsNeedUpdate = !1,
                            t = i
                        }
                        if (!0 === t.verticesNeedUpdate) {
                            var r = this.attributes.position;
                            void 0 !== r && (r.copyVector3sArray(t.vertices),
                            r.needsUpdate = !0),
                            t.verticesNeedUpdate = !1
                        }
                        if (!0 === t.normalsNeedUpdate) {
                            var n = this.attributes.normal;
                            void 0 !== n && (n.copyVector3sArray(t.normals),
                            n.needsUpdate = !0),
                            t.normalsNeedUpdate = !1
                        }
                        if (!0 === t.colorsNeedUpdate) {
                            var a = this.attributes.color;
                            void 0 !== a && (a.copyColorsArray(t.colors),
                            a.needsUpdate = !0),
                            t.colorsNeedUpdate = !1
                        }
                        if (t.uvsNeedUpdate) {
                            var o = this.attributes.uv;
                            void 0 !== o && (o.copyVector2sArray(t.uvs),
                            o.needsUpdate = !0),
                            t.uvsNeedUpdate = !1
                        }
                        if (t.lineDistancesNeedUpdate) {
                            var s = this.attributes.lineDistance;
                            void 0 !== s && (s.copyArray(t.lineDistances),
                            s.needsUpdate = !0),
                            t.lineDistancesNeedUpdate = !1
                        }
                        return t.groupsNeedUpdate && (t.computeGroups(e.geometry),
                        this.groups = t.groups,
                        t.groupsNeedUpdate = !1),
                        this
                    },
                    fromGeometry: function(e) {
                        return e.__directGeometry = (new Dt).fromGeometry(e),
                        this.fromDirectGeometry(e.__directGeometry)
                    },
                    fromDirectGeometry: function(e) {
                        var t = new Float32Array(3 * e.vertices.length);
                        if (this.setAttribute("position", new _t(t,3).copyVector3sArray(e.vertices)),
                        e.normals.length > 0) {
                            var i = new Float32Array(3 * e.normals.length);
                            this.setAttribute("normal", new _t(i,3).copyVector3sArray(e.normals))
                        }
                        if (e.colors.length > 0) {
                            var r = new Float32Array(3 * e.colors.length);
                            this.setAttribute("color", new _t(r,3).copyColorsArray(e.colors))
                        }
                        if (e.uvs.length > 0) {
                            var n = new Float32Array(2 * e.uvs.length);
                            this.setAttribute("uv", new _t(n,2).copyVector2sArray(e.uvs))
                        }
                        if (e.uvs2.length > 0) {
                            var a = new Float32Array(2 * e.uvs2.length);
                            this.setAttribute("uv2", new _t(a,2).copyVector2sArray(e.uvs2))
                        }
                        for (var o in this.groups = e.groups,
                        e.morphTargets) {
                            for (var s = [], l = e.morphTargets[o], u = 0, c = l.length; u < c; u++) {
                                var h = l[u]
                                  , p = new Pt(3 * h.data.length,3);
                                p.name = h.name,
                                s.push(p.copyVector3sArray(h.data))
                            }
                            this.morphAttributes[o] = s
                        }
                        if (e.skinIndices.length > 0) {
                            var f = new Pt(4 * e.skinIndices.length,4);
                            this.setAttribute("skinIndex", f.copyVector4sArray(e.skinIndices))
                        }
                        if (e.skinWeights.length > 0) {
                            var d = new Pt(4 * e.skinWeights.length,4);
                            this.setAttribute("skinWeight", d.copyVector4sArray(e.skinWeights))
                        }
                        return null !== e.boundingSphere && (this.boundingSphere = e.boundingSphere.clone()),
                        null !== e.boundingBox && (this.boundingBox = e.boundingBox.clone()),
                        this
                    },
                    computeBoundingBox: function() {
                        null === this.boundingBox && (this.boundingBox = new Ge);
                        var e = this.attributes.position
                          , t = this.morphAttributes.position;
                        if (e && e.isGLBufferAttribute)
                            return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".', this),
                            void this.boundingBox.set(new w(-1 / 0,-1 / 0,-1 / 0), new w(1 / 0,1 / 0,1 / 0));
                        if (void 0 !== e) {
                            if (this.boundingBox.setFromBufferAttribute(e),
                            t)
                                for (var i = 0, r = t.length; i < r; i++) {
                                    var n = t[i];
                                    Ut.setFromBufferAttribute(n),
                                    this.morphTargetsRelative ? (Gt.addVectors(this.boundingBox.min, Ut.min),
                                    this.boundingBox.expandByPoint(Gt),
                                    Gt.addVectors(this.boundingBox.max, Ut.max),
                                    this.boundingBox.expandByPoint(Gt)) : (this.boundingBox.expandByPoint(Ut.min),
                                    this.boundingBox.expandByPoint(Ut.max))
                                }
                        } else
                            this.boundingBox.makeEmpty();
                        (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) && console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.', this)
                    },
                    computeBoundingSphere: function() {
                        null === this.boundingSphere && (this.boundingSphere = new kt);
                        var e = this.attributes.position
                          , t = this.morphAttributes.position;
                        if (e && e.isGLBufferAttribute)
                            return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".', this),
                            void this.boundingSphere.set(new w, 1 / 0);
                        if (e) {
                            var i = this.boundingSphere.center;
                            if (Ut.setFromBufferAttribute(e),
                            t)
                                for (var r = 0, n = t.length; r < n; r++) {
                                    var a = t[r];
                                    Vt.setFromBufferAttribute(a),
                                    this.morphTargetsRelative ? (Gt.addVectors(Ut.min, Vt.min),
                                    Ut.expandByPoint(Gt),
                                    Gt.addVectors(Ut.max, Vt.max),
                                    Ut.expandByPoint(Gt)) : (Ut.expandByPoint(Vt.min),
                                    Ut.expandByPoint(Vt.max))
                                }
                            Ut.getCenter(i);
                            for (var o = 0, s = 0, l = e.count; s < l; s++)
                                Gt.fromBufferAttribute(e, s),
                                o = Math.max(o, i.distanceToSquared(Gt));
                            if (t)
                                for (var u = 0, c = t.length; u < c; u++)
                                    for (var h = t[u], p = this.morphTargetsRelative, f = 0, d = h.count; f < d; f++)
                                        Gt.fromBufferAttribute(h, f),
                                        p && (Nt.fromBufferAttribute(e, f),
                                        Gt.add(Nt)),
                                        o = Math.max(o, i.distanceToSquared(Gt));
                            this.boundingSphere.radius = Math.sqrt(o),
                            isNaN(this.boundingSphere.radius) && console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.', this)
                        }
                    },
                    computeFaceNormals: function() {},
                    computeVertexNormals: function() {
                        var e = this.index
                          , t = this.getAttribute("position");
                        if (void 0 !== t) {
                            var i = this.getAttribute("normal");
                            if (void 0 === i)
                                i = new _t(new Float32Array(3 * t.count),3),
                                this.setAttribute("normal", i);
                            else
                                for (var r = 0, n = i.count; r < n; r++)
                                    i.setXYZ(r, 0, 0, 0);
                            var a = new w
                              , o = new w
                              , s = new w
                              , l = new w
                              , u = new w
                              , c = new w
                              , h = new w
                              , p = new w;
                            if (e)
                                for (var f = 0, d = e.count; f < d; f += 3) {
                                    var m = e.getX(f + 0)
                                      , v = e.getX(f + 1)
                                      , g = e.getX(f + 2);
                                    a.fromBufferAttribute(t, m),
                                    o.fromBufferAttribute(t, v),
                                    s.fromBufferAttribute(t, g),
                                    h.subVectors(s, o),
                                    p.subVectors(a, o),
                                    h.cross(p),
                                    l.fromBufferAttribute(i, m),
                                    u.fromBufferAttribute(i, v),
                                    c.fromBufferAttribute(i, g),
                                    l.add(h),
                                    u.add(h),
                                    c.add(h),
                                    i.setXYZ(m, l.x, l.y, l.z),
                                    i.setXYZ(v, u.x, u.y, u.z),
                                    i.setXYZ(g, c.x, c.y, c.z)
                                }
                            else
                                for (var y = 0, _ = t.count; y < _; y += 3)
                                    a.fromBufferAttribute(t, y + 0),
                                    o.fromBufferAttribute(t, y + 1),
                                    s.fromBufferAttribute(t, y + 2),
                                    h.subVectors(s, o),
                                    p.subVectors(a, o),
                                    h.cross(p),
                                    i.setXYZ(y + 0, h.x, h.y, h.z),
                                    i.setXYZ(y + 1, h.x, h.y, h.z),
                                    i.setXYZ(y + 2, h.x, h.y, h.z);
                            this.normalizeNormals(),
                            i.needsUpdate = !0
                        }
                    },
                    merge: function(e, t) {
                        if (e && e.isBufferGeometry) {
                            void 0 === t && (t = 0,
                            console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));
                            var i = this.attributes;
                            for (var r in i)
                                if (void 0 !== e.attributes[r])
                                    for (var n = i[r].array, a = e.attributes[r], o = a.array, s = a.itemSize * t, l = Math.min(o.length, n.length - s), u = 0, c = s; u < l; u++,
                                    c++)
                                        n[c] = o[u];
                            return this
                        }
                        console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.", e)
                    },
                    normalizeNormals: function() {
                        for (var e = this.attributes.normal, t = 0, i = e.count; t < i; t++)
                            Gt.fromBufferAttribute(e, t),
                            Gt.normalize(),
                            e.setXYZ(t, Gt.x, Gt.y, Gt.z)
                    },
                    toNonIndexed: function() {
                        function e(e, t) {
                            for (var i = e.array, r = e.itemSize, n = e.normalized, a = new i.constructor(t.length * r), o = 0, s = 0, l = 0, u = t.length; l < u; l++) {
                                o = t[l] * r;
                                for (var c = 0; c < r; c++)
                                    a[s++] = i[o++]
                            }
                            return new _t(a,r,n)
                        }
                        if (null === this.index)
                            return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),
                            this;
                        var t = new jt
                          , i = this.index.array
                          , r = this.attributes;
                        for (var n in r) {
                            var a = e(r[n], i);
                            t.setAttribute(n, a)
                        }
                        var o = this.morphAttributes;
                        for (var s in o) {
                            for (var l = [], u = o[s], c = 0, h = u.length; c < h; c++) {
                                var p = e(u[c], i);
                                l.push(p)
                            }
                            t.morphAttributes[s] = l
                        }
                        t.morphTargetsRelative = this.morphTargetsRelative;
                        for (var f = this.groups, d = 0, m = f.length; d < m; d++) {
                            var v = f[d];
                            t.addGroup(v.start, v.count, v.materialIndex)
                        }
                        return t
                    },
                    toJSON: function() {
                        var e = {
                            metadata: {
                                version: 4.5,
                                type: "BufferGeometry",
                                generator: "BufferGeometry.toJSON"
                            }
                        };
                        if (e.uuid = this.uuid,
                        e.type = this.type,
                        "" !== this.name && (e.name = this.name),
                        Object.keys(this.userData).length > 0 && (e.userData = this.userData),
                        void 0 !== this.parameters) {
                            var t = this.parameters;
                            for (var i in t)
                                void 0 !== t[i] && (e[i] = t[i]);
                            return e
                        }
                        e.data = {
                            attributes: {}
                        };
                        var r = this.index;
                        null !== r && (e.data.index = {
                            type: r.array.constructor.name,
                            array: Array.prototype.slice.call(r.array)
                        });
                        var n = this.attributes;
                        for (var a in n) {
                            var o = n[a]
                              , s = o.toJSON(e.data);
                            "" !== o.name && (s.name = o.name),
                            e.data.attributes[a] = s
                        }
                        var l = {}
                          , u = !1;
                        for (var c in this.morphAttributes) {
                            for (var h = this.morphAttributes[c], p = [], f = 0, d = h.length; f < d; f++) {
                                var m = h[f]
                                  , v = m.toJSON(e.data);
                                "" !== m.name && (v.name = m.name),
                                p.push(v)
                            }
                            p.length > 0 && (l[c] = p,
                            u = !0)
                        }
                        u && (e.data.morphAttributes = l,
                        e.data.morphTargetsRelative = this.morphTargetsRelative);
                        var g = this.groups;
                        g.length > 0 && (e.data.groups = JSON.parse(JSON.stringify(g)));
                        var y = this.boundingSphere;
                        return null !== y && (e.data.boundingSphere = {
                            center: y.center.toArray(),
                            radius: y.radius
                        }),
                        e
                    },
                    clone: function() {
                        return (new jt).copy(this)
                    },
                    copy: function(e) {
                        this.index = null,
                        this.attributes = {},
                        this.morphAttributes = {},
                        this.groups = [],
                        this.boundingBox = null,
                        this.boundingSphere = null;
                        var t = {};
                        this.name = e.name;
                        var i = e.index;
                        null !== i && this.setIndex(i.clone(t));
                        var r = e.attributes;
                        for (var n in r) {
                            var a = r[n];
                            this.setAttribute(n, a.clone(t))
                        }
                        var o = e.morphAttributes;
                        for (var s in o) {
                            for (var l = [], u = o[s], c = 0, h = u.length; c < h; c++)
                                l.push(u[c].clone(t));
                            this.morphAttributes[s] = l
                        }
                        this.morphTargetsRelative = e.morphTargetsRelative;
                        for (var p = e.groups, f = 0, d = p.length; f < d; f++) {
                            var m = p[f];
                            this.addGroup(m.start, m.count, m.materialIndex)
                        }
                        var v = e.boundingBox;
                        null !== v && (this.boundingBox = v.clone());
                        var g = e.boundingSphere;
                        return null !== g && (this.boundingSphere = g.clone()),
                        this.drawRange.start = e.drawRange.start,
                        this.drawRange.count = e.drawRange.count,
                        this.userData = e.userData,
                        this
                    },
                    dispose: function() {
                        this.dispatchEvent({
                            type: "dispose"
                        })
                    }
                });
                var Kt = function(e) {
                    !function(e, t) {
                        if ("function" != typeof t && null !== t)
                            throw new TypeError("Super expression must either be null or a function");
                        e.prototype = Object.create(t && t.prototype, {
                            constructor: {
                                value: e,
                                writable: !0,
                                configurable: !0
                            }
                        }),
                        t && Wt(e, t)
                    }(i, e);
                    var t = function(e) {
                        var t = function() {
                            if ("undefined" == typeof Reflect || !Reflect.construct)
                                return !1;
                            if (Reflect.construct.sham)
                                return !1;
                            if ("function" == typeof Proxy)
                                return !0;
                            try {
                                return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}
                                ))),
                                !0
                            } catch (e) {
                                return !1
                            }
                        }();
                        return function() {
                            var i, r = Yt(e);
                            if (t) {
                                var n = Yt(this).constructor;
                                i = Reflect.construct(r, arguments, n)
                            } else
                                i = r.apply(this, arguments);
                            return Zt(this, i)
                        }
                    }(i);
                    function i() {
                        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1, s = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 1, l = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 1;
                        qt(this, i),
                        (e = t.call(this)).type = "BoxBufferGeometry",
                        e.parameters = {
                            width: r,
                            height: n,
                            depth: a,
                            widthSegments: o,
                            heightSegments: s,
                            depthSegments: l
                        };
                        var u = Xt(e);
                        o = Math.floor(o),
                        s = Math.floor(s),
                        l = Math.floor(l);
                        var c = []
                          , h = []
                          , p = []
                          , f = []
                          , d = 0
                          , m = 0;
                        function v(e, t, i, r, n, a, o, s, l, v, g) {
                            for (var y = a / l, _ = o / v, x = a / 2, b = o / 2, S = s / 2, M = l + 1, T = v + 1, E = 0, A = 0, P = new w, C = 0; C < T; C++)
                                for (var L = C * _ - b, I = 0; I < M; I++) {
                                    var k = I * y - x;
                                    P[e] = k * r,
                                    P[t] = L * n,
                                    P[i] = S,
                                    h.push(P.x, P.y, P.z),
                                    P[e] = 0,
                                    P[t] = 0,
                                    P[i] = s > 0 ? 1 : -1,
                                    p.push(P.x, P.y, P.z),
                                    f.push(I / l),
                                    f.push(1 - C / v),
                                    E += 1
                                }
                            for (var z = 0; z < v; z++)
                                for (var D = 0; D < l; D++) {
                                    var R = d + D + M * z
                                      , O = d + D + M * (z + 1)
                                      , B = d + (D + 1) + M * (z + 1)
                                      , F = d + (D + 1) + M * z;
                                    c.push(R, O, F),
                                    c.push(O, B, F),
                                    A += 6
                                }
                            u.addGroup(m, A, g),
                            m += A,
                            d += E
                        }
                        return v("z", "y", "x", -1, -1, a, n, r, l, s, 0),
                        v("z", "y", "x", 1, -1, a, n, -r, l, s, 1),
                        v("x", "z", "y", 1, 1, r, a, n, o, l, 2),
                        v("x", "z", "y", 1, -1, r, a, -n, o, l, 3),
                        v("x", "y", "z", 1, -1, r, n, a, o, s, 4),
                        v("x", "y", "z", -1, -1, r, n, -a, o, s, 5),
                        e.setIndex(c),
                        e.setAttribute("position", new Pt(h,3)),
                        e.setAttribute("normal", new Pt(p,3)),
                        e.setAttribute("uv", new Pt(f,2)),
                        e
                    }
                    return i
                }(jt);
                function Jt(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var Qt = new w
                  , $t = new w
                  , ei = new w
                  , ti = new w
                  , ii = new w
                  , ri = new w
                  , ni = new w
                  , ai = function() {
                    function e(t, i) {
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, e),
                        this.origin = void 0 !== t ? t : new w,
                        this.direction = void 0 !== i ? i : new w(0,0,-1)
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e, t) {
                            return this.origin.copy(e),
                            this.direction.copy(t),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return (new this.constructor).copy(this)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this.origin.copy(e.origin),
                            this.direction.copy(e.direction),
                            this
                        }
                    }, {
                        key: "at",
                        value: function(e, t) {
                            return void 0 === t && (console.warn("THREE.Ray: .at() target is now required"),
                            t = new w),
                            t.copy(this.direction).multiplyScalar(e).add(this.origin)
                        }
                    }, {
                        key: "lookAt",
                        value: function(e) {
                            return this.direction.copy(e).sub(this.origin).normalize(),
                            this
                        }
                    }, {
                        key: "recast",
                        value: function(e) {
                            return this.origin.copy(this.at(e, Qt)),
                            this
                        }
                    }, {
                        key: "closestPointToPoint",
                        value: function(e, t) {
                            void 0 === t && (console.warn("THREE.Ray: .closestPointToPoint() target is now required"),
                            t = new w),
                            t.subVectors(e, this.origin);
                            var i = t.dot(this.direction);
                            return i < 0 ? t.copy(this.origin) : t.copy(this.direction).multiplyScalar(i).add(this.origin)
                        }
                    }, {
                        key: "distanceToPoint",
                        value: function(e) {
                            return Math.sqrt(this.distanceSqToPoint(e))
                        }
                    }, {
                        key: "distanceSqToPoint",
                        value: function(e) {
                            var t = Qt.subVectors(e, this.origin).dot(this.direction);
                            return t < 0 ? this.origin.distanceToSquared(e) : (Qt.copy(this.direction).multiplyScalar(t).add(this.origin),
                            Qt.distanceToSquared(e))
                        }
                    }, {
                        key: "distanceSqToSegment",
                        value: function(e, t, i, r) {
                            $t.copy(e).add(t).multiplyScalar(.5),
                            ei.copy(t).sub(e).normalize(),
                            ti.copy(this.origin).sub($t);
                            var n, a, o, s, l = .5 * e.distanceTo(t), u = -this.direction.dot(ei), c = ti.dot(this.direction), h = -ti.dot(ei), p = ti.lengthSq(), f = Math.abs(1 - u * u);
                            if (f > 0)
                                if (a = u * c - h,
                                s = l * f,
                                (n = u * h - c) >= 0)
                                    if (a >= -s)
                                        if (a <= s) {
                                            var d = 1 / f;
                                            o = (n *= d) * (n + u * (a *= d) + 2 * c) + a * (u * n + a + 2 * h) + p
                                        } else
                                            a = l,
                                            o = -(n = Math.max(0, -(u * a + c))) * n + a * (a + 2 * h) + p;
                                    else
                                        a = -l,
                                        o = -(n = Math.max(0, -(u * a + c))) * n + a * (a + 2 * h) + p;
                                else
                                    a <= -s ? o = -(n = Math.max(0, -(-u * l + c))) * n + (a = n > 0 ? -l : Math.min(Math.max(-l, -h), l)) * (a + 2 * h) + p : a <= s ? (n = 0,
                                    o = (a = Math.min(Math.max(-l, -h), l)) * (a + 2 * h) + p) : o = -(n = Math.max(0, -(u * l + c))) * n + (a = n > 0 ? l : Math.min(Math.max(-l, -h), l)) * (a + 2 * h) + p;
                            else
                                a = u > 0 ? -l : l,
                                o = -(n = Math.max(0, -(u * a + c))) * n + a * (a + 2 * h) + p;
                            return i && i.copy(this.direction).multiplyScalar(n).add(this.origin),
                            r && r.copy(ei).multiplyScalar(a).add($t),
                            o
                        }
                    }, {
                        key: "intersectSphere",
                        value: function(e, t) {
                            Qt.subVectors(e.center, this.origin);
                            var i = Qt.dot(this.direction)
                              , r = Qt.dot(Qt) - i * i
                              , n = e.radius * e.radius;
                            if (r > n)
                                return null;
                            var a = Math.sqrt(n - r)
                              , o = i - a
                              , s = i + a;
                            return o < 0 && s < 0 ? null : o < 0 ? this.at(s, t) : this.at(o, t)
                        }
                    }, {
                        key: "intersectsSphere",
                        value: function(e) {
                            return this.distanceSqToPoint(e.center) <= e.radius * e.radius
                        }
                    }, {
                        key: "distanceToPlane",
                        value: function(e) {
                            var t = e.normal.dot(this.direction);
                            if (0 === t)
                                return 0 === e.distanceToPoint(this.origin) ? 0 : null;
                            var i = -(this.origin.dot(e.normal) + e.constant) / t;
                            return i >= 0 ? i : null
                        }
                    }, {
                        key: "intersectPlane",
                        value: function(e, t) {
                            var i = this.distanceToPlane(e);
                            return null === i ? null : this.at(i, t)
                        }
                    }, {
                        key: "intersectsPlane",
                        value: function(e) {
                            var t = e.distanceToPoint(this.origin);
                            return 0 === t || e.normal.dot(this.direction) * t < 0
                        }
                    }, {
                        key: "intersectBox",
                        value: function(e, t) {
                            var i, r, n, a, o, s, l = 1 / this.direction.x, u = 1 / this.direction.y, c = 1 / this.direction.z, h = this.origin;
                            return l >= 0 ? (i = (e.min.x - h.x) * l,
                            r = (e.max.x - h.x) * l) : (i = (e.max.x - h.x) * l,
                            r = (e.min.x - h.x) * l),
                            u >= 0 ? (n = (e.min.y - h.y) * u,
                            a = (e.max.y - h.y) * u) : (n = (e.max.y - h.y) * u,
                            a = (e.min.y - h.y) * u),
                            i > a || n > r ? null : ((n > i || i != i) && (i = n),
                            (a < r || r != r) && (r = a),
                            c >= 0 ? (o = (e.min.z - h.z) * c,
                            s = (e.max.z - h.z) * c) : (o = (e.max.z - h.z) * c,
                            s = (e.min.z - h.z) * c),
                            i > s || o > r ? null : ((o > i || i != i) && (i = o),
                            (s < r || r != r) && (r = s),
                            r < 0 ? null : this.at(i >= 0 ? i : r, t)))
                        }
                    }, {
                        key: "intersectsBox",
                        value: function(e) {
                            return null !== this.intersectBox(e, Qt)
                        }
                    }, {
                        key: "intersectTriangle",
                        value: function(e, t, i, r, n) {
                            ii.subVectors(t, e),
                            ri.subVectors(i, e),
                            ni.crossVectors(ii, ri);
                            var a, o = this.direction.dot(ni);
                            if (o > 0) {
                                if (r)
                                    return null;
                                a = 1
                            } else {
                                if (!(o < 0))
                                    return null;
                                a = -1,
                                o = -o
                            }
                            ti.subVectors(this.origin, e);
                            var s = a * this.direction.dot(ri.crossVectors(ti, ri));
                            if (s < 0)
                                return null;
                            var l = a * this.direction.dot(ii.cross(ti));
                            if (l < 0)
                                return null;
                            if (s + l > o)
                                return null;
                            var u = -a * ti.dot(ni);
                            return u < 0 ? null : this.at(u / o, n)
                        }
                    }, {
                        key: "applyMatrix4",
                        value: function(e) {
                            return this.origin.applyMatrix4(e),
                            this.direction.transformDirection(e),
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e.origin.equals(this.origin) && e.direction.equals(this.direction)
                        }
                    }]) && Jt(t.prototype, i),
                    e
                }();
                function oi(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var si = new w
                  , li = new w
                  , ui = new q
                  , ci = function() {
                    function e(t, i) {
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, e),
                        Object.defineProperty(this, "isPlane", {
                            value: !0
                        }),
                        this.normal = void 0 !== t ? t : new w(1,0,0),
                        this.constant = void 0 !== i ? i : 0
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e, t) {
                            return this.normal.copy(e),
                            this.constant = t,
                            this
                        }
                    }, {
                        key: "setComponents",
                        value: function(e, t, i, r) {
                            return this.normal.set(e, t, i),
                            this.constant = r,
                            this
                        }
                    }, {
                        key: "setFromNormalAndCoplanarPoint",
                        value: function(e, t) {
                            return this.normal.copy(e),
                            this.constant = -t.dot(this.normal),
                            this
                        }
                    }, {
                        key: "setFromCoplanarPoints",
                        value: function(e, t, i) {
                            var r = si.subVectors(i, t).cross(li.subVectors(e, t)).normalize();
                            return this.setFromNormalAndCoplanarPoint(r, e),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return (new this.constructor).copy(this)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this.normal.copy(e.normal),
                            this.constant = e.constant,
                            this
                        }
                    }, {
                        key: "normalize",
                        value: function() {
                            var e = 1 / this.normal.length();
                            return this.normal.multiplyScalar(e),
                            this.constant *= e,
                            this
                        }
                    }, {
                        key: "negate",
                        value: function() {
                            return this.constant *= -1,
                            this.normal.negate(),
                            this
                        }
                    }, {
                        key: "distanceToPoint",
                        value: function(e) {
                            return this.normal.dot(e) + this.constant
                        }
                    }, {
                        key: "distanceToSphere",
                        value: function(e) {
                            return this.distanceToPoint(e.center) - e.radius
                        }
                    }, {
                        key: "projectPoint",
                        value: function(e, t) {
                            return void 0 === t && (console.warn("THREE.Plane: .projectPoint() target is now required"),
                            t = new w),
                            t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)
                        }
                    }, {
                        key: "intersectLine",
                        value: function(e, t) {
                            void 0 === t && (console.warn("THREE.Plane: .intersectLine() target is now required"),
                            t = new w);
                            var i = e.delta(si)
                              , r = this.normal.dot(i);
                            if (0 === r)
                                return 0 === this.distanceToPoint(e.start) ? t.copy(e.start) : void 0;
                            var n = -(e.start.dot(this.normal) + this.constant) / r;
                            return n < 0 || n > 1 ? void 0 : t.copy(i).multiplyScalar(n).add(e.start)
                        }
                    }, {
                        key: "intersectsLine",
                        value: function(e) {
                            var t = this.distanceToPoint(e.start)
                              , i = this.distanceToPoint(e.end);
                            return t < 0 && i > 0 || i < 0 && t > 0
                        }
                    }, {
                        key: "intersectsBox",
                        value: function(e) {
                            return e.intersectsPlane(this)
                        }
                    }, {
                        key: "intersectsSphere",
                        value: function(e) {
                            return e.intersectsPlane(this)
                        }
                    }, {
                        key: "coplanarPoint",
                        value: function(e) {
                            return void 0 === e && (console.warn("THREE.Plane: .coplanarPoint() target is now required"),
                            e = new w),
                            e.copy(this.normal).multiplyScalar(-this.constant)
                        }
                    }, {
                        key: "applyMatrix4",
                        value: function(e, t) {
                            var i = t || ui.getNormalMatrix(e)
                              , r = this.coplanarPoint(si).applyMatrix4(e)
                              , n = this.normal.applyMatrix3(i).normalize();
                            return this.constant = -r.dot(n),
                            this
                        }
                    }, {
                        key: "translate",
                        value: function(e) {
                            return this.constant -= e.dot(this.normal),
                            this
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e.normal.equals(this.normal) && e.constant === this.constant
                        }
                    }]) && oi(t.prototype, i),
                    e
                }();
                function hi(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var pi = new w
                  , fi = new w
                  , di = new w
                  , mi = new w
                  , vi = new w
                  , gi = new w
                  , yi = new w
                  , _i = new w
                  , xi = new w
                  , bi = new w
                  , wi = function() {
                    function e(t, i, r) {
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, e),
                        this.a = void 0 !== t ? t : new w,
                        this.b = void 0 !== i ? i : new w,
                        this.c = void 0 !== r ? r : new w
                    }
                    var t, i, r;
                    return t = e,
                    r = [{
                        key: "getNormal",
                        value: function(e, t, i, r) {
                            void 0 === r && (console.warn("THREE.Triangle: .getNormal() target is now required"),
                            r = new w),
                            r.subVectors(i, t),
                            pi.subVectors(e, t),
                            r.cross(pi);
                            var n = r.lengthSq();
                            return n > 0 ? r.multiplyScalar(1 / Math.sqrt(n)) : r.set(0, 0, 0)
                        }
                    }, {
                        key: "getBarycoord",
                        value: function(e, t, i, r, n) {
                            pi.subVectors(r, t),
                            fi.subVectors(i, t),
                            di.subVectors(e, t);
                            var a = pi.dot(pi)
                              , o = pi.dot(fi)
                              , s = pi.dot(di)
                              , l = fi.dot(fi)
                              , u = fi.dot(di)
                              , c = a * l - o * o;
                            if (void 0 === n && (console.warn("THREE.Triangle: .getBarycoord() target is now required"),
                            n = new w),
                            0 === c)
                                return n.set(-2, -1, -1);
                            var h = 1 / c
                              , p = (l * s - o * u) * h
                              , f = (a * u - o * s) * h;
                            return n.set(1 - p - f, f, p)
                        }
                    }, {
                        key: "containsPoint",
                        value: function(e, t, i, r) {
                            return this.getBarycoord(e, t, i, r, mi),
                            mi.x >= 0 && mi.y >= 0 && mi.x + mi.y <= 1
                        }
                    }, {
                        key: "getUV",
                        value: function(e, t, i, r, n, a, o, s) {
                            return this.getBarycoord(e, t, i, r, mi),
                            s.set(0, 0),
                            s.addScaledVector(n, mi.x),
                            s.addScaledVector(a, mi.y),
                            s.addScaledVector(o, mi.z),
                            s
                        }
                    }, {
                        key: "isFrontFacing",
                        value: function(e, t, i, r) {
                            return pi.subVectors(i, t),
                            fi.subVectors(e, t),
                            pi.cross(fi).dot(r) < 0
                        }
                    }],
                    (i = [{
                        key: "set",
                        value: function(e, t, i) {
                            return this.a.copy(e),
                            this.b.copy(t),
                            this.c.copy(i),
                            this
                        }
                    }, {
                        key: "setFromPointsAndIndices",
                        value: function(e, t, i, r) {
                            return this.a.copy(e[t]),
                            this.b.copy(e[i]),
                            this.c.copy(e[r]),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return (new this.constructor).copy(this)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            return this.a.copy(e.a),
                            this.b.copy(e.b),
                            this.c.copy(e.c),
                            this
                        }
                    }, {
                        key: "getArea",
                        value: function() {
                            return pi.subVectors(this.c, this.b),
                            fi.subVectors(this.a, this.b),
                            .5 * pi.cross(fi).length()
                        }
                    }, {
                        key: "getMidpoint",
                        value: function(e) {
                            return void 0 === e && (console.warn("THREE.Triangle: .getMidpoint() target is now required"),
                            e = new w),
                            e.addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3)
                        }
                    }, {
                        key: "getNormal",
                        value: function(t) {
                            return e.getNormal(this.a, this.b, this.c, t)
                        }
                    }, {
                        key: "getPlane",
                        value: function(e) {
                            return void 0 === e && (console.warn("THREE.Triangle: .getPlane() target is now required"),
                            e = new ci),
                            e.setFromCoplanarPoints(this.a, this.b, this.c)
                        }
                    }, {
                        key: "getBarycoord",
                        value: function(t, i) {
                            return e.getBarycoord(t, this.a, this.b, this.c, i)
                        }
                    }, {
                        key: "getUV",
                        value: function(t, i, r, n, a) {
                            return e.getUV(t, this.a, this.b, this.c, i, r, n, a)
                        }
                    }, {
                        key: "containsPoint",
                        value: function(t) {
                            return e.containsPoint(t, this.a, this.b, this.c)
                        }
                    }, {
                        key: "isFrontFacing",
                        value: function(t) {
                            return e.isFrontFacing(this.a, this.b, this.c, t)
                        }
                    }, {
                        key: "intersectsBox",
                        value: function(e) {
                            return e.intersectsTriangle(this)
                        }
                    }, {
                        key: "closestPointToPoint",
                        value: function(e, t) {
                            void 0 === t && (console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),
                            t = new w);
                            var i, r, n = this.a, a = this.b, o = this.c;
                            vi.subVectors(a, n),
                            gi.subVectors(o, n),
                            _i.subVectors(e, n);
                            var s = vi.dot(_i)
                              , l = gi.dot(_i);
                            if (s <= 0 && l <= 0)
                                return t.copy(n);
                            xi.subVectors(e, a);
                            var u = vi.dot(xi)
                              , c = gi.dot(xi);
                            if (u >= 0 && c <= u)
                                return t.copy(a);
                            var h = s * c - u * l;
                            if (h <= 0 && s >= 0 && u <= 0)
                                return i = s / (s - u),
                                t.copy(n).addScaledVector(vi, i);
                            bi.subVectors(e, o);
                            var p = vi.dot(bi)
                              , f = gi.dot(bi);
                            if (f >= 0 && p <= f)
                                return t.copy(o);
                            var d = p * l - s * f;
                            if (d <= 0 && l >= 0 && f <= 0)
                                return r = l / (l - f),
                                t.copy(n).addScaledVector(gi, r);
                            var m = u * f - p * c;
                            if (m <= 0 && c - u >= 0 && p - f >= 0)
                                return yi.subVectors(o, a),
                                r = (c - u) / (c - u + (p - f)),
                                t.copy(a).addScaledVector(yi, r);
                            var v = 1 / (m + d + h);
                            return i = d * v,
                            r = h * v,
                            t.copy(n).addScaledVector(vi, i).addScaledVector(gi, r)
                        }
                    }, {
                        key: "equals",
                        value: function(e) {
                            return e.a.equals(this.a) && e.b.equals(this.b) && e.c.equals(this.c)
                        }
                    }]) && hi(t.prototype, i),
                    r && hi(t, r),
                    e
                }();
                function Si(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function Mi(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                var Ti = function() {
                    function e(t, i, r, n, a) {
                        var o = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 0;
                        Si(this, e),
                        this.a = t,
                        this.b = i,
                        this.c = r,
                        this.normal = n && n.isVector3 ? n : new w,
                        this.vertexNormals = Array.isArray(n) ? n : [],
                        this.color = a && a.isColor ? a : new vt,
                        this.vertexColors = Array.isArray(a) ? a : [],
                        this.materialIndex = o
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "clone",
                        value: function() {
                            return (new this.constructor).copy(this)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            this.a = e.a,
                            this.b = e.b,
                            this.c = e.c,
                            this.normal.copy(e.normal),
                            this.color.copy(e.color),
                            this.materialIndex = e.materialIndex;
                            for (var t = 0, i = e.vertexNormals.length; t < i; t++)
                                this.vertexNormals[t] = e.vertexNormals[t].clone();
                            for (var r = 0, n = e.vertexColors.length; r < n; r++)
                                this.vertexColors[r] = e.vertexColors[r].clone();
                            return this
                        }
                    }]) && Mi(t.prototype, i),
                    e
                }();
                function Ei(e) {
                    Oe.call(this),
                    this.type = "MeshBasicMaterial",
                    this.color = new vt(16777215),
                    this.map = null,
                    this.lightMap = null,
                    this.lightMapIntensity = 1,
                    this.aoMap = null,
                    this.aoMapIntensity = 1,
                    this.specularMap = null,
                    this.alphaMap = null,
                    this.envMap = null,
                    this.combine = 0,
                    this.reflectivity = 1,
                    this.refractionRatio = .98,
                    this.wireframe = !1,
                    this.wireframeLinewidth = 1,
                    this.wireframeLinecap = "round",
                    this.wireframeLinejoin = "round",
                    this.skinning = !1,
                    this.morphTargets = !1,
                    this.setValues(e)
                }
                Ei.prototype = Object.create(Oe.prototype),
                Ei.prototype.constructor = Ei,
                Ei.prototype.isMeshBasicMaterial = !0,
                Ei.prototype.copy = function(e) {
                    return Oe.prototype.copy.call(this, e),
                    this.color.copy(e.color),
                    this.map = e.map,
                    this.lightMap = e.lightMap,
                    this.lightMapIntensity = e.lightMapIntensity,
                    this.aoMap = e.aoMap,
                    this.aoMapIntensity = e.aoMapIntensity,
                    this.specularMap = e.specularMap,
                    this.alphaMap = e.alphaMap,
                    this.envMap = e.envMap,
                    this.combine = e.combine,
                    this.reflectivity = e.reflectivity,
                    this.refractionRatio = e.refractionRatio,
                    this.wireframe = e.wireframe,
                    this.wireframeLinewidth = e.wireframeLinewidth,
                    this.wireframeLinecap = e.wireframeLinecap,
                    this.wireframeLinejoin = e.wireframeLinejoin,
                    this.skinning = e.skinning,
                    this.morphTargets = e.morphTargets,
                    this
                }
                ;
                var Ai = new A
                  , Pi = new ai
                  , Ci = new kt
                  , Li = new w
                  , Ii = new w
                  , ki = new w
                  , zi = new w
                  , Di = new w
                  , Ri = new w
                  , Oi = new w
                  , Bi = new w
                  , Fi = new w
                  , Ni = new lt
                  , Ui = new lt
                  , Vi = new lt
                  , Gi = new w
                  , ji = new w;
                function Hi() {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new jt
                      , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new Ei;
                    ae.call(this),
                    this.type = "Mesh",
                    this.geometry = e,
                    this.material = t,
                    this.updateMorphTargets()
                }
                function qi(e, t, i, r, n, a, o, s) {
                    if (null === (1 === t.side ? r.intersectTriangle(o, a, n, !0, s) : r.intersectTriangle(n, a, o, 2 !== t.side, s)))
                        return null;
                    ji.copy(s),
                    ji.applyMatrix4(e.matrixWorld);
                    var l = i.ray.origin.distanceTo(ji);
                    return l < i.near || l > i.far ? null : {
                        distance: l,
                        point: ji.clone(),
                        object: e
                    }
                }
                function Wi(e, t, i, r, n, a, o, s, l, u, c, h) {
                    Li.fromBufferAttribute(n, u),
                    Ii.fromBufferAttribute(n, c),
                    ki.fromBufferAttribute(n, h);
                    var p = e.morphTargetInfluences;
                    if (t.morphTargets && a && p) {
                        Oi.set(0, 0, 0),
                        Bi.set(0, 0, 0),
                        Fi.set(0, 0, 0);
                        for (var f = 0, d = a.length; f < d; f++) {
                            var m = p[f]
                              , v = a[f];
                            0 !== m && (zi.fromBufferAttribute(v, u),
                            Di.fromBufferAttribute(v, c),
                            Ri.fromBufferAttribute(v, h),
                            o ? (Oi.addScaledVector(zi, m),
                            Bi.addScaledVector(Di, m),
                            Fi.addScaledVector(Ri, m)) : (Oi.addScaledVector(zi.sub(Li), m),
                            Bi.addScaledVector(Di.sub(Ii), m),
                            Fi.addScaledVector(Ri.sub(ki), m)))
                        }
                        Li.add(Oi),
                        Ii.add(Bi),
                        ki.add(Fi)
                    }
                    e.isSkinnedMesh && (e.boneTransform(u, Li),
                    e.boneTransform(c, Ii),
                    e.boneTransform(h, ki));
                    var g = qi(e, t, i, r, Li, Ii, ki, Gi);
                    if (g) {
                        s && (Ni.fromBufferAttribute(s, u),
                        Ui.fromBufferAttribute(s, c),
                        Vi.fromBufferAttribute(s, h),
                        g.uv = wi.getUV(Gi, Li, Ii, ki, Ni, Ui, Vi, new lt)),
                        l && (Ni.fromBufferAttribute(l, u),
                        Ui.fromBufferAttribute(l, c),
                        Vi.fromBufferAttribute(l, h),
                        g.uv2 = wi.getUV(Gi, Li, Ii, ki, Ni, Ui, Vi, new lt));
                        var y = new Ti(u,c,h);
                        wi.getNormal(Li, Ii, ki, y.normal),
                        g.face = y
                    }
                    return g
                }
                function Zi(e) {
                    return (Zi = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                        return typeof e
                    }
                    : function(e) {
                        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                    }
                    )(e)
                }
                function Xi(e, t) {
                    return (Xi = Object.setPrototypeOf || function(e, t) {
                        return e.__proto__ = t,
                        e
                    }
                    )(e, t)
                }
                function Yi(e, t) {
                    return !t || "object" !== Zi(t) && "function" != typeof t ? function(e) {
                        if (void 0 === e)
                            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return e
                    }(e) : t
                }
                function Ki(e) {
                    return (Ki = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                        return e.__proto__ || Object.getPrototypeOf(e)
                    }
                    )(e)
                }
                Hi.prototype = Object.assign(Object.create(ae.prototype), {
                    constructor: Hi,
                    isMesh: !0,
                    copy: function(e) {
                        return ae.prototype.copy.call(this, e),
                        void 0 !== e.morphTargetInfluences && (this.morphTargetInfluences = e.morphTargetInfluences.slice()),
                        void 0 !== e.morphTargetDictionary && (this.morphTargetDictionary = Object.assign({}, e.morphTargetDictionary)),
                        this.material = e.material,
                        this.geometry = e.geometry,
                        this
                    },
                    updateMorphTargets: function() {
                        var e = this.geometry;
                        if (e.isBufferGeometry) {
                            var t = e.morphAttributes
                              , i = Object.keys(t);
                            if (i.length > 0) {
                                var r = t[i[0]];
                                if (void 0 !== r) {
                                    this.morphTargetInfluences = [],
                                    this.morphTargetDictionary = {};
                                    for (var n = 0, a = r.length; n < a; n++) {
                                        var o = r[n].name || String(n);
                                        this.morphTargetInfluences.push(0),
                                        this.morphTargetDictionary[o] = n
                                    }
                                }
                            }
                        } else {
                            var s = e.morphTargets;
                            void 0 !== s && s.length > 0 && console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")
                        }
                    },
                    raycast: function(e, t) {
                        var i, r = this.geometry, n = this.material, a = this.matrixWorld;
                        if (void 0 !== n && (null === r.boundingSphere && r.computeBoundingSphere(),
                        Ci.copy(r.boundingSphere),
                        Ci.applyMatrix4(a),
                        !1 !== e.ray.intersectsSphere(Ci) && (Ai.copy(a).invert(),
                        Pi.copy(e.ray).applyMatrix4(Ai),
                        null === r.boundingBox || !1 !== Pi.intersectsBox(r.boundingBox))))
                            if (r.isBufferGeometry) {
                                var o = r.index
                                  , s = r.attributes.position
                                  , l = r.morphAttributes.position
                                  , u = r.morphTargetsRelative
                                  , c = r.attributes.uv
                                  , h = r.attributes.uv2
                                  , p = r.groups
                                  , f = r.drawRange;
                                if (null !== o)
                                    if (Array.isArray(n))
                                        for (var d = 0, m = p.length; d < m; d++)
                                            for (var v = p[d], g = n[v.materialIndex], y = Math.max(v.start, f.start), _ = Math.min(v.start + v.count, f.start + f.count); y < _; y += 3) {
                                                var x = o.getX(y)
                                                  , b = o.getX(y + 1)
                                                  , w = o.getX(y + 2);
                                                (i = Wi(this, g, e, Pi, s, l, u, c, h, x, b, w)) && (i.faceIndex = Math.floor(y / 3),
                                                i.face.materialIndex = v.materialIndex,
                                                t.push(i))
                                            }
                                    else
                                        for (var S = Math.max(0, f.start), M = Math.min(o.count, f.start + f.count); S < M; S += 3) {
                                            var T = o.getX(S)
                                              , E = o.getX(S + 1)
                                              , A = o.getX(S + 2);
                                            (i = Wi(this, n, e, Pi, s, l, u, c, h, T, E, A)) && (i.faceIndex = Math.floor(S / 3),
                                            t.push(i))
                                        }
                                else if (void 0 !== s)
                                    if (Array.isArray(n))
                                        for (var P = 0, C = p.length; P < C; P++)
                                            for (var L = p[P], I = n[L.materialIndex], k = Math.max(L.start, f.start), z = Math.min(L.start + L.count, f.start + f.count); k < z; k += 3)
                                                (i = Wi(this, I, e, Pi, s, l, u, c, h, k, k + 1, k + 2)) && (i.faceIndex = Math.floor(k / 3),
                                                i.face.materialIndex = L.materialIndex,
                                                t.push(i));
                                    else
                                        for (var D = Math.max(0, f.start), R = Math.min(s.count, f.start + f.count); D < R; D += 3)
                                            (i = Wi(this, n, e, Pi, s, l, u, c, h, D, D + 1, D + 2)) && (i.faceIndex = Math.floor(D / 3),
                                            t.push(i))
                            } else if (r.isGeometry) {
                                var O, B = Array.isArray(n), F = r.vertices, N = r.faces, U = r.faceVertexUvs[0];
                                U.length > 0 && (O = U);
                                for (var V = 0, G = N.length; V < G; V++) {
                                    var j = N[V]
                                      , H = B ? n[j.materialIndex] : n;
                                    if (void 0 !== H) {
                                        var q = F[j.a]
                                          , W = F[j.b]
                                          , Z = F[j.c];
                                        if (i = qi(this, H, e, Pi, q, W, Z, Gi)) {
                                            if (O && O[V]) {
                                                var X = O[V];
                                                Ni.copy(X[0]),
                                                Ui.copy(X[1]),
                                                Vi.copy(X[2]),
                                                i.uv = wi.getUV(Gi, q, W, Z, Ni, Ui, Vi, new lt)
                                            }
                                            i.face = j,
                                            i.faceIndex = V,
                                            t.push(i)
                                        }
                                    }
                                }
                            }
                    }
                });
                var Ji = new w
                  , Qi = new w
                  , $i = new w
                  , er = new wi
                  , tr = function(e) {
                    !function(e, t) {
                        if ("function" != typeof t && null !== t)
                            throw new TypeError("Super expression must either be null or a function");
                        e.prototype = Object.create(t && t.prototype, {
                            constructor: {
                                value: e,
                                writable: !0,
                                configurable: !0
                            }
                        }),
                        t && Xi(e, t)
                    }(i, e);
                    var t = function(e) {
                        var t = function() {
                            if ("undefined" == typeof Reflect || !Reflect.construct)
                                return !1;
                            if (Reflect.construct.sham)
                                return !1;
                            if ("function" == typeof Proxy)
                                return !0;
                            try {
                                return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}
                                ))),
                                !0
                            } catch (e) {
                                return !1
                            }
                        }();
                        return function() {
                            var i, r = Ki(e);
                            if (t) {
                                var n = Ki(this).constructor;
                                i = Reflect.construct(r, arguments, n)
                            } else
                                i = r.apply(this, arguments);
                            return Yi(this, i)
                        }
                    }(i);
                    function i(e, r) {
                        var n;
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, i),
                        (n = t.call(this)).type = "EdgesGeometry",
                        n.parameters = {
                            thresholdAngle: r
                        },
                        r = void 0 !== r ? r : 1,
                        e.isGeometry && (e = (new jt).fromGeometry(e));
                        for (var a = Math.pow(10, 4), o = Math.cos(v.DEG2RAD * r), s = e.getIndex(), l = e.getAttribute("position"), u = s ? s.count : l.count, c = [0, 0, 0], h = ["a", "b", "c"], p = new Array(3), f = {}, d = [], m = 0; m < u; m += 3) {
                            s ? (c[0] = s.getX(m),
                            c[1] = s.getX(m + 1),
                            c[2] = s.getX(m + 2)) : (c[0] = m,
                            c[1] = m + 1,
                            c[2] = m + 2);
                            var g = er.a
                              , y = er.b
                              , _ = er.c;
                            if (g.fromBufferAttribute(l, c[0]),
                            y.fromBufferAttribute(l, c[1]),
                            _.fromBufferAttribute(l, c[2]),
                            er.getNormal($i),
                            p[0] = "".concat(Math.round(g.x * a), ",").concat(Math.round(g.y * a), ",").concat(Math.round(g.z * a)),
                            p[1] = "".concat(Math.round(y.x * a), ",").concat(Math.round(y.y * a), ",").concat(Math.round(y.z * a)),
                            p[2] = "".concat(Math.round(_.x * a), ",").concat(Math.round(_.y * a), ",").concat(Math.round(_.z * a)),
                            p[0] !== p[1] && p[1] !== p[2] && p[2] !== p[0])
                                for (var x = 0; x < 3; x++) {
                                    var b = (x + 1) % 3
                                      , w = p[x]
                                      , S = p[b]
                                      , M = er[h[x]]
                                      , T = er[h[b]]
                                      , E = "".concat(w, "_").concat(S)
                                      , A = "".concat(S, "_").concat(w);
                                    A in f && f[A] ? ($i.dot(f[A].normal) <= o && (d.push(M.x, M.y, M.z),
                                    d.push(T.x, T.y, T.z)),
                                    f[A] = null) : E in f || (f[E] = {
                                        index0: c[x],
                                        index1: c[b],
                                        normal: $i.clone()
                                    })
                                }
                        }
                        for (var P in f)
                            if (f[P]) {
                                var C = f[P]
                                  , L = C.index0
                                  , I = C.index1;
                                Ji.fromBufferAttribute(l, L),
                                Qi.fromBufferAttribute(l, I),
                                d.push(Ji.x, Ji.y, Ji.z),
                                d.push(Qi.x, Qi.y, Qi.z)
                            }
                        return n.setAttribute("position", new Pt(d,3)),
                        n
                    }
                    return i
                }(jt);
                function ir(e) {
                    Oe.call(this),
                    this.type = "LineBasicMaterial",
                    this.color = new vt(16777215),
                    this.linewidth = 1,
                    this.linecap = "round",
                    this.linejoin = "round",
                    this.morphTargets = !1,
                    this.setValues(e)
                }
                ir.prototype = Object.create(Oe.prototype),
                ir.prototype.constructor = ir,
                ir.prototype.isLineBasicMaterial = !0,
                ir.prototype.copy = function(e) {
                    return Oe.prototype.copy.call(this, e),
                    this.color.copy(e.color),
                    this.linewidth = e.linewidth,
                    this.linecap = e.linecap,
                    this.linejoin = e.linejoin,
                    this.morphTargets = e.morphTargets,
                    this
                }
                ;
                var rr = new w
                  , nr = new w
                  , ar = new A
                  , or = new ai
                  , sr = new kt;
                function lr() {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : new jt
                      , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new ir;
                    ae.call(this),
                    this.type = "Line",
                    this.geometry = e,
                    this.material = t,
                    this.updateMorphTargets()
                }
                lr.prototype = Object.assign(Object.create(ae.prototype), {
                    constructor: lr,
                    isLine: !0,
                    copy: function(e) {
                        return ae.prototype.copy.call(this, e),
                        this.material = e.material,
                        this.geometry = e.geometry,
                        this
                    },
                    computeLineDistances: function() {
                        var e = this.geometry;
                        if (e.isBufferGeometry)
                            if (null === e.index) {
                                for (var t = e.attributes.position, i = [0], r = 1, n = t.count; r < n; r++)
                                    rr.fromBufferAttribute(t, r - 1),
                                    nr.fromBufferAttribute(t, r),
                                    i[r] = i[r - 1],
                                    i[r] += rr.distanceTo(nr);
                                e.setAttribute("lineDistance", new Pt(i,1))
                            } else
                                console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
                        else if (e.isGeometry) {
                            var a = e.vertices
                              , o = e.lineDistances;
                            o[0] = 0;
                            for (var s = 1, l = a.length; s < l; s++)
                                o[s] = o[s - 1],
                                o[s] += a[s - 1].distanceTo(a[s])
                        }
                        return this
                    },
                    raycast: function(e, t) {
                        var i = this.geometry
                          , r = this.matrixWorld
                          , n = e.params.Line.threshold;
                        if (null === i.boundingSphere && i.computeBoundingSphere(),
                        sr.copy(i.boundingSphere),
                        sr.applyMatrix4(r),
                        sr.radius += n,
                        !1 !== e.ray.intersectsSphere(sr)) {
                            ar.copy(r).invert(),
                            or.copy(e.ray).applyMatrix4(ar);
                            var a = n / ((this.scale.x + this.scale.y + this.scale.z) / 3)
                              , o = a * a
                              , s = new w
                              , l = new w
                              , u = new w
                              , c = new w
                              , h = this.isLineSegments ? 2 : 1;
                            if (i.isBufferGeometry) {
                                var p = i.index
                                  , f = i.attributes.position;
                                if (null !== p)
                                    for (var d = p.array, m = 0, v = d.length - 1; m < v; m += h) {
                                        var g = d[m]
                                          , y = d[m + 1];
                                        if (s.fromBufferAttribute(f, g),
                                        l.fromBufferAttribute(f, y),
                                        !(or.distanceSqToSegment(s, l, c, u) > o)) {
                                            c.applyMatrix4(this.matrixWorld);
                                            var _ = e.ray.origin.distanceTo(c);
                                            _ < e.near || _ > e.far || t.push({
                                                distance: _,
                                                point: u.clone().applyMatrix4(this.matrixWorld),
                                                index: m,
                                                face: null,
                                                faceIndex: null,
                                                object: this
                                            })
                                        }
                                    }
                                else
                                    for (var x = 0, b = f.count - 1; x < b; x += h)
                                        if (s.fromBufferAttribute(f, x),
                                        l.fromBufferAttribute(f, x + 1),
                                        !(or.distanceSqToSegment(s, l, c, u) > o)) {
                                            c.applyMatrix4(this.matrixWorld);
                                            var S = e.ray.origin.distanceTo(c);
                                            S < e.near || S > e.far || t.push({
                                                distance: S,
                                                point: u.clone().applyMatrix4(this.matrixWorld),
                                                index: x,
                                                face: null,
                                                faceIndex: null,
                                                object: this
                                            })
                                        }
                            } else if (i.isGeometry)
                                for (var M = i.vertices, T = M.length, E = 0; E < T - 1; E += h)
                                    if (!(or.distanceSqToSegment(M[E], M[E + 1], c, u) > o)) {
                                        c.applyMatrix4(this.matrixWorld);
                                        var A = e.ray.origin.distanceTo(c);
                                        A < e.near || A > e.far || t.push({
                                            distance: A,
                                            point: u.clone().applyMatrix4(this.matrixWorld),
                                            index: E,
                                            face: null,
                                            faceIndex: null,
                                            object: this
                                        })
                                    }
                        }
                    },
                    updateMorphTargets: function() {
                        var e = this.geometry;
                        if (e.isBufferGeometry) {
                            var t = e.morphAttributes
                              , i = Object.keys(t);
                            if (i.length > 0) {
                                var r = t[i[0]];
                                if (void 0 !== r) {
                                    this.morphTargetInfluences = [],
                                    this.morphTargetDictionary = {};
                                    for (var n = 0, a = r.length; n < a; n++) {
                                        var o = r[n].name || String(n);
                                        this.morphTargetInfluences.push(0),
                                        this.morphTargetDictionary[o] = n
                                    }
                                }
                            }
                        } else {
                            var s = e.morphTargets;
                            void 0 !== s && s.length > 0 && console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")
                        }
                    }
                });
                var ur, cr = new w, hr = new w;
                function pr(e, t) {
                    lr.call(this, e, t),
                    this.type = "LineSegments"
                }
                pr.prototype = Object.assign(Object.create(lr.prototype), {
                    constructor: pr,
                    isLineSegments: !0,
                    computeLineDistances: function() {
                        var e = this.geometry;
                        if (e.isBufferGeometry)
                            if (null === e.index) {
                                for (var t = e.attributes.position, i = [], r = 0, n = t.count; r < n; r += 2)
                                    cr.fromBufferAttribute(t, r),
                                    hr.fromBufferAttribute(t, r + 1),
                                    i[r] = 0 === r ? 0 : i[r - 1],
                                    i[r + 1] = i[r] + cr.distanceTo(hr);
                                e.setAttribute("lineDistance", new Pt(i,1))
                            } else
                                console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
                        else if (e.isGeometry)
                            for (var a = e.vertices, o = e.lineDistances, s = 0, l = a.length; s < l; s += 2)
                                cr.copy(a[s]),
                                hr.copy(a[s + 1]),
                                o[s] = 0 === s ? 0 : o[s - 1],
                                o[s + 1] = o[s] + cr.distanceTo(hr);
                        return this
                    }
                });
                var fr = 0;
                function dr() {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : dr.DEFAULT_IMAGE
                      , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : dr.DEFAULT_MAPPING
                      , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : ge
                      , r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : ge
                      , n = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : xe
                      , a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : be
                      , o = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : Ce
                      , s = arguments.length > 7 && void 0 !== arguments[7] ? arguments[7] : we
                      , l = arguments.length > 8 && void 0 !== arguments[8] ? arguments[8] : 1
                      , u = arguments.length > 9 && void 0 !== arguments[9] ? arguments[9] : ke;
                    Object.defineProperty(this, "id", {
                        value: fr++
                    }),
                    this.uuid = v.generateUUID(),
                    this.name = "",
                    this.image = e,
                    this.mipmaps = [],
                    this.mapping = t,
                    this.wrapS = i,
                    this.wrapT = r,
                    this.magFilter = n,
                    this.minFilter = a,
                    this.anisotropy = l,
                    this.format = o,
                    this.internalFormat = null,
                    this.type = s,
                    this.offset = new lt(0,0),
                    this.repeat = new lt(1,1),
                    this.center = new lt(0,0),
                    this.rotation = 0,
                    this.matrixAutoUpdate = !0,
                    this.matrix = new q,
                    this.generateMipmaps = !0,
                    this.premultiplyAlpha = !1,
                    this.flipY = !0,
                    this.unpackAlignment = 4,
                    this.encoding = u,
                    this.version = 0,
                    this.onUpdate = null
                }
                function mr(e) {
                    return "undefined" != typeof HTMLImageElement && e instanceof HTMLImageElement || "undefined" != typeof HTMLCanvasElement && e instanceof HTMLCanvasElement || "undefined" != typeof ImageBitmap && e instanceof ImageBitmap ? function(e) {
                        if (/^data:/i.test(e.src))
                            return e.src;
                        if ("undefined" == typeof HTMLCanvasElement)
                            return e.src;
                        var t;
                        if (e instanceof HTMLCanvasElement)
                            t = e;
                        else {
                            void 0 === ur && (ur = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas")),
                            ur.width = e.width,
                            ur.height = e.height;
                            var i = ur.getContext("2d");
                            e instanceof ImageData ? i.putImageData(e, 0, 0) : i.drawImage(e, 0, 0, e.width, e.height),
                            t = ur
                        }
                        return t.width > 2048 || t.height > 2048 ? t.toDataURL("image/jpeg", .6) : t.toDataURL("image/png")
                    }(e) : e.data ? {
                        data: Array.prototype.slice.call(e.data),
                        width: e.width,
                        height: e.height,
                        type: e.data.constructor.name
                    } : (console.warn("THREE.Texture: Unable to serialize Texture."),
                    {})
                }
                function vr(e, t, i, r, n, a, o, s, l, u, c, h) {
                    dr.call(this, null, a, o, s, l, u, r, n, c, h),
                    this.image = {
                        data: e || null,
                        width: t || 1,
                        height: i || 1
                    },
                    this.magFilter = void 0 !== l ? l : _e,
                    this.minFilter = void 0 !== u ? u : _e,
                    this.generateMipmaps = !1,
                    this.flipY = !1,
                    this.unpackAlignment = 1,
                    this.needsUpdate = !0
                }
                function gr(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var r = t[i];
                        r.enumerable = r.enumerable || !1,
                        r.configurable = !0,
                        "value"in r && (r.writable = !0),
                        Object.defineProperty(e, r.key, r)
                    }
                }
                dr.DEFAULT_IMAGE = void 0,
                dr.DEFAULT_MAPPING = 300,
                dr.prototype = Object.assign(Object.create(R.prototype), {
                    constructor: dr,
                    isTexture: !0,
                    updateMatrix: function() {
                        this.matrix.setUvTransform(this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y)
                    },
                    clone: function() {
                        return (new this.constructor).copy(this)
                    },
                    copy: function(e) {
                        return this.name = e.name,
                        this.image = e.image,
                        this.mipmaps = e.mipmaps.slice(0),
                        this.mapping = e.mapping,
                        this.wrapS = e.wrapS,
                        this.wrapT = e.wrapT,
                        this.magFilter = e.magFilter,
                        this.minFilter = e.minFilter,
                        this.anisotropy = e.anisotropy,
                        this.format = e.format,
                        this.internalFormat = e.internalFormat,
                        this.type = e.type,
                        this.offset.copy(e.offset),
                        this.repeat.copy(e.repeat),
                        this.center.copy(e.center),
                        this.rotation = e.rotation,
                        this.matrixAutoUpdate = e.matrixAutoUpdate,
                        this.matrix.copy(e.matrix),
                        this.generateMipmaps = e.generateMipmaps,
                        this.premultiplyAlpha = e.premultiplyAlpha,
                        this.flipY = e.flipY,
                        this.unpackAlignment = e.unpackAlignment,
                        this.encoding = e.encoding,
                        this
                    },
                    toJSON: function(e) {
                        var t = void 0 === e || "string" == typeof e;
                        if (!t && void 0 !== e.textures[this.uuid])
                            return e.textures[this.uuid];
                        var i = {
                            metadata: {
                                version: 4.5,
                                type: "Texture",
                                generator: "Texture.toJSON"
                            },
                            uuid: this.uuid,
                            name: this.name,
                            mapping: this.mapping,
                            repeat: [this.repeat.x, this.repeat.y],
                            offset: [this.offset.x, this.offset.y],
                            center: [this.center.x, this.center.y],
                            rotation: this.rotation,
                            wrap: [this.wrapS, this.wrapT],
                            format: this.format,
                            type: this.type,
                            encoding: this.encoding,
                            minFilter: this.minFilter,
                            magFilter: this.magFilter,
                            anisotropy: this.anisotropy,
                            flipY: this.flipY,
                            premultiplyAlpha: this.premultiplyAlpha,
                            unpackAlignment: this.unpackAlignment
                        };
                        if (void 0 !== this.image) {
                            var r = this.image;
                            if (void 0 === r.uuid && (r.uuid = v.generateUUID()),
                            !t && void 0 === e.images[r.uuid]) {
                                var n;
                                if (Array.isArray(r)) {
                                    n = [];
                                    for (var a = 0, o = r.length; a < o; a++)
                                        r[a].isDataTexture ? n.push(mr(r[a].image)) : n.push(mr(r[a]))
                                } else
                                    n = mr(r);
                                e.images[r.uuid] = {
                                    uuid: r.uuid,
                                    url: n
                                }
                            }
                            i.image = r.uuid
                        }
                        return t || (e.textures[this.uuid] = i),
                        i
                    },
                    dispose: function() {
                        this.dispatchEvent({
                            type: "dispose"
                        })
                    },
                    transformUv: function(e) {
                        if (300 !== this.mapping)
                            return e;
                        if (e.applyMatrix3(this.matrix),
                        e.x < 0 || e.x > 1)
                            switch (this.wrapS) {
                            case ve:
                                e.x = e.x - Math.floor(e.x);
                                break;
                            case ge:
                                e.x = e.x < 0 ? 0 : 1;
                                break;
                            case ye:
                                1 === Math.abs(Math.floor(e.x) % 2) ? e.x = Math.ceil(e.x) - e.x : e.x = e.x - Math.floor(e.x)
                            }
                        if (e.y < 0 || e.y > 1)
                            switch (this.wrapT) {
                            case ve:
                                e.y = e.y - Math.floor(e.y);
                                break;
                            case ge:
                                e.y = e.y < 0 ? 0 : 1;
                                break;
                            case ye:
                                1 === Math.abs(Math.floor(e.y) % 2) ? e.y = Math.ceil(e.y) - e.y : e.y = e.y - Math.floor(e.y)
                            }
                        return this.flipY && (e.y = 1 - e.y),
                        e
                    }
                }),
                Object.defineProperty(dr.prototype, "needsUpdate", {
                    set: function(e) {
                        !0 === e && this.version++
                    }
                }),
                vr.prototype = Object.create(dr.prototype),
                vr.prototype.constructor = vr,
                vr.prototype.isDataTexture = !0;
                var yr = new kt
                  , _r = new w
                  , xr = function() {
                    function e(t, i, r, n, a, o) {
                        !function(e, t) {
                            if (!(e instanceof t))
                                throw new TypeError("Cannot call a class as a function")
                        }(this, e),
                        this.planes = [void 0 !== t ? t : new ci, void 0 !== i ? i : new ci, void 0 !== r ? r : new ci, void 0 !== n ? n : new ci, void 0 !== a ? a : new ci, void 0 !== o ? o : new ci]
                    }
                    var t, i;
                    return t = e,
                    (i = [{
                        key: "set",
                        value: function(e, t, i, r, n, a) {
                            var o = this.planes;
                            return o[0].copy(e),
                            o[1].copy(t),
                            o[2].copy(i),
                            o[3].copy(r),
                            o[4].copy(n),
                            o[5].copy(a),
                            this
                        }
                    }, {
                        key: "clone",
                        value: function() {
                            return (new this.constructor).copy(this)
                        }
                    }, {
                        key: "copy",
                        value: function(e) {
                            for (var t = this.planes, i = 0; i < 6; i++)
                                t[i].copy(e.planes[i]);
                            return this
                        }
                    }, {
                        key: "setFromProjectionMatrix",
                        value: function(e) {
                            var t = this.planes
                              , i = e.elements
                              , r = i[0]
                              , n = i[1]
                              , a = i[2]
                              , o = i[3]
                              , s = i[4]
                              , l = i[5]
                              , u = i[6]
                              , c = i[7]
                              , h = i[8]
                              , p = i[9]
                              , f = i[10]
                              , d = i[11]
                              , m = i[12]
                              , v = i[13]
                              , g = i[14]
                              , y = i[15];
                            return t[0].setComponents(o - r, c - s, d - h, y - m).normalize(),
                            t[1].setComponents(o + r, c + s, d + h, y + m).normalize(),
                            t[2].setComponents(o + n, c + l, d + p, y + v).normalize(),
                            t[3].setComponents(o - n, c - l, d - p, y - v).normalize(),
                            t[4].setComponents(o - a, c - u, d - f, y - g).normalize(),
                            t[5].setComponents(o + a, c + u, d + f, y + g).normalize(),
                            this
                        }
                    }, {
                        key: "intersectsObject",
                        value: function(e) {
                            var t = e.geometry;
                            return null === t.boundingSphere && t.computeBoundingSphere(),
                            yr.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),
                            this.intersectsSphere(yr)
                        }
                    }, {
                        key: "intersectsSprite",
                        value: function(e) {
                            return yr.center.set(0, 0, 0),
                            yr.radius = .7071067811865476,
                            yr.applyMatrix4(e.matrixWorld),
                            this.intersectsSphere(yr)
                        }
                    }, {
                        key: "intersectsSphere",
                        value: function(e) {
                            for (var t = this.planes, i = e.center, r = -e.radius, n = 0; n < 6; n++)
                                if (t[n].distanceToPoint(i) < r)
                                    return !1;
                            return !0
                        }
                    }, {
                        key: "intersectsBox",
                        value: function(e) {
                            for (var t = this.planes, i = 0; i < 6; i++) {
                                var r = t[i];
                                if (_r.x = r.normal.x > 0 ? e.max.x : e.min.x,
                                _r.y = r.normal.y > 0 ? e.max.y : e.min.y,
                                _r.z = r.normal.z > 0 ? e.max.z : e.min.z,
                                r.distanceToPoint(_r) < 0)
                                    return !1
                            }
                            return !0
                        }
                    }, {
                        key: "containsPoint",
                        value: function(e) {
                            for (var t = this.planes, i = 0; i < 6; i++)
                                if (t[i].distanceToPoint(e) < 0)
                                    return !1;
                            return !0
                        }
                    }]) && gr(t.prototype, i),
                    e
                }();
                function br() {
                    var e = null
                      , t = !1
                      , i = null
                      , r = null;
                    function n(t, a) {
                        i(t, a),
                        r = e.requestAnimationFrame(n)
                    }
                    return {
                        start: function() {
                            !0 !== t && null !== i && (r = e.requestAnimationFrame(n),
                            t = !0)
                        },
                        stop: function() {
                            e.cancelAnimationFrame(r),
                            t = !1
                        },
                        setAnimationLoop: function(e) {
                            i = e
                        },
                        setContext: function(t) {
                            e = t
                        }
                    }
                }
                function wr(e, t) {
                    var i = t.isWebGL2
                      , r = new WeakMap;
                    return {
                        get: function(e) {
                            return e.isInterleavedBufferAttribute && (e = e.data),
                            r.get(e)
                        },
                        remove: function(t) {
                            t.isInterleavedBufferAttribute && (t = t.data);
                            var i = r.get(t);
                            i && (e.deleteBuffer(i.buffer),
                            r.delete(t))
                        },
                        update: function(t, n) {
                            if (t.isGLBufferAttribute) {
                                var a = r.get(t);
                                (!a || a.version < t.version) && r.set(t, {
                                    buffer: t.buffer,
                                    type: t.type,
                                    bytesPerElement: t.elementSize,
                                    version: t.version
                                })
                            } else {
                                t.isInterleavedBufferAttribute && (t = t.data);
                                var o = r.get(t);
                                void 0 === o ? r.set(t, function(t, r) {
                                    var n = t.array
                                      , a = t.usage
                                      , o = e.createBuffer();
                                    e.bindBuffer(r, o),
                                    e.bufferData(r, n, a),
                                    t.onUploadCallback();
                                    var s = 5126;
                                    return n instanceof Float32Array ? s = 5126 : n instanceof Float64Array ? console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.") : n instanceof Uint16Array ? t.isFloat16BufferAttribute ? i ? s = 5131 : console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.") : s = 5123 : n instanceof Int16Array ? s = 5122 : n instanceof Uint32Array ? s = 5125 : n instanceof Int32Array ? s = 5124 : n instanceof Int8Array ? s = 5120 : n instanceof Uint8Array && (s = 5121),
                                    {
                                        buffer: o,
                                        type: s,
                                        bytesPerElement: n.BYTES_PER_ELEMENT,
                                        version: t.version
                                    }
                                }(t, n)) : o.version < t.version && (function(t, r, n) {
                                    var a = r.array
                                      , o = r.updateRange;
                                    e.bindBuffer(n, t),
                                    -1 === o.count ? e.bufferSubData(n, 0, a) : (i ? e.bufferSubData(n, o.offset * a.BYTES_PER_ELEMENT, a, o.offset, o.count) : e.bufferSubData(n, o.offset * a.BYTES_PER_ELEMENT, a.subarray(o.offset, o.offset + o.count)),
                                    o.count = -1)
                                }(o.buffer, t, n),
                                o.version = t.version)
                            }
                        }
                    }
                }
                function Sr(e) {
                    return (Sr = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                        return typeof e
                    }
                    : function(e) {
                        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                    }
                    )(e)
                }
                function Mr(e, t) {
                    if (!(e instanceof t))
                        throw new TypeError("Cannot call a class as a function")
                }
                function Tr(e, t) {
                    return (Tr = Object.setPrototypeOf || function(e, t) {
                        return e.__proto__ = t,
                        e
                    }
                    )(e, t)
                }
                function Er(e, t) {
                    return !t || "object" !== Sr(t) && "function" != typeof t ? function(e) {
                        if (void 0 === e)
                            throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return e
                    }(e) : t
                }
                function Ar(e) {
                    return (Ar = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                        return e.__proto__ || Object.getPrototypeOf(e)
                    }
                    )(e)
                }
                var Pr = function(e) {
                    !function(e, t) {
                        if ("function" != typeof t && null !== t)
                            throw new TypeError("Super expression must either be null or a function");
                        e.prototype = Object.create(t && t.prototype, {
                            constructor: {
                                value: e,
                                writable: !0,
                                configurable: !0
                            }
                        }),
                        t && Tr(e, t)
                    }(i, e);
                    var t = function(e) {
                        var t = function() {
                            if ("undefined" == typeof Reflect || !Reflect.construct)
                                return !1;
                            if (Reflect.construct.sham)
                                return !1;
                            if ("function" == typeof Proxy)
                                return !0;
                            try {
                                return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}
                                ))),
                                !0
                            } catch (e) {
                                return !1
                            }
                        }();
                        return function() {
                            var i, r = Ar(e);
                            if (t) {
                                var n = Ar(this).constructor;
                                i = Reflect.construct(r, arguments, n)
                            } else
                                i = r.apply(this, arguments);
                            return Er(this, i)
                        }
                    }(i);
                    function i() {
                        var e, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1, a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1, o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
                        Mr(this, i),
                        (e = t.call(this)).type = "PlaneBufferGeometry",
                        e.parameters = {
                            width: r,
                            height: n,
                            widthSegments: a,
                            heightSegments: o
                        };
                        for (var s = r / 2, l = n / 2, u = Math.floor(a), c = Math.floor(o), h = u + 1, p = c + 1, f = r / u, d = n / c, m = [], v = [], g = [], y = [], _ = 0; _ < p; _++)
                            for (var x = _ * d - l, b = 0; b < h; b++) {
                                var w = b * f - s;
                                v.push(w, -x, 0),
                                g.push(0, 0, 1),
                                y.push(b / u),
                                y.push(1 - _ / c)
                            }
                        for (var S = 0; S < c; S++)
                            for (var M = 0; M < u; M++) {
                                var T = M + h * S
                                  , E = M + h * (S + 1)
                                  , A = M + 1 + h * (S + 1)
                                  , P = M + 1 + h * S;
                                m.push(T, E, P),
                                m.push(E, A, P)
                            }
                        return e.setIndex(m),
                        e.setAttribute("position", new Pt(v,3)),
                        e.setAttribute("normal", new Pt(g,3)),
                        e.setAttribute("uv", new Pt(y,2)),
                        e
                    }
                    return i
                }(jt)
                  , Cr = {
                    alphamap_fragment: "#ifdef USE_ALPHAMAP\ndiffuseColor.a*=texture2D(alphaMap,vUv).g;\n#endif",
                    alphamap_pars_fragment: "#ifdef USE_ALPHAMAP\nuniform sampler2D alphaMap;\n#endif",
                    alphatest_fragment: "#ifdef ALPHATEST\nif(diffuseColor.a<ALPHATEST)discard;\n#endif",
                    aomap_fragment: "#ifdef USE_AOMAP\nfloat ambientOcclusion=(texture2D(aoMap,vUv2).r-1.0)*aoMapIntensity+1.0;reflectedLight.indirectDiffuse*=ambientOcclusion;\n#if defined(USE_ENVMAP)&&defined(STANDARD)\nfloat dotNV=saturate(dot(geometry.normal,geometry.viewDir));reflectedLight.indirectSpecular*=computeSpecularOcclusion(dotNV,ambientOcclusion,material.specularRoughness);\n#endif\n#endif",
                    aomap_pars_fragment: "#ifdef USE_AOMAP\nuniform sampler2D aoMap;uniform float aoMapIntensity;\n#endif",
                    begin_vertex: "vec3 transformed=vec3(position);",
                    beginnormal_vertex: "vec3 objectNormal=vec3(normal);\n#ifdef USE_TANGENT\nvec3 objectTangent=vec3(tangent.xyz);\n#endif",
                    bsdfs: "vec2 integrateSpecularBRDF(const in float dotNV,const in float roughness){const vec4 c0=vec4(-1,-0.0275,-0.572,0.022);const vec4 c1=vec4(1,0.0425,1.04,-0.04);vec4 r=roughness*c0+c1;float a004=min(r.x*r.x,exp2(-9.28*dotNV))*r.x+r.y;return vec2(-1.04,1.04)*a004+r.zw;}float punctualLightIntensityToIrradianceFactor(const in float lightDistance,const in float cutoffDistance,const in float decayExponent){\n#if defined(PHYSICALLY_CORRECT_LIGHTS)\nfloat distanceFalloff=1.0/max(pow(lightDistance,decayExponent),0.01);if(cutoffDistance>0.0){distanceFalloff*=pow2(saturate(1.0-pow4(lightDistance/cutoffDistance)));}return distanceFalloff;\n#else\nif(cutoffDistance>0.0&&decayExponent>0.0){return pow(saturate(-lightDistance/cutoffDistance+1.0),decayExponent);}return 1.0;\n#endif\n}vec3 BRDF_Diffuse_Lambert(const in vec3 diffuseColor){return RECIPROCAL_PI*diffuseColor;}vec3 F_Schlick(const in vec3 specularColor,const in float dotLH){float fresnel=exp2((-5.55473*dotLH-6.98316)*dotLH);return(1.0-specularColor)*fresnel+specularColor;}vec3 F_Schlick_RoughnessDependent(const in vec3 F0,const in float dotNV,const in float roughness){float fresnel=exp2((-5.55473*dotNV-6.98316)*dotNV);vec3 Fr=max(vec3(1.0-roughness),F0)-F0;return Fr*fresnel+F0;}float G_GGX_Smith(const in float alpha,const in float dotNL,const in float dotNV){float a2=pow2(alpha);float gl=dotNL+sqrt(a2+(1.0-a2)*pow2(dotNL));float gv=dotNV+sqrt(a2+(1.0-a2)*pow2(dotNV));return 1.0/(gl*gv);}float G_GGX_SmithCorrelated(const in float alpha,const in float dotNL,const in float dotNV){float a2=pow2(alpha);float gv=dotNL*sqrt(a2+(1.0-a2)*pow2(dotNV));float gl=dotNV*sqrt(a2+(1.0-a2)*pow2(dotNL));return 0.5/max(gv+gl,EPSILON);}float D_GGX(const in float alpha,const in float dotNH){float a2=pow2(alpha);float denom=pow2(dotNH)*(a2-1.0)+1.0;return RECIPROCAL_PI*a2/pow2(denom);}vec3 BRDF_Specular_GGX(const in IncidentLight incidentLight,const in vec3 viewDir,const in vec3 normal,const in vec3 specularColor,const in float roughness){float alpha=pow2(roughness);vec3 halfDir=normalize(incidentLight.direction+viewDir);float dotNL=saturate(dot(normal,incidentLight.direction));float dotNV=saturate(dot(normal,viewDir));float dotNH=saturate(dot(normal,halfDir));float dotLH=saturate(dot(incidentLight.direction,halfDir));vec3 F=F_Schlick(specularColor,dotLH);float G=G_GGX_SmithCorrelated(alpha,dotNL,dotNV);float D=D_GGX(alpha,dotNH);return F*(G*D);}vec2 LTC_Uv(const in vec3 N,const in vec3 V,const in float roughness){const float LUT_SIZE=64.0;const float LUT_SCALE=(LUT_SIZE-1.0)/LUT_SIZE;const float LUT_BIAS=0.5/LUT_SIZE;float dotNV=saturate(dot(N,V));vec2 uv=vec2(roughness,sqrt(1.0-dotNV));uv=uv*LUT_SCALE+LUT_BIAS;return uv;}float LTC_ClippedSphereFormFactor(const in vec3 f){float l=length(f);return max((l*l+f.z)/(l+1.0),0.0);}vec3 LTC_EdgeVectorFormFactor(const in vec3 v1,const in vec3 v2){float x=dot(v1,v2);float y=abs(x);float a=0.8543985+(0.4965155+0.0145206*y)*y;float b=3.4175940+(4.1616724+y)*y;float v=a/b;float theta_sintheta=(x>0.0)?v:0.5*inversesqrt(max(1.0-x*x,1e-7))-v;return cross(v1,v2)*theta_sintheta;}vec3 LTC_Evaluate(const in vec3 N,const in vec3 V,const in vec3 P,const in mat3 mInv,const in vec3 rectCoords[4]){vec3 v1=rectCoords[1]-rectCoords[0];vec3 v2=rectCoords[3]-rectCoords[0];vec3 lightNormal=cross(v1,v2);if(dot(lightNormal,P-rectCoords[0])<0.0)return vec3(0.0);vec3 T1,T2;T1=normalize(V-N*dot(V,N));T2=-cross(N,T1);mat3 mat=mInv*transposeMat3(mat3(T1,T2,N));vec3 coords[4];coords[0]=mat*(rectCoords[0]-P);coords[1]=mat*(rectCoords[1]-P);coords[2]=mat*(rectCoords[2]-P);coords[3]=mat*(rectCoords[3]-P);coords[0]=normalize(coords[0]);coords[1]=normalize(coords[1]);coords[2]=normalize(coords[2]);coords[3]=normalize(coords[3]);vec3 vectorFormFactor=vec3(0.0);vectorFormFactor+=LTC_EdgeVectorFormFactor(coords[0],coords[1]);vectorFormFactor+=LTC_EdgeVectorFormFactor(coords[1],coords[2]);vectorFormFactor+=LTC_EdgeVectorFormFactor(coords[2],coords[3]);vectorFormFactor+=LTC_EdgeVectorFormFactor(coords[3],coords[0]);float result=LTC_ClippedSphereFormFactor(vectorFormFactor);return vec3(result);}vec3 BRDF_Specular_GGX_Environment(const in vec3 viewDir,const in vec3 normal,const in vec3 specularColor,const in float roughness){float dotNV=saturate(dot(normal,viewDir));vec2 brdf=integrateSpecularBRDF(dotNV,roughness);return specularColor*brdf.x+brdf.y;}void BRDF_Specular_Multiscattering_Environment(const in GeometricContext geometry,const in vec3 specularColor,const in float roughness,inout vec3 singleScatter,inout vec3 multiScatter){float dotNV=saturate(dot(geometry.normal,geometry.viewDir));vec3 F=F_Schlick_RoughnessDependent(specularColor,dotNV,roughness);vec2 brdf=integrateSpecularBRDF(dotNV,roughness);vec3 FssEss=F*brdf.x+brdf.y;float Ess=brdf.x+brdf.y;float Ems=1.0-Ess;vec3 Favg=specularColor+(1.0-specularColor)*0.047619;vec3 Fms=FssEss*Favg/(1.0-Ems*Favg);singleScatter+=FssEss;multiScatter+=Fms*Ems;}float G_BlinnPhong_Implicit(){return 0.25;}float D_BlinnPhong(const in float shininess,const in float dotNH){return RECIPROCAL_PI*(shininess*0.5+1.0)*pow(dotNH,shininess);}vec3 BRDF_Specular_BlinnPhong(const in IncidentLight incidentLight,const in GeometricContext geometry,const in vec3 specularColor,const in float shininess){vec3 halfDir=normalize(incidentLight.direction+geometry.viewDir);float dotNH=saturate(dot(geometry.normal,halfDir));float dotLH=saturate(dot(incidentLight.direction,halfDir));vec3 F=F_Schlick(specularColor,dotLH);float G=G_BlinnPhong_Implicit();float D=D_BlinnPhong(shininess,dotNH);return F*(G*D);}float GGXRoughnessToBlinnExponent(const in float ggxRoughness){return(2.0/pow2(ggxRoughness+0.0001)-2.0);}float BlinnExponentToGGXRoughness(const in float blinnExponent){return sqrt(2.0/(blinnExponent+2.0));}\n#if defined(USE_SHEEN)\nfloat D_Charlie(float roughness,float NoH){float invAlpha=1.0/roughness;float cos2h=NoH*NoH;float sin2h=max(1.0-cos2h,0.0078125);return(2.0+invAlpha)*pow(sin2h,invAlpha*0.5)/(2.0*PI);}float V_Neubelt(float NoV,float NoL){return saturate(1.0/(4.0*(NoL+NoV-NoL*NoV)));}vec3 BRDF_Specular_Sheen(const in float roughness,const in vec3 L,const in GeometricContext geometry,vec3 specularColor){vec3 N=geometry.normal;vec3 V=geometry.viewDir;vec3 H=normalize(V+L);float dotNH=saturate(dot(N,H));return specularColor*D_Charlie(roughness,dotNH)*V_Neubelt(dot(N,V),dot(N,L));}\n#endif",
                    bumpmap_pars_fragment: "#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;uniform float bumpScale;vec2 dHdxy_fwd(){vec2 dSTdx=dFdx(vUv);vec2 dSTdy=dFdy(vUv);float Hll=bumpScale*texture2D(bumpMap,vUv).x;float dBx=bumpScale*texture2D(bumpMap,vUv+dSTdx).x-Hll;float dBy=bumpScale*texture2D(bumpMap,vUv+dSTdy).x-Hll;return vec2(dBx,dBy);}vec3 perturbNormalArb(vec3 surf_pos,vec3 surf_norm,vec2 dHdxy){vec3 vSigmaX=vec3(dFdx(surf_pos.x),dFdx(surf_pos.y),dFdx(surf_pos.z));vec3 vSigmaY=vec3(dFdy(surf_pos.x),dFdy(surf_pos.y),dFdy(surf_pos.z));vec3 vN=surf_norm;vec3 R1=cross(vSigmaY,vN);vec3 R2=cross(vN,vSigmaX);float fDet=dot(vSigmaX,R1);fDet*=(float(gl_FrontFacing)*2.0-1.0);vec3 vGrad=sign(fDet)*(dHdxy.x*R1+dHdxy.y*R2);return normalize(abs(fDet)*surf_norm-vGrad);}\n#endif",
                    clipping_planes_fragment: "#if NUM_CLIPPING_PLANES>0\nvec4 plane;\n#pragma unroll_loop_start\nfor(int i=0;i<UNION_CLIPPING_PLANES;i++){plane=clippingPlanes[i];if(dot(vClipPosition,plane.xyz)>plane.w)discard;}\n#pragma unroll_loop_end\n#if UNION_CLIPPING_PLANES<NUM_CLIPPING_PLANES\nbool clipped=true;\n#pragma unroll_loop_start\nfor(int i=UNION_CLIPPING_PLANES;i<NUM_CLIPPING_PLANES;i++){plane=clippingPlanes[i];clipped=(dot(vClipPosition,plane.xyz)>plane.w)&&clipped;}\n#pragma unroll_loop_end\nif(clipped)discard;\n#endif\n#endif",
                    clipping_planes_pars_fragment: "#if NUM_CLIPPING_PLANES>0\nvarying vec3 vClipPosition;uniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif",
                    clipping_planes_pars_vertex: "#if NUM_CLIPPING_PLANES>0\nvarying vec3 vClipPosition;\n#endif",
                    clipping_planes_vertex: "#if NUM_CLIPPING_PLANES>0\nvClipPosition=-mvPosition.xyz;\n#endif",
                    color_fragment: "#ifdef USE_COLOR\ndiffuseColor.rgb*=vColor;\n#endif",
                    color_pars_fragment: "#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",
                    color_pars_vertex: "#if defined(USE_COLOR)||defined(USE_INSTANCING_COLOR)\nvarying vec3 vColor;\n#endif",
                    color_vertex: "#if defined(USE_COLOR)||defined(USE_INSTANCING_COLOR)\nvColor=vec3(1.0);\n#endif\n#ifdef USE_COLOR\nvColor.xyz*=color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\nvColor.xyz*=instanceColor.xyz;\n#endif",
                    common: "#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a)clamp(a,0.0,1.0)\n#endif\n#define whiteComplement(a)(1.0-saturate(a))\nfloat pow2(const in float x){return x*x;}float pow3(const in float x){return x*x*x;}float pow4(const in float x){float x2=x*x;return x2*x2;}float average(const in vec3 color){return dot(color,vec3(0.3333));}highp float rand(const in vec2 uv){const highp float a=12.9898,b=78.233,c=43758.5453;highp float dt=dot(uv.xy,vec2(a,b)),sn=mod(dt,PI);return fract(sin(sn)*c);}\n#ifdef HIGH_PRECISION\nfloat precisionSafeLength(vec3 v){return length(v);}\n#else\nfloat max3(vec3 v){return max(max(v.x,v.y),v.z);}float precisionSafeLength(vec3 v){float maxComponent=max3(abs(v));return length(v/maxComponent)*maxComponent;}\n#endif\nstruct IncidentLight{vec3 color;vec3 direction;bool visible;};struct ReflectedLight{vec3 directDiffuse;vec3 directSpecular;vec3 indirectDiffuse;vec3 indirectSpecular;};struct GeometricContext{vec3 position;vec3 normal;vec3 viewDir;\n#ifdef CLEARCOAT\nvec3 clearcoatNormal;\n#endif\n};vec3 transformDirection(in vec3 dir,in mat4 matrix){return normalize((matrix*vec4(dir,0.0)).xyz);}vec3 inverseTransformDirection(in vec3 dir,in mat4 matrix){return normalize((vec4(dir,0.0)*matrix).xyz);}vec3 projectOnPlane(in vec3 point,in vec3 pointOnPlane,in vec3 planeNormal){float distance=dot(planeNormal,point-pointOnPlane);return-distance*planeNormal+point;}float sideOfPlane(in vec3 point,in vec3 pointOnPlane,in vec3 planeNormal){return sign(dot(point-pointOnPlane,planeNormal));}vec3 linePlaneIntersect(in vec3 pointOnLine,in vec3 lineDirection,in vec3 pointOnPlane,in vec3 planeNormal){return lineDirection*(dot(planeNormal,pointOnPlane-pointOnLine)/dot(planeNormal,lineDirection))+pointOnLine;}mat3 transposeMat3(const in mat3 m){mat3 tmp;tmp[0]=vec3(m[0].x,m[1].x,m[2].x);tmp[1]=vec3(m[0].y,m[1].y,m[2].y);tmp[2]=vec3(m[0].z,m[1].z,m[2].z);return tmp;}float linearToRelativeLuminance(const in vec3 color){vec3 weights=vec3(0.2126,0.7152,0.0722);return dot(weights,color.rgb);}bool isPerspectiveMatrix(mat4 m){return m[2][3]==-1.0;}vec2 equirectUv(in vec3 dir){float u=atan(dir.z,dir.x)*RECIPROCAL_PI2+0.5;float v=asin(clamp(dir.y,-1.0,1.0))*RECIPROCAL_PI+0.5;return vec2(u,v);}",
                    cube_uv_reflection_fragment: "#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction){vec3 absDirection=abs(direction);float face=-1.0;if(absDirection.x>absDirection.z){if(absDirection.x>absDirection.y)face=direction.x>0.0?0.0:3.0;else face=direction.y>0.0?1.0:4.0;}else{if(absDirection.z>absDirection.y)face=direction.z>0.0?2.0:5.0;else face=direction.y>0.0?1.0:4.0;}return face;}vec2 getUV(vec3 direction,float face){vec2 uv;if(face==0.0){uv=vec2(direction.z,direction.y)/abs(direction.x);}else if(face==1.0){uv=vec2(-direction.x,-direction.z)/abs(direction.y);}else if(face==2.0){uv=vec2(-direction.x,direction.y)/abs(direction.z);}else if(face==3.0){uv=vec2(-direction.z,direction.y)/abs(direction.x);}else if(face==4.0){uv=vec2(-direction.x,direction.z)/abs(direction.y);}else{uv=vec2(direction.x,direction.y)/abs(direction.z);}return 0.5*(uv+1.0);}vec3 bilinearCubeUV(sampler2D envMap,vec3 direction,float mipInt){float face=getFace(direction);float filterInt=max(cubeUV_minMipLevel-mipInt,0.0);mipInt=max(mipInt,cubeUV_minMipLevel);float faceSize=exp2(mipInt);float texelSize=1.0/(3.0*cubeUV_maxTileSize);vec2 uv=getUV(direction,face)*(faceSize-1.0);vec2 f=fract(uv);uv+=0.5-f;if(face>2.0){uv.y+=faceSize;face-=3.0;}uv.x+=face*faceSize;if(mipInt<cubeUV_maxMipLevel){uv.y+=2.0*cubeUV_maxTileSize;}uv.y+=filterInt*2.0*cubeUV_minTileSize;uv.x+=3.0*max(0.0,cubeUV_maxTileSize-2.0*faceSize);uv*=texelSize;vec3 tl=envMapTexelToLinear(texture2D(envMap,uv)).rgb;uv.x+=texelSize;vec3 tr=envMapTexelToLinear(texture2D(envMap,uv)).rgb;uv.y+=texelSize;vec3 br=envMapTexelToLinear(texture2D(envMap,uv)).rgb;uv.x-=texelSize;vec3 bl=envMapTexelToLinear(texture2D(envMap,uv)).rgb;vec3 tm=mix(tl,tr,f.x);vec3 bm=mix(bl,br,f.x);return mix(tm,bm,f.y);}\n#define r0 1.0\n#define v0 0.339\n#define m0-2.0\n#define r1 0.8\n#define v1 0.276\n#define m1-1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness){float mip=0.0;if(roughness>=r1){mip=(r0-roughness)*(m1-m0)/(r0-r1)+m0;}else if(roughness>=r4){mip=(r1-roughness)*(m4-m1)/(r1-r4)+m1;}else if(roughness>=r5){mip=(r4-roughness)*(m5-m4)/(r4-r5)+m4;}else if(roughness>=r6){mip=(r5-roughness)*(m6-m5)/(r5-r6)+m5;}else{mip=-2.0*log2(1.16*roughness);}return mip;}vec4 textureCubeUV(sampler2D envMap,vec3 sampleDir,float roughness){float mip=clamp(roughnessToMip(roughness),m0,cubeUV_maxMipLevel);float mipF=fract(mip);float mipInt=floor(mip);vec3 color0=bilinearCubeUV(envMap,sampleDir,mipInt);if(mipF==0.0){return vec4(color0,1.0);}else{vec3 color1=bilinearCubeUV(envMap,sampleDir,mipInt+1.0);return vec4(mix(color0,color1,mipF),1.0);}}\n#endif",
                    defaultnormal_vertex: "vec3 transformedNormal=objectNormal;\n#ifdef USE_INSTANCING\nmat3 m=mat3(instanceMatrix);transformedNormal/=vec3(dot(m[0],m[0]),dot(m[1],m[1]),dot(m[2],m[2]));transformedNormal=m*transformedNormal;\n#endif\ntransformedNormal=normalMatrix*transformedNormal;\n#ifdef FLIP_SIDED\ntransformedNormal=-transformedNormal;\n#endif\n#ifdef USE_TANGENT\nvec3 transformedTangent=(modelViewMatrix*vec4(objectTangent,0.0)).xyz;\n#ifdef FLIP_SIDED\ntransformedTangent=-transformedTangent;\n#endif\n#endif",
                    displacementmap_pars_vertex: "#ifdef USE_DISPLACEMENTMAP\nuniform sampler2D displacementMap;uniform float displacementScale;uniform float displacementBias;\n#endif",
                    displacementmap_vertex: "#ifdef USE_DISPLACEMENTMAP\ntransformed+=normalize(objectNormal)*(texture2D(displacementMap,vUv).x*displacementScale+displacementBias);\n#endif",
                    emissivemap_fragment: "#ifdef USE_EMISSIVEMAP\nvec4 emissiveColor=texture2D(emissiveMap,vUv);emissiveColor.rgb=emissiveMapTexelToLinear(emissiveColor).rgb;totalEmissiveRadiance*=emissiveColor.rgb;\n#endif",
                    emissivemap_pars_fragment: "#ifdef USE_EMISSIVEMAP\nuniform sampler2D emissiveMap;\n#endif",
                    encodings_fragment: "gl_FragColor=linearToOutputTexel(gl_FragColor);",
                    encodings_pars_fragment: "vec4 LinearToLinear(in vec4 value){return value;}vec4 GammaToLinear(in vec4 value,in float gammaFactor){return vec4(pow(value.rgb,vec3(gammaFactor)),value.a);}vec4 LinearToGamma(in vec4 value,in float gammaFactor){return vec4(pow(value.rgb,vec3(1.0/gammaFactor)),value.a);}vec4 sRGBToLinear(in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}vec4 LinearTosRGB(in vec4 value){return vec4(mix(pow(value.rgb,vec3(0.41666))*1.055-vec3(0.055),value.rgb*12.92,vec3(lessThanEqual(value.rgb,vec3(0.0031308)))),value.a);}vec4 RGBEToLinear(in vec4 value){return vec4(value.rgb*exp2(value.a*255.0-128.0),1.0);}vec4 LinearToRGBE(in vec4 value){float maxComponent=max(max(value.r,value.g),value.b);float fExp=clamp(ceil(log2(maxComponent)),-128.0,127.0);return vec4(value.rgb/exp2(fExp),(fExp+128.0)/255.0);}vec4 RGBMToLinear(in vec4 value,in float maxRange){return vec4(value.rgb*value.a*maxRange,1.0);}vec4 LinearToRGBM(in vec4 value,in float maxRange){float maxRGB=max(value.r,max(value.g,value.b));float M=clamp(maxRGB/maxRange,0.0,1.0);M=ceil(M*255.0)/255.0;return vec4(value.rgb/(M*maxRange),M);}vec4 RGBDToLinear(in vec4 value,in float maxRange){return vec4(value.rgb*((maxRange/255.0)/value.a),1.0);}vec4 LinearToRGBD(in vec4 value,in float maxRange){float maxRGB=max(value.r,max(value.g,value.b));float D=max(maxRange/maxRGB,1.0);D=clamp(floor(D)/255.0,0.0,1.0);return vec4(value.rgb*(D*(255.0/maxRange)),D);}const mat3 cLogLuvM=mat3(0.2209,0.3390,0.4184,0.1138,0.6780,0.7319,0.0102,0.1130,0.2969);vec4 LinearToLogLuv(in vec4 value){vec3 Xp_Y_XYZp=cLogLuvM*value.rgb;Xp_Y_XYZp=max(Xp_Y_XYZp,vec3(1e-6,1e-6,1e-6));vec4 vResult;vResult.xy=Xp_Y_XYZp.xy/Xp_Y_XYZp.z;float Le=2.0*log2(Xp_Y_XYZp.y)+127.0;vResult.w=fract(Le);vResult.z=(Le-(floor(vResult.w*255.0))/255.0)/255.0;return vResult;}const mat3 cLogLuvInverseM=mat3(6.0014,-2.7008,-1.7996,-1.3320,3.1029,-5.7721,0.3008,-1.0882,5.6268);vec4 LogLuvToLinear(in vec4 value){float Le=value.z*255.0+value.w;vec3 Xp_Y_XYZp;Xp_Y_XYZp.y=exp2((Le-127.0)/2.0);Xp_Y_XYZp.z=Xp_Y_XYZp.y/value.y;Xp_Y_XYZp.x=value.x*Xp_Y_XYZp.z;vec3 vRGB=cLogLuvInverseM*Xp_Y_XYZp.rgb;return vec4(max(vRGB,0.0),1.0);}",
                    envmap_fragment: "#ifdef USE_ENVMAP\n#ifdef ENV_WORLDPOS\nvec3 cameraToFrag;if(isOrthographic){cameraToFrag=normalize(vec3(-viewMatrix[0][2],-viewMatrix[1][2],-viewMatrix[2][2]));}else{cameraToFrag=normalize(vWorldPosition-cameraPosition);}vec3 worldNormal=inverseTransformDirection(normal,viewMatrix);\n#ifdef ENVMAP_MODE_REFLECTION\nvec3 reflectVec=reflect(cameraToFrag,worldNormal);\n#else\nvec3 reflectVec=refract(cameraToFrag,worldNormal,refractionRatio);\n#endif\n#else\nvec3 reflectVec=vReflect;\n#endif\n#ifdef ENVMAP_TYPE_CUBE\nvec4 envColor=textureCube(envMap,vec3(flipEnvMap*reflectVec.x,reflectVec.yz));\n#elif defined(ENVMAP_TYPE_CUBE_UV)\nvec4 envColor=textureCubeUV(envMap,reflectVec,0.0);\n#else\nvec4 envColor=vec4(0.0);\n#endif\n#ifndef ENVMAP_TYPE_CUBE_UV\nenvColor=envMapTexelToLinear(envColor);\n#endif\n#ifdef ENVMAP_BLENDING_MULTIPLY\noutgoingLight=mix(outgoingLight,outgoingLight*envColor.xyz,specularStrength*reflectivity);\n#elif defined(ENVMAP_BLENDING_MIX)\noutgoingLight=mix(outgoingLight,envColor.xyz,specularStrength*reflectivity);\n#elif defined(ENVMAP_BLENDING_ADD)\noutgoingLight+=envColor.xyz*specularStrength*reflectivity;\n#endif\n#endif",
                    envmap_common_pars_fragment: "#ifdef USE_ENVMAP\nuniform float envMapIntensity;uniform float flipEnvMap;uniform int maxMipLevel;\n#ifdef ENVMAP_TYPE_CUBE\nuniform samplerCube envMap;\n#else\nuniform sampler2D envMap;\n#endif\n#endif",
                    envmap_pars_fragment: "#ifdef USE_ENVMAP\nuniform float reflectivity;\n#if defined(USE_BUMPMAP)||defined(USE_NORMALMAP)||defined(PHONG)\n#define ENV_WORLDPOS\n#endif\n#ifdef ENV_WORLDPOS\nvarying vec3 vWorldPosition;uniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",
                    envmap_pars_vertex: "#ifdef USE_ENVMAP\n#if defined(USE_BUMPMAP)||defined(USE_NORMALMAP)||defined(PHONG)\n#define ENV_WORLDPOS\n#endif\n#ifdef ENV_WORLDPOS\nvarying vec3 vWorldPosition;\n#else\nvarying vec3 vReflect;uniform float refractionRatio;\n#endif\n#endif",
                    envmap_physical_pars_fragment: "#if defined(USE_ENVMAP)\n#ifdef ENVMAP_MODE_REFRACTION\nuniform float refractionRatio;\n#endif\nvec3 getLightProbeIndirectIrradiance(const in GeometricContext geometry,const in int maxMIPLevel){vec3 worldNormal=inverseTransformDirection(geometry.normal,viewMatrix);\n#ifdef ENVMAP_TYPE_CUBE\nvec3 queryVec=vec3(flipEnvMap*worldNormal.x,worldNormal.yz);\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor=textureCubeLodEXT(envMap,queryVec,float(maxMIPLevel));\n#else\nvec4 envMapColor=textureCube(envMap,queryVec,float(maxMIPLevel));\n#endif\nenvMapColor.rgb=envMapTexelToLinear(envMapColor).rgb;\n#elif defined(ENVMAP_TYPE_CUBE_UV)\nvec4 envMapColor=textureCubeUV(envMap,worldNormal,1.0);\n#else\nvec4 envMapColor=vec4(0.0);\n#endif\nreturn PI*envMapColor.rgb*envMapIntensity;}float getSpecularMIPLevel(const in float roughness,const in int maxMIPLevel){float maxMIPLevelScalar=float(maxMIPLevel);float sigma=PI*roughness*roughness/(1.0+roughness);float desiredMIPLevel=maxMIPLevelScalar+log2(sigma);return clamp(desiredMIPLevel,0.0,maxMIPLevelScalar);}vec3 getLightProbeIndirectRadiance(const in vec3 viewDir,const in vec3 normal,const in float roughness,const in int maxMIPLevel){\n#ifdef ENVMAP_MODE_REFLECTION\nvec3 reflectVec=reflect(-viewDir,normal);reflectVec=normalize(mix(reflectVec,normal,roughness*roughness));\n#else\nvec3 reflectVec=refract(-viewDir,normal,refractionRatio);\n#endif\nreflectVec=inverseTransformDirection(reflectVec,viewMatrix);float specularMIPLevel=getSpecularMIPLevel(roughness,maxMIPLevel);\n#ifdef ENVMAP_TYPE_CUBE\nvec3 queryReflectVec=vec3(flipEnvMap*reflectVec.x,reflectVec.yz);\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor=textureCubeLodEXT(envMap,queryReflectVec,specularMIPLevel);\n#else\nvec4 envMapColor=textureCube(envMap,queryReflectVec,specularMIPLevel);\n#endif\nenvMapColor.rgb=envMapTexelToLinear(envMapColor).rgb;\n#elif defined(ENVMAP_TYPE_CUBE_UV)\nvec4 envMapColor=textureCubeUV(envMap,reflectVec,roughness);\n#endif\nreturn envMapColor.rgb*envMapIntensity;}\n#endif",
                    envmap_vertex: "#ifdef USE_ENVMAP\n#ifdef ENV_WORLDPOS\nvWorldPosition=worldPosition.xyz;\n#else\nvec3 cameraToVertex;if(isOrthographic){cameraToVertex=normalize(vec3(-viewMatrix[0][2],-viewMatrix[1][2],-viewMatrix[2][2]));}else{cameraToVertex=normalize(worldPosition.xyz-cameraPosition);}vec3 worldNormal=inverseTransformDirection(transformedNormal,viewMatrix);\n#ifdef ENVMAP_MODE_REFLECTION\nvReflect=reflect(cameraToVertex,worldNormal);\n#else\nvReflect=refract(cameraToVertex,worldNormal,refractionRatio);\n#endif\n#endif\n#endif",
                    fog_vertex: "#ifdef USE_FOG\nfogDepth=-mvPosition.z;\n#endif",
                    fog_pars_vertex: "#ifdef USE_FOG\nvarying float fogDepth;\n#endif",
                    fog_fragment: "#ifdef USE_FOG\n#ifdef FOG_EXP2\nfloat fogFactor=1.0-exp(-fogDensity*fogDensity*fogDepth*fogDepth);\n#else\nfloat fogFactor=smoothstep(fogNear,fogFar,fogDepth);\n#endif\ngl_FragColor.rgb=mix(gl_FragColor.rgb,fogColor,fogFactor);\n#endif",
                    fog_pars_fragment: "#ifdef USE_FOG\nuniform vec3 fogColor;varying float fogDepth;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;uniform float fogFar;\n#endif\n#endif",
                    gradientmap_pars_fragment: "#ifdef USE_GRADIENTMAP\nuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance(vec3 normal,vec3 lightDirection){float dotNL=dot(normal,lightDirection);vec2 coord=vec2(dotNL*0.5+0.5,0.0);\n#ifdef USE_GRADIENTMAP\nreturn texture2D(gradientMap,coord).rgb;\n#else\nreturn(coord.x<0.7)?vec3(0.7):vec3(1.0);\n#endif\n}",
                    lightmap_fragment: "#ifdef USE_LIGHTMAP\nvec4 lightMapTexel=texture2D(lightMap,vUv2);reflectedLight.indirectDiffuse+=PI*lightMapTexelToLinear(lightMapTexel).rgb*lightMapIntensity;\n#endif",
                    lightmap_pars_fragment: "#ifdef USE_LIGHTMAP\nuniform sampler2D lightMap;uniform float lightMapIntensity;\n#endif",
                    lights_lambert_vertex: "vec3 diffuse=vec3(1.0);GeometricContext geometry;geometry.position=mvPosition.xyz;geometry.normal=normalize(transformedNormal);geometry.viewDir=(isOrthographic)?vec3(0,0,1):normalize(-mvPosition.xyz);GeometricContext backGeometry;backGeometry.position=geometry.position;backGeometry.normal=-geometry.normal;backGeometry.viewDir=geometry.viewDir;vLightFront=vec3(0.0);vIndirectFront=vec3(0.0);\n#ifdef DOUBLE_SIDED\nvLightBack=vec3(0.0);vIndirectBack=vec3(0.0);\n#endif\nIncidentLight directLight;float dotNL;vec3 directLightColor_Diffuse;vIndirectFront+=getAmbientLightIrradiance(ambientLightColor);vIndirectFront+=getLightProbeIrradiance(lightProbe,geometry);\n#ifdef DOUBLE_SIDED\nvIndirectBack+=getAmbientLightIrradiance(ambientLightColor);vIndirectBack+=getLightProbeIrradiance(lightProbe,backGeometry);\n#endif\n#if NUM_POINT_LIGHTS>0\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_POINT_LIGHTS;i++){getPointDirectLightIrradiance(pointLights[i],geometry,directLight);dotNL=dot(geometry.normal,directLight.direction);directLightColor_Diffuse=PI*directLight.color;vLightFront+=saturate(dotNL)*directLightColor_Diffuse;\n#ifdef DOUBLE_SIDED\nvLightBack+=saturate(-dotNL)*directLightColor_Diffuse;\n#endif\n}\n#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS>0\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_SPOT_LIGHTS;i++){getSpotDirectLightIrradiance(spotLights[i],geometry,directLight);dotNL=dot(geometry.normal,directLight.direction);directLightColor_Diffuse=PI*directLight.color;vLightFront+=saturate(dotNL)*directLightColor_Diffuse;\n#ifdef DOUBLE_SIDED\nvLightBack+=saturate(-dotNL)*directLightColor_Diffuse;\n#endif\n}\n#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS>0\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_DIR_LIGHTS;i++){getDirectionalDirectLightIrradiance(directionalLights[i],geometry,directLight);dotNL=dot(geometry.normal,directLight.direction);directLightColor_Diffuse=PI*directLight.color;vLightFront+=saturate(dotNL)*directLightColor_Diffuse;\n#ifdef DOUBLE_SIDED\nvLightBack+=saturate(-dotNL)*directLightColor_Diffuse;\n#endif\n}\n#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS>0\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_HEMI_LIGHTS;i++){vIndirectFront+=getHemisphereLightIrradiance(hemisphereLights[i],geometry);\n#ifdef DOUBLE_SIDED\nvIndirectBack+=getHemisphereLightIrradiance(hemisphereLights[i],backGeometry);\n#endif\n}\n#pragma unroll_loop_end\n#endif",
                    lights_pars_begin: "uniform bool receiveShadow;uniform vec3 ambientLightColor;uniform vec3 lightProbe[9];vec3 shGetIrradianceAt(in vec3 normal,in vec3 shCoefficients[9]){float x=normal.x,y=normal.y,z=normal.z;vec3 result=shCoefficients[0]*0.886227;result+=shCoefficients[1]*2.0*0.511664*y;result+=shCoefficients[2]*2.0*0.511664*z;result+=shCoefficients[3]*2.0*0.511664*x;result+=shCoefficients[4]*2.0*0.429043*x*y;result+=shCoefficients[5]*2.0*0.429043*y*z;result+=shCoefficients[6]*(0.743125*z*z-0.247708);result+=shCoefficients[7]*2.0*0.429043*x*z;result+=shCoefficients[8]*0.429043*(x*x-y*y);return result;}vec3 getLightProbeIrradiance(const in vec3 lightProbe[9],const in GeometricContext geometry){vec3 worldNormal=inverseTransformDirection(geometry.normal,viewMatrix);vec3 irradiance=shGetIrradianceAt(worldNormal,lightProbe);return irradiance;}vec3 getAmbientLightIrradiance(const in vec3 ambientLightColor){vec3 irradiance=ambientLightColor;\n#ifndef PHYSICALLY_CORRECT_LIGHTS\nirradiance*=PI;\n#endif\nreturn irradiance;}\n#if NUM_DIR_LIGHTS>0\nstruct DirectionalLight{vec3 direction;vec3 color;};uniform DirectionalLight directionalLights[NUM_DIR_LIGHTS];void getDirectionalDirectLightIrradiance(const in DirectionalLight directionalLight,const in GeometricContext geometry,out IncidentLight directLight){directLight.color=directionalLight.color;directLight.direction=directionalLight.direction;directLight.visible=true;}\n#endif\n#if NUM_POINT_LIGHTS>0\nstruct PointLight{vec3 position;vec3 color;float distance;float decay;};uniform PointLight pointLights[NUM_POINT_LIGHTS];void getPointDirectLightIrradiance(const in PointLight pointLight,const in GeometricContext geometry,out IncidentLight directLight){vec3 lVector=pointLight.position-geometry.position;directLight.direction=normalize(lVector);float lightDistance=length(lVector);directLight.color=pointLight.color;directLight.color*=punctualLightIntensityToIrradianceFactor(lightDistance,pointLight.distance,pointLight.decay);directLight.visible=(directLight.color!=vec3(0.0));}\n#endif\n#if NUM_SPOT_LIGHTS>0\nstruct SpotLight{vec3 position;vec3 direction;vec3 color;float distance;float decay;float coneCos;float penumbraCos;};uniform SpotLight spotLights[NUM_SPOT_LIGHTS];void getSpotDirectLightIrradiance(const in SpotLight spotLight,const in GeometricContext geometry,out IncidentLight directLight){vec3 lVector=spotLight.position-geometry.position;directLight.direction=normalize(lVector);float lightDistance=length(lVector);float angleCos=dot(directLight.direction,spotLight.direction);if(angleCos>spotLight.coneCos){float spotEffect=smoothstep(spotLight.coneCos,spotLight.penumbraCos,angleCos);directLight.color=spotLight.color;directLight.color*=spotEffect*punctualLightIntensityToIrradianceFactor(lightDistance,spotLight.distance,spotLight.decay);directLight.visible=true;}else{directLight.color=vec3(0.0);directLight.visible=false;}}\n#endif\n#if NUM_RECT_AREA_LIGHTS>0\nstruct RectAreaLight{vec3 color;vec3 position;vec3 halfWidth;vec3 halfHeight;};uniform sampler2D ltc_1;uniform sampler2D ltc_2;uniform RectAreaLight rectAreaLights[NUM_RECT_AREA_LIGHTS];\n#endif\n#if NUM_HEMI_LIGHTS>0\nstruct HemisphereLight{vec3 direction;vec3 skyColor;vec3 groundColor;};uniform HemisphereLight hemisphereLights[NUM_HEMI_LIGHTS];vec3 getHemisphereLightIrradiance(const in HemisphereLight hemiLight,const in GeometricContext geometry){float dotNL=dot(geometry.normal,hemiLight.direction);float hemiDiffuseWeight=0.5*dotNL+0.5;vec3 irradiance=mix(hemiLight.groundColor,hemiLight.skyColor,hemiDiffuseWeight);\n#ifndef PHYSICALLY_CORRECT_LIGHTS\nirradiance*=PI;\n#endif\nreturn irradiance;}\n#endif",
                    lights_toon_fragment: "ToonMaterial material;material.diffuseColor=diffuseColor.rgb;",
                    lights_toon_pars_fragment: "varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\nstruct ToonMaterial{vec3 diffuseColor;};void RE_Direct_Toon(const in IncidentLight directLight,const in GeometricContext geometry,const in ToonMaterial material,inout ReflectedLight reflectedLight){vec3 irradiance=getGradientIrradiance(geometry.normal,directLight.direction)*directLight.color;\n#ifndef PHYSICALLY_CORRECT_LIGHTS\nirradiance*=PI;\n#endif\nreflectedLight.directDiffuse+=irradiance*BRDF_Diffuse_Lambert(material.diffuseColor);}void RE_IndirectDiffuse_Toon(const in vec3 irradiance,const in GeometricContext geometry,const in ToonMaterial material,inout ReflectedLight reflectedLight){reflectedLight.indirectDiffuse+=irradiance*BRDF_Diffuse_Lambert(material.diffuseColor);}\n#define RE_Direct RE_Direct_Toon\n#define RE_IndirectDiffuse RE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD(material)(0)",
                    lights_phong_fragment: "BlinnPhongMaterial material;material.diffuseColor=diffuseColor.rgb;material.specularColor=specular;material.specularShininess=shininess;material.specularStrength=specularStrength;",
                    lights_phong_pars_fragment: "varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial{vec3 diffuseColor;vec3 specularColor;float specularShininess;float specularStrength;};void RE_Direct_BlinnPhong(const in IncidentLight directLight,const in GeometricContext geometry,const in BlinnPhongMaterial material,inout ReflectedLight reflectedLight){float dotNL=saturate(dot(geometry.normal,directLight.direction));vec3 irradiance=dotNL*directLight.color;\n#ifndef PHYSICALLY_CORRECT_LIGHTS\nirradiance*=PI;\n#endif\nreflectedLight.directDiffuse+=irradiance*BRDF_Diffuse_Lambert(material.diffuseColor);reflectedLight.directSpecular+=irradiance*BRDF_Specular_BlinnPhong(directLight,geometry,material.specularColor,material.specularShininess)*material.specularStrength;}void RE_IndirectDiffuse_BlinnPhong(const in vec3 irradiance,const in GeometricContext geometry,const in BlinnPhongMaterial material,inout ReflectedLight reflectedLight){reflectedLight.indirectDiffuse+=irradiance*BRDF_Diffuse_Lambert(material.diffuseColor);}\n#define RE_Direct RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse RE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD(material)(0)",
                    lights_physical_fragment: "PhysicalMaterial material;material.diffuseColor=diffuseColor.rgb*(1.0-metalnessFactor);vec3 dxy=max(abs(dFdx(geometryNormal)),abs(dFdy(geometryNormal)));float geometryRoughness=max(max(dxy.x,dxy.y),dxy.z);material.specularRoughness=max(roughnessFactor,0.0525);material.specularRoughness+=geometryRoughness;material.specularRoughness=min(material.specularRoughness,1.0);\n#ifdef REFLECTIVITY\nmaterial.specularColor=mix(vec3(MAXIMUM_SPECULAR_COEFFICIENT*pow2(reflectivity)),diffuseColor.rgb,metalnessFactor);\n#else\nmaterial.specularColor=mix(vec3(DEFAULT_SPECULAR_COEFFICIENT),diffuseColor.rgb,metalnessFactor);\n#endif\n#ifdef CLEARCOAT\nmaterial.clearcoat=clearcoat;material.clearcoatRoughness=clearcoatRoughness;\n#ifdef USE_CLEARCOATMAP\nmaterial.clearcoat*=texture2D(clearcoatMap,vUv).x;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\nmaterial.clearcoatRoughness*=texture2D(clearcoatRoughnessMap,vUv).y;\n#endif\nmaterial.clearcoat=saturate(material.clearcoat);material.clearcoatRoughness=max(material.clearcoatRoughness,0.0525);material.clearcoatRoughness+=geometryRoughness;material.clearcoatRoughness=min(material.clearcoatRoughness,1.0);\n#endif\n#ifdef USE_SHEEN\nmaterial.sheenColor=sheen;\n#endif",
                    lights_physical_pars_fragment: "struct PhysicalMaterial{vec3 diffuseColor;float specularRoughness;vec3 specularColor;\n#ifdef CLEARCOAT\nfloat clearcoat;float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\nvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox(const in float roughness,const in float dotNL){return DEFAULT_SPECULAR_COEFFICIENT+(1.0-DEFAULT_SPECULAR_COEFFICIENT)*(pow(1.0-dotNL,5.0)*pow(1.0-roughness,2.0));}\n#if NUM_RECT_AREA_LIGHTS>0\nvoid RE_Direct_RectArea_Physical(const in RectAreaLight rectAreaLight,const in GeometricContext geometry,const in PhysicalMaterial material,inout ReflectedLight reflectedLight){vec3 normal=geometry.normal;vec3 viewDir=geometry.viewDir;vec3 position=geometry.position;vec3 lightPos=rectAreaLight.position;vec3 halfWidth=rectAreaLight.halfWidth;vec3 halfHeight=rectAreaLight.halfHeight;vec3 lightColor=rectAreaLight.color;float roughness=material.specularRoughness;vec3 rectCoords[4];rectCoords[0]=lightPos+halfWidth-halfHeight;rectCoords[1]=lightPos-halfWidth-halfHeight;rectCoords[2]=lightPos-halfWidth+halfHeight;rectCoords[3]=lightPos+halfWidth+halfHeight;vec2 uv=LTC_Uv(normal,viewDir,roughness);vec4 t1=texture2D(ltc_1,uv);vec4 t2=texture2D(ltc_2,uv);mat3 mInv=mat3(vec3(t1.x,0,t1.y),vec3(0,1,0),vec3(t1.z,0,t1.w));vec3 fresnel=(material.specularColor*t2.x+(vec3(1.0)-material.specularColor)*t2.y);reflectedLight.directSpecular+=lightColor*fresnel*LTC_Evaluate(normal,viewDir,position,mInv,rectCoords);reflectedLight.directDiffuse+=lightColor*material.diffuseColor*LTC_Evaluate(normal,viewDir,position,mat3(1.0),rectCoords);}\n#endif\nvoid RE_Direct_Physical(const in IncidentLight directLight,const in GeometricContext geometry,const in PhysicalMaterial material,inout ReflectedLight reflectedLight){float dotNL=saturate(dot(geometry.normal,directLight.direction));vec3 irradiance=dotNL*directLight.color;\n#ifndef PHYSICALLY_CORRECT_LIGHTS\nirradiance*=PI;\n#endif\n#ifdef CLEARCOAT\nfloat ccDotNL=saturate(dot(geometry.clearcoatNormal,directLight.direction));vec3 ccIrradiance=ccDotNL*directLight.color;\n#ifndef PHYSICALLY_CORRECT_LIGHTS\nccIrradiance*=PI;\n#endif\nfloat clearcoatDHR=material.clearcoat*clearcoatDHRApprox(material.clearcoatRoughness,ccDotNL);reflectedLight.directSpecular+=ccIrradiance*material.clearcoat*BRDF_Specular_GGX(directLight,geometry.viewDir,geometry.clearcoatNormal,vec3(DEFAULT_SPECULAR_COEFFICIENT),material.clearcoatRoughness);\n#else\nfloat clearcoatDHR=0.0;\n#endif\n#ifdef USE_SHEEN\nreflectedLight.directSpecular+=(1.0-clearcoatDHR)*irradiance*BRDF_Specular_Sheen(material.specularRoughness,directLight.direction,geometry,material.sheenColor);\n#else\nreflectedLight.directSpecular+=(1.0-clearcoatDHR)*irradiance*BRDF_Specular_GGX(directLight,geometry.viewDir,geometry.normal,material.specularColor,material.specularRoughness);\n#endif\nreflectedLight.directDiffuse+=(1.0-clearcoatDHR)*irradiance*BRDF_Diffuse_Lambert(material.diffuseColor);}void RE_IndirectDiffuse_Physical(const in vec3 irradiance,const in GeometricContext geometry,const in PhysicalMaterial material,inout ReflectedLight reflectedLight){reflectedLight.indirectDiffuse+=irradiance*BRDF_Diffuse_Lambert(material.diffuseColor);}void RE_IndirectSpecular_Physical(const in vec3 radiance,const in vec3 irradiance,const in vec3 clearcoatRadiance,const in GeometricContext geometry,const in PhysicalMaterial material,inout ReflectedLight reflectedLight){\n#ifdef CLEARCOAT\nfloat ccDotNV=saturate(dot(geometry.clearcoatNormal,geometry.viewDir));reflectedLight.indirectSpecular+=clearcoatRadiance*material.clearcoat*BRDF_Specular_GGX_Environment(geometry.viewDir,geometry.clearcoatNormal,vec3(DEFAULT_SPECULAR_COEFFICIENT),material.clearcoatRoughness);float ccDotNL=ccDotNV;float clearcoatDHR=material.clearcoat*clearcoatDHRApprox(material.clearcoatRoughness,ccDotNL);\n#else\nfloat clearcoatDHR=0.0;\n#endif\nfloat clearcoatInv=1.0-clearcoatDHR;vec3 singleScattering=vec3(0.0);vec3 multiScattering=vec3(0.0);vec3 cosineWeightedIrradiance=irradiance*RECIPROCAL_PI;BRDF_Specular_Multiscattering_Environment(geometry,material.specularColor,material.specularRoughness,singleScattering,multiScattering);vec3 diffuse=material.diffuseColor*(1.0-(singleScattering+multiScattering));reflectedLight.indirectSpecular+=clearcoatInv*radiance*singleScattering;reflectedLight.indirectSpecular+=multiScattering*cosineWeightedIrradiance;reflectedLight.indirectDiffuse+=diffuse*cosineWeightedIrradiance;}\n#define RE_Direct RE_Direct_Physical\n#define RE_Direct_RectArea RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion(const in float dotNV,const in float ambientOcclusion,const in float roughness){return saturate(pow(dotNV+ambientOcclusion,exp2(-16.0*roughness-1.0))-1.0+ambientOcclusion);}",
                    lights_fragment_begin: "GeometricContext geometry;geometry.position=-vViewPosition;geometry.normal=normal;geometry.viewDir=(isOrthographic)?vec3(0,0,1):normalize(vViewPosition);\n#ifdef CLEARCOAT\ngeometry.clearcoatNormal=clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if (NUM_POINT_LIGHTS>0)&&defined(RE_Direct)\nPointLight pointLight;\n#if defined(USE_SHADOWMAP)&&NUM_POINT_LIGHT_SHADOWS>0\nPointLightShadow pointLightShadow;\n#endif\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_POINT_LIGHTS;i++){pointLight=pointLights[i];getPointDirectLightIrradiance(pointLight,geometry,directLight);\n#if defined(USE_SHADOWMAP)&&(UNROLLED_LOOP_INDEX<NUM_POINT_LIGHT_SHADOWS)\npointLightShadow=pointLightShadows[i];directLight.color*=all(bvec2(directLight.visible,receiveShadow))?getPointShadow(pointShadowMap[i],pointLightShadow.shadowMapSize,pointLightShadow.shadowBias,pointLightShadow.shadowRadius,vPointShadowCoord[i],pointLightShadow.shadowCameraNear,pointLightShadow.shadowCameraFar):1.0;\n#endif\nRE_Direct(directLight,geometry,material,reflectedLight);}\n#pragma unroll_loop_end\n#endif\n#if (NUM_SPOT_LIGHTS>0)&&defined(RE_Direct)\nSpotLight spotLight;\n#if defined(USE_SHADOWMAP)&&NUM_SPOT_LIGHT_SHADOWS>0\nSpotLightShadow spotLightShadow;\n#endif\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_SPOT_LIGHTS;i++){spotLight=spotLights[i];getSpotDirectLightIrradiance(spotLight,geometry,directLight);\n#if defined(USE_SHADOWMAP)&&(UNROLLED_LOOP_INDEX<NUM_SPOT_LIGHT_SHADOWS)\nspotLightShadow=spotLightShadows[i];directLight.color*=all(bvec2(directLight.visible,receiveShadow))?getShadow(spotShadowMap[i],spotLightShadow.shadowMapSize,spotLightShadow.shadowBias,spotLightShadow.shadowRadius,vSpotShadowCoord[i]):1.0;\n#endif\nRE_Direct(directLight,geometry,material,reflectedLight);}\n#pragma unroll_loop_end\n#endif\n#if (NUM_DIR_LIGHTS>0)&&defined(RE_Direct)\nDirectionalLight directionalLight;\n#if defined(USE_SHADOWMAP)&&NUM_DIR_LIGHT_SHADOWS>0\nDirectionalLightShadow directionalLightShadow;\n#endif\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_DIR_LIGHTS;i++){directionalLight=directionalLights[i];getDirectionalDirectLightIrradiance(directionalLight,geometry,directLight);\n#if defined(USE_SHADOWMAP)&&(UNROLLED_LOOP_INDEX<NUM_DIR_LIGHT_SHADOWS)\ndirectionalLightShadow=directionalLightShadows[i];directLight.color*=all(bvec2(directLight.visible,receiveShadow))?getShadow(directionalShadowMap[i],directionalLightShadow.shadowMapSize,directionalLightShadow.shadowBias,directionalLightShadow.shadowRadius,vDirectionalShadowCoord[i]):1.0;\n#endif\nRE_Direct(directLight,geometry,material,reflectedLight);}\n#pragma unroll_loop_end\n#endif\n#if (NUM_RECT_AREA_LIGHTS>0)&&defined(RE_Direct_RectArea)\nRectAreaLight rectAreaLight;\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_RECT_AREA_LIGHTS;i++){rectAreaLight=rectAreaLights[i];RE_Direct_RectArea(rectAreaLight,geometry,material,reflectedLight);}\n#pragma unroll_loop_end\n#endif\n#if defined(RE_IndirectDiffuse)\nvec3 iblIrradiance=vec3(0.0);vec3 irradiance=getAmbientLightIrradiance(ambientLightColor);irradiance+=getLightProbeIrradiance(lightProbe,geometry);\n#if (NUM_HEMI_LIGHTS>0)\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_HEMI_LIGHTS;i++){irradiance+=getHemisphereLightIrradiance(hemisphereLights[i],geometry);}\n#pragma unroll_loop_end\n#endif\n#endif\n#if defined(RE_IndirectSpecular)\nvec3 radiance=vec3(0.0);vec3 clearcoatRadiance=vec3(0.0);\n#endif",
                    lights_fragment_maps: "#if defined(RE_IndirectDiffuse)\n#ifdef USE_LIGHTMAP\nvec4 lightMapTexel=texture2D(lightMap,vUv2);vec3 lightMapIrradiance=lightMapTexelToLinear(lightMapTexel).rgb*lightMapIntensity;\n#ifndef PHYSICALLY_CORRECT_LIGHTS\nlightMapIrradiance*=PI;\n#endif\nirradiance+=lightMapIrradiance;\n#endif\n#if defined(USE_ENVMAP)&&defined(STANDARD)&&defined(ENVMAP_TYPE_CUBE_UV)\niblIrradiance+=getLightProbeIndirectIrradiance(geometry,maxMipLevel);\n#endif\n#endif\n#if defined(USE_ENVMAP)&&defined(RE_IndirectSpecular)\nradiance+=getLightProbeIndirectRadiance(geometry.viewDir,geometry.normal,material.specularRoughness,maxMipLevel);\n#ifdef CLEARCOAT\nclearcoatRadiance+=getLightProbeIndirectRadiance(geometry.viewDir,geometry.clearcoatNormal,material.clearcoatRoughness,maxMipLevel);\n#endif\n#endif",
                    lights_fragment_end: "#if defined(RE_IndirectDiffuse)\nRE_IndirectDiffuse(irradiance,geometry,material,reflectedLight);\n#endif\n#if defined(RE_IndirectSpecular)\nRE_IndirectSpecular(radiance,iblIrradiance,clearcoatRadiance,geometry,material,reflectedLight);\n#endif",
                    logdepthbuf_fragment: "#if defined(USE_LOGDEPTHBUF)&&defined(USE_LOGDEPTHBUF_EXT)\ngl_FragDepthEXT=vIsPerspective==0.0?gl_FragCoord.z:log2(vFragDepth)*logDepthBufFC*0.5;\n#endif",
                    logdepthbuf_pars_fragment: "#if defined(USE_LOGDEPTHBUF)&&defined(USE_LOGDEPTHBUF_EXT)\nuniform float logDepthBufFC;varying float vFragDepth;varying float vIsPerspective;\n#endif",
                    logdepthbuf_pars_vertex: "#ifdef USE_LOGDEPTHBUF\n#ifdef USE_LOGDEPTHBUF_EXT\nvarying float vFragDepth;varying float vIsPerspective;\n#else\nuniform float logDepthBufFC;\n#endif\n#endif",
                    logdepthbuf_vertex: "#ifdef USE_LOGDEPTHBUF\n#ifdef USE_LOGDEPTHBUF_EXT\nvFragDepth=1.0+gl_Position.w;vIsPerspective=float(isPerspectiveMatrix(projectionMatrix));\n#else\nif(isPerspectiveMatrix(projectionMatrix)){gl_Position.z=log2(max(EPSILON,gl_Position.w+1.0))*logDepthBufFC-1.0;gl_Position.z*=gl_Position.w;}\n#endif\n#endif",
                    map_fragment: "#ifdef USE_MAP\nvec4 texelColor=texture2D(map,vUv);texelColor=mapTexelToLinear(texelColor);diffuseColor*=texelColor;\n#endif",
                    map_pars_fragment: "#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
                    map_particle_fragment: "#if defined(USE_MAP)||defined(USE_ALPHAMAP)\nvec2 uv=(uvTransform*vec3(gl_PointCoord.x,1.0-gl_PointCoord.y,1)).xy;\n#endif\n#ifdef USE_MAP\nvec4 mapTexel=texture2D(map,uv);diffuseColor*=mapTexelToLinear(mapTexel);\n#endif\n#ifdef USE_ALPHAMAP\ndiffuseColor.a*=texture2D(alphaMap,uv).g;\n#endif",
                    map_particle_pars_fragment: "#if defined(USE_MAP)||defined(USE_ALPHAMAP)\nuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\nuniform sampler2D alphaMap;\n#endif",
                    metalnessmap_fragment: "float metalnessFactor=metalness;\n#ifdef USE_METALNESSMAP\nvec4 texelMetalness=texture2D(metalnessMap,vUv);metalnessFactor*=texelMetalness.b;\n#endif",
                    metalnessmap_pars_fragment: "#ifdef USE_METALNESSMAP\nuniform sampler2D metalnessMap;\n#endif",
                    morphnormal_vertex: "#ifdef USE_MORPHNORMALS\nobjectNormal*=morphTargetBaseInfluence;objectNormal+=morphNormal0*morphTargetInfluences[0];objectNormal+=morphNormal1*morphTargetInfluences[1];objectNormal+=morphNormal2*morphTargetInfluences[2];objectNormal+=morphNormal3*morphTargetInfluences[3];\n#endif",
                    morphtarget_pars_vertex: "#ifdef USE_MORPHTARGETS\nuniform float morphTargetBaseInfluence;\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[8];\n#else\nuniform float morphTargetInfluences[4];\n#endif\n#endif",
                    morphtarget_vertex: "#ifdef USE_MORPHTARGETS\ntransformed*=morphTargetBaseInfluence;transformed+=morphTarget0*morphTargetInfluences[0];transformed+=morphTarget1*morphTargetInfluences[1];transformed+=morphTarget2*morphTargetInfluences[2];transformed+=morphTarget3*morphTargetInfluences[3];\n#ifndef USE_MORPHNORMALS\ntransformed+=morphTarget4*morphTargetInfluences[4];transformed+=morphTarget5*morphTargetInfluences[5];transformed+=morphTarget6*morphTargetInfluences[6];transformed+=morphTarget7*morphTargetInfluences[7];\n#endif\n#endif",
                    normal_fragment_begin: "#ifdef FLAT_SHADED\nvec3 fdx=vec3(dFdx(vViewPosition.x),dFdx(vViewPosition.y),dFdx(vViewPosition.z));vec3 fdy=vec3(dFdy(vViewPosition.x),dFdy(vViewPosition.y),dFdy(vViewPosition.z));vec3 normal=normalize(cross(fdx,fdy));\n#else\nvec3 normal=normalize(vNormal);\n#ifdef DOUBLE_SIDED\nnormal=normal*(float(gl_FrontFacing)*2.0-1.0);\n#endif\n#ifdef USE_TANGENT\nvec3 tangent=normalize(vTangent);vec3 bitangent=normalize(vBitangent);\n#ifdef DOUBLE_SIDED\ntangent=tangent*(float(gl_FrontFacing)*2.0-1.0);bitangent=bitangent*(float(gl_FrontFacing)*2.0-1.0);\n#endif\n#if defined(TANGENTSPACE_NORMALMAP)||defined(USE_CLEARCOAT_NORMALMAP)\nmat3 vTBN=mat3(tangent,bitangent,normal);\n#endif\n#endif\n#endif\nvec3 geometryNormal=normal;",
                    normal_fragment_maps: "#ifdef OBJECTSPACE_NORMALMAP\nnormal=texture2D(normalMap,vUv).xyz*2.0-1.0;\n#ifdef FLIP_SIDED\nnormal=-normal;\n#endif\n#ifdef DOUBLE_SIDED\nnormal=normal*(float(gl_FrontFacing)*2.0-1.0);\n#endif\nnormal=normalize(normalMatrix*normal);\n#elif defined(TANGENTSPACE_NORMALMAP)\nvec3 mapN=texture2D(normalMap,vUv).xyz*2.0-1.0;mapN.xy*=normalScale;\n#ifdef USE_TANGENT\nnormal=normalize(vTBN*mapN);\n#else\nnormal=perturbNormal2Arb(-vViewPosition,normal,mapN);\n#endif\n#elif defined(USE_BUMPMAP)\nnormal=perturbNormalArb(-vViewPosition,normal,dHdxy_fwd());\n#endif",
                    normalmap_pars_fragment: "#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;uniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\nuniform mat3 normalMatrix;\n#endif\n#if !defined(USE_TANGENT)&&(defined(TANGENTSPACE_NORMALMAP)||defined(USE_CLEARCOAT_NORMALMAP))\nvec3 perturbNormal2Arb(vec3 eye_pos,vec3 surf_norm,vec3 mapN){vec3 q0=vec3(dFdx(eye_pos.x),dFdx(eye_pos.y),dFdx(eye_pos.z));vec3 q1=vec3(dFdy(eye_pos.x),dFdy(eye_pos.y),dFdy(eye_pos.z));vec2 st0=dFdx(vUv.st);vec2 st1=dFdy(vUv.st);float scale=sign(st1.t*st0.s-st0.t*st1.s);vec3 S=normalize((q0*st1.t-q1*st0.t)*scale);vec3 T=normalize((-q0*st1.s+q1*st0.s)*scale);vec3 N=normalize(surf_norm);mat3 tsn=mat3(S,T,N);mapN.xy*=(float(gl_FrontFacing)*2.0-1.0);return normalize(tsn*mapN);}\n#endif",
                    clearcoat_normal_fragment_begin: "#ifdef CLEARCOAT\nvec3 clearcoatNormal=geometryNormal;\n#endif",
                    clearcoat_normal_fragment_maps: "#ifdef USE_CLEARCOAT_NORMALMAP\nvec3 clearcoatMapN=texture2D(clearcoatNormalMap,vUv).xyz*2.0-1.0;clearcoatMapN.xy*=clearcoatNormalScale;\n#ifdef USE_TANGENT\nclearcoatNormal=normalize(vTBN*clearcoatMapN);\n#else\nclearcoatNormal=perturbNormal2Arb(-vViewPosition,clearcoatNormal,clearcoatMapN);\n#endif\n#endif",
                    clearcoat_pars_fragment: "#ifdef USE_CLEARCOATMAP\nuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\nuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\nuniform sampler2D clearcoatNormalMap;uniform vec2 clearcoatNormalScale;\n#endif",
                    packing: "vec3 packNormalToRGB(const in vec3 normal){return normalize(normal)*0.5+0.5;}vec3 unpackRGBToNormal(const in vec3 rgb){return 2.0*rgb.xyz-1.0;}const float PackUpscale=256./255.;const float UnpackDownscale=255./256.;const vec3 PackFactors=vec3(256.*256.*256.,256.*256.,256.);const vec4 UnpackFactors=UnpackDownscale/vec4(PackFactors,1.);const float ShiftRight8=1./256.;vec4 packDepthToRGBA(const in float v){vec4 r=vec4(fract(v*PackFactors),v);r.yzw-=r.xyz*ShiftRight8;return r*PackUpscale;}float unpackRGBAToDepth(const in vec4 v){return dot(v,UnpackFactors);}vec4 pack2HalfToRGBA(vec2 v){vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}vec2 unpackRGBATo2Half(vec4 v){return vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));}float viewZToOrthographicDepth(const in float viewZ,const in float near,const in float far){return(viewZ+near)/(near-far);}float orthographicDepthToViewZ(const in float linearClipZ,const in float near,const in float far){return linearClipZ*(near-far)-near;}float viewZToPerspectiveDepth(const in float viewZ,const in float near,const in float far){return((near+viewZ)*far)/((far-near)*viewZ);}float perspectiveDepthToViewZ(const in float invClipZ,const in float near,const in float far){return(near*far)/((far-near)*invClipZ-far);}",
                    premultiplied_alpha_fragment: "#ifdef PREMULTIPLIED_ALPHA\ngl_FragColor.rgb*=gl_FragColor.a;\n#endif",
                    project_vertex: "vec4 mvPosition=vec4(transformed,1.0);\n#ifdef USE_INSTANCING\nmvPosition=instanceMatrix*mvPosition;\n#endif\nmvPosition=modelViewMatrix*mvPosition;gl_Position=projectionMatrix*mvPosition;",
                    dithering_fragment: "#ifdef DITHERING\ngl_FragColor.rgb=dithering(gl_FragColor.rgb);\n#endif",
                    dithering_pars_fragment: "#ifdef DITHERING\nvec3 dithering(vec3 color){float grid_position=rand(gl_FragCoord.xy);vec3 dither_shift_RGB=vec3(0.25/255.0,-0.25/255.0,0.25/255.0);dither_shift_RGB=mix(2.0*dither_shift_RGB,-2.0*dither_shift_RGB,grid_position);return color+dither_shift_RGB;}\n#endif",
                    roughnessmap_fragment: "float roughnessFactor=roughness;\n#ifdef USE_ROUGHNESSMAP\nvec4 texelRoughness=texture2D(roughnessMap,vUv);roughnessFactor*=texelRoughness.g;\n#endif",
                    roughnessmap_pars_fragment: "#ifdef USE_ROUGHNESSMAP\nuniform sampler2D roughnessMap;\n#endif",
                    shadowmap_pars_fragment: "#ifdef USE_SHADOWMAP\n#if NUM_DIR_LIGHT_SHADOWS>0\nuniform sampler2D directionalShadowMap[NUM_DIR_LIGHT_SHADOWS];varying vec4 vDirectionalShadowCoord[NUM_DIR_LIGHT_SHADOWS];struct DirectionalLightShadow{float shadowBias;float shadowNormalBias;float shadowRadius;vec2 shadowMapSize;};uniform DirectionalLightShadow directionalLightShadows[NUM_DIR_LIGHT_SHADOWS];\n#endif\n#if NUM_SPOT_LIGHT_SHADOWS>0\nuniform sampler2D spotShadowMap[NUM_SPOT_LIGHT_SHADOWS];varying vec4 vSpotShadowCoord[NUM_SPOT_LIGHT_SHADOWS];struct SpotLightShadow{float shadowBias;float shadowNormalBias;float shadowRadius;vec2 shadowMapSize;};uniform SpotLightShadow spotLightShadows[NUM_SPOT_LIGHT_SHADOWS];\n#endif\n#if NUM_POINT_LIGHT_SHADOWS>0\nuniform sampler2D pointShadowMap[NUM_POINT_LIGHT_SHADOWS];varying vec4 vPointShadowCoord[NUM_POINT_LIGHT_SHADOWS];struct PointLightShadow{float shadowBias;float shadowNormalBias;float shadowRadius;vec2 shadowMapSize;float shadowCameraNear;float shadowCameraFar;};uniform PointLightShadow pointLightShadows[NUM_POINT_LIGHT_SHADOWS];\n#endif\nfloat texture2DCompare(sampler2D depths,vec2 uv,float compare){return step(compare,unpackRGBAToDepth(texture2D(depths,uv)));}vec2 texture2DDistribution(sampler2D shadow,vec2 uv){return unpackRGBATo2Half(texture2D(shadow,uv));}float VSMShadow(sampler2D shadow,vec2 uv,float compare){float occlusion=1.0;vec2 distribution=texture2DDistribution(shadow,uv);float hard_shadow=step(compare,distribution.x);if(hard_shadow!=1.0){float distance=compare-distribution.x;float variance=max(0.00000,distribution.y*distribution.y);float softness_probability=variance/(variance+distance*distance);softness_probability=clamp((softness_probability-0.3)/(0.95-0.3),0.0,1.0);occlusion=clamp(max(hard_shadow,softness_probability),0.0,1.0);}return occlusion;}float getShadow(sampler2D shadowMap,vec2 shadowMapSize,float shadowBias,float shadowRadius,vec4 shadowCoord){float shadow=1.0;shadowCoord.xyz/=shadowCoord.w;shadowCoord.z+=shadowBias;bvec4 inFrustumVec=bvec4(shadowCoord.x>=0.0,shadowCoord.x<=1.0,shadowCoord.y>=0.0,shadowCoord.y<=1.0);bool inFrustum=all(inFrustumVec);bvec2 frustumTestVec=bvec2(inFrustum,shadowCoord.z<=1.0);bool frustumTest=all(frustumTestVec);if(frustumTest){\n#if defined(SHADOWMAP_TYPE_PCF)\nvec2 texelSize=vec2(1.0)/shadowMapSize;float dx0=-texelSize.x*shadowRadius;float dy0=-texelSize.y*shadowRadius;float dx1=+texelSize.x*shadowRadius;float dy1=+texelSize.y*shadowRadius;float dx2=dx0/2.0;float dy2=dy0/2.0;float dx3=dx1/2.0;float dy3=dy1/2.0;shadow=(texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx0,dy0),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(0.0,dy0),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx1,dy0),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx2,dy2),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(0.0,dy2),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx3,dy2),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx0,0.0),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx2,0.0),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy,shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx3,0.0),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx1,0.0),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx2,dy3),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(0.0,dy3),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx3,dy3),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx0,dy1),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(0.0,dy1),shadowCoord.z)+texture2DCompare(shadowMap,shadowCoord.xy+vec2(dx1,dy1),shadowCoord.z))*(1.0/17.0);\n#elif defined(SHADOWMAP_TYPE_PCF_SOFT)\nvec2 texelSize=vec2(1.0)/shadowMapSize;float dx=texelSize.x;float dy=texelSize.y;vec2 uv=shadowCoord.xy;vec2 f=fract(uv*shadowMapSize+0.5);uv-=f*texelSize;shadow=(texture2DCompare(shadowMap,uv,shadowCoord.z)+texture2DCompare(shadowMap,uv+vec2(dx,0.0),shadowCoord.z)+texture2DCompare(shadowMap,uv+vec2(0.0,dy),shadowCoord.z)+texture2DCompare(shadowMap,uv+texelSize,shadowCoord.z)+mix(texture2DCompare(shadowMap,uv+vec2(-dx,0.0),shadowCoord.z),texture2DCompare(shadowMap,uv+vec2(2.0*dx,0.0),shadowCoord.z),f.x)+mix(texture2DCompare(shadowMap,uv+vec2(-dx,dy),shadowCoord.z),texture2DCompare(shadowMap,uv+vec2(2.0*dx,dy),shadowCoord.z),f.x)+mix(texture2DCompare(shadowMap,uv+vec2(0.0,-dy),shadowCoord.z),texture2DCompare(shadowMap,uv+vec2(0.0,2.0*dy),shadowCoord.z),f.y)+mix(texture2DCompare(shadowMap,uv+vec2(dx,-dy),shadowCoord.z),texture2DCompare(shadowMap,uv+vec2(dx,2.0*dy),shadowCoord.z),f.y)+mix(mix(texture2DCompare(shadowMap,uv+vec2(-dx,-dy),shadowCoord.z),texture2DCompare(shadowMap,uv+vec2(2.0*dx,-dy),shadowCoord.z),f.x),mix(texture2DCompare(shadowMap,uv+vec2(-dx,2.0*dy),shadowCoord.z),texture2DCompare(shadowMap,uv+vec2(2.0*dx,2.0*dy),shadowCoord.z),f.x),f.y))*(1.0/9.0);\n#elif defined(SHADOWMAP_TYPE_VSM)\nshadow=VSMShadow(shadowMap,shadowCoord.xy,shadowCoord.z);\n#else\nshadow=texture2DCompare(shadowMap,shadowCoord.xy,shadowCoord.z);\n#endif\n}return shadow;}vec2 cubeToUV(vec3 v,float texelSizeY){vec3 absV=abs(v);float scaleToCube=1.0/max(absV.x,max(absV.y,absV.z));absV*=scaleToCube;v*=scaleToCube*(1.0-2.0*texelSizeY);vec2 planar=v.xy;float almostATexel=1.5*texelSizeY;float almostOne=1.0-almostATexel;if(absV.z>=almostOne){if(v.z>0.0)planar.x=4.0-v.x;}else if(absV.x>=almostOne){float signX=sign(v.x);planar.x=v.z*signX+2.0*signX;}else if(absV.y>=almostOne){float signY=sign(v.y);planar.x=v.x+2.0*signY+2.0;planar.y=v.z*signY-2.0;}return vec2(0.125,0.25)*planar+vec2(0.375,0.75);}float getPointShadow(sampler2D shadowMap,vec2 shadowMapSize,float shadowBias,float shadowRadius,vec4 shadowCoord,float shadowCameraNear,float shadowCameraFar){vec2 texelSize=vec2(1.0)/(shadowMapSize*vec2(4.0,2.0));vec3 lightToPosition=shadowCoord.xyz;float dp=(length(lightToPosition)-shadowCameraNear)/(shadowCameraFar-shadowCameraNear);dp+=shadowBias;vec3 bd3D=normalize(lightToPosition);\n#if defined(SHADOWMAP_TYPE_PCF)||defined(SHADOWMAP_TYPE_PCF_SOFT)||defined(SHADOWMAP_TYPE_VSM)\nvec2 offset=vec2(-1,1)*shadowRadius*texelSize.y;return(texture2DCompare(shadowMap,cubeToUV(bd3D+offset.xyy,texelSize.y),dp)+texture2DCompare(shadowMap,cubeToUV(bd3D+offset.yyy,texelSize.y),dp)+texture2DCompare(shadowMap,cubeToUV(bd3D+offset.xyx,texelSize.y),dp)+texture2DCompare(shadowMap,cubeToUV(bd3D+offset.yyx,texelSize.y),dp)+texture2DCompare(shadowMap,cubeToUV(bd3D,texelSize.y),dp)+texture2DCompare(shadowMap,cubeToUV(bd3D+offset.xxy,texelSize.y),dp)+texture2DCompare(shadowMap,cubeToUV(bd3D+offset.yxy,texelSize.y),dp)+texture2DCompare(shadowMap,cubeToUV(bd3D+offset.xxx,texelSize.y),dp)+texture2DCompare(shadowMap,cubeToUV(bd3D+offset.yxx,texelSize.y),dp))*(1.0/9.0);\n#else\nreturn texture2DCompare(shadowMap,cubeToUV(bd3D,texelSize.y),dp);\n#endif\n}\n#endif",
                    shadowmap_pars_vertex: "#ifdef USE_SHADOWMAP\n#if NUM_DIR_LIGHT_SHADOWS>0\nuniform mat4 directionalShadowMatrix[NUM_DIR_LIGHT_SHADOWS];varying vec4 vDirectionalShadowCoord[NUM_DIR_LIGHT_SHADOWS];struct DirectionalLightShadow{float shadowBias;float shadowNormalBias;float shadowRadius;vec2 shadowMapSize;};uniform DirectionalLightShadow directionalLightShadows[NUM_DIR_LIGHT_SHADOWS];\n#endif\n#if NUM_SPOT_LIGHT_SHADOWS>0\nuniform mat4 spotShadowMatrix[NUM_SPOT_LIGHT_SHADOWS];varying vec4 vSpotShadowCoord[NUM_SPOT_LIGHT_SHADOWS];struct SpotLightShadow{float shadowBias;float shadowNormalBias;float shadowRadius;vec2 shadowMapSize;};uniform SpotLightShadow spotLightShadows[NUM_SPOT_LIGHT_SHADOWS];\n#endif\n#if NUM_POINT_LIGHT_SHADOWS>0\nuniform mat4 pointShadowMatrix[NUM_POINT_LIGHT_SHADOWS];varying vec4 vPointShadowCoord[NUM_POINT_LIGHT_SHADOWS];struct PointLightShadow{float shadowBias;float shadowNormalBias;float shadowRadius;vec2 shadowMapSize;float shadowCameraNear;float shadowCameraFar;};uniform PointLightShadow pointLightShadows[NUM_POINT_LIGHT_SHADOWS];\n#endif\n#endif",
                    shadowmap_vertex: "#ifdef USE_SHADOWMAP\n#if NUM_DIR_LIGHT_SHADOWS>0||NUM_SPOT_LIGHT_SHADOWS>0||NUM_POINT_LIGHT_SHADOWS>0\nvec3 shadowWorldNormal=inverseTransformDirection(transformedNormal,viewMatrix);vec4 shadowWorldPosition;\n#endif\n#if NUM_DIR_LIGHT_SHADOWS>0\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_DIR_LIGHT_SHADOWS;i++){shadowWorldPosition=worldPosition+vec4(shadowWorldNormal*directionalLightShadows[i].shadowNormalBias,0);vDirectionalShadowCoord[i]=directionalShadowMatrix[i]*shadowWorldPosition;}\n#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHT_SHADOWS>0\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_SPOT_LIGHT_SHADOWS;i++){shadowWorldPosition=worldPosition+vec4(shadowWorldNormal*spotLightShadows[i].shadowNormalBias,0);vSpotShadowCoord[i]=spotShadowMatrix[i]*shadowWorldPosition;}\n#pragma unroll_loop_end\n#endif\n#if NUM_POINT_LIGHT_SHADOWS>0\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_POINT_LIGHT_SHADOWS;i++){shadowWorldPosition=worldPosition+vec4(shadowWorldNormal*pointLightShadows[i].shadowNormalBias,0);vPointShadowCoord[i]=pointShadowMatrix[i]*shadowWorldPosition;}\n#pragma unroll_loop_end\n#endif\n#endif",
                    shadowmask_pars_fragment: "float getShadowMask(){float shadow=1.0;\n#ifdef USE_SHADOWMAP\n#if NUM_DIR_LIGHT_SHADOWS>0\nDirectionalLightShadow directionalLight;\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_DIR_LIGHT_SHADOWS;i++){directionalLight=directionalLightShadows[i];shadow*=receiveShadow?getShadow(directionalShadowMap[i],directionalLight.shadowMapSize,directionalLight.shadowBias,directionalLight.shadowRadius,vDirectionalShadowCoord[i]):1.0;}\n#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHT_SHADOWS>0\nSpotLightShadow spotLight;\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_SPOT_LIGHT_SHADOWS;i++){spotLight=spotLightShadows[i];shadow*=receiveShadow?getShadow(spotShadowMap[i],spotLight.shadowMapSize,spotLight.shadowBias,spotLight.shadowRadius,vSpotShadowCoord[i]):1.0;}\n#pragma unroll_loop_end\n#endif\n#if NUM_POINT_LIGHT_SHADOWS>0\nPointLightShadow pointLight;\n#pragma unroll_loop_start\nfor(int i=0;i<NUM_POINT_LIGHT_SHADOWS;i++){pointLight=pointLightShadows[i];shadow*=receiveShadow?getPointShadow(pointShadowMap[i],pointLight.shadowMapSize,pointLight.shadowBias,pointLight.shadowRadius,vPointShadowCoord[i],pointLight.shadowCameraNear,pointLight.shadowCameraFar):1.0;}\n#pragma unroll_loop_end\n#endif\n#endif\nreturn shadow;}",
                    skinbase_vertex: "#ifdef USE_SKINNING\nmat4 boneMatX=getBoneMatrix(skinIndex.x);mat4 boneMatY=getBoneMatrix(skinIndex.y);mat4 boneMatZ=getBoneMatrix(skinIndex.z);mat4 boneMatW=getBoneMatrix(skinIndex.w);\n#endif",
                    skinning_pars_vertex: "#ifdef USE_SKINNING\nuniform mat4 bindMatrix;uniform mat4 bindMatrixInverse;\n#ifdef BONE_TEXTURE\nuniform highp sampler2D boneTexture;uniform int boneTextureSize;mat4 getBoneMatrix(const in float i){float j=i*4.0;float x=mod(j,float(boneTextureSize));float y=floor(j/float(boneTextureSize));float dx=1.0/float(boneTextureSize);float dy=1.0/float(boneTextureSize);y=dy*(y+0.5);vec4 v1=texture2D(boneTexture,vec2(dx*(x+0.5),y));vec4 v2=texture2D(boneTexture,vec2(dx*(x+1.5),y));vec4 v3=texture2D(boneTexture,vec2(dx*(x+2.5),y));vec4 v4=texture2D(boneTexture,vec2(dx*(x+3.5),y));mat4 bone=mat4(v1,v2,v3,v4);return bone;}\n#else\nuniform mat4 boneMatrices[MAX_BONES];mat4 getBoneMatrix(const in float i){mat4 bone=boneMatrices[int(i)];return bone;}\n#endif\n#endif",
                    skinning_vertex: "#ifdef USE_SKINNING\nvec4 skinVertex=bindMatrix*vec4(transformed,1.0);vec4 skinned=vec4(0.0);skinned+=boneMatX*skinVertex*skinWeight.x;skinned+=boneMatY*skinVertex*skinWeight.y;skinned+=boneMatZ*skinVertex*skinWeight.z;skinned+=boneMatW*skinVertex*skinWeight.w;transformed=(bindMatrixInverse*skinned).xyz;\n#endif",
                    skinnormal_vertex: "#ifdef USE_SKINNING\nmat4 skinMatrix=mat4(0.0);skinMatrix+=skinWeight.x*boneMatX;skinMatrix+=skinWeight.y*boneMatY;skinMatrix+=skinWeight.z*boneMatZ;skinMatrix+=skinWeight.w*boneMatW;skinMatrix=bindMatrixInverse*skinMatrix*bindMatrix;objectNormal=vec4(skinMatrix*vec4(objectNormal,0.0)).xyz;\n#ifdef USE_TANGENT\nobjectTangent=vec4(skinMatrix*vec4(objectTangent,0.0)).xyz;\n#endif\n#endif",
                    specularmap_fragment: "float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular=texture2D(specularMap,vUv);specularStrength=texelSpecular.r;\n#else\nspecularStrength=1.0;\n#endif",
                    specularmap_pars_fragment: "#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",
                    tonemapping_fragment: "#if defined(TONE_MAPPING)\ngl_FragColor.rgb=toneMapping(gl_FragColor.rgb);\n#endif",
                    tonemapping_pars_fragment: "#ifndef saturate\n#define saturate(a)clamp(a,0.0,1.0)\n#endif\nuniform float toneMappingExposure;vec3 LinearToneMapping(vec3 color){return toneMappingExposure*color;}vec3 ReinhardToneMapping(vec3 color){color*=toneMappingExposure;return saturate(color/(vec3(1.0)+color));}vec3 OptimizedCineonToneMapping(vec3 color){color*=toneMappingExposure;color=max(vec3(0.0),color-0.004);return pow((color*(6.2*color+0.5))/(color*(6.2*color+1.7)+0.06),vec3(2.2));}vec3 RRTAndODTFit(vec3 v){vec3 a=v*(v+0.0245786)-0.000090537;vec3 b=v*(0.983729*v+0.4329510)+0.238081;return a/b;}vec3 ACESFilmicToneMapping(vec3 color){const mat3 ACESInputMat=mat3(vec3(0.59719,0.07600,0.02840),vec3(0.35458,0.90834,0.13383),vec3(0.04823,0.01566,0.83777));const mat3 ACESOutputMat=mat3(vec3(1.60475,-0.10208,-0.00327),vec3(-0.53108,1.10813,-0.07276),vec3(-0.07367,-0.00605,1.07602));color*=toneMappingExposure/0.6;color=ACESInputMat*color;color=RRTAndODTFit(color);color=ACESOutputMat*color;return saturate(color);}vec3 CustomToneMapping(vec3 color){return color;}",
                    transmissionmap_fragment: "#ifdef USE_TRANSMISSIONMAP\ntotalTransmission*=texture2D(transmissionMap,vUv).r;\n#endif",
                    transmissionmap_pars_fragment: "#ifdef USE_TRANSMISSIONMAP\nuniform sampler2D transmissionMap;\n#endif",
                    uv_pars_fragment: "#if (defined(USE_UV)&&!defined(UVS_VERTEX_ONLY))\nvarying vec2 vUv;\n#endif",
                    uv_pars_vertex: "#ifdef USE_UV\n#ifdef UVS_VERTEX_ONLY\nvec2 vUv;\n#else\nvarying vec2 vUv;\n#endif\nuniform mat3 uvTransform;\n#endif",
                    uv_vertex: "#ifdef USE_UV\nvUv=(uvTransform*vec3(uv,1)).xy;\n#endif",
                    uv2_pars_fragment: "#if defined(USE_LIGHTMAP)||defined(USE_AOMAP)\nvarying vec2 vUv2;\n#endif",
                    uv2_pars_vertex: "#if defined(USE_LIGHTMAP)||defined(USE_AOMAP)\nattribute vec2 uv2;varying vec2 vUv2;uniform mat3 uv2Transform;\n#endif",
                    uv2_vertex: "#if defined(USE_LIGHTMAP)||defined(USE_AOMAP)\nvUv2=(uv2Transform*vec3(uv2,1)).xy;\n#endif",
                    worldpos_vertex: "#if defined(USE_ENVMAP)||defined(DISTANCE)||defined(USE_SHADOWMAP)\nvec4 worldPosition=vec4(transformed,1.0);\n#ifdef USE_INSTANCING\nworldPosition=instanceMatrix*worldPosition;\n#endif\nworldPosition=modelMatrix*worldPosition;\n#endif",
                    background_frag: "uniform sampler2D t2D;varying vec2 vUv;void main(){vec4 texColor=texture2D(t2D,vUv);gl_FragColor=mapTexelToLinear(texColor);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n}",
                    background_vert: "varying vec2 vUv;uniform mat3 uvTransform;void main(){vUv=(uvTransform*vec3(uv,1)).xy;gl_Position=vec4(position.xy,1.0,1.0);}",
                    cube_frag: "#include <envmap_common_pars_fragment>\nuniform float opacity;varying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main(){vec3 vReflect=vWorldDirection;\n#include <envmap_fragment>\ngl_FragColor=envColor;gl_FragColor.a*=opacity;\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n}",
                    cube_vert: "varying vec3 vWorldDirection;\n#include <common>\nvoid main(){vWorldDirection=transformDirection(position,modelMatrix);\n#include <begin_vertex>\n#include <project_vertex>\ngl_Position.z=gl_Position.w;}",
                    depth_frag: "#if DEPTH_PACKING==3200\nuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;void main(){\n#include <clipping_planes_fragment>\nvec4 diffuseColor=vec4(1.0);\n#if DEPTH_PACKING==3200\ndiffuseColor.a=opacity;\n#endif\n#include <map_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <logdepthbuf_fragment>\nfloat fragCoordZ=0.5*vHighPrecisionZW[0]/vHighPrecisionZW[1]+0.5;\n#if DEPTH_PACKING==3200\ngl_FragColor=vec4(vec3(1.0-fragCoordZ),opacity);\n#elif DEPTH_PACKING==3201\ngl_FragColor=packDepthToRGBA(fragCoordZ);\n#endif\n}",
                    depth_vert: "#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;void main(){\n#include <uv_vertex>\n#include <skinbase_vertex>\n#ifdef USE_DISPLACEMENTMAP\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinnormal_vertex>\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\nvHighPrecisionZW=gl_Position.zw;}",
                    distanceRGBA_frag: "#define DISTANCE\nuniform vec3 referencePosition;uniform float nearDistance;uniform float farDistance;varying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nvec4 diffuseColor=vec4(1.0);\n#include <map_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\nfloat dist=length(vWorldPosition-referencePosition);dist=(dist-nearDistance)/(farDistance-nearDistance);dist=saturate(dist);gl_FragColor=packDepthToRGBA(dist);}",
                    distanceRGBA_vert: "#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <uv_vertex>\n#include <skinbase_vertex>\n#ifdef USE_DISPLACEMENTMAP\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinnormal_vertex>\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <worldpos_vertex>\n#include <clipping_planes_vertex>\nvWorldPosition=worldPosition.xyz;}",
                    equirect_frag: "uniform sampler2D tEquirect;varying vec3 vWorldDirection;\n#include <common>\nvoid main(){vec3 direction=normalize(vWorldDirection);vec2 sampleUV=equirectUv(direction);vec4 texColor=texture2D(tEquirect,sampleUV);gl_FragColor=mapTexelToLinear(texColor);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n}",
                    equirect_vert: "varying vec3 vWorldDirection;\n#include <common>\nvoid main(){vWorldDirection=transformDirection(position,modelMatrix);\n#include <begin_vertex>\n#include <project_vertex>\n}",
                    linedashed_frag: "uniform vec3 diffuse;uniform float opacity;uniform float dashSize;uniform float totalSize;varying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nif(mod(vLineDistance,totalSize)>dashSize){discard;}vec3 outgoingLight=vec3(0.0);vec4 diffuseColor=vec4(diffuse,opacity);\n#include <logdepthbuf_fragment>\n#include <color_fragment>\noutgoingLight=diffuseColor.rgb;gl_FragColor=vec4(outgoingLight,diffuseColor.a);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n#include <premultiplied_alpha_fragment>\n}",
                    linedashed_vert: "uniform float scale;attribute float lineDistance;varying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){vLineDistance=scale*lineDistance;\n#include <color_vertex>\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n#include <fog_vertex>\n}",
                    meshbasic_frag: "uniform vec3 diffuse;uniform float opacity;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nvec4 diffuseColor=vec4(diffuse,opacity);\n#include <logdepthbuf_fragment>\n#include <map_fragment>\n#include <color_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <specularmap_fragment>\nReflectedLight reflectedLight=ReflectedLight(vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));\n#ifdef USE_LIGHTMAP\nvec4 lightMapTexel=texture2D(lightMap,vUv2);reflectedLight.indirectDiffuse+=lightMapTexelToLinear(lightMapTexel).rgb*lightMapIntensity;\n#else\nreflectedLight.indirectDiffuse+=vec3(1.0);\n#endif\n#include <aomap_fragment>\nreflectedLight.indirectDiffuse*=diffuseColor.rgb;vec3 outgoingLight=reflectedLight.indirectDiffuse;\n#include <envmap_fragment>\ngl_FragColor=vec4(outgoingLight,diffuseColor.a);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n#include <premultiplied_alpha_fragment>\n#include <dithering_fragment>\n}",
                    meshbasic_vert: "#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <uv_vertex>\n#include <uv2_vertex>\n#include <color_vertex>\n#include <skinbase_vertex>\n#ifdef USE_ENVMAP\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <worldpos_vertex>\n#include <clipping_planes_vertex>\n#include <envmap_vertex>\n#include <fog_vertex>\n}",
                    meshlambert_frag: "uniform vec3 diffuse;uniform vec3 emissive;uniform float opacity;varying vec3 vLightFront;varying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;varying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nvec4 diffuseColor=vec4(diffuse,opacity);ReflectedLight reflectedLight=ReflectedLight(vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));vec3 totalEmissiveRadiance=emissive;\n#include <logdepthbuf_fragment>\n#include <map_fragment>\n#include <color_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <specularmap_fragment>\n#include <emissivemap_fragment>\n#ifdef DOUBLE_SIDED\nreflectedLight.indirectDiffuse+=(gl_FrontFacing)?vIndirectFront:vIndirectBack;\n#else\nreflectedLight.indirectDiffuse+=vIndirectFront;\n#endif\n#include <lightmap_fragment>\nreflectedLight.indirectDiffuse*=BRDF_Diffuse_Lambert(diffuseColor.rgb);\n#ifdef DOUBLE_SIDED\nreflectedLight.directDiffuse=(gl_FrontFacing)?vLightFront:vLightBack;\n#else\nreflectedLight.directDiffuse=vLightFront;\n#endif\nreflectedLight.directDiffuse*=BRDF_Diffuse_Lambert(diffuseColor.rgb)*getShadowMask();\n#include <aomap_fragment>\nvec3 outgoingLight=reflectedLight.directDiffuse+reflectedLight.indirectDiffuse+totalEmissiveRadiance;\n#include <envmap_fragment>\ngl_FragColor=vec4(outgoingLight,diffuseColor.a);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n#include <premultiplied_alpha_fragment>\n#include <dithering_fragment>\n}",
                    meshlambert_vert: "#define LAMBERT\nvarying vec3 vLightFront;varying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;varying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <uv_vertex>\n#include <uv2_vertex>\n#include <color_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n#include <worldpos_vertex>\n#include <envmap_vertex>\n#include <lights_lambert_vertex>\n#include <shadowmap_vertex>\n#include <fog_vertex>\n}",
                    meshmatcap_frag: "#define MATCAP\nuniform vec3 diffuse;uniform float opacity;uniform sampler2D matcap;varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nvec4 diffuseColor=vec4(diffuse,opacity);\n#include <logdepthbuf_fragment>\n#include <map_fragment>\n#include <color_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <normal_fragment_begin>\n#include <normal_fragment_maps>\nvec3 viewDir=normalize(vViewPosition);vec3 x=normalize(vec3(viewDir.z,0.0,-viewDir.x));vec3 y=cross(viewDir,x);vec2 uv=vec2(dot(x,normal),dot(y,normal))*0.495+0.5;\n#ifdef USE_MATCAP\nvec4 matcapColor=texture2D(matcap,uv);matcapColor=matcapTexelToLinear(matcapColor);\n#else\nvec4 matcapColor=vec4(1.0);\n#endif\nvec3 outgoingLight=diffuseColor.rgb*matcapColor.rgb;gl_FragColor=vec4(outgoingLight,diffuseColor.a);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n#include <premultiplied_alpha_fragment>\n#include <dithering_fragment>\n}",
                    meshmatcap_vert: "#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <uv_vertex>\n#include <color_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\nvNormal=normalize(transformedNormal);\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n#include <fog_vertex>\nvViewPosition=-mvPosition.xyz;}",
                    meshtoon_frag: "#define TOON\nuniform vec3 diffuse;uniform vec3 emissive;uniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nvec4 diffuseColor=vec4(diffuse,opacity);ReflectedLight reflectedLight=ReflectedLight(vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));vec3 totalEmissiveRadiance=emissive;\n#include <logdepthbuf_fragment>\n#include <map_fragment>\n#include <color_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <normal_fragment_begin>\n#include <normal_fragment_maps>\n#include <emissivemap_fragment>\n#include <lights_toon_fragment>\n#include <lights_fragment_begin>\n#include <lights_fragment_maps>\n#include <lights_fragment_end>\n#include <aomap_fragment>\nvec3 outgoingLight=reflectedLight.directDiffuse+reflectedLight.indirectDiffuse+totalEmissiveRadiance;gl_FragColor=vec4(outgoingLight,diffuseColor.a);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n#include <premultiplied_alpha_fragment>\n#include <dithering_fragment>\n}",
                    meshtoon_vert: "#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <uv_vertex>\n#include <uv2_vertex>\n#include <color_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\nvNormal=normalize(transformedNormal);\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\nvViewPosition=-mvPosition.xyz;\n#include <worldpos_vertex>\n#include <shadowmap_vertex>\n#include <fog_vertex>\n}",
                    meshphong_frag: "#define PHONG\nuniform vec3 diffuse;uniform vec3 emissive;uniform vec3 specular;uniform float shininess;uniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nvec4 diffuseColor=vec4(diffuse,opacity);ReflectedLight reflectedLight=ReflectedLight(vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));vec3 totalEmissiveRadiance=emissive;\n#include <logdepthbuf_fragment>\n#include <map_fragment>\n#include <color_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <specularmap_fragment>\n#include <normal_fragment_begin>\n#include <normal_fragment_maps>\n#include <emissivemap_fragment>\n#include <lights_phong_fragment>\n#include <lights_fragment_begin>\n#include <lights_fragment_maps>\n#include <lights_fragment_end>\n#include <aomap_fragment>\nvec3 outgoingLight=reflectedLight.directDiffuse+reflectedLight.indirectDiffuse+reflectedLight.directSpecular+reflectedLight.indirectSpecular+totalEmissiveRadiance;\n#include <envmap_fragment>\ngl_FragColor=vec4(outgoingLight,diffuseColor.a);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n#include <premultiplied_alpha_fragment>\n#include <dithering_fragment>\n}",
                    meshphong_vert: "#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <uv_vertex>\n#include <uv2_vertex>\n#include <color_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\nvNormal=normalize(transformedNormal);\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\nvViewPosition=-mvPosition.xyz;\n#include <worldpos_vertex>\n#include <envmap_vertex>\n#include <shadowmap_vertex>\n#include <fog_vertex>\n}",
                    meshphysical_frag: "#define STANDARD\n#ifdef PHYSICAL\n#define REFLECTIVITY\n#define CLEARCOAT\n#define TRANSMISSION\n#endif\nuniform vec3 diffuse;uniform vec3 emissive;uniform float roughness;uniform float metalness;uniform float opacity;\n#ifdef TRANSMISSION\nuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\nuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\nuniform float clearcoat;uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\nuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#ifdef USE_TANGENT\nvarying vec3 vTangent;varying vec3 vBitangent;\n#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nvec4 diffuseColor=vec4(diffuse,opacity);ReflectedLight reflectedLight=ReflectedLight(vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));vec3 totalEmissiveRadiance=emissive;\n#ifdef TRANSMISSION\nfloat totalTransmission=transmission;\n#endif\n#include <logdepthbuf_fragment>\n#include <map_fragment>\n#include <color_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <roughnessmap_fragment>\n#include <metalnessmap_fragment>\n#include <normal_fragment_begin>\n#include <normal_fragment_maps>\n#include <clearcoat_normal_fragment_begin>\n#include <clearcoat_normal_fragment_maps>\n#include <emissivemap_fragment>\n#include <transmissionmap_fragment>\n#include <lights_physical_fragment>\n#include <lights_fragment_begin>\n#include <lights_fragment_maps>\n#include <lights_fragment_end>\n#include <aomap_fragment>\nvec3 outgoingLight=reflectedLight.directDiffuse+reflectedLight.indirectDiffuse+reflectedLight.directSpecular+reflectedLight.indirectSpecular+totalEmissiveRadiance;\n#ifdef TRANSMISSION\ndiffuseColor.a*=mix(saturate(1.-totalTransmission+linearToRelativeLuminance(reflectedLight.directSpecular+reflectedLight.indirectSpecular)),1.0,metalness);\n#endif\ngl_FragColor=vec4(outgoingLight,diffuseColor.a);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n#include <premultiplied_alpha_fragment>\n#include <dithering_fragment>\n}",
                    meshphysical_vert: "#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#ifdef USE_TANGENT\nvarying vec3 vTangent;varying vec3 vBitangent;\n#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <uv_vertex>\n#include <uv2_vertex>\n#include <color_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\nvNormal=normalize(transformedNormal);\n#ifdef USE_TANGENT\nvTangent=normalize(transformedTangent);vBitangent=normalize(cross(vNormal,vTangent)*tangent.w);\n#endif\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\nvViewPosition=-mvPosition.xyz;\n#include <worldpos_vertex>\n#include <shadowmap_vertex>\n#include <fog_vertex>\n}",
                    normal_frag: "#define NORMAL\nuniform float opacity;\n#if defined(FLAT_SHADED)||defined(USE_BUMPMAP)||defined(TANGENTSPACE_NORMALMAP)\nvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#ifdef USE_TANGENT\nvarying vec3 vTangent;varying vec3 vBitangent;\n#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\n#include <logdepthbuf_fragment>\n#include <normal_fragment_begin>\n#include <normal_fragment_maps>\ngl_FragColor=vec4(packNormalToRGB(normal),opacity);}",
                    normal_vert: "#define NORMAL\n#if defined(FLAT_SHADED)||defined(USE_BUMPMAP)||defined(TANGENTSPACE_NORMALMAP)\nvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#ifdef USE_TANGENT\nvarying vec3 vTangent;varying vec3 vBitangent;\n#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <uv_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\nvNormal=normalize(transformedNormal);\n#ifdef USE_TANGENT\nvTangent=normalize(transformedTangent);vBitangent=normalize(cross(vNormal,vTangent)*tangent.w);\n#endif\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n#if defined(FLAT_SHADED)||defined(USE_BUMPMAP)||defined(TANGENTSPACE_NORMALMAP)\nvViewPosition=-mvPosition.xyz;\n#endif\n}",
                    points_frag: "uniform vec3 diffuse;uniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nvec3 outgoingLight=vec3(0.0);vec4 diffuseColor=vec4(diffuse,opacity);\n#include <logdepthbuf_fragment>\n#include <map_particle_fragment>\n#include <color_fragment>\n#include <alphatest_fragment>\noutgoingLight=diffuseColor.rgb;gl_FragColor=vec4(outgoingLight,diffuseColor.a);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n#include <premultiplied_alpha_fragment>\n}",
                    points_vert: "uniform float size;uniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <color_vertex>\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <project_vertex>\ngl_PointSize=size;\n#ifdef USE_SIZEATTENUATION\nbool isPerspective=isPerspectiveMatrix(projectionMatrix);if(isPerspective)gl_PointSize*=(scale/-mvPosition.z);\n#endif\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n#include <worldpos_vertex>\n#include <fog_vertex>\n}",
                    shadow_frag: "uniform vec3 color;uniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main(){gl_FragColor=vec4(color,opacity*(1.0-getShadowMask()));\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n}",
                    shadow_vert: "#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main(){\n#include <begin_vertex>\n#include <project_vertex>\n#include <worldpos_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#include <shadowmap_vertex>\n#include <fog_vertex>\n}",
                    sprite_frag: "uniform vec3 diffuse;uniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main(){\n#include <clipping_planes_fragment>\nvec3 outgoingLight=vec3(0.0);vec4 diffuseColor=vec4(diffuse,opacity);\n#include <logdepthbuf_fragment>\n#include <map_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\noutgoingLight=diffuseColor.rgb;gl_FragColor=vec4(outgoingLight,diffuseColor.a);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n#include <fog_fragment>\n}",
                    sprite_vert: "uniform float rotation;uniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main(){\n#include <uv_vertex>\nvec4 mvPosition=modelViewMatrix*vec4(0.0,0.0,0.0,1.0);vec2 scale;scale.x=length(vec3(modelMatrix[0].x,modelMatrix[0].y,modelMatrix[0].z));scale.y=length(vec3(modelMatrix[1].x,modelMatrix[1].y,modelMatrix[1].z));\n#ifndef USE_SIZEATTENUATION\nbool isPerspective=isPerspectiveMatrix(projectionMatrix);if(isPerspective)scale*=-mvPosition.z;\n#endif\nvec2 alignedPosition=(position.xy-(center-vec2(0.5)))*scale;vec2 rotatedPosition;rotatedPosition.x=cos(rotation)*alignedPosition.x-sin(rotation)*alignedPosition.y;rotatedPosition.y=sin(rotation)*alignedPosition.x+cos(rotation)*alignedPosition.y;mvPosition.xy+=rotatedPosition;gl_Position=projectionMatrix*mvPosition;\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\n#include <fog_vertex>\n}"
                }
                  , Lr = {
                    common: {
                        diffuse: {
                            value: new vt(15658734)
                        },
                        opacity: {
                            value: 1
                        },
                        map: {
                            value: null
                        },
                        uvTransform: {
                            value: new q
                        },
                        uv2Transform: {
                            value: new q
                        },
                        alphaMap: {
                            value: null
                        }
                    },
                    specularmap: {
                        specularMap: {
                            value: null
                        }
                    },
                    envmap: {
                        envMap: {
                            value: null
                        },
                        flipEnvMap: {
                            value: -1
                        },
                        reflectivity: {
                            value: 1
                        },
                        refractionRatio: {
                            value: .98
                        },
                        maxMipLevel: {
                            value: 0
                        }
                    },
                    aomap: {
                        aoMap: {
                            value: null
                        },
                        aoMapIntensity: {
                            value: 1
                        }
                    },
                    lightmap: {
                        lightMap: {
                            value: null
                        },
                        lightMapIntensity: {
                            value: 1
                        }
                    },
                    emissivemap: {
                        emissiveMap: {
                            value: null
                        }
                    },
                    bumpmap: {
                        bumpMap: {
                            value: null
                        },
                        bumpScale: {
                            value: 1
                        }
                    },
                    normalmap: {
                        normalMap: {
                            value: null
                        },
                        normalScale: {
                            value: new lt(1,1)
                        }
                    },
                    displacementmap: {
                        displacementMap: {
                            value: null
                        },
                        displacementScale: {
                            value: 1
                        },
                        displacementBias: {
                            value: 0
                        }
                    },
                    roughnessmap: {
                        roughnessMap: {
                            value: null
                        }
                    },
                    metalnessmap: {
                        metalnessMap: {
                            value: null
                        }
                    },
                    gradientmap: {
                        gradientMap: {
                            value: null
                        }
                    },
                    fog: {
                        fogDensity: {
                            value: 25e-5
                        },
                        fogNear: {
                            value: 1
                        },
                        fogFar: {
                            value: 2e3
                        },
                        fogColor: {
                            value: new vt(16777215)
                        }
                    },
                    lights: {
                        ambientLightColor: {
                            value: []
                        },
                        lightProbe: {
                            value: []
                        },
                        directionalLights: {
                            value: [],
                            properties: {
                                direction: {},
                                color: {}
                            }
                        },
                        directionalLightShadows: {
                            value: [],
                            properties: {
                                shadowBias: {},
                                shadowNormalBias: {},
                                shadowRadius: {},
                                shadowMapSize: {}
                            }
                        },
                        directionalShadowMap: {
                            value: []
                        },
                        directionalShadowMatrix: {
                            value: []
                        },
                        spotLights: {
                            value: [],
                            properties: {
                                color: {},
                                position: {},
                                direction: {},
                                distance: {},
                                coneCos: {},
                                penumbraCos: {},
                                decay: {}
                            }
                        },
                        spotLightShadows: {
                            value: [],
                            properties: {
                                shadowBias: {},
                                shadowNormalBias: {},
                                shadowRadius: {},
                                shadowMapSize: {}
                            }
                        },
                        spotShadowMap: {
                            value: []
                        },
                        spotShadowMatrix: {
                            value: []
                        },
                        pointLights: {
                            value: [],
                            properties: {
                                color: {},
                                position: {},
                                decay: {},
                                distance: {}
                            }
                        },
                        pointLightShadows: {
                            value: [],
                            properties: {
                                shadowBias: {},
                                shadowNormalBias: {},
                                shadowRadius: {},
                                shadowMapSize: {},
                                shadowCameraNear: {},
                                shadowCameraFar: {}
                            }
                        },
                        pointShadowMap: {
                            value: []
                        },
                        pointShadowMatrix: {
                            value: []
                        },
                        hemisphereLights: {
                            value: [],
                            properties: {
                                direction: {},
                                skyColor: {},
                                groundColor: {}
                            }
                        },
                        rectAreaLights: {
                            value: [],
                            properties: {
                                color: {},
                                position: {},
                                width: {},
                                height: {}
                            }
                        },
                        ltc_1: {
                            value: null
                        },
                        ltc_2: {
                            value: null
                        }
                    },
                    points: {
                        diffuse: {
                            value: new vt(15658734)
                        },
                        opacity: {
                            value: 1
                        },
                        size: {
                            value: 1
                        },
                        scale: {
                            value: 1
                        },
                        map: {
                            value: null
                        },
                        alphaMap: {
                            value: null
                        },
                        uvTransform: {
                            value: new q
                        }
                    },
                    sprite: {
                        diffuse: {
                            value: new vt(15658734)
                        },
                        opacity: {
                            value: 1
                        },
                        center: {
                            value: new lt(.5,.5)
                        },
                        rotation: {
                            value: 0
                        },
                        map: {
                            value: null
                        },
                        alphaMap: {
                            value: null
                        },
                        uvTransform: {
                            value: new q
                        }
                    }
                }
                  , Ir = {
                    basic: {
                        uniforms: Fe([Lr.common, Lr.specularmap, Lr.envmap, Lr.aomap, Lr.lightmap, Lr.fog]),
                        vertexShader: Cr.meshbasic_vert,
                        fragmentShader: Cr.meshbasic_frag
                    },
                    lambert: {
                        uniforms: Fe([Lr.common, Lr.specularmap, Lr.envmap, Lr.aomap, Lr.lightmap, Lr.emissivemap, Lr.fog, Lr.lights, {
                            emissive: {
                                value: new vt(0)
                            }
                        }]),
                        vertexShader: Cr.meshlambert_vert,
                        fragmentShader: Cr.meshlambert_frag
                    },
                    phong: {
                        uniforms: Fe([Lr.common, Lr.specularmap, Lr.envmap, Lr.aomap, Lr.lightmap, Lr.emissivemap, Lr.bumpmap, Lr.normalmap, Lr.displacementmap, Lr.fog, Lr.lights, {
                            emissive: {
                                value: new vt(0)
                            },
                            specular: {
                                value: new vt(1118481)
                            },
                            shininess: {
                                value: 30
                            }
                        }]),
                        vertexShader: Cr.meshphong_vert,
                        fragmentShader: Cr.meshphong_frag
                    },
                    standard: {
                        uniforms: Fe([Lr.common, Lr.envmap, Lr.aomap, Lr.lightmap, Lr.emissivemap, Lr.bumpmap, Lr.normalmap, Lr.displacementmap, Lr.roughnessmap, Lr.metalnessmap, Lr.fog, Lr.lights, {
                            emissive: {
                                value: new vt(0)
                            },
                            roughness: {
                                value: 1
                            },
                            metalness: {
                                value: 0
                            },
                            envMapIntensity: {
                                value: 1
                            }
                        }]),
                        vertexShader: Cr.meshphysical_vert,
                        fragmentShader: Cr.meshphysical_frag
                    },
                    toon: {
                        uniforms: Fe([Lr.common, Lr.aomap, Lr.lightmap, Lr.emissivemap, Lr.bumpmap, Lr.normalmap, Lr.displacementmap, Lr.gradientmap, Lr.fog, Lr.lights, {
                            emissive: {
                                value: new vt(0)
                            }
                        }]),
                        vertexShader: Cr.meshtoon_vert,
                        fragmentShader: Cr.meshtoon_frag
                    },
                    matcap: {
                        uniforms: Fe([Lr.common, Lr.bumpmap, Lr.normalmap, Lr.displacementmap, Lr.fog, {
                            matcap: {
                                value: null
                            }
                        }]),
                        vertexShader: Cr.meshmatcap_vert,
                        fragmentShader: Cr.meshmatcap_frag
                    },
                    points: {
                        uniforms: Fe([Lr.points, Lr.fog]),
                        vertexShader: Cr.points_vert,
                        fragmentShader: Cr.points_frag
                    },
                    dashed: {
                        uniforms: Fe([Lr.common, Lr.fog, {
                            scale: {
                                value: 1
                            },
                            dashSize: {
                                value: 1
                            },
                            totalSize: {
                                value: 2
                            }
                        }]),
                        vertexShader: Cr.linedashed_vert,
                        fragmentShader: Cr.linedashed_frag
                    },
                    depth: {
                        uniforms: Fe([Lr.common, Lr.displacementmap]),
                        vertexShader: Cr.depth_vert,
                        fragmentShader: Cr.depth_frag
                    },
                    normal: {
                        uniforms: Fe([Lr.common, Lr.bumpmap, Lr.normalmap, Lr.displacementmap, {
                            opacity: {
                                value: 1
                            }
                        }]),
                        vertexShader: Cr.normal_vert,
                        fragmentShader: Cr.normal_frag
                    },
                    sprite: {
                        uniforms: Fe([Lr.sprite, Lr.fog]),
                        vertexShader: Cr.sprite_vert,
                        fragmentShader: Cr.sprite_frag
                    },
                    background: {
                        uniforms: {
                            uvTransform: {
                                value: new q
                            },
                            t2D: {
                                value: null
                            }
                        },
                        vertexShader: Cr.background_vert,
                        fragmentShader: Cr.background_frag
                    },
                    cube: {
                        uniforms: Fe([Lr.envmap, {
                            opacity: {
                                value: 1
                            }
                        }]),
                        vertexShader: Cr.cube_vert,
                        fragmentShader: Cr.cube_frag
                    },
                    equirect: {
                        uniforms: {
                            tEquirect: {
                                value: null
                            }
                        },
                        vertexShader: Cr.equirect_vert,
                        fragmentShader: Cr.equirect_frag
                    },
                    distanceRGBA: {
                        uniforms: Fe([Lr.common, Lr.displacementmap, {
                            referencePosition: {
                                value: new w
                            },
                            nearDistance: {
                                value: 1
                            },
                            farDistance: {
                                value: 1e3
                            }
                        }]),
                        vertexShader: Cr.distanceRGBA_vert,
                        fragmentShader: Cr.distanceRGBA_frag
                    },
                    shadow: {
                        uniforms: Fe([Lr.lights, Lr.fog, {
                            color: {
                                value: new vt(0)
                            },
                            opacity: {
                                value: 1
                            }
                        }]),
                        vertexShader: Cr.shadow_vert,
                        fragmentShader: Cr.shadow_frag
                    }
                };
                function kr(e, t, i, r, n) {
                    var a, o, s = new vt(0), l = 0, u = null, c = 0, h = null;
                    function p(e, t) {
                        i.buffers.color.setClear(e.r, e.g, e.b, t, n)
                    }
                    return {
                        getClearColor: function() {
                            return s
                        },
                        setClearColor: function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1;
                            s.set(e),
                            p(s, l = t)
                        },
                        getClearAlpha: function() {
                            return l
                        },
                        setClearAlpha: function(e) {
                            p(s, l = e)
                        },
                        render: function(i, n, f, d) {
                            var m = !0 === n.isScene ? n.background : null;
                            m && m.isTexture && (m = t.get(m));
                            var v = e.xr
                              , g = v.getSession && v.getSession();
                            g && "additive" === g.environmentBlendMode && (m = null),
                            null === m ? p(s, l) : m && m.isColor && (p(m, 1),
                            d = !0),
                            (e.autoClear || d) && e.clear(e.autoClearColor, e.autoClearDepth, e.autoClearStencil),
                            m && (m.isCubeTexture || m.isWebGLCubeRenderTarget || 306 === m.mapping) ? (void 0 === o && ((o = new Hi(new Kt(1,1,1),new Ue({
                                name: "BackgroundCubeMaterial",
                                uniforms: Be(Ir.cube.uniforms),
                                vertexShader: Ir.cube.vertexShader,
                                fragmentShader: Ir.cube.fragmentShader,
                                side: 1,
                                depthTest: !1,
                                depthWrite: !1,
                                fog: !1
                            }))).geometry.deleteAttribute("normal"),
                            o.geometry.deleteAttribute("uv"),
                            o.onBeforeRender = function(e, t, i) {
                                this.matrixWorld.copyPosition(i.matrixWorld)
                            }
                            ,
                            Object.defineProperty(o.material, "envMap", {
                                get: function() {
                                    return this.uniforms.envMap.value
                                }
                            }),
                            r.update(o)),
                            m.isWebGLCubeRenderTarget && (m = m.texture),
                            o.material.uniforms.envMap.value = m,
                            o.material.uniforms.flipEnvMap.value = m.isCubeTexture && m._needsFlipEnvMap ? -1 : 1,
                            u === m && c === m.version && h === e.toneMapping || (o.material.needsUpdate = !0,
                            u = m,
                            c = m.version,
                            h = e.toneMapping),
                            i.unshift(o, o.geometry, o.material, 0, 0, null)) : m && m.isTexture && (void 0 === a && ((a = new Hi(new Pr(2,2),new Ue({
                                name: "BackgroundMaterial",
                                uniforms: Be(Ir.background.uniforms),
                                vertexShader: Ir.background.vertexShader,
                                fragmentShader: Ir.background.fragmentShader,
                                side: 0,
                                depthTest: !1,
                                depthWrite: !1,
                                fog: !1
                            }))).geometry.deleteAttribute("normal"),
                            Object.defineProperty(a.material, "map", {
                                get: function() {
                                    return this.uniforms.t2D.value
                                }
                            }),
                            r.update(a)),
                            a.material.uniforms.t2D.value = m,
                            !0 === m.matrixAutoUpdate && m.updateMatrix(),
                            a.material.uniforms.uvTransform.value.copy(m.matrix),
                            u === m && c === m.version && h === e.toneMapping || (a.material.needsUpdate = !0,
                            u = m,
                            c = m.version,
                            h = e.toneMapping),
                            i.unshift(a, a.geometry, a.material, 0, 0, null))
                        }
                    }
                }
                function zr(e, t, i, r) {
                    var n = e.getParameter(34921)
                      , a = r.isWebGL2 ? null : t.get("OES_vertex_array_object")
                      , o = r.isWebGL2 || null !== a
                      , s = {}
                      , l = p(null)
                      , u = l;
                    function c(t) {
                        return r.isWebGL2 ? e.bindVertexArray(t) : a.bindVertexArrayOES(t)
                    }
                    function h(t) {
                        return r.isWebGL2 ? e.deleteVertexArray(t) : a.deleteVertexArrayOES(t)
                    }
                    function p(e) {
                        for (var t = [], i = [], r = [], a = 0; a < n; a++)
                            t[a] = 0,
                            i[a] = 0,
                            r[a] = 0;
                        return {
                            geometry: null,
                            program: null,
                            wireframe: !1,
                            newAttributes: t,
                            enabledAttributes: i,
                            attributeDivisors: r,
                            object: e,
                            attributes: {},
                            index: null
                        }
                    }
                    function f() {
                        for (var e = u.newAttributes, t = 0, i = e.length; t < i; t++)
                            e[t] = 0
                    }
                    function d(e) {
                        m(e, 0)
                    }
                    function m(i, n) {
                        var a = u.newAttributes
                          , o = u.enabledAttributes
                          , s = u.attributeDivisors;
                        a[i] = 1,
                        0 === o[i] && (e.enableVertexAttribArray(i),
                        o[i] = 1),
                        s[i] !== n && ((r.isWebGL2 ? e : t.get("ANGLE_instanced_arrays"))[r.isWebGL2 ? "vertexAttribDivisor" : "vertexAttribDivisorANGLE"](i, n),
                        s[i] = n)
                    }
                    function v() {
                        for (var t = u.newAttributes, i = u.enabledAttributes, r = 0, n = i.length; r < n; r++)
                            i[r] !== t[r] && (e.disableVertexAttribArray(r),
                            i[r] = 0)
                    }
                    function g(t, i, n, a, o, s) {
                        !0 !== r.isWebGL2 || 5124 !== n && 5125 !== n ? e.vertexAttribPointer(t, i, n, a, o, s) : e.vertexAttribIPointer(t, i, n, o, s)
                    }
                    function y() {
                        _(),
                        u !== l && c((u = l).object)
                    }
                    function _() {
                        l.geometry = null,
                        l.program = null,
                        l.wireframe = !1
                    }
                    return {
                        setup: function(n, l, h, y, _) {
                            var x = !1;
                            if (o) {
                                var b = function(t, i, n) {
                                    var o = !0 === n.wireframe
                                      , l = s[t.id];
                                    void 0 === l && (l = {},
                                    s[t.id] = l);
                                    var u = l[i.id];
                                    void 0 === u && (u = {},
                                    l[i.id] = u);
                                    var c = u[o];
                                    return void 0 === c && (c = p(r.isWebGL2 ? e.createVertexArray() : a.createVertexArrayOES()),
                                    u[o] = c),
                                    c
                                }(y, h, l);
                                u !== b && c((u = b).object),
                                (x = function(e, t) {
                                    var i = u.attributes
                                      , r = e.attributes
                                      , n = 0;
                                    for (var a in r) {
                                        var o = i[a]
                                          , s = r[a];
                                        if (void 0 === o)
                                            return !0;
                                        if (o.attribute !== s)
                                            return !0;
                                        if (o.data !== s.data)
                                            return !0;
                                        n++
                                    }
                                    return u.attributesNum !== n || u.index !== t
                                }(y, _)) && function(e, t) {
                                    var i = {}
                                      , r = e.attributes
                                      , n = 0;
                                    for (var a in r) {
                                        var o = r[a]
                                          , s = {};
                                        s.attribute = o,
                                        o.data && (s.data = o.data),
                                        i[a] = s,
                                        n++
                                    }
                                    u.attributes = i,
                                    u.attributesNum = n,
                                    u.index = t
                                }(y, _)
                            } else {
                                var w = !0 === l.wireframe;
                                u.geometry === y.id && u.program === h.id && u.wireframe === w || (u.geometry = y.id,
                                u.program = h.id,
                                u.wireframe = w,
                                x = !0)
                            }
                            !0 === n.isInstancedMesh && (x = !0),
                            null !== _ && i.update(_, 34963),
                            x && (function(n, a, o, s) {
                                if (!1 !== r.isWebGL2 || !n.isInstancedMesh && !s.isInstancedBufferGeometry || null !== t.get("ANGLE_instanced_arrays")) {
                                    f();
                                    var l = s.attributes
                                      , u = o.getAttributes()
                                      , c = a.defaultAttributeValues;
                                    for (var h in u) {
                                        var p = u[h];
                                        if (p >= 0) {
                                            var y = l[h];
                                            if (void 0 !== y) {
                                                var _ = y.normalized
                                                  , x = y.itemSize
                                                  , b = i.get(y);
                                                if (void 0 === b)
                                                    continue;
                                                var w = b.buffer
                                                  , S = b.type
                                                  , M = b.bytesPerElement;
                                                if (y.isInterleavedBufferAttribute) {
                                                    var T = y.data
                                                      , E = T.stride
                                                      , A = y.offset;
                                                    T && T.isInstancedInterleavedBuffer ? (m(p, T.meshPerAttribute),
                                                    void 0 === s._maxInstanceCount && (s._maxInstanceCount = T.meshPerAttribute * T.count)) : d(p),
                                                    e.bindBuffer(34962, w),
                                                    g(p, x, S, _, E * M, A * M)
                                                } else
                                                    y.isInstancedBufferAttribute ? (m(p, y.meshPerAttribute),
                                                    void 0 === s._maxInstanceCount && (s._maxInstanceCount = y.meshPerAttribute * y.count)) : d(p),
                                                    e.bindBuffer(34962, w),
                                                    g(p, x, S, _, 0, 0)
                                            } else if ("instanceMatrix" === h) {
                                                var P = i.get(n.instanceMatrix);
                                                if (void 0 === P)
                                                    continue;
                                                var C = P.buffer
                                                  , L = P.type;
                                                m(p + 0, 1),
                                                m(p + 1, 1),
                                                m(p + 2, 1),
                                                m(p + 3, 1),
                                                e.bindBuffer(34962, C),
                                                e.vertexAttribPointer(p + 0, 4, L, !1, 64, 0),
                                                e.vertexAttribPointer(p + 1, 4, L, !1, 64, 16),
                                                e.vertexAttribPointer(p + 2, 4, L, !1, 64, 32),
                                                e.vertexAttribPointer(p + 3, 4, L, !1, 64, 48)
                                            } else if ("instanceColor" === h) {
                                                var I = i.get(n.instanceColor);
                                                if (void 0 === I)
                                                    continue;
                                                var k = I.buffer
                                                  , z = I.type;
                                                m(p, 1),
                                                e.bindBuffer(34962, k),
                                                e.vertexAttribPointer(p, 3, z, !1, 12, 0)
                                            } else if (void 0 !== c) {
                                                var D = c[h];
                                                if (void 0 !== D)
                                                    switch (D.length) {
                                                    case 2:
                                                        e.vertexAttrib2fv(p, D);
                                                        break;
                                                    case 3:
                                                        e.vertexAttrib3fv(p, D);
                                                        break;
                                                    case 4:
                                                        e.vertexAttrib4fv(p, D);
                                                        break;
                                                    default:
                                                        e.vertexAttrib1fv(p, D)
                                                    }
                                            }
                                        }
                                    }
                                    v()
                                }
                            }(n, l, h, y),
                            null !== _ && e.bindBuffer(34963, i.get(_).buffer))
                        },
                        reset: y,
                        resetDefaultState: _,
                        dispose: function() {
                            for (var e in y(),
                            s) {
                                var t = s[e];
                                for (var i in t) {
                                    var r = t[i];
                                    for (var n in r)
                                        h(r[n].object),
                                        delete r[n];
                                    delete t[i]
                                }
                                delete s[e]
                            }
                        },
                        releaseStatesOfGeometry: function(e) {
                            if (void 0 !== s[e.id]) {
                                var t = s[e.id];
                                for (var i in t) {
                                    var r = t[i];
                                    for (var n in r)
                                        h(r[n].object),
                                        delete r[n];
                                    delete t[i]
                                }
                                delete s[e.id]
                            }
                        },
                        releaseStatesOfProgram: function(e) {
                            for (var t in s) {
                                var i = s[t];
                                if (void 0 !== i[e.id]) {
                                    var r = i[e.id];
                                    for (var n in r)
                                        h(r[n].object),
                                        delete r[n];
                                    delete i[e.id]
                                }
                            }
                        },
                        initAttributes: f,
                        enableAttribute: d,
                        disableUnusedAttributes: v
                    }
                }
                function Dr(e, t, i, r) {
                    var n, a = r.isWebGL2;
                    this.setMode = function(e) {
                        n = e
                    }
                    ,
                    this.render = function(t, r) {
                        e.drawArrays(n, t, r),
                        i.update(r, n, 1)
                    }
                    ,
                    this.renderInstances = function(r, o, s) {
                        if (0 !== s) {
                            var l, u;
                            if (a)
                                l = e,
                                u = "drawArraysInstanced";
                            else if (u = "drawArraysInstancedANGLE",
                            null === (l = t.get("ANGLE_instanced_arrays")))
                                return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
                            l[u](n, r, o, s),
                            i.update(o, n, s)
                        }
                    }
                }
                function Rr(e, t, i) {
                    var r;
                    function n(t) {
                        if ("highp" === t) {
                            if (e.getShaderPrecisionFormat(35633, 36338).precision > 0 && e.getShaderPrecisionFormat(35632, 36338).precision > 0)
                                return "highp";
                            t = "mediump"
                        }
                        return "mediump" === t && e.getShaderPrecisionFormat(35633, 36337).precision > 0 && e.getShaderPrecisionFormat(35632, 36337).precision > 0 ? "mediump" : "lowp"
                    }
                    var a = "undefined" != typeof WebGL2RenderingContext && e instanceof WebGL2RenderingContext || "undefined" != typeof WebGL2ComputeRenderingContext && e instanceof WebGL2ComputeRenderingContext
                      , o = void 0 !== i.precision ? i.precision : "highp"
                      , s = n(o);
                    s !== o && (console.warn("THREE.WebGLRenderer:", o, "not supported, using", s, "instead."),
                    o = s);
                    var l = !0 === i.logarithmicDepthBuffer
                      , u = e.getParameter(34930)
                      , c = e.getParameter(35660)
                      , h = e.getParameter(3379)
                      , p = e.getParameter(34076)
                      , f = e.getParameter(34921)
                      , d = e.getParameter(36347)
                      , m = e.getParameter(36348)
                      , v = e.getParameter(36349)
                      , g = c > 0
                      , y = a || !!t.get("OES_texture_float");
                    return {
                        isWebGL2: a,
                        getMaxAnisotropy: function() {
                            if (void 0 !== r)
                                return r;
                            var i = t.get("EXT_texture_filter_anisotropic");
                            return r = null !== i ? e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0
                        },
                        getMaxPrecision: n,
                        precision: o,
                        logarithmicDepthBuffer: l,
                        maxTextures: u,
                        maxVertexTextures: c,
                        maxTextureSize: h,
                        maxCubemapSize: p,
                        maxAttributes: f,
                        maxVertexUniforms: d,
                        maxVaryings: m,
                        maxFragmentUniforms: v,
                        vertexTextures: g,
                        floatFragmentTextures: y,
                        floatVertexTextures: g && y,
                        maxSamples: a ? e.getParameter(36183) : 0
                    }
                }
                function Or(e) {
                    var t = this
                      , i = null
                      , r = 0
                      , n = !1
                      , a = !1
                      , o = new ci
                      , s = new q
                      , l = {
                        value: null,
                        needsUpdate: !1
                    };
                    function u() {
                        l.value !== i && (l.value = i,
                        l.needsUpdate = r > 0),
                        t.numPlanes = r,
                        t.numIntersection = 0
                    }
                    function c(e, i, r, n) {
                        var a = null !== e ? e.length : 0
                          , u = null;
                        if (0 !== a) {
                            if (u = l.value,
                            !0 !== n || null === u) {
                                var c = r + 4 * a
                                  , h = i.matrixWorldInverse;
                                s.getNormalMatrix(h),
                                (null === u || u.length < c) && (u = new Float32Array(c));
                                for (var p = 0, f = r; p !== a; ++p,
                                f += 4)
                                    o.copy(e[p]).applyMatrix4(h, s),
                                    o.normal.toArray(u, f),
                                    u[f + 3] = o.constant
                            }
                            l.value = u,
                            l.needsUpdate = !0
                        }
                        return t.numPlanes = a,
                        t.numIntersection = 0,
                        u
                    }
                    this.uniform = l,
                    this.numPlanes = 0,
                    this.numIntersection = 0,
                    this.init = function(e, t, a) {
                        var o = 0 !== e.length || t || 0 !== r || n;
                        return n = t,
                        i = c(e, a, 0),
                        r = e.length,
                        o
                    }
                    ,
                    this.beginShadows = function() {
                        a = !0,
                        c(null)
                    }
                    ,
                    this.endShadows = function() {
                        a = !1,
                        u()
                    }
                    ,
                    this.setState = function(t, o, s) {
                        var h = t.clippingPlanes
                          , p = t.clipIntersection
                          , f = t.clipShadows
                          , d = e.get(t);
                        if (!n || null === h || 0 === h.length || a && !f)
                            a ? c(null) : u();
                        else {
                            var m = a ? 0 : r
                              , v = 4 * m
                              , g = d.clippingState || null;
                            l.value = g,
                            g = c(h, o, v, s);
                            for (var y = 0; y !== v; ++y)
                                g[y] = i[y];
                            d.clippingState = g,
                            this.numIntersection = p ? this.numPlanes : 0,
                            this.numPlanes += m
                        }
                    }
                }
                function Br(e, t, i) {
                    this.width = e,
                    this.height = t,
                    this.scissor = new at(0,0,e,t),
                    this.scissorTest = !1,
                    this.viewport = new at(0,0,e,t),
                    i = i || {},
                    this.texture = new dr(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),
                    this.texture.image = {},
                    this.texture.image.width = e,
                    this.texture.image.height = t,
                    this.texture.generateMipmaps = void 0 !== i.generateMipmaps && i.generateMipmaps,
                    this.texture.minFilter = void 0 !== i.minFilter ? i.minFilter : xe,
                    this.depthBuffer = void 0 === i.depthBuffer || i.depthBuffer,
                    this.stencilBuffer = void 0 !== i.stencilBuffer && i.stencilBuffer,
                    this.depthTexture = void 0 !== i.depthTexture ? i.depthTexture : null
                }
                function Fr() {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 50
                      , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1
                      , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : .1
                      , r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 2e3;
                    oe.call(this),
                    this.type = "PerspectiveCamera",
                    this.fov = e,
                    this.zoom = 1,
                    this.near = i,
                    this.far = r,
                    this.focus = 10,
                    this.aspect = t,
                    this.view = null,
                    this.filmGauge = 35,
                    this.filmOffset = 0,
                    this.updateProjectionMatrix()
                }
                Ir.physical = {
                    uniforms: Fe([Ir.standard.uniforms, {
                        clearcoat: {
                            value: 0
                        },
                        clearcoatMap: {
                            value: null
                        },
                        clearcoatRoughness: {
                            value: 0
                        },
                        clearcoatRoughnessMap: {
                            value: null
                        },
                        clearcoatNormalScale: {
                            value: new lt(1,1)
                        },
                        clearcoatNormalMap: {
                            value: null
                        },
                        sheen: {
                            value: new vt(0)
                        },
                        transmission: {
                            value: 0
                        },
                        transmissionMap: {
                            value: null
                        }
                    }]),
                    vertexShader: Cr.meshphysical_vert,
                    fragmentShader: Cr.meshphysical_frag
                },
                Br.prototype = Object.assign(Object.create(R.prototype), {
                    constructor: Br,
                    isWebGLRenderTarget: !0,
                    setSize: function(e, t) {
                        this.width === e && this.height === t || (this.width = e,
                        this.height = t,
                        this.texture.image.width = e,
                        this.texture.image.height = t,
                        this.dispose()),
                        this.viewport.set(0, 0, e, t),
                        this.scissor.set(0, 0, e, t)
                    },
                    clone: function() {
                        return (new this.constructor).copy(this)
                    },
                    copy: function(e) {
                        return this.width = e.width,
                        this.height = e.height,
                        this.viewport.copy(e.viewport),
                        this.texture = e.texture.clone(),
                        this.depthBuffer = e.depthBuffer,
                        this.stencilBuffer = e.stencilBuffer,
                        this.depthTexture = e.depthTexture,
                        this
                    },
                    dispose: function() {
                        this.dispatchEvent({
                            type: "dispose"
                        })
                    }
                }),
                Fr.prototype = Object.assign(Object.create(oe.prototype), {
                    constructor: Fr,
                    isPerspectiveCamera: !0,
                    copy: function(e, t) {
                        return oe.prototype.copy.call(this, e, t),
                        this.fov = e.fov,
                        this.zoom = e.zoom,
                        this.near = e.near,
                        this.far = e.far,
                        this.focus = e.focus,
                        this.aspect = e.aspect,
                        this.view = null === e.view ? null : Object.assign({}, e.view),
                        this.filmGauge = e.filmGauge,
                        this.filmOffset = e.filmOffset,
                        this
                    },
                    setFocalLength: function(e) {
                        var t = .5 * this.getFilmHeight() / e;
                        this.fov = 2 * v.RAD2DEG * Math.atan(t),
                        this.updateProjectionMatrix()
                    },
                    getFocalLength: function() {
                        var e = Math.tan(.5 * v.DEG2RAD * this.fov);
                        return .5 * this.getFilmHeight() / e
                    },
                    getEffectiveFOV: function() {
                        return 2 * v.RAD2DEG * Math.atan(Math.tan(.5 * v.DEG2RAD * this.fov) / this.zoom)
                    },
                    getFilmWidth: function() {
                        return this.filmGauge * Math.min(this.aspect, 1)
                    },
                    getFilmHeight: function() {
                        return this.filmGauge / Math.max(this.aspect, 1)
                    },
                    setViewOffset: function(e, t, i, r, n, a) {
                        this.aspect = e / t,
                        null === this.view && (this.view = {
                            enabled: !0,
                            fullWidth: 1,
                            fullHeight: 1,
                            offsetX: 0,
                            offsetY: 0,
                            width: 1,
                            height: 1
                        }),
                        this.view.enabled = !0,
                        this.view.fullWidth = e,
                        this.view.fullHeight = t,
                        this.view.offsetX = i,
                        this.view.offsetY = r,
                        this.view.width = n,
                        this.view.height = a,
                        this.updateProjectionMatrix()
                    },
                    clearViewOffset: function() {
                        null !== this.view && (this.view.enabled = !1),
                        this.updateProjectionMatrix()
                    },
                    updateProjectionMatrix: function() {
                        var e = this.near
                          , t = e * Math.tan(.5 * v.DEG2RAD * this.fov) / this.zoom
                          , i = 2 * t
                          , r = this.aspect * i
                          , n = -.5 * r
                          , a = this.view;
                        if (null !== this.view && this.view.enabled) {
                            var o = a.fullWidth
                              , s = a.fullHeight;
                            n += a.offsetX * r / o,
                            t -= a.offsetY * i / s,
                            r *= a.width / o,
                            i *= a.height / s
                        }
                        var l = this.filmOffset;
                        0 !== l && (n += e * l / this.getFilmWidth()),
                        this.projectionMatrix.makePerspective(n, n + r, t, t - i, e, this.far),
                        this.projectionMatrixInverse.copy(this.projectionMatrix).invert()
                    },
                    toJSON: function(e) {
                        var t = ae.prototype.toJSON.call(this, e);
                        return t.object.fov = this.fov,
                        t.object.zoom = this.zoom,
                        t.object.near = this.near,
                        t.object.far = this.far,
                        t.object.focus = this.focus,
                        t.object.aspect = this.aspect,
                        null !== this.view && (t.object.view = Object.assign({}, this.view)),
                        t.object.filmGauge = this.filmGauge,
                        t.object.filmOffset = this.filmOffset,
                        t
                    }
                });
                var Nr = 90;
                function Ur(e, t, i) {
                    if (ae.call(this),
                    this.type = "CubeCamera",
                    !0 === i.isWebGLCubeRenderTarget) {
                        this.renderTarget = i;
                        var r = new Fr(Nr,1,e,t);
                        r.layers = this.layers,
                        r.up.set(0, -1, 0),
                        r.lookAt(new w(1,0,0)),
                        this.add(r);
                        var n = new Fr(Nr,1,e,t);
                        n.layers = this.layers,
                        n.up.set(0, -1, 0),
                        n.lookAt(new w(-1,0,0)),
                        this.add(n);
                        var a = new Fr(Nr,1,e,t);
                        a.layers = this.layers,
                        a.up.set(0, 0, 1),
                        a.lookAt(new w(0,1,0)),
                        this.add(a);
                        var o = new Fr(Nr,1,e,t);
                        o.layers = this.layers,
                        o.up.set(0, 0, -1),
                        o.lookAt(new w(0,-1,0)),
                        this.add(o);
                        var s = new Fr(Nr,1,e,t);
                        s.layers = this.layers,
                        s.up.set(0, -1, 0),
                        s.lookAt(new w(0,0,1)),
                        this.add(s);
                        var l = new Fr(Nr,1,e,t);
                        l.layers = this.layers,
                        l.up.set(0, -1, 0),
                        l.lookAt(new w(0,0,-1)),
                        this.add(l),
                        this.update = function(e, t) {
                            null === this.parent && this.updateMatrixWorld();
                            var u = e.xr.enabled
                              , c = e.getRenderTarget();
                            e.xr.enabled = !1;
                            var h = i.texture.generateMipmaps;
                            i.texture.generateMipmaps = !1,
                            e.setRenderTarget(i, 0),
                            e.render(t, r),
                            e.setRenderTarget(i, 1),
                            e.render(t, n),
                            e.setRenderTarget(i, 2),
                            e.render(t, a),
                            e.setRenderTarget(i, 3),
                            e.render(t, o),
                            e.setRenderTarget(i, 4),
                            e.render(t, s),
                            i.texture.generateMipmaps = h,
                            e.setRenderTarget(i, 5),
                            e.render(t, l),
                            e.setRenderTarget(c),
                            e.xr.enabled = u
                        }
                    } else
                        console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.")
                }
                function Vr(e, t, i, r, n, a, o, s, l, u) {
                    e = void 0 !== e ? e : [],
                    t = void 0 !== t ? t : 301,
                    o = void 0 !== o ? o : Pe,
                    dr.call(this, e, t, i, r, n, a, o, s, l, u),
                    this.flipY = !1,
                    this._needsFlipEnvMap = !0
                }
                function Gr(e, t, i) {
                    Number.isInteger(t) && (console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),
                    t = i),
                    Br.call(this, e, e, t),
                    t = t || {},
                    this.texture = new Vr(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),
                    this.texture._needsFlipEnvMap = !1
                }
                function jr(e) {
                    var t = new WeakMap;
                    function i(e, t) {
                        return 303 === t ? e.mapping = 301 : 304 === t && (e.mapping = 302),
                        e
                    }
                    function r(e) {
                        var i = e.target;
                        i.removeEventListener("dispose", r);
                        var n = t.get(i);
                        void 0 !== n && (t.delete(i),
                        n.dispose())
                    }
                    return {
                        get: function(n) {
                            if (n && n.isTexture) {
                                var a = n.mapping;
                                if (303 === a || 304 === a) {
                                    if (t.has(n))
                                        return i(t.get(n).texture, n.mapping);
                                    var o = n.image;
                                    if (o && o.height > 0) {
                                        var s = e.getRenderList()
                                          , l = e.getRenderTarget()
                                          , u = new Gr(o.height / 2);
                                        return u.fromEquirectangularTexture(e, n),
                                        t.set(n, u),
                                        e.setRenderTarget(l),
                                        e.setRenderList(s),
                                        n.addEventListener("dispose", r),
                                        i(u.texture, n.mapping)
                                    }
                                    return null
                                }
                            }
                            return n
                        },
                        dispose: function() {
                            t = new WeakMap
                        }
                    }
                }
                function Hr(e) {
                    var t = {};
                    return {
                        has: function(i) {
                            if (void 0 !== t[i])
                                return null !== t[i];
                            var r;
                            switch (i) {
                            case "WEBGL_depth_texture":
                                r = e.getExtension("WEBGL_depth_texture") || e.getExtension("MOZ_WEBGL_depth_texture") || e.getExtension("WEBKIT_WEBGL_depth_texture");
                                break;
                            case "EXT_texture_filter_anisotropic":
                                r = e.getExtension("EXT_texture_filter_anisotropic") || e.getExtension("MOZ_EXT_texture_filter_anisotropic") || e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
                                break;
                            case "WEBGL_compressed_texture_s3tc":
                                r = e.getExtension("WEBGL_compressed_texture_s3tc") || e.getExtension("MOZ_WEBGL_compressed_texture_s3tc") || e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
                                break;
                            case "WEBGL_compressed_texture_pvrtc":
                                r = e.getExtension("WEBGL_compressed_texture_pvrtc") || e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
                                break;
                            default:
                                r = e.getExtension(i)
                            }
                            return t[i] = r,
                            null !== r
                        },
                        get: function(e) {
                            return this.has(e) || console.warn("THREE.WebGLRenderer: " + e + " extension not supported."),
                            t[e]
                        }
                    }
                }
                function qr(e, t, i, r) {
                    var n = new WeakMap
                      , a = new WeakMap;
                    function o(e) {
                        var s = e.target
                          , l = n.get(s);
                        for (var u in null !== l.index && t.remove(l.index),
                        l.attributes)
                            t.remove(l.attributes[u]);
                        s.removeEventListener("dispose", o),
                        n.delete(s);
                        var c = a.get(l);
                        c && (t.remove(c),
                        a.delete(l)),
                        r.releaseStatesOfGeometry(l),
                        !0 === s.isInstancedBufferGeometry && delete s._maxInstanceCount,
                        i.memory.geometries--
                    }
                    function s(e) {
                        var i = []
                          , r = e.index
                          , n = e.attributes.position
                          , o = 0;
                        if (null !== r) {
                            var s = r.array;
                            o = r.version;
                            for (var l = 0, u = s.length; l < u; l += 3) {
                                var c = s[l + 0]
                                  , h = s[l + 1]
                                  , p = s[l + 2];
                                i.push(c, h, h, p, p, c)
                            }
                        } else {
                            var f = n.array;
                            o = n.version;
                            for (var d = 0, m = f.length / 3 - 1; d < m; d += 3) {
                                var v = d + 0
                                  , g = d + 1
                                  , y = d + 2;
                                i.push(v, g, g, y, y, v)
                            }
                        }
                        var _ = new (Rt(i) > 65535 ? Et : Mt)(i,1);
                        _.version = o;
                        var x = a.get(e);
                        x && t.remove(x),
                        a.set(e, _)
                    }
                    return {
                        get: function(e, t) {
                            var r = n.get(t);
                            return r || (t.addEventListener("dispose", o),
                            t.isBufferGeometry ? r = t : t.isGeometry && (void 0 === t._bufferGeometry && (t._bufferGeometry = (new jt).setFromObject(e)),
                            r = t._bufferGeometry),
                            n.set(t, r),
                            i.memory.geometries++,
                            r)
                        },
                        update: function(e) {
                            var i = e.attributes;
                            for (var r in i)
                                t.update(i[r], 34962);
                            var n = e.morphAttributes;
                            for (var a in n)
                                for (var o = n[a], s = 0, l = o.length; s < l; s++)
                                    t.update(o[s], 34962)
                        },
                        getWireframeAttribute: function(e) {
                            var t = a.get(e);
                            if (t) {
                                var i = e.index;
                                null !== i && t.version < i.version && s(e)
                            } else
                                s(e);
                            return a.get(e)
                        }
                    }
                }
                function Wr(e, t, i, r) {
                    var n, a, o, s = r.isWebGL2;
                    this.setMode = function(e) {
                        n = e
                    }
                    ,
                    this.setIndex = function(e) {
                        a = e.type,
                        o = e.bytesPerElement
                    }
                    ,
                    this.render = function(t, r) {
                        e.drawElements(n, r, a, t * o),
                        i.update(r, n, 1)
                    }
                    ,
                    this.renderInstances = function(r, l, u) {
                        if (0 !== u) {
                            var c, h;
                            if (s)
                                c = e,
                                h = "drawElementsInstanced";
                            else if (h = "drawElementsInstancedANGLE",
                            null === (c = t.get("ANGLE_instanced_arrays")))
                                return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
                            c[h](n, l, a, r * o, u),
                            i.update(l, n, u)
                        }
                    }
                }
                function Zr(e) {
                    var t = {
                        frame: 0,
                        calls: 0,
                        triangles: 0,
                        points: 0,
                        lines: 0
                    };
                    return {
                        memory: {
                            geometries: 0,
                            textures: 0
                        },
                        render: t,
                        programs: null,
                        autoReset: !0,
                        reset: function() {
                            t.frame++,
                            t.calls = 0,
                            t.triangles = 0,
                            t.points = 0,
                            t.lines = 0
                        },
                        update: function(e, i, r) {
                            switch (t.calls++,
                            i) {
                            case 4:
                                t.triangles += r * (e / 3);
                                break;
                            case 1:
                                t.lines += r * (e / 2);
                                break;
                            case 3:
                                t.lines += r * (e - 1);
                                break;
                            case 2:
                                t.lines += r * e;
                                break;
                            case 0:
                                t.points += r * e;
                                break;
                            default:
                                console.error("THREE.WebGLInfo: Unknown draw mode:", i)
                            }
                        }
                    }
                }
                function Xr(e, t) {
                    return e[0] - t[0]
                }
                function Yr(e, t) {
                    return Math.abs(t[1]) - Math.abs(e[1])
                }
                function Kr(e) {
                    for (var t = {}, i = new Float32Array(8), r = [], n = 0; n < 8; n++)
                        r[n] = [n, 0];
                    return {
                        update: function(n, a, o, s) {
                            var l = n.morphTargetInfluences
                              , u = void 0 === l ? 0 : l.length
                              , c = t[a.id];
                            if (void 0 === c) {
                                c = [];
                                for (var h = 0; h < u; h++)
                                    c[h] = [h, 0];
                                t[a.id] = c
                            }
                            for (var p = 0; p < u; p++) {
                                var f = c[p];
                                f[0] = p,
                                f[1] = l[p]
                            }
                            c.sort(Yr);
                            for (var d = 0; d < 8; d++)
                                d < u && c[d][1] ? (r[d][0] = c[d][0],
                                r[d][1] = c[d][1]) : (r[d][0] = Number.MAX_SAFE_INTEGER,
                                r[d][1] = 0);
                            r.sort(Xr);
                            for (var m = o.morphTargets && a.morphAttributes.position, v = o.morphNormals && a.morphAttributes.normal, g = 0, y = 0; y < 8; y++) {
                                var _ = r[y]
                                  , x = _[0]
                                  , b = _[1];
                                x !== Number.MAX_SAFE_INTEGER && b ? (m && a.getAttribute("morphTarget" + y) !== m[x] && a.setAttribute("morphTarget" + y, m[x]),
                                v && a.getAttribute("morphNormal" + y) !== v[x] && a.setAttribute("morphNormal" + y, v[x]),
                                i[y] = b,
                                g += b) : (m && !0 === a.hasAttribute("morphTarget" + y) && a.deleteAttribute("morphTarget" + y),
                                v && !0 === a.hasAttribute("morphNormal" + y) && a.deleteAttribute("morphNormal" + y),
                                i[y] = 0)
                            }
                            var w = a.morphTargetsRelative ? 1 : 1 - g;
                            s.getUniforms().setValue(e, "morphTargetBaseInfluence", w),
                            s.getUniforms().setValue(e, "morphTargetInfluences", i)
                        }
                    }
                }
                function Jr(e, t, i, r) {
                    var n = new WeakMap;
                    function a(e) {
                        var t = e.target;
                        t.removeEventListener("dispose", a),
                        i.remove(t.instanceMatrix),
                        null !== t.instanceColor && i.remove(t.instanceColor)
                    }
                    return {
                        update: function(e) {
                            var o = r.render.frame
                              , s = e.geometry
                              , l = t.get(e, s);
                            return n.get(l) !== o && (s.isGeometry && l.updateFromObject(e),
                            t.update(l),
                            n.set(l, o)),
                            e.isInstancedMesh && (!1 === e.hasEventListener("dispose", a) && e.addEventListener("dispose", a),
                            i.update(e.instanceMatrix, 34962),
                            null !== e.instanceColor && i.update(e.instanceColor, 34962)),
                            l
                        },
                        dispose: function() {
                            n = new WeakMap
                        }
                    }
                }
                function Qr() {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null
                      , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1
                      , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1
                      , r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
                    dr.call(this, null),
                    this.image = {
                        data: e,
                        width: t,
                        height: i,
                        depth: r
                    },
                    this.magFilter = _e,
                    this.minFilter = _e,
                    this.wrapR = ge,
                    this.generateMipmaps = !1,
                    this.flipY = !1,
                    this.needsUpdate = !0
                }
                function $r() {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null
                      , t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1
                      , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1
                      , r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
                    dr.call(this, null),
                    this.image = {
                        data: e,
                        width: t,
                        height: i,
                        depth: r
                    },
                    this.magFilter = _e,
                    this.minFilter = _e,
                    this.wrapR = ge,
                    this.generateMipmaps = !1,
                    this.flipY = !1,
                    this.needsUpdate = !0
                }
                Ur.prototype = Object.create(ae.prototype),
                Ur.prototype.constructor = Ur,
                Vr.prototype = Object.create(dr.prototype),
                Vr.prototype.constructor = Vr,
                Vr.prototype.isCubeTexture = !0,
                Object.defineProperty(Vr.prototype, "images", {
                    get: function() {
                        return this.image
                    },
                    set: function(e) {
                        this.image = e
                    }
                }),
                Gr.prototype = Object.create(Br.prototype),
                Gr.prototype.constructor = Gr,
                Gr.prototype.isWebGLCubeRenderTarget = !0,
                Gr.prototype.fromEquirectangularTexture = function(e, t) {
                    this.texture.type = t.type,
                    this.texture.format = Ce,
                    this.texture.encoding = t.encoding,
                    this.texture.generateMipmaps = t.generateMipmaps,
                    this.texture.minFilter = t.minFilter,
                    this.texture.magFilter = t.magFilter;
                    var i = new Kt(5,5,5)
                      , r = new Ue({
                        name: "CubemapFromEquirect",
                        uniforms: Be({
                            tEquirect: {
                                value: null
                            }
                        }),
                        vertexShader: "varying vec3 vWorldDirection;vec3 transformDirection(in vec3 dir,in mat4 matrix){return normalize((matrix*vec4(dir,0.0)).xyz);}void main(){vWorldDirection=transformDirection(position,modelMatrix);\n#include <begin_vertex>\n#include <project_vertex>\n}",
                        fragmentShader: "uniform sampler2D tEquirect;varying vec3 vWorldDirection;\n#include <common>\nvoid main(){vec3 direction=normalize(vWorldDirection);vec2 sampleUV=equirectUv(direction);gl_FragColor=texture2D(tEquirect,sampleUV);}",
                        side: 1,
                        blending: 0
                    });
                    r.uniforms.tEquirect.value = t;
                    var n = new Hi(i,r)
                      , a = t.minFilter;
                    return t.minFilter === be && (t.minFilter = xe),
                    new Ur(1,10,this).update(e, n),
                    t.minFilter = a,
                    n.geometry.dispose(),
                    n.material.dispose(),
                    this
                }
                ,
                Gr.prototype.clear = function(e, t, i, r) {
                    for (var n = e.getRenderTarget(), a = 0; a < 6; a++)
                        e.setRenderTarget(this, a),
                        e.clear(t, i, r);
                    e.setRenderTarget(n)
                }
                ,
                Qr.prototype = Object.create(dr.prototype),
                Qr.prototype.constructor = Qr,
                Qr.prototype.isDataTexture2DArray = !0,
                $r.prototype = Object.create(dr.prototype),
                $r.prototype.constructor = $r,
                $r.prototype.isDataTexture3D = !0;
                var en = new dr
                  , tn = new Qr
                  , rn = new $r
                  , nn = new Vr
                  , an = []
                  , on = []
                  , sn = new Float32Array(16)
                  , ln = new Float32Array(9)
                  , un = new Float32Array(4);
                function cn(e, t, i) {
                    var r = e[0];
                    if (r <= 0 || r > 0)
                        return e;
                    var n = t * i
                      , a = an[n];
                    if (void 0 === a && (a = new Float32Array(n),
                    an[n] = a),
                    0 !== t) {
                        r.toArray(a, 0);
                        for (var o = 1, s = 0; o !== t; ++o)
                            s += i,
                            e[o].toArray(a, s)
                    }
                    return a
                }
                function hn(e, t) {
                    if (e.length !== t.length)
                        return !1;
                    for (var i = 0, r = e.length; i < r; i++)
                        if (e[i] !== t[i])
                            return !1;
                    return !0
                }
                function pn(e, t) {
                    for (var i = 0, r = t.length; i < r; i++)
                        e[i] = t[i]
                }
                function fn(e, t) {
                    var i = on[t];
                    void 0 === i && (i = new Int32Array(t),
                    on[t] = i);
                    for (var r = 0; r !== t; ++r)
                        i[r] = e.allocateTextureUnit();
                    return i
                }
                function dn(e, t) {
                    var i = this.cache;
                    i[0] !== t && (e.uniform1f(this.addr, t),
                    i[0] = t)
                }
                function mn(e, t) {
                    var i = this.cache;
                    if (void 0 !== t.x)
                        i[0] === t.x && i[1] === t.y || (e.uniform2f(this.addr, t.x, t.y),
                        i[0] = t.x,
                        i[1] = t.y);
                    else {
                        if (hn(i, t))
                            return;
                        e.uniform2fv(this.addr, t),
                        pn(i, t)
                    }
                }
                function vn(e, t) {
                    var i = this.cache;
                    if (void 0 !== t.x)
                        i[0] === t.x && i[1] === t.y && i[2] === t.z || (e.uniform3f(this.addr, t.x, t.y, t.z),
                        i[0] = t.x,
                        i[1] = t.y,
                        i[2] = t.z);
                    else if (void 0 !== t.r)
                        i[0] === t.r && i[1] === t.g && i[2] === t.b || (e.uniform3f(this.addr, t.r, t.g, t.b),
                        i[0] = t.r,
                        i[1] = t.g,
                        i[2] = t.b);
                    else {
                        if (hn(i, t))
                            return;
                        e.uniform3fv(this.addr, t),
                        pn(i, t)
                    }
                }
                function gn(e, t) {
                    var i = this.cache;
                    if (void 0 !== t.x)
                        i[0] === t.x && i[1] === t.y && i[2] === t.z && i[3] === t.w || (e.uniform4f(this.addr, t.x, t.y, t.z, t.w),
                        i[0] = t.x,
                        i[1] = t.y,
                        i[2] = t.z,
                        i[3] = t.w);
                    else {
                        if (hn(i, t))
                            return;
                        e.uniform4fv(this.addr, t),
                        pn(i, t)
                    }
                }
                function yn(e, t) {
                    var i = this.cache
                      , r = t.elements;
                    if (void 0 === r) {
                        if (hn(i, t))
                            return;
                        e.uniformMatrix2fv(this.addr, !1, t),
                        pn(i, t)
                    } else {
                        if (hn(i, r))
                            return;
                        un.set(r),
                        e.uniformMatrix2fv(this.addr, !1, un),
                        pn(i, r)
                    }
                }
                function _n(e, t) {
                    var i = this.cache
                      , r = t.elements;
                    if (void 0 === r) {
                        if (hn(i, t))
                            return;
                        e.uniformMatrix3fv(this.addr, !1, t),
                        pn(i, t)
                    } else {
                        if (hn(i, r))
                            return;
                        ln.set(r),
                        e.uniformMatrix3fv(this.addr, !1, ln),
                        pn(i, r)
                    }
                }
                function xn(e, t) {
                    var i = this.cache
                      , r = t.elements;
                    if (void 0 === r) {
                        if (hn(i, t))
                            return;
                        e.uniformMatrix4fv(this.addr, !1, t),
                        pn(i, t)
                    } else {
                        if (hn(i, r))
                            return;
                        sn.set(r),
                        e.uniformMatrix4fv(this.addr, !1, sn),
                        pn(i, r)
                    }
                }
                function bn(e, t, i) {
                    var r = this.cache
                      , n = i.allocateTextureUnit();
                    r[0] !== n && (e.uniform1i(this.addr, n),
                    r[0] = n),
                    i.safeSetTexture2D(t || en, n)
                }
                function wn(e, t, i) {
                    var r = this.cache
                      , n = i.allocateTextureUnit();
                    r[0] !== n && (e.uniform1i(this.addr, n),
                    r[0] = n),
                    i.setTexture2DArray(t || tn, n)
                }
                function Sn(e, t, i) {
                    var r = this.cache
                      , n = i.allocateTextureUnit();
                    r[0] !== n && (e.uniform1i(this.addr, n),
                    r[0] = n),
                    i.setTexture3D(t || rn, n)
                }
                function Mn(e, t, i) {
                    var r = this.cache
                      , n = i.allocateTextureUnit();
                    r[0] !== n && (e.uniform1i(this.addr, n),
                    r[0] = n),
                    i.safeSetTextureCube(t || nn, n)
                }
                function Tn(e, t) {
                    var i = this.cache;
                    i[0] !== t && (e.uniform1i(this.addr, t),
                    i[0] = t)
                }
                function En(e, t) {
                    var i = this.cache;
                    hn(i, t) || (e.uniform2iv(this.addr, t),
                    pn(i, t))
                }
                function An(e, t) {
                    var i = this.cache;
                    hn(i, t) || (e.uniform3iv(this.addr, t),
                    pn(i, t))
                }
                function Pn(e, t) {
                    var i = this.cache;
                    hn(i, t) || (e.uniform4iv(this.addr, t),
                    pn(i, t))
                }
                function Cn(e, t) {
                    var i = this.cache;
                    i[0] !== t && (e.uniform1ui(this.addr, t),
                    i[0] = t)
                }
                function Ln(e, t) {
                    e.uniform1fv(this.addr, t)
                }
                function In(e, t) {
                    e.uniform1iv(this.addr, t)
                }
                function kn(e, t) {
                    e.uniform2iv(this.addr, t)
                }
                function zn(e, t) {
                    e.uniform3iv(this.addr, t)
                }
                function Dn(e, t) {
                    e.uniform4iv(this.addr, t)
                }
                function Rn(e, t) {
                    var i = cn(t, this.size, 2);
                    e.uniform2fv(this.addr, i)
                }
                function On(e, t) {
                    var i = cn(t, this.size, 3);
                    e.uniform3fv(this.addr, i)
                }
                function Bn(e, t) {
                    var i = cn(t, this.size, 4);
                    e.uniform4fv(this.addr, i)
                }
                function Fn(e, t) {
                    var i = cn(t, this.size, 4);
                    e.uniformMatrix2fv(this.addr, !1, i)
                }
                function Nn(e, t) {
                    var i = cn(t, this.size, 9);
                    e.uniformMatrix3fv(this.addr, !1, i)
                }
                function Un(e, t) {
                    var i = cn(t, this.size, 16);
                    e.uniformMatrix4fv(this.addr, !1, i)
                }
                function Vn(e, t, i) {
                    var r = t.length
                      , n = fn(i, r);
                    e.uniform1iv(this.addr, n);
                    for (var a = 0; a !== r; ++a)
                        i.safeSetTexture2D(t[a] || en, n[a])
                }
                function Gn(e, t, i) {
                    var r = t.length
                      , n = fn(i, r);
                    e.uniform1iv(this.addr, n);
                    for (var a = 0; a !== r; ++a)
                        i.safeSetTextureCube(t[a] || nn, n[a])
                }
                function jn(e, t, i) {
                    this.id = e,
                    this.addr = i,
                    this.cache = [],
                    this.setValue = function(e) {
                        switch (e) {
                        case 5126:
                            return dn;
                        case 35664:
                            return mn;
                        case 35665:
                            return vn;
                        case 35666:
                            return gn;
                        case 35674:
                            return yn;
                        case 35675:
                            return _n;
                        case 35676:
                            return xn;
                        case 5124:
                        case 35670:
                            return Tn;
                        case 35667:
                        case 35671:
                            return En;
                        case 35668:
                        case 35672:
                            return An;
                        case 35669:
                        case 35673:
                            return Pn;
                        case 5125:
                            return Cn;
                        case 35678:
                        case 36198:
                        case 36298:
                        case 36306:
                        case 35682:
                            return bn;
                        case 35679:
                        case 36299:
                        case 36307:
                            return Sn;
                        case 35680:
                        case 36300:
                        case 36308:
                        case 36293:
                            return Mn;
                        case 36289:
                        case 36303:
                        case 36311:
                        case 36292:
                            return wn
                        }
                    }(t.type)
                }
                function Hn(e, t, i) {
                    this.id = e,
                    this.addr = i,
                    this.cache = [],
                    this.size = t.size,
                    this.setValue = function(e) {
                        switch (e) {
                        case 5126:
                            return Ln;
                        case 35664:
                            return Rn;
                        case 35665:
                            return On;
                        case 35666:
                            return Bn;
                        case 35674:
                            return Fn;
                        case 35675:
                            return Nn;
                        case 35676:
                            return Un;
                        case 5124:
                        case 35670:
                            return In;
                        case 35667:
                        case 35671:
                            return kn;
                        case 35668:
                        case 35672:
                            return zn;
                        case 35669:
                        case 35673:
                            return Dn;
                        case 35678:
                        case 36198:
                        case 36298:
                        case 36306:
                        case 35682:
                            return Vn;
                        case 35680:
                        case 36300:
                        case 36308:
                        case 36293:
                            return Gn
                        }
                    }(t.type)
                }
                function qn(e) {
                    this.id = e,
                    this.seq = [],
                    this.map = {}
                }
                Hn.prototype.updateCache = function(e) {
                    var t = this.cache;
                    e instanceof Float32Array && t.length !== e.length && (this.cache = new Float32Array(e.length)),
                    pn(t, e)
                }
                ,
                qn.prototype.setValue = function(e, t, i) {
                    for (var r = this.seq, n = 0, a = r.length; n !== a; ++n) {
                        var o = r[n];
                        o.setValue(e, t[o.id], i)
                    }
                }
                ;
                var Wn = /(\w+)(\])?(\[|\.)?/g;
                function Zn(e, t) {
                    e.seq.push(t),
                    e.map[t.id] = t
                }
                function Xn(e, t, i) {
                    var r = e.name
                      , n = r.length;
                    for (Wn.lastIndex = 0; ; ) {
                        var a = Wn.exec(r)
                          , o = Wn.lastIndex
                          , s = a[1]
                          , l = "]" === a[2]
                          , u = a[3];
                        if (l && (s |= 0),
                        void 0 === u || "[" === u && o + 2 === n) {
                            Zn(i, void 0 === u ? new jn(s,e,t) : new Hn(s,e,t));
                            break
                        }
                        var c = i.map[s];
                        void 0 === c && Zn(i, c = new qn(s)),
                        i = c
                    }
                }
                function Yn(e, t) {
                    this.seq = [],
                    this.map = {};
                    for (var i = e.getProgramParameter(t, 35718), r = 0; r < i; ++r) {
                        var n = e.getActiveUniform(t, r);
                        Xn(n, e.getUniformLocation(t, n.name), this)
                    }
                }
                function Kn(e, t, i) {
                    var r = e.createShader(t);
                    return e.shaderSource(r, i),
                    e.compileShader(r),
                    r
                }
                Yn.prototype.setValue = function(e, t, i, r) {
                    var n = this.map[t];
                    void 0 !== n && n.setValue(e, i, r)
                }
                ,
                Yn.prototype.setOptional = function(e, t, i) {
                    var r = t[i];
                    void 0 !== r && this.setValue(e, i, r)
                }
                ,
                Yn.upload = function(e, t, i, r) {
                    for (var n = 0, a = t.length; n !== a; ++n) {
                        var o = t[n]
                          , s = i[o.id];
                        !1 !== s.needsUpdate && o.setValue(e, s.value, r)
                    }
                }
                ,
                Yn.seqWithValue = function(e, t) {
                    for (var i = [], r = 0, n = e.length; r !== n; ++r) {
                        var a = e[r];
                        a.id in t && i.push(a)
                    }
                    return i
                }
                ;
                var Jn = 0;
                function Qn(e) {
                    switch (e) {
                    case ke:
                        return ["Linear", "( value )"];
                    case 3001:
                        return ["sRGB", "( value )"];
                    case 3002:
                        return ["RGBE", "( value )"];
                    case 3004:
                        return ["RGBM", "( value, 7.0 )"];
                    case 3005:
                        return ["RGBM", "( value, 16.0 )"];
                    case 3006:
                        return ["RGBD", "( value, 256.0 )"];
                    case 3007:
                        return ["Gamma", "( value, float( GAMMA_FACTOR ) )"];
                    case 3003:
                        return ["LogLuv", "( value )"];
                    default:
                        return console.warn("THREE.WebGLProgram: Unsupported encoding:", e),
                        ["Linear", "( value )"]
                    }
                }
                function $n(e, t, i) {
                    var r = e.getShaderParameter(t, 35713)
                      , n = e.getShaderInfoLog(t).trim();
                    return r && "" === n ? "" : "THREE.WebGLShader: gl.getShaderInfoLog() " + i + "\n" + n + function(e) {
                        for (var t = e.split("\n"), i = 0; i < t.length; i++)
                            t[i] = i + 1 + ": " + t[i];
                        return t.join("\n")
                    }(e.getShaderSource(t))
                }
                function ea(e, t) {
                    var i = Qn(t);
                    return "vec4 " + e + "( vec4 value ) { return " + i[0] + "ToLinear" + i[1] + "; }"
                }
                function ta(e, t) {
                    var i;
                    switch (t) {
                    case 1:
                        i = "Linear";
                        break;
                    case 2:
                        i = "Reinhard";
                        break;
                    case 3:
                        i = "OptimizedCineon";
                        break;
                    case 4:
                        i = "ACESFilmic";
                        break;
                    case 5:
                        i = "Custom";
                        break;
                    default:
                        console.warn("THREE.WebGLProgram: Unsupported toneMapping:", t),
                        i = "Linear"
                    }
                    return "vec3 " + e + "( vec3 color ) { return " + i + "ToneMapping( color ); }"
                }
                function ia(e) {
                    return "" !== e
                }
                function ra(e, t) {
                    return e.replace(/NUM_DIR_LIGHTS/g, t.numDirLights).replace(/NUM_SPOT_LIGHTS/g, t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g, t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g, t.numPointLights).replace(/NUM_HEMI_LIGHTS/g, t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g, t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g, t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g, t.numPointLightShadows)
                }
                function na(e, t) {
                    return e.replace(/NUM_CLIPPING_PLANES/g, t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g, t.numClippingPlanes - t.numClipIntersection)
                }
                var aa = /^[ \t]*#include +<([\w\d./]+)>/gm;
                function oa(e) {
                    return e.replace(aa, sa)
                }
                function sa(e, t) {
                    var i = Cr[t];
                    if (void 0 === i)
                        throw new Error("Can not resolve #include <" + t + ">");
                    return oa(i)
                }
                var la = /#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g
                  , ua = /#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;
                function ca(e) {
                    return e.replace(ua, pa).replace(la, ha)
                }
                function ha(e, t, i, r) {
                    return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),
                    pa(0, t, i, r)
                }
                function pa(e, t, i, r) {
                    for (var n = "", a = parseInt(t); a < parseInt(i); a++)
                        n += r.replace(/\[\s*i\s*\]/g, "[ " + a + " ]").replace(/UNROLLED_LOOP_INDEX/g, a);
                    return n
                }
                function fa(e) {
                    var t = "precision " + e.precision + " float;\nprecision " + e.precision + " int;";
                    return "highp" === e.precision ? t += "\n#define HIGH_PRECISION" : "mediump" === e.precision ? t += "\n#define MEDIUM_PRECISION" : "lowp" === e.precision && (t += "\n#define LOW_PRECISION"),
                    t
                }
                function da(e, t, i, r) {
                    var n, a, o, s, l = e.getContext(), u = i.defines, c = i.vertexShader, h = i.fragmentShader, p = function(e) {
                        var t = "SHADOWMAP_TYPE_BASIC";
                        return 1 === e.shadowMapType ? t = "SHADOWMAP_TYPE_PCF" : 2 === e.shadowMapType ? t = "SHADOWMAP_TYPE_PCF_SOFT" : 3 === e.shadowMapType && (t = "SHADOWMAP_TYPE_VSM"),
                        t
                    }(i), f = function(e) {
                        var t = "ENVMAP_TYPE_CUBE";
                        if (e.envMap)
                            switch (e.envMapMode) {
                            case 301:
                            case 302:
                                t = "ENVMAP_TYPE_CUBE";
                                break;
                            case 306:
                            case 307:
                                t = "ENVMAP_TYPE_CUBE_UV"
                            }
                        return t
                    }(i), d = function(e) {
                        var t = "ENVMAP_MODE_REFLECTION";
                        if (e.envMap)
                            switch (e.envMapMode) {
                            case 302:
                            case 307:
                                t = "ENVMAP_MODE_REFRACTION"
                            }
                        return t
                    }(i), m = function(e) {
                        var t = "ENVMAP_BLENDING_NONE";
                        if (e.envMap)
                            switch (e.combine) {
                            case 0:
                                t = "ENVMAP_BLENDING_MULTIPLY";
                                break;
                            case 1:
                                t = "ENVMAP_BLENDING_MIX";
                                break;
                            case 2:
                                t = "ENVMAP_BLENDING_ADD"
                            }
                        return t
                    }(i), v = e.gammaFactor > 0 ? e.gammaFactor : 1, g = i.isWebGL2 ? "" : function(e) {
                        return [e.extensionDerivatives || e.envMapCubeUV || e.bumpMap || e.tangentSpaceNormalMap || e.clearcoatNormalMap || e.flatShading || "physical" === e.shaderID ? "#extension GL_OES_standard_derivatives : enable" : "", (e.extensionFragDepth || e.logarithmicDepthBuffer) && e.rendererExtensionFragDepth ? "#extension GL_EXT_frag_depth : enable" : "", e.extensionDrawBuffers && e.rendererExtensionDrawBuffers ? "#extension GL_EXT_draw_buffers : require" : "", (e.extensionShaderTextureLOD || e.envMap) && e.rendererExtensionShaderTextureLod ? "#extension GL_EXT_shader_texture_lod : enable" : ""].filter(ia).join("\n")
                    }(i), y = function(e) {
                        var t = [];
                        for (var i in e) {
                            var r = e[i];
                            !1 !== r && t.push("#define " + i + " " + r)
                        }
                        return t.join("\n")
                    }(u), _ = l.createProgram(), x = i.glslVersion ? "#version " + i.glslVersion + "\n" : "";
                    i.isRawShaderMaterial ? ((n = [y].filter(ia).join("\n")).length > 0 && (n += "\n"),
                    (a = [g, y].filter(ia).join("\n")).length > 0 && (a += "\n")) : (n = [fa(i), "#define SHADER_NAME " + i.shaderName, y, i.instancing ? "#define USE_INSTANCING" : "", i.instancingColor ? "#define USE_INSTANCING_COLOR" : "", i.supportsVertexTextures ? "#define VERTEX_TEXTURES" : "", "#define GAMMA_FACTOR " + v, "#define MAX_BONES " + i.maxBones, i.useFog && i.fog ? "#define USE_FOG" : "", i.useFog && i.fogExp2 ? "#define FOG_EXP2" : "", i.map ? "#define USE_MAP" : "", i.envMap ? "#define USE_ENVMAP" : "", i.envMap ? "#define " + d : "", i.lightMap ? "#define USE_LIGHTMAP" : "", i.aoMap ? "#define USE_AOMAP" : "", i.emissiveMap ? "#define USE_EMISSIVEMAP" : "", i.bumpMap ? "#define USE_BUMPMAP" : "", i.normalMap ? "#define USE_NORMALMAP" : "", i.normalMap && i.objectSpaceNormalMap ? "#define OBJECTSPACE_NORMALMAP" : "", i.normalMap && i.tangentSpaceNormalMap ? "#define TANGENTSPACE_NORMALMAP" : "", i.clearcoatMap ? "#define USE_CLEARCOATMAP" : "", i.clearcoatRoughnessMap ? "#define USE_CLEARCOAT_ROUGHNESSMAP" : "", i.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "", i.displacementMap && i.supportsVertexTextures ? "#define USE_DISPLACEMENTMAP" : "", i.specularMap ? "#define USE_SPECULARMAP" : "", i.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", i.metalnessMap ? "#define USE_METALNESSMAP" : "", i.alphaMap ? "#define USE_ALPHAMAP" : "", i.transmissionMap ? "#define USE_TRANSMISSIONMAP" : "", i.vertexTangents ? "#define USE_TANGENT" : "", i.vertexColors ? "#define USE_COLOR" : "", i.vertexUvs ? "#define USE_UV" : "", i.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "", i.flatShading ? "#define FLAT_SHADED" : "", i.skinning ? "#define USE_SKINNING" : "", i.useVertexTexture ? "#define BONE_TEXTURE" : "", i.morphTargets ? "#define USE_MORPHTARGETS" : "", i.morphNormals && !1 === i.flatShading ? "#define USE_MORPHNORMALS" : "", i.doubleSided ? "#define DOUBLE_SIDED" : "", i.flipSided ? "#define FLIP_SIDED" : "", i.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", i.shadowMapEnabled ? "#define " + p : "", i.sizeAttenuation ? "#define USE_SIZEATTENUATION" : "", i.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", i.logarithmicDepthBuffer && i.rendererExtensionFragDepth ? "#define USE_LOGDEPTHBUF_EXT" : "", "uniform mat4 modelMatrix;", "uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "uniform mat4 viewMatrix;", "uniform mat3 normalMatrix;", "uniform vec3 cameraPosition;", "uniform bool isOrthographic;", "#ifdef USE_INSTANCING", "\tattribute mat4 instanceMatrix;", "#endif", "#ifdef USE_INSTANCING_COLOR", "\tattribute vec3 instanceColor;", "#endif", "attribute vec3 position;", "attribute vec3 normal;", "attribute vec2 uv;", "#ifdef USE_TANGENT", "\tattribute vec4 tangent;", "#endif", "#ifdef USE_COLOR", "\tattribute vec3 color;", "#endif", "#ifdef USE_MORPHTARGETS", "\tattribute vec3 morphTarget0;", "\tattribute vec3 morphTarget1;", "\tattribute vec3 morphTarget2;", "\tattribute vec3 morphTarget3;", "\t#ifdef USE_MORPHNORMALS", "\t\tattribute vec3 morphNormal0;", "\t\tattribute vec3 morphNormal1;", "\t\tattribute vec3 morphNormal2;", "\t\tattribute vec3 morphNormal3;", "\t#else", "\t\tattribute vec3 morphTarget4;", "\t\tattribute vec3 morphTarget5;", "\t\tattribute vec3 morphTarget6;", "\t\tattribute vec3 morphTarget7;", "\t#endif", "#endif", "#ifdef USE_SKINNING", "\tattribute vec4 skinIndex;", "\tattribute vec4 skinWeight;", "#endif", "\n"].filter(ia).join("\n"),
                    a = [g, fa(i), "#define SHADER_NAME " + i.shaderName, y, i.alphaTest ? "#define ALPHATEST " + i.alphaTest + (i.alphaTest % 1 ? "" : ".0") : "", "#define GAMMA_FACTOR " + v, i.useFog && i.fog ? "#define USE_FOG" : "", i.useFog && i.fogExp2 ? "#define FOG_EXP2" : "", i.map ? "#define USE_MAP" : "", i.matcap ? "#define USE_MATCAP" : "", i.envMap ? "#define USE_ENVMAP" : "", i.envMap ? "#define " + f : "", i.envMap ? "#define " + d : "", i.envMap ? "#define " + m : "", i.lightMap ? "#define USE_LIGHTMAP" : "", i.aoMap ? "#define USE_AOMAP" : "", i.emissiveMap ? "#define USE_EMISSIVEMAP" : "", i.bumpMap ? "#define USE_BUMPMAP" : "", i.normalMap ? "#define USE_NORMALMAP" : "", i.normalMap && i.objectSpaceNormalMap ? "#define OBJECTSPACE_NORMALMAP" : "", i.normalMap && i.tangentSpaceNormalMap ? "#define TANGENTSPACE_NORMALMAP" : "", i.clearcoatMap ? "#define USE_CLEARCOATMAP" : "", i.clearcoatRoughnessMap ? "#define USE_CLEARCOAT_ROUGHNESSMAP" : "", i.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "", i.specularMap ? "#define USE_SPECULARMAP" : "", i.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", i.metalnessMap ? "#define USE_METALNESSMAP" : "", i.alphaMap ? "#define USE_ALPHAMAP" : "", i.sheen ? "#define USE_SHEEN" : "", i.transmissionMap ? "#define USE_TRANSMISSIONMAP" : "", i.vertexTangents ? "#define USE_TANGENT" : "", i.vertexColors || i.instancingColor ? "#define USE_COLOR" : "", i.vertexUvs ? "#define USE_UV" : "", i.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "", i.gradientMap ? "#define USE_GRADIENTMAP" : "", i.flatShading ? "#define FLAT_SHADED" : "", i.doubleSided ? "#define DOUBLE_SIDED" : "", i.flipSided ? "#define FLIP_SIDED" : "", i.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", i.shadowMapEnabled ? "#define " + p : "", i.premultipliedAlpha ? "#define PREMULTIPLIED_ALPHA" : "", i.physicallyCorrectLights ? "#define PHYSICALLY_CORRECT_LIGHTS" : "", i.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", i.logarithmicDepthBuffer && i.rendererExtensionFragDepth ? "#define USE_LOGDEPTHBUF_EXT" : "", (i.extensionShaderTextureLOD || i.envMap) && i.rendererExtensionShaderTextureLod ? "#define TEXTURE_LOD_EXT" : "", "uniform mat4 viewMatrix;", "uniform vec3 cameraPosition;", "uniform bool isOrthographic;", 0 !== i.toneMapping ? "#define TONE_MAPPING" : "", 0 !== i.toneMapping ? Cr.tonemapping_pars_fragment : "", 0 !== i.toneMapping ? ta("toneMapping", i.toneMapping) : "", i.dithering ? "#define DITHERING" : "", Cr.encodings_pars_fragment, i.map ? ea("mapTexelToLinear", i.mapEncoding) : "", i.matcap ? ea("matcapTexelToLinear", i.matcapEncoding) : "", i.envMap ? ea("envMapTexelToLinear", i.envMapEncoding) : "", i.emissiveMap ? ea("emissiveMapTexelToLinear", i.emissiveMapEncoding) : "", i.lightMap ? ea("lightMapTexelToLinear", i.lightMapEncoding) : "", ("linearToOutputTexel",
                    o = i.outputEncoding,
                    s = Qn(o),
                    "vec4 linearToOutputTexel( vec4 value ) { return LinearTo" + s[0] + s[1] + "; }"), i.depthPacking ? "#define DEPTH_PACKING " + i.depthPacking : "", "\n"].filter(ia).join("\n")),
                    c = na(c = ra(c = oa(c), i), i),
                    h = na(h = ra(h = oa(h), i), i),
                    c = ca(c),
                    h = ca(h),
                    i.isWebGL2 && !0 !== i.isRawShaderMaterial && (x = "#version 300 es\n",
                    n = ["#define attribute in", "#define varying out", "#define texture2D texture"].join("\n") + "\n" + n,
                    a = ["#define varying in", i.glslVersion === De ? "" : "out highp vec4 pc_fragColor;", i.glslVersion === De ? "" : "#define gl_FragColor pc_fragColor", "#define gl_FragDepthEXT gl_FragDepth", "#define texture2D texture", "#define textureCube texture", "#define texture2DProj textureProj", "#define texture2DLodEXT textureLod", "#define texture2DProjLodEXT textureProjLod", "#define textureCubeLodEXT textureLod", "#define texture2DGradEXT textureGrad", "#define texture2DProjGradEXT textureProjGrad", "#define textureCubeGradEXT textureGrad"].join("\n") + "\n" + a);
                    var b, w, S = x + a + h, M = Kn(l, 35633, x + n + c), T = Kn(l, 35632, S);
                    if (l.attachShader(_, M),
                    l.attachShader(_, T),
                    void 0 !== i.index0AttributeName ? l.bindAttribLocation(_, 0, i.index0AttributeName) : !0 === i.morphTargets && l.bindAttribLocation(_, 0, "position"),
                    l.linkProgram(_),
                    e.debug.checkShaderErrors) {
                        var E = l.getProgramInfoLog(_).trim()
                          , A = l.getShaderInfoLog(M).trim()
                          , P = l.getShaderInfoLog(T).trim()
                          , C = !0
                          , L = !0;
                        if (!1 === l.getProgramParameter(_, 35714)) {
                            C = !1;
                            var I = $n(l, M, "vertex")
                              , k = $n(l, T, "fragment");
                            console.error("THREE.WebGLProgram: shader error: ", l.getError(), "gl.VALIDATE_STATUS", l.getProgramParameter(_, 35715), "gl.getProgramInfoLog", E, I, k)
                        } else
                            "" !== E ? console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()", E) : "" !== A && "" !== P || (L = !1);
                        L && (this.diagnostics = {
                            runnable: C,
                            programLog: E,
                            vertexShader: {
                                log: A,
                                prefix: n
                            },
                            fragmentShader: {
                                log: P,
                                prefix: a
                            }
                        })
                    }
                    return l.deleteShader(M),
                    l.deleteShader(T),
                    this.getUniforms = function() {
                        return void 0 === b && (b = new Yn(l,_)),
                        b
                    }
                    ,
                    this.getAttributes = function() {
                        return void 0 === w && (w = function(e, t) {
                            for (var i = {}, r = e.getProgramParameter(t, 35721), n = 0; n < r; n++) {
                                var a = e.getActiveAttrib(t, n).name;
                                i[a] = e.getAttribLocation(t, a)
                            }
                            return i
                        }(l, _)),
                        w
                    }
                    ,
                    this.destroy = function() {
                        r.releaseStatesOfProgram(this),
                        l.deleteProgram(_),
                        this.program = void 0
                    }
                    ,
                    this.name = i.shaderName,
                    this.id = Jn++,
                    this.cacheKey = t,
                    this.usedTimes = 1,
                    this.program = _,
                    this.vertexShader = M,
                    this.fragmentShader = T,
                    this
                }
                function ma(e, t, i, r, n, a) {
                    var o = []
                      , s = r.isWebGL2
                      , l = r.logarithmicDepthBuffer
                      , u = r.floatVertexTextures
                      , c = r.maxVertexUniforms
                      , h = r.vertexTextures
                      , p = r.precision
                      , f = {
                        MeshDepthMaterial: "depth",
                        MeshDistanceMaterial: "distanceRGBA",
                        MeshNormalMaterial: "normal",
                        MeshBasicMaterial: "basic",
                        MeshLambertMaterial: "lambert",
                        MeshPhongMaterial: "phong",
                        MeshToonMaterial: "toon",
                        MeshStandardMaterial: "physical",
                        MeshPhysicalMaterial: "physical",
                        MeshMatcapMaterial: "matcap",
                        LineBasicMaterial: "basic",
                        LineDashedMaterial: "dashed",
                        PointsMaterial: "points",
                        ShadowMaterial: "shadow",
                        SpriteMaterial: "sprite"
                    }
                      , d = ["precision", "isWebGL2", "supportsVertexTextures", "outputEncoding", "instancing", "instancingColor", "map", "mapEncoding", "matcap", "matcapEncoding", "envMap", "envMapMode", "envMapEncoding", "envMapCubeUV", "lightMap", "lightMapEncoding", "aoMap", "emissiveMap", "emissiveMapEncoding", "bumpMap", "normalMap", "objectSpaceNormalMap", "tangentSpaceNormalMap", "clearcoatMap", "clearcoatRoughnessMap", "clearcoatNormalMap", "displacementMap", "specularMap", "roughnessMap", "metalnessMap", "gradientMap", "alphaMap", "combine", "vertexColors", "vertexTangents", "vertexUvs", "uvsVertexOnly", "fog", "useFog", "fogExp2", "flatShading", "sizeAttenuation", "logarithmicDepthBuffer", "skinning", "maxBones", "useVertexTexture", "morphTargets", "morphNormals", "maxMorphTargets", "maxMorphNormals", "premultipliedAlpha", "numDirLights", "numPointLights", "numSpotLights", "numHemiLights", "numRectAreaLights", "numDirLightShadows", "numPointLightShadows", "numSpotLightShadows", "shadowMapEnabled", "shadowMapType", "toneMapping", "physicallyCorrectLights", "alphaTest", "doubleSided", "flipSided", "numClippingPlanes", "numClipIntersection", "depthPacking", "dithering", "sheen", "transmissionMap"];
                    function m(e) {
                        var t;
                        return e && e.isTexture ? t = e.encoding : e && e.isWebGLRenderTarget ? (console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),
                        t = e.texture.encoding) : t = ke,
                        t
                    }
                    return {
                        getParameters: function(n, o, d, v, g) {
                            var y, _, x = v.fog, b = n.isMeshStandardMaterial ? v.environment : null, w = t.get(n.envMap || b), S = f[n.type], M = g.isSkinnedMesh ? function(e) {
                                var t = e.skeleton.bones;
                                if (u)
                                    return 1024;
                                var i = c
                                  , r = Math.floor((i - 20) / 4)
                                  , n = Math.min(r, t.length);
                                return n < t.length ? (console.warn("THREE.WebGLRenderer: Skeleton has " + t.length + " bones. This GPU supports " + n + "."),
                                0) : n
                            }(g) : 0;
                            if (null !== n.precision && (p = r.getMaxPrecision(n.precision)) !== n.precision && console.warn("THREE.WebGLProgram.getParameters:", n.precision, "not supported, using", p, "instead."),
                            S) {
                                var T = Ir[S];
                                y = T.vertexShader,
                                _ = T.fragmentShader
                            } else
                                y = n.vertexShader,
                                _ = n.fragmentShader;
                            var E = e.getRenderTarget();
                            return {
                                isWebGL2: s,
                                shaderID: S,
                                shaderName: n.type,
                                vertexShader: y,
                                fragmentShader: _,
                                defines: n.defines,
                                isRawShaderMaterial: !0 === n.isRawShaderMaterial,
                                glslVersion: n.glslVersion,
                                precision: p,
                                instancing: !0 === g.isInstancedMesh,
                                instancingColor: !0 === g.isInstancedMesh && null !== g.instanceColor,
                                supportsVertexTextures: h,
                                outputEncoding: null !== E ? m(E.texture) : e.outputEncoding,
                                map: !!n.map,
                                mapEncoding: m(n.map),
                                matcap: !!n.matcap,
                                matcapEncoding: m(n.matcap),
                                envMap: !!w,
                                envMapMode: w && w.mapping,
                                envMapEncoding: m(w),
                                envMapCubeUV: !!w && (306 === w.mapping || 307 === w.mapping),
                                lightMap: !!n.lightMap,
                                lightMapEncoding: m(n.lightMap),
                                aoMap: !!n.aoMap,
                                emissiveMap: !!n.emissiveMap,
                                emissiveMapEncoding: m(n.emissiveMap),
                                bumpMap: !!n.bumpMap,
                                normalMap: !!n.normalMap,
                                objectSpaceNormalMap: 1 === n.normalMapType,
                                tangentSpaceNormalMap: 0 === n.normalMapType,
                                clearcoatMap: !!n.clearcoatMap,
                                clearcoatRoughnessMap: !!n.clearcoatRoughnessMap,
                                clearcoatNormalMap: !!n.clearcoatNormalMap,
                                displacementMap: !!n.displacementMap,
                                roughnessMap: !!n.roughnessMap,
                                metalnessMap: !!n.metalnessMap,
                                specularMap: !!n.specularMap,
                                alphaMap: !!n.alphaMap,
                                gradientMap: !!n.gradientMap,
                                sheen: !!n.sheen,
                                transmissionMap: !!n.transmissionMap,
                                combine: n.combine,
                                vertexTangents: n.normalMap && n.vertexTangents,
                                vertexColors: n.vertexColors,
                                vertexUvs: !!(n.map || n.bumpMap || n.normalMap || n.specularMap || n.alphaMap || n.emissiveMap || n.roughnessMap || n.metalnessMap || n.clearcoatMap || n.clearcoatRoughnessMap || n.clearcoatNormalMap || n.displacementMap || n.transmissionMap),
                                uvsVertexOnly: !(n.map || n.bumpMap || n.normalMap || n.specularMap || n.alphaMap || n.emissiveMap || n.roughnessMap || n.metalnessMap || n.clearcoatNormalMap || n.transmissionMap || !n.displacementMap),
                                fog: !!x,
                                useFog: n.fog,
                                fogExp2: x && x.isFogExp2,
                                flatShading: n.flatShading,
                                sizeAttenuation: n.sizeAttenuation,
                                logarithmicDepthBuffer: l,
                                skinning: n.skinning && M > 0,
                                maxBones: M,
                                useVertexTexture: u,
                                morphTargets: n.morphTargets,
                                morphNormals: n.morphNormals,
                                maxMorphTargets: e.maxMorphTargets,
                                maxMorphNormals: e.maxMorphNormals,
                                numDirLights: o.directional.length,
                                numPointLights: o.point.length,
                                numSpotLights: o.spot.length,
                                numRectAreaLights: o.rectArea.length,
                                numHemiLights: o.hemi.length,
                                numDirLightShadows: o.directionalShadowMap.length,
                                numPointLightShadows: o.pointShadowMap.length,
                                numSpotLightShadows: o.spotShadowMap.length,
                                numClippingPlanes: a.numPlanes,
                                numClipIntersection: a.numIntersection,
                                dithering: n.dithering,
                                shadowMapEnabled: e.shadowMap.enabled && d.length > 0,
                                shadowMapType: e.shadowMap.type,
                                toneMapping: n.toneMapped ? e.toneMapping : 0,
                                physicallyCorrectLights: e.physicallyCorrectLights,
                                premultipliedAlpha: n.premultipliedAlpha,
                                alphaTest: n.alphaTest,
                                doubleSided: 2 === n.side,
                                flipSided: 1 === n.side,
                                depthPacking: void 0 !== n.depthPacking && n.depthPacking,
                                index0AttributeName: n.index0AttributeName,
                                extensionDerivatives: n.extensions && n.extensions.derivatives,
                                extensionFragDepth: n.extensions && n.extensions.fragDepth,
                                extensionDrawBuffers: n.extensions && n.extensions.drawBuffers,
                                extensionShaderTextureLOD: n.extensions && n.extensions.shaderTextureLOD,
                                rendererExtensionFragDepth: s || i.has("EXT_frag_depth"),
                                rendererExtensionDrawBuffers: s || i.has("WEBGL_draw_buffers"),
                                rendererExtensionShaderTextureLod: s || i.has("EXT_shader_texture_lod"),
                                customProgramCacheKey: n.customProgramCacheKey()
                            }
                        },
                        getProgramCacheKey: function(t) {
                            var i = [];
                            if (t.shaderID ? i.push(t.shaderID) : (i.push(t.fragmentShader),
                            i.push(t.vertexShader)),
                            void 0 !== t.defines)
                                for (var r in t.defines)
                                    i.push(r),
                                    i.push(t.defines[r]);
                            if (!1 === t.isRawShaderMaterial) {
                                for (var n = 0; n < d.length; n++)
                                    i.push(t[d[n]]);
                                i.push(e.outputEncoding),
                                i.push(e.gammaFactor)
                            }
                            return i.push(t.customProgramCacheKey),
                            i.join()
                        },
                        getUniforms: function(e) {
                            var t, i = f[e.type];
                            if (i) {
                                var r = Ir[i];
                                t = Ne.clone(r.uniforms)
                            } else
                                t = e.uniforms;
                            return t
                        },
                        acquireProgram: function(t, i) {
                            for (var r, a = 0, s = o.length; a < s; a++) {
                                var l = o[a];
                                if (l.cacheKey === i) {
                                    ++(r = l).usedTimes;
                                    break
                                }
                            }
                            return void 0 === r && (r = new da(e,i,t,n),
                            o.push(r)),
                            r
                        },
                        releaseProgram: function(e) {
                            if (0 == --e.usedTimes) {
                                var t = o.indexOf(e);
                                o[t] = o[o.length - 1],
                                o.pop(),
                                e.destroy()
                            }
                        },
                        programs: o
                    }
                }
                function va() {
                    var e = new WeakMap;
                    return {
                        get: function(t) {
                            var i = e.get(t);
                            return void 0 === i && (i = {},
                            e.set(t, i)),
                            i
                        },
                        remove: function(t) {
                            e.delete(t)
                        },
                        update: function(t, i, r) {
                            e.get(t)[i] = r
                        },
                        dispose: function() {
                            e = new WeakMap
                        }
                    }
                }
                function ga(e, t) {
                    return e.groupOrder !== t.groupOrder ? e.groupOrder - t.groupOrder : e.renderOrder !== t.renderOrder ? e.renderOrder - t.renderOrder : e.program !== t.program ? e.program.id - t.program.id : e.material.id !== t.material.id ? e.material.id - t.material.id : e.z !== t.z ? e.z - t.z : e.id - t.id
                }
                function ya(e, t) {
                    return e.groupOrder !== t.groupOrder ? e.groupOrder - t.groupOrder : e.renderOrder !== t.renderOrder ? e.renderOrder - t.renderOrder : e.z !== t.z ? t.z - e.z : e.id - t.id
                }
                function _a(e) {
                    var t = []
                      , i = 0
                      , r = []
                      , n = []
                      , a = {
                        id: -1
                    };
                    function o(r, n, o, s, l, u) {
                        var c = t[i]
                          , h = e.get(o);
                        return void 0 === c ? (c = {
                            id: r.id,
                            object: r,
                            geometry: n,
                            material: o,
                            program: h.program || a,
                            groupOrder: s,
                            renderOrder: r.renderOrder,
                            z: l,
                            group: u
                        },
                        t[i] = c) : (c.id = r.id,
                        c.object = r,
                        c.geometry = n,
                        c.material = o,
                        c.program = h.program || a,
                        c.groupOrder = s,
                        c.renderOrder = r.renderOrder,
                        c.z = l,
                        c.group = u),
                        i++,
                        c
                    }
                    return {
                        opaque: r,
                        transparent: n,
                        init: function() {
                            i = 0,
                            r.length = 0,
                            n.length = 0
                        },
                        push: function(e, t, i, a, s, l) {
                            var u = o(e, t, i, a, s, l);
                            (!0 === i.transparent ? n : r).push(u)
                        },
                        unshift: function(e, t, i, a, s, l) {
                            var u = o(e, t, i, a, s, l);
                            (!0 === i.transparent ? n : r).unshift(u)
                        },
                        finish: function() {
                            for (var e = i, r = t.length; e < r; e++) {
                                var n = t[e];
                                if (null === n.id)
                                    break;
                                n.id = null,
                                n.object = null,
                                n.geometry = null,
                                n.material = null,
                                n.program = null,
                                n.group = null
                            }
                        },
                        sort: function(e, t) {
                            r.length > 1 && r.sort(e || ga),
                            n.length > 1 && n.sort(t || ya)
                        }
                    }
                }
                function xa(e) {
                    var t = new WeakMap;
                    return {
                        get: function(i, r) {
                            var n, a = t.get(i);
                            return void 0 === a ? (n = new _a(e),
                            t.set(i, new WeakMap),
                            t.get(i).set(r, n)) : void 0 === (n = a.get(r)) && (n = new _a(e),
                            a.set(r, n)),
                            n
                        },
                        dispose: function() {
                            t = new WeakMap
                        }
                    }
                }
                function ba() {
                    var e = {};
                    return {
                        get: function(t) {
                            if (void 0 !== e[t.id])
                                return e[t.id];
                            var i;
                            switch (t.type) {
                            case "DirectionalLight":
                                i = {
                                    direction: new w,
                                    color: new vt
                                };
                                break;
                            case "SpotLight":
                                i = {
                                    position: new w,
                                    direction: new w,
                                    color: new vt,
                                    distance: 0,
                                    coneCos: 0,
                                    penumbraCos: 0,
                                    decay: 0
                                };
                                break;
                            case "PointLight":
                                i = {
                                    position: new w,
                                    color: new vt,
                                    distance: 0,
                                    decay: 0
                                };
                                break;
                            case "HemisphereLight":
                                i = {
                                    direction: new w,
                                    skyColor: new vt,
                                    groundColor: new vt
                                };
                                break;
                            case "RectAreaLight":
                                i = {
                                    color: new vt,
                                    position: new w,
                                    halfWidth: new w,
                                    halfHeight: new w
                                }
                            }
                            return e[t.id] = i,
                            i
                        }
                    }
                }
                var wa = 0;
                function Sa(e, t) {
                    return (t.castShadow ? 1 : 0) - (e.castShadow ? 1 : 0)
                }
                function Ma(e, t) {
                    for (var i, r = new ba, n = (i = {},
                    {
                        get: function(e) {
                            if (void 0 !== i[e.id])
                                return i[e.id];
                            var t;
                            switch (e.type) {
                            case "DirectionalLight":
                            case "SpotLight":
                                t = {
                                    shadowBias: 0,
                                    shadowNormalBias: 0,
                                    shadowRadius: 1,
                                    shadowMapSize: new lt
                                };
                                break;
                            case "PointLight":
                                t = {
                                    shadowBias: 0,
                                    shadowNormalBias: 0,
                                    shadowRadius: 1,
                                    shadowMapSize: new lt,
                                    shadowCameraNear: 1,
                                    shadowCameraFar: 1e3
                                }
                            }
                            return i[e.id] = t,
                            t
                        }
                    }), a = {
                        version: 0,
                        hash: {
                            directionalLength: -1,
                            pointLength: -1,
                            spotLength: -1,
                            rectAreaLength: -1,
                            hemiLength: -1,
                            numDirectionalShadows: -1,
                            numPointShadows: -1,
                            numSpotShadows: -1
                        },
                        ambient: [0, 0, 0],
                        probe: [],
                        directional: [],
                        directionalShadow: [],
                        directionalShadowMap: [],
                        directionalShadowMatrix: [],
                        spot: [],
                        spotShadow: [],
                        spotShadowMap: [],
                        spotShadowMatrix: [],
                        rectArea: [],
                        rectAreaLTC1: null,
                        rectAreaLTC2: null,
                        point: [],
                        pointShadow: [],
                        pointShadowMap: [],
                        pointShadowMatrix: [],
                        hemi: []
                    }, o = 0; o < 9; o++)
                        a.probe.push(new w);
                    var s = new w
                      , l = new A
                      , u = new A;
                    return {
                        setup: function(i) {
                            for (var o = 0, s = 0, l = 0, u = 0; u < 9; u++)
                                a.probe[u].set(0, 0, 0);
                            var c = 0
                              , h = 0
                              , p = 0
                              , f = 0
                              , d = 0
                              , m = 0
                              , v = 0
                              , g = 0;
                            i.sort(Sa);
                            for (var y = 0, _ = i.length; y < _; y++) {
                                var x = i[y]
                                  , b = x.color
                                  , w = x.intensity
                                  , S = x.distance
                                  , M = x.shadow && x.shadow.map ? x.shadow.map.texture : null;
                                if (x.isAmbientLight)
                                    o += b.r * w,
                                    s += b.g * w,
                                    l += b.b * w;
                                else if (x.isLightProbe)
                                    for (var T = 0; T < 9; T++)
                                        a.probe[T].addScaledVector(x.sh.coefficients[T], w);
                                else if (x.isDirectionalLight) {
                                    var E = r.get(x);
                                    if (E.color.copy(x.color).multiplyScalar(x.intensity),
                                    x.castShadow) {
                                        var A = x.shadow
                                          , P = n.get(x);
                                        P.shadowBias = A.bias,
                                        P.shadowNormalBias = A.normalBias,
                                        P.shadowRadius = A.radius,
                                        P.shadowMapSize = A.mapSize,
                                        a.directionalShadow[c] = P,
                                        a.directionalShadowMap[c] = M,
                                        a.directionalShadowMatrix[c] = x.shadow.matrix,
                                        m++
                                    }
                                    a.directional[c] = E,
                                    c++
                                } else if (x.isSpotLight) {
                                    var C = r.get(x);
                                    if (C.position.setFromMatrixPosition(x.matrixWorld),
                                    C.color.copy(b).multiplyScalar(w),
                                    C.distance = S,
                                    C.coneCos = Math.cos(x.angle),
                                    C.penumbraCos = Math.cos(x.angle * (1 - x.penumbra)),
                                    C.decay = x.decay,
                                    x.castShadow) {
                                        var L = x.shadow
                                          , I = n.get(x);
                                        I.shadowBias = L.bias,
                                        I.shadowNormalBias = L.normalBias,
                                        I.shadowRadius = L.radius,
                                        I.shadowMapSize = L.mapSize,
                                        a.spotShadow[p] = I,
                                        a.spotShadowMap[p] = M,
                                        a.spotShadowMatrix[p] = x.shadow.matrix,
                                        g++
                                    }
                                    a.spot[p] = C,
                                    p++
                                } else if (x.isRectAreaLight) {
                                    var k = r.get(x);
                                    k.color.copy(b).multiplyScalar(w),
                                    k.halfWidth.set(.5 * x.width, 0, 0),
                                    k.halfHeight.set(0, .5 * x.height, 0),
                                    a.rectArea[f] = k,
                                    f++
                                } else if (x.isPointLight) {
                                    var z = r.get(x);
                                    if (z.color.copy(x.color).multiplyScalar(x.intensity),
                                    z.distance = x.distance,
                                    z.decay = x.decay,
                                    x.castShadow) {
                                        var D = x.shadow
                                          , R = n.get(x);
                                        R.shadowBias = D.bias,
                                        R.shadowNormalBias = D.normalBias,
                                        R.shadowRadius = D.radius,
                                        R.shadowMapSize = D.mapSize,
                                        R.shadowCameraNear = D.camera.near,
                                        R.shadowCameraFar = D.camera.far,
                                        a.pointShadow[h] = R,
                                        a.pointShadowMap[h] = M,
                                        a.pointShadowMatrix[h] = x.shadow.matrix,
                                        v++
                                    }
                                    a.point[h] = z,
                                    h++
                                } else if (x.isHemisphereLight) {
                                    var O = r.get(x);
                                    O.skyColor.copy(x.color).multiplyScalar(w),
                                    O.groundColor.copy(x.groundColor).multiplyScalar(w),
                                    a.hemi[d] = O,
                                    d++
                                }
                            }
                            f > 0 && (t.isWebGL2 || !0 === e.has("OES_texture_float_linear") ? (a.rectAreaLTC1 = Lr.LTC_FLOAT_1,
                            a.rectAreaLTC2 = Lr.LTC_FLOAT_2) : !0 === e.has("OES_texture_half_float_linear") ? (a.rectAreaLTC1 = Lr.LTC_HALF_1,
                            a.rectAreaLTC2 = Lr.LTC_HALF_2) : console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),
                            a.ambient[0] = o,
                            a.ambient[1] = s,
                            a.ambient[2] = l;
                            var B = a.hash;
                            B.directionalLength === c && B.pointLength === h && B.spotLength === p && B.rectAreaLength === f && B.hemiLength === d && B.numDirectionalShadows === m && B.numPointShadows === v && B.numSpotShadows === g || (a.directional.length = c,
                            a.spot.length = p,
                            a.rectArea.length = f,
                            a.point.length = h,
                            a.hemi.length = d,
                            a.directionalShadow.length = m,
                            a.directionalShadowMap.length = m,
                            a.pointShadow.length = v,
                            a.pointShadowMap.length = v,
                            a.spotShadow.length = g,
                            a.spotShadowMap.length = g,
                            a.directionalShadowMatrix.length = m,
                            a.pointShadowMatrix.length = v,
                            a.spotShadowMatrix.length = g,
                            B.directionalLength = c,
                            B.pointLength = h,
                            B.spotLength = p,
                            B.rectAreaLength = f,
                            B.hemiLength = d,
                            B.numDirectionalShadows = m,
                            B.numPointShadows = v,
                            B.numSpotShadows = g,
                            a.version = wa++)
                        },
                        setupView: function(e, t) {
                            for (var i = 0, r = 0, n = 0, o = 0, c = 0, h = t.matrixWorldInverse, p = 0, f = e.length; p < f; p++) {
                                var d = e[p];
                                if (d.isDirectionalLight) {
                                    var m = a.directional[i];
                                    m.direction.setFromMatrixPosition(d.matrixWorld),
                                    s.setFromMatrixPosition(d.target.matrixWorld),
                                    m.direction.sub(s),
                                    m.direction.transformDirection(h),
                                    i++
                                } else if (d.isSpotLight) {
                                    var v = a.spot[n];
                                    v.position.setFromMatrixPosition(d.matrixWorld),
                                    v.position.applyMatrix4(h),
                                    v.direction.setFromMatrixPosition(d.matrixWorld),
                                    s.setFromMatrixPosition(d.target.matrixWorld),
                                    v.direction.sub(s),
                                    v.direction.transformDirection(h),
                                    n++
                                } else if (d.isRectAreaLight) {
                                    var g = a.rectArea[o];
                                    g.position.setFromMatrixPosition(d.matrixWorld),
                                    g.position.applyMatrix4(h),
                                    u.identity(),
                                    l.copy(d.matrixWorld),
                                    l.premultiply(h),
                                    u.extractRotation(l),
                                    g.halfWidth.set(.5 * d.width, 0, 0),
                                    g.halfHeight.set(0, .5 * d.height, 0),
                                    g.halfWidth.applyMatrix4(u),
                                    g.halfHeight.applyMatrix4(u),
                                    o++
                                } else if (d.isPointLight) {
                                    var y = a.point[r];
                                    y.position.setFromMatrixPosition(d.matrixWorld),
                                    y.position.applyMatrix4(h),
                                    r++
                                } else if (d.isHemisphereLight) {
                                    var _ = a.hemi[c];
                                    _.direction.setFromMatrixPosition(d.matrixWorld),
                                    _.direction.transformDirection(h),
                                    _.direction.normalize(),
                                    c++
                                }
                            }
                        },
                        state: a
                    }
                }
                function Ta(e, t) {
                    var i = new Ma(e,t)
                      , r = []
                      , n = [];
                    return {
                        init: function() {
                            r.length = 0,
                            n.length = 0
                        },
                        state: {
                            lightsArray: r,
                            shadowsArray: n,
                            lights: i
                        },
                        setupLights: function() {
                            i.setup(r)
                        },
                        setupLightsView: function(e) {
                            i.setupView(r, e)
                        },
                        pushLight: function(e) {
                            r.push(e)
                        },
                        pushShadow: function(e) {
                            n.push(e)
                        }
                    }
                }
                function Ea(e, t) {
                    var i = new WeakMap;
                    return {
                        get: function(r) {
                            var n, a = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                            return !1 === i.has(r) ? (n = new Ta(e,t),
                            i.set(r, []),
                            i.get(r).push(n)) : a >= i.get(r).length ? (n = new Ta(e,t),
                            i.get(r).push(n)) : n = i.get(r)[a],
                            n
                        },
                        dispose: function() {
                            i = new WeakMap
                        }
                    }
                }
                function Aa(e) {
                    Oe.call(this),
                    this.type = "MeshDepthMaterial",
                    this.depthPacking = 3200,
                    this.skinning = !1,
                    this.morphTargets = !1,
                    this.map = null,
                    this.alphaMap = null,
                    this.displacementMap = null,
                    this.displacementScale = 1,
                    this.displacementBias = 0,
                    this.wireframe = !1,
                    this.wireframeLinewidth = 1,
                    this.fog = !1,
                    this.setValues(e)
                }
                function Pa(e) {
                    Oe.call(this),
                    this.type = "MeshDistanceMaterial",
                    this.referencePosition = new w,
                    this.nearDistance = 1,
                    this.farDistance = 1e3,
                    this.skinning = !1,
                    this.morphTargets = !1,
                    this.map = null,
                    this.alphaMap = null,
                    this.displacementMap = null,
                    this.displacementScale = 1,
                    this.displacementBias = 0,
                    this.fog = !1,
                    this.setValues(e)
                }
                function Ca(e, t, i) {
                    var r = new xr
                      , n = new lt
                      , a = new lt
                      , o = new at
                      , s = []
                      , l = []
                      , u = {}
                      , c = {
                        0: 1,
                        1: 0,
                        2: 2
                    }
                      , h = new Ue({
                        defines: {
                            SAMPLE_RATE: 2 / 8,
                            HALF_SAMPLE_RATE: 1 / 8
                        },
                        uniforms: {
                            shadow_pass: {
                                value: null
                            },
                            resolution: {
                                value: new lt
                            },
                            radius: {
                                value: 4
                            }
                        },
                        vertexShader: "void main(){gl_Position=vec4(position,1.0);}",
                        fragmentShader: "uniform sampler2D shadow_pass;uniform vec2 resolution;uniform float radius;\n#include <packing>\nvoid main(){float mean=0.0;float squared_mean=0.0;float depth=unpackRGBAToDepth(texture2D(shadow_pass,(gl_FragCoord.xy)/resolution));for(float i=-1.0;i<1.0;i+=SAMPLE_RATE){\n#ifdef HORIZONTAL_PASS\nvec2 distribution=unpackRGBATo2Half(texture2D(shadow_pass,(gl_FragCoord.xy+vec2(i,0.0)*radius)/resolution));mean+=distribution.x;squared_mean+=distribution.y*distribution.y+distribution.x*distribution.x;\n#else\nfloat depth=unpackRGBAToDepth(texture2D(shadow_pass,(gl_FragCoord.xy+vec2(0.0,i)*radius)/resolution));mean+=depth;squared_mean+=depth*depth;\n#endif\n}mean=mean*HALF_SAMPLE_RATE;squared_mean=squared_mean*HALF_SAMPLE_RATE;float std_dev=sqrt(squared_mean-mean*mean);gl_FragColor=pack2HalfToRGBA(vec2(mean,std_dev));}"
                    })
                      , p = h.clone();
                    p.defines.HORIZONTAL_PASS = 1;
                    var f = new jt;
                    f.setAttribute("position", new _t(new Float32Array([-1, -1, .5, 3, -1, .5, -1, 3, .5]),3));
                    var d = new Hi(f,h)
                      , m = this;
                    function v(i, r) {
                        var n = t.update(d);
                        h.uniforms.shadow_pass.value = i.map.texture,
                        h.uniforms.resolution.value = i.mapSize,
                        h.uniforms.radius.value = i.radius,
                        e.setRenderTarget(i.mapPass),
                        e.clear(),
                        e.renderBufferDirect(r, null, n, h, d, null),
                        p.uniforms.shadow_pass.value = i.mapPass.texture,
                        p.uniforms.resolution.value = i.mapSize,
                        p.uniforms.radius.value = i.radius,
                        e.setRenderTarget(i.map),
                        e.clear(),
                        e.renderBufferDirect(r, null, n, p, d, null)
                    }
                    function g(e, t, i) {
                        var r = e << 0 | t << 1 | i << 2
                          , n = s[r];
                        return void 0 === n && (n = new Aa({
                            depthPacking: 3201,
                            morphTargets: e,
                            skinning: t
                        }),
                        s[r] = n),
                        n
                    }
                    function y(e, t, i) {
                        var r = e << 0 | t << 1 | i << 2
                          , n = l[r];
                        return void 0 === n && (n = new Pa({
                            morphTargets: e,
                            skinning: t
                        }),
                        l[r] = n),
                        n
                    }
                    function _(t, i, r, n, a, o, s) {
                        var l = null
                          , h = g
                          , p = t.customDepthMaterial;
                        if (!0 === n.isPointLight && (h = y,
                        p = t.customDistanceMaterial),
                        void 0 === p) {
                            var f = !1;
                            !0 === r.morphTargets && (f = i.morphAttributes && i.morphAttributes.position && i.morphAttributes.position.length > 0);
                            var d = !1;
                            !0 === t.isSkinnedMesh && (!0 === r.skinning ? d = !0 : console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:", t)),
                            l = h(f, d, !0 === t.isInstancedMesh)
                        } else
                            l = p;
                        if (e.localClippingEnabled && !0 === r.clipShadows && 0 !== r.clippingPlanes.length) {
                            var m = l.uuid
                              , v = r.uuid
                              , _ = u[m];
                            void 0 === _ && (_ = {},
                            u[m] = _);
                            var x = _[v];
                            void 0 === x && (x = l.clone(),
                            _[v] = x),
                            l = x
                        }
                        return l.visible = r.visible,
                        l.wireframe = r.wireframe,
                        l.side = 3 === s ? null !== r.shadowSide ? r.shadowSide : r.side : null !== r.shadowSide ? r.shadowSide : c[r.side],
                        l.clipShadows = r.clipShadows,
                        l.clippingPlanes = r.clippingPlanes,
                        l.clipIntersection = r.clipIntersection,
                        l.wireframeLinewidth = r.wireframeLinewidth,
                        l.linewidth = r.linewidth,
                        !0 === n.isPointLight && !0 === l.isMeshDistanceMaterial && (l.referencePosition.setFromMatrixPosition(n.matrixWorld),
                        l.nearDistance = a,
                        l.farDistance = o),
                        l
                    }
                    function x(i, n, a, o, s) {
                        if (!1 !== i.visible) {
                            if (i.layers.test(n.layers) && (i.isMesh || i.isLine || i.isPoints) && (i.castShadow || i.receiveShadow && 3 === s) && (!i.frustumCulled || r.intersectsObject(i))) {
                                i.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse, i.matrixWorld);
                                var l = t.update(i)
                                  , u = i.material;
                                if (Array.isArray(u))
                                    for (var c = l.groups, h = 0, p = c.length; h < p; h++) {
                                        var f = c[h]
                                          , d = u[f.materialIndex];
                                        if (d && d.visible) {
                                            var m = _(i, l, d, o, a.near, a.far, s);
                                            e.renderBufferDirect(a, null, l, m, i, f)
                                        }
                                    }
                                else if (u.visible) {
                                    var v = _(i, l, u, o, a.near, a.far, s);
                                    e.renderBufferDirect(a, null, l, v, i, null)
                                }
                            }
                            for (var g = i.children, y = 0, b = g.length; y < b; y++)
                                x(g[y], n, a, o, s)
                        }
                    }
                    this.enabled = !1,
                    this.autoUpdate = !0,
                    this.needsUpdate = !1,
                    this.type = 1,
                    this.render = function(t, s, l) {
                        if (!1 !== m.enabled && (!1 !== m.autoUpdate || !1 !== m.needsUpdate) && 0 !== t.length) {
                            var u = e.getRenderTarget()
                              , c = e.getActiveCubeFace()
                              , h = e.getActiveMipmapLevel()
                              , p = e.state;
                            p.setBlending(0),
                            p.buffers.color.setClear(1, 1, 1, 1),
                            p.buffers.depth.setTest(!0),
                            p.setScissorTest(!1);
                            for (var f = 0, d = t.length; f < d; f++) {
                                var g = t[f]
                                  , y = g.shadow;
                                if (void 0 !== y) {
                                    if (!1 !== y.autoUpdate || !1 !== y.needsUpdate) {
                                        n.copy(y.mapSize);
                                        var _ = y.getFrameExtents();
                                        if (n.multiply(_),
                                        a.copy(y.mapSize),
                                        (n.x > i || n.y > i) && (n.x > i && (a.x = Math.floor(i / _.x),
                                        n.x = a.x * _.x,
                                        y.mapSize.x = a.x),
                                        n.y > i && (a.y = Math.floor(i / _.y),
                                        n.y = a.y * _.y,
                                        y.mapSize.y = a.y)),
                                        null === y.map && !y.isPointLightShadow && 3 === this.type) {
                                            var b = {
                                                minFilter: xe,
                                                magFilter: xe,
                                                format: Ce
                                            };
                                            y.map = new Br(n.x,n.y,b),
                                            y.map.texture.name = g.name + ".shadowMap",
                                            y.mapPass = new Br(n.x,n.y,b),
                                            y.camera.updateProjectionMatrix()
                                        }
                                        if (null === y.map) {
                                            var w = {
                                                minFilter: _e,
                                                magFilter: _e,
                                                format: Ce
                                            };
                                            y.map = new Br(n.x,n.y,w),
                                            y.map.texture.name = g.name + ".shadowMap",
                                            y.camera.updateProjectionMatrix()
                                        }
                                        e.setRenderTarget(y.map),
                                        e.clear();
                                        for (var S = y.getViewportCount(), M = 0; M < S; M++) {
                                            var T = y.getViewport(M);
                                            o.set(a.x * T.x, a.y * T.y, a.x * T.z, a.y * T.w),
                                            p.viewport(o),
                                            y.updateMatrices(g, M),
                                            r = y.getFrustum(),
                                            x(s, l, y.camera, g, this.type)
                                        }
                                        y.isPointLightShadow || 3 !== this.type || v(y, l),
                                        y.needsUpdate = !1
                                    }
                                } else
                                    console.warn("THREE.WebGLShadowMap:", g, "has no shadow.")
                            }
                            m.needsUpdate = !1,
                            e.setRenderTarget(u, c, h)
                        }
                    }
                }
                function La(e, t, i) {
                    return t in e ? Object.defineProperty(e, t, {
                        value: i,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : e[t] = i,
                    e
                }
                function Ia(e, t, i) {
                    var r, n, a = i.isWebGL2, o = new function() {
                        var t = !1
                          , i = new at
                          , r = null
                          , n = new at(0,0,0,0);
                        return {
                            setMask: function(i) {
                                r === i || t || (e.colorMask(i, i, i, i),
                                r = i)
                            },
                            setLocked: function(e) {
                                t = e
                            },
                            setClear: function(t, r, a, o, s) {
                                !0 === s && (t *= o,
                                r *= o,
                                a *= o),
                                i.set(t, r, a, o),
                                !1 === n.equals(i) && (e.clearColor(t, r, a, o),
                                n.copy(i))
                            },
                            reset: function() {
                                t = !1,
                                r = null,
                                n.set(-1, 0, 0, 0)
                            }
                        }
                    }
                    , s = new function() {
                        var t = !1
                          , i = null
                          , r = null
                          , n = null;
                        return {
                            setTest: function(e) {
                                e ? R(2929) : O(2929)
                            },
                            setMask: function(r) {
                                i === r || t || (e.depthMask(r),
                                i = r)
                            },
                            setFunc: function(t) {
                                if (r !== t) {
                                    if (t)
                                        switch (t) {
                                        case 0:
                                            e.depthFunc(512);
                                            break;
                                        case 1:
                                            e.depthFunc(519);
                                            break;
                                        case 2:
                                            e.depthFunc(513);
                                            break;
                                        case 3:
                                            e.depthFunc(515);
                                            break;
                                        case 4:
                                            e.depthFunc(514);
                                            break;
                                        case 5:
                                            e.depthFunc(518);
                                            break;
                                        case 6:
                                            e.depthFunc(516);
                                            break;
                                        case 7:
                                            e.depthFunc(517);
                                            break;
                                        default:
                                            e.depthFunc(515)
                                        }
                                    else
                                        e.depthFunc(515);
                                    r = t
                                }
                            },
                            setLocked: function(e) {
                                t = e
                            },
                            setClear: function(t) {
                                n !== t && (e.clearDepth(t),
                                n = t)
                            },
                            reset: function() {
                                t = !1,
                                i = null,
                                r = null,
                                n = null
                            }
                        }
                    }
                    , l = new function() {
                        var t = !1
                          , i = null
                          , r = null
                          , n = null
                          , a = null
                          , o = null
                          , s = null
                          , l = null
                          , u = null;
                        return {
                            setTest: function(e) {
                                t || (e ? R(2960) : O(2960))
                            },
                            setMask: function(r) {
                                i === r || t || (e.stencilMask(r),
                                i = r)
                            },
                            setFunc: function(t, i, o) {
                                r === t && n === i && a === o || (e.stencilFunc(t, i, o),
                                r = t,
                                n = i,
                                a = o)
                            },
                            setOp: function(t, i, r) {
                                o === t && s === i && l === r || (e.stencilOp(t, i, r),
                                o = t,
                                s = i,
                                l = r)
                            },
                            setLocked: function(e) {
                                t = e
                            },
                            setClear: function(t) {
                                u !== t && (e.clearStencil(t),
                                u = t)
                            },
                            reset: function() {
                                t = !1,
                                i = null,
                                r = null,
                                n = null,
                                a = null,
                                o = null,
                                s = null,
                                l = null,
                                u = null
                            }
                        }
                    }
                    , u = {}, c = null, h = null, p = null, f = null, d = null, m = null, v = null, g = null, y = null, _ = !1, x = null, b = null, w = null, S = null, M = null, T = e.getParameter(35661), E = !1, A = 0, P = e.getParameter(7938);
                    -1 !== P.indexOf("WebGL") ? (A = parseFloat(/^WebGL (\d)/.exec(P)[1]),
                    E = A >= 1) : -1 !== P.indexOf("OpenGL ES") && (A = parseFloat(/^OpenGL ES (\d)/.exec(P)[1]),
                    E = A >= 2);
                    var C = null
                      , L = {}
                      , I = new at
                      , k = new at;
                    function z(t, i, r) {
                        var n = new Uint8Array(4)
                          , a = e.createTexture();
                        e.bindTexture(t, a),
                        e.texParameteri(t, 10241, 9728),
                        e.texParameteri(t, 10240, 9728);
                        for (var o = 0; o < r; o++)
                            e.texImage2D(i + o, 0, 6408, 1, 1, 0, 6408, 5121, n);
                        return a
                    }
                    var D = {};
                    function R(t) {
                        !0 !== u[t] && (e.enable(t),
                        u[t] = !0)
                    }
                    function O(t) {
                        !1 !== u[t] && (e.disable(t),
                        u[t] = !1)
                    }
                    D[3553] = z(3553, 3553, 1),
                    D[34067] = z(34067, 34069, 6),
                    o.setClear(0, 0, 0, 1),
                    s.setClear(1),
                    l.setClear(0),
                    R(2929),
                    s.setFunc(3),
                    V(!1),
                    G(1),
                    R(2884),
                    U(0);
                    var B = (La(r = {}, me, 32774),
                    La(r, 101, 32778),
                    La(r, 102, 32779),
                    r);
                    if (a)
                        B[103] = 32775,
                        B[104] = 32776;
                    else {
                        var F = t.get("EXT_blend_minmax");
                        null !== F && (B[103] = F.MIN_EXT,
                        B[104] = F.MAX_EXT)
                    }
                    var N = (La(n = {}, 200, 0),
                    La(n, 201, 1),
                    La(n, 202, 768),
                    La(n, 204, 770),
                    La(n, 210, 776),
                    La(n, 208, 774),
                    La(n, 206, 772),
                    La(n, 203, 769),
                    La(n, 205, 771),
                    La(n, 209, 775),
                    La(n, 207, 773),
                    n);
                    function U(t, i, r, n, a, o, s, l) {
                        if (0 !== t) {
                            if (h || (R(3042),
                            h = !0),
                            5 === t)
                                a = a || i,
                                o = o || r,
                                s = s || n,
                                i === f && a === v || (e.blendEquationSeparate(B[i], B[a]),
                                f = i,
                                v = a),
                                r === d && n === m && o === g && s === y || (e.blendFuncSeparate(N[r], N[n], N[o], N[s]),
                                d = r,
                                m = n,
                                g = o,
                                y = s),
                                p = t,
                                _ = null;
                            else if (t !== p || l !== _) {
                                if (f === me && v === me || (e.blendEquation(32774),
                                f = me,
                                v = me),
                                l)
                                    switch (t) {
                                    case 1:
                                        e.blendFuncSeparate(1, 771, 1, 771);
                                        break;
                                    case 2:
                                        e.blendFunc(1, 1);
                                        break;
                                    case 3:
                                        e.blendFuncSeparate(0, 0, 769, 771);
                                        break;
                                    case 4:
                                        e.blendFuncSeparate(0, 768, 0, 770);
                                        break;
                                    default:
                                        console.error("THREE.WebGLState: Invalid blending: ", t)
                                    }
                                else
                                    switch (t) {
                                    case 1:
                                        e.blendFuncSeparate(770, 771, 1, 771);
                                        break;
                                    case 2:
                                        e.blendFunc(770, 1);
                                        break;
                                    case 3:
                                        e.blendFunc(0, 769);
                                        break;
                                    case 4:
                                        e.blendFunc(0, 768);
                                        break;
                                    default:
                                        console.error("THREE.WebGLState: Invalid blending: ", t)
                                    }
                                d = null,
                                m = null,
                                g = null,
                                y = null,
                                p = t,
                                _ = l
                            }
                        } else
                            h && (O(3042),
                            h = !1)
                    }
                    function V(t) {
                        x !== t && (t ? e.frontFace(2304) : e.frontFace(2305),
                        x = t)
                    }
                    function G(t) {
                        0 !== t ? (R(2884),
                        t !== b && (1 === t ? e.cullFace(1029) : 2 === t ? e.cullFace(1028) : e.cullFace(1032))) : O(2884),
                        b = t
                    }
                    function j(t, i, r) {
                        t ? (R(32823),
                        S === i && M === r || (e.polygonOffset(i, r),
                        S = i,
                        M = r)) : O(32823)
                    }
                    function H(t) {
                        void 0 === t && (t = 33984 + T - 1),
                        C !== t && (e.activeTexture(t),
                        C = t)
                    }
                    return {
                        buffers: {
                            color: o,
                            depth: s,
                            stencil: l
                        },
                        enable: R,
                        disable: O,
                        useProgram: function(t) {
                            return c !== t && (e.useProgram(t),
                            c = t,
                            !0)
                        },
                        setBlending: U,
                        setMaterial: function(e, t) {
                            2 === e.side ? O(2884) : R(2884);
                            var i = 1 === e.side;
                            t && (i = !i),
                            V(i),
                            1 === e.blending && !1 === e.transparent ? U(0) : U(e.blending, e.blendEquation, e.blendSrc, e.blendDst, e.blendEquationAlpha, e.blendSrcAlpha, e.blendDstAlpha, e.premultipliedAlpha),
                            s.setFunc(e.depthFunc),
                            s.setTest(e.depthTest),
                            s.setMask(e.depthWrite),
                            o.setMask(e.colorWrite);
                            var r = e.stencilWrite;
                            l.setTest(r),
                            r && (l.setMask(e.stencilWriteMask),
                            l.setFunc(e.stencilFunc, e.stencilRef, e.stencilFuncMask),
                            l.setOp(e.stencilFail, e.stencilZFail, e.stencilZPass)),
                            j(e.polygonOffset, e.polygonOffsetFactor, e.polygonOffsetUnits)
                        },
                        setFlipSided: V,
                        setCullFace: G,
                        setLineWidth: function(t) {
                            t !== w && (E && e.lineWidth(t),
                            w = t)
                        },
                        setPolygonOffset: j,
                        setScissorTest: function(e) {
                            e ? R(3089) : O(3089)
                        },
                        activeTexture: H,
                        bindTexture: function(t, i) {
                            null === C && H();
                            var r = L[C];
                            void 0 === r && (r = {
                                type: void 0,
                                texture: void 0
                            },
                            L[C] = r),
                            r.type === t && r.texture === i || (e.bindTexture(t, i || D[t]),
                            r.type = t,
                            r.texture = i)
                        },
                        unbindTexture: function() {
                            var t = L[C];
                            void 0 !== t && void 0 !== t.type && (e.bindTexture(t.type, null),
                            t.type = void 0,
                            t.texture = void 0)
                        },
                        compressedTexImage2D: function() {
                            try {
                                e.compressedTexImage2D.apply(e, arguments)
                            } catch (e) {
                                console.error("THREE.WebGLState:", e)
                            }
                        },
                        texImage2D: function() {
                            try {
                                e.texImage2D.apply(e, arguments)
                            } catch (e) {
                                console.error("THREE.WebGLState:", e)
                            }
                        },
                        texImage3D: function() {
                            try {
                                e.texImage3D.apply(e, arguments)
                            } catch (e) {
                                console.error("THREE.WebGLState:", e)
                            }
                        },
                        scissor: function(t) {
                            !1 === I.equals(t) && (e.scissor(t.x, t.y, t.z, t.w),
                            I.copy(t))
                        },
                        viewport: function(t) {
                            !1 === k.equals(t) && (e.viewport(t.x, t.y, t.z, t.w),
                            k.copy(t))
                        },
                        reset: function() {
                            u = {},
                            C = null,
                            L = {},
                            c = null,
                            h = null,
                            p = null,
                            f = null,
                            d = null,
                            m = null,
                            v = null,
                            g = null,
                            y = null,
                            _ = !1,
                            x = null,
                            b = null,
                            w = null,
                            S = null,
                            M = null,
                            o.reset(),
                            s.reset(),
                            l.reset()
                        }
                    }
                }
                function ka(e, t, i) {
                    return t in e ? Object.defineProperty(e, t, {
                        value: i,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : e[t] = i,
                    e
                }
                function za(e, t, i, r, n, a, o) {
                    var s, l, u, c = n.isWebGL2, h = n.maxTextures, p = n.maxCubemapSize, f = n.maxTextureSize, d = n.maxSamples, m = new WeakMap, g = !1;
                    try {
                        g = "undefined" != typeof OffscreenCanvas && null !== new OffscreenCanvas(1,1).getContext("2d")
                    } catch (e) {}
                    function y(e, t) {
                        return g ? new OffscreenCanvas(e,t) : document.createElementNS("http://www.w3.org/1999/xhtml", "canvas")
                    }
                    function _(e, t, i, r) {
                        var n = 1;
                        if ((e.width > r || e.height > r) && (n = r / Math.max(e.width, e.height)),
                        n < 1 || !0 === t) {
                            if ("undefined" != typeof HTMLImageElement && e instanceof HTMLImageElement || "undefined" != typeof HTMLCanvasElement && e instanceof HTMLCanvasElement || "undefined" != typeof ImageBitmap && e instanceof ImageBitmap) {
                                var a = t ? v.floorPowerOfTwo : Math.floor
                                  , o = a(n * e.width)
                                  , s = a(n * e.height);
                                void 0 === u && (u = y(o, s));
                                var l = i ? y(o, s) : u;
                                return l.width = o,
                                l.height = s,
                                l.getContext("2d").drawImage(e, 0, 0, o, s),
                                console.warn("THREE.WebGLRenderer: Texture has been resized from (" + e.width + "x" + e.height + ") to (" + o + "x" + s + ")."),
                                l
                            }
                            return "data"in e && console.warn("THREE.WebGLRenderer: Image in DataTexture is too big (" + e.width + "x" + e.height + ")."),
                            e
                        }
                        return e
                    }
                    function x(e) {
                        return v.isPowerOfTwo(e.width) && v.isPowerOfTwo(e.height)
                    }
                    function b(e, t) {
                        return e.generateMipmaps && t && e.minFilter !== _e && e.minFilter !== xe
                    }
                    function w(t, i, n, a) {
                        e.generateMipmap(t),
                        r.get(i).__maxMipLevel = Math.log(Math.max(n, a)) * Math.LOG2E
                    }
                    function S(i, r, n) {
                        if (!1 === c)
                            return r;
                        if (null !== i) {
                            if (void 0 !== e[i])
                                return e[i];
                            console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '" + i + "'")
                        }
                        var a = r;
                        return 6403 === r && (5126 === n && (a = 33326),
                        5131 === n && (a = 33325),
                        5121 === n && (a = 33321)),
                        6407 === r && (5126 === n && (a = 34837),
                        5131 === n && (a = 34843),
                        5121 === n && (a = 32849)),
                        6408 === r && (5126 === n && (a = 34836),
                        5131 === n && (a = 34842),
                        5121 === n && (a = 32856)),
                        33325 !== a && 33326 !== a && 34842 !== a && 34836 !== a || t.get("EXT_color_buffer_float"),
                        a
                    }
                    function M(e) {
                        return e === _e || 1004 === e || 1005 === e ? 9728 : 9729
                    }
                    function T(t) {
                        var i = t.target;
                        i.removeEventListener("dispose", T),
                        function(t) {
                            var i = r.get(t);
                            void 0 !== i.__webglInit && (e.deleteTexture(i.__webglTexture),
                            r.remove(t))
                        }(i),
                        i.isVideoTexture && m.delete(i),
                        o.memory.textures--
                    }
                    function E(t) {
                        var i = t.target;
                        i.removeEventListener("dispose", E),
                        function(t) {
                            var i = r.get(t)
                              , n = r.get(t.texture);
                            if (t) {
                                if (void 0 !== n.__webglTexture && e.deleteTexture(n.__webglTexture),
                                t.depthTexture && t.depthTexture.dispose(),
                                t.isWebGLCubeRenderTarget)
                                    for (var a = 0; a < 6; a++)
                                        e.deleteFramebuffer(i.__webglFramebuffer[a]),
                                        i.__webglDepthbuffer && e.deleteRenderbuffer(i.__webglDepthbuffer[a]);
                                else
                                    e.deleteFramebuffer(i.__webglFramebuffer),
                                    i.__webglDepthbuffer && e.deleteRenderbuffer(i.__webglDepthbuffer),
                                    i.__webglMultisampledFramebuffer && e.deleteFramebuffer(i.__webglMultisampledFramebuffer),
                                    i.__webglColorRenderbuffer && e.deleteRenderbuffer(i.__webglColorRenderbuffer),
                                    i.__webglDepthRenderbuffer && e.deleteRenderbuffer(i.__webglDepthRenderbuffer);
                                r.remove(t.texture),
                                r.remove(t)
                            }
                        }(i),
                        o.memory.textures--
                    }
                    var A = 0;
                    function P(e, t) {
                        var n = r.get(e);
                        if (e.isVideoTexture && function(e) {
                            var t = o.render.frame;
                            m.get(e) !== t && (m.set(e, t),
                            e.update())
                        }(e),
                        e.version > 0 && n.__version !== e.version) {
                            var a = e.image;
                            if (void 0 === a)
                                console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");
                            else {
                                if (!1 !== a.complete)
                                    return void D(n, e, t);
                                console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")
                            }
                        }
                        i.activeTexture(33984 + t),
                        i.bindTexture(3553, n.__webglTexture)
                    }
                    function C(t, n) {
                        var o = r.get(t);
                        t.version > 0 && o.__version !== t.version ? function(t, r, n) {
                            if (6 === r.image.length) {
                                z(t, r),
                                i.activeTexture(33984 + n),
                                i.bindTexture(34067, t.__webglTexture),
                                e.pixelStorei(37440, r.flipY);
                                for (var o = r && (r.isCompressedTexture || r.image[0].isCompressedTexture), s = r.image[0] && r.image[0].isDataTexture, l = [], u = 0; u < 6; u++)
                                    l[u] = o || s ? s ? r.image[u].image : r.image[u] : _(r.image[u], !1, !0, p);
                                var h, f = l[0], d = x(f) || c, m = a.convert(r.format), v = a.convert(r.type), g = S(r.internalFormat, m, v);
                                if (k(34067, r, d),
                                o) {
                                    for (var y = 0; y < 6; y++) {
                                        h = l[y].mipmaps;
                                        for (var M = 0; M < h.length; M++) {
                                            var T = h[M];
                                            r.format !== Ce && r.format !== Pe ? null !== m ? i.compressedTexImage2D(34069 + y, M, g, T.width, T.height, 0, T.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()") : i.texImage2D(34069 + y, M, g, T.width, T.height, 0, m, v, T.data)
                                        }
                                    }
                                    t.__maxMipLevel = h.length - 1
                                } else {
                                    h = r.mipmaps;
                                    for (var E = 0; E < 6; E++)
                                        if (s) {
                                            i.texImage2D(34069 + E, 0, g, l[E].width, l[E].height, 0, m, v, l[E].data);
                                            for (var A = 0; A < h.length; A++) {
                                                var P = h[A].image[E].image;
                                                i.texImage2D(34069 + E, A + 1, g, P.width, P.height, 0, m, v, P.data)
                                            }
                                        } else {
                                            i.texImage2D(34069 + E, 0, g, m, v, l[E]);
                                            for (var C = 0; C < h.length; C++) {
                                                var L = h[C];
                                                i.texImage2D(34069 + E, C + 1, g, m, v, L.image[E])
                                            }
                                        }
                                    t.__maxMipLevel = h.length
                                }
                                b(r, d) && w(34067, r, f.width, f.height),
                                t.__version = r.version,
                                r.onUpdate && r.onUpdate(r)
                            }
                        }(o, t, n) : (i.activeTexture(33984 + n),
                        i.bindTexture(34067, o.__webglTexture))
                    }
                    var L = (ka(s = {}, ve, 10497),
                    ka(s, ge, 33071),
                    ka(s, ye, 33648),
                    s)
                      , I = (ka(l = {}, _e, 9728),
                    ka(l, 1004, 9984),
                    ka(l, 1005, 9986),
                    ka(l, xe, 9729),
                    ka(l, 1007, 9985),
                    ka(l, be, 9987),
                    l);
                    function k(i, a, o) {
                        o ? (e.texParameteri(i, 10242, L[a.wrapS]),
                        e.texParameteri(i, 10243, L[a.wrapT]),
                        32879 !== i && 35866 !== i || e.texParameteri(i, 32882, L[a.wrapR]),
                        e.texParameteri(i, 10240, I[a.magFilter]),
                        e.texParameteri(i, 10241, I[a.minFilter])) : (e.texParameteri(i, 10242, 33071),
                        e.texParameteri(i, 10243, 33071),
                        32879 !== i && 35866 !== i || e.texParameteri(i, 32882, 33071),
                        a.wrapS === ge && a.wrapT === ge || console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),
                        e.texParameteri(i, 10240, M(a.magFilter)),
                        e.texParameteri(i, 10241, M(a.minFilter)),
                        a.minFilter !== _e && a.minFilter !== xe && console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));
                        var s = t.get("EXT_texture_filter_anisotropic");
                        if (s) {
                            if (a.type === Te && null === t.get("OES_texture_float_linear"))
                                return;
                            if (a.type === Ee && null === (c || t.get("OES_texture_half_float_linear")))
                                return;
                            (a.anisotropy > 1 || r.get(a).__currentAnisotropy) && (e.texParameterf(i, s.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(a.anisotropy, n.getMaxAnisotropy())),
                            r.get(a).__currentAnisotropy = a.anisotropy)
                        }
                    }
                    function z(t, i) {
                        void 0 === t.__webglInit && (t.__webglInit = !0,
                        i.addEventListener("dispose", T),
                        t.__webglTexture = e.createTexture(),
                        o.memory.textures++)
                    }
                    function D(t, r, n) {
                        var o = 3553;
                        r.isDataTexture2DArray && (o = 35866),
                        r.isDataTexture3D && (o = 32879),
                        z(t, r),
                        i.activeTexture(33984 + n),
                        i.bindTexture(o, t.__webglTexture),
                        e.pixelStorei(37440, r.flipY),
                        e.pixelStorei(37441, r.premultiplyAlpha),
                        e.pixelStorei(3317, r.unpackAlignment);
                        var s, l = function(e) {
                            return !c && (e.wrapS !== ge || e.wrapT !== ge || e.minFilter !== _e && e.minFilter !== xe)
                        }(r) && !1 === x(r.image), u = _(r.image, l, !1, f), h = x(u) || c, p = a.convert(r.format), d = a.convert(r.type), m = S(r.internalFormat, p, d);
                        k(o, r, h);
                        var v = r.mipmaps;
                        if (r.isDepthTexture)
                            m = 6402,
                            c ? m = r.type === Te ? 36012 : r.type === Me ? 33190 : r.type === Ae ? 35056 : 33189 : r.type === Te && console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),
                            r.format === Le && 6402 === m && r.type !== Se && r.type !== Me && (console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),
                            r.type = Se,
                            d = a.convert(r.type)),
                            r.format === Ie && 6402 === m && (m = 34041,
                            r.type !== Ae && (console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),
                            r.type = Ae,
                            d = a.convert(r.type))),
                            i.texImage2D(3553, 0, m, u.width, u.height, 0, p, d, null);
                        else if (r.isDataTexture)
                            if (v.length > 0 && h) {
                                for (var g = 0, y = v.length; g < y; g++)
                                    s = v[g],
                                    i.texImage2D(3553, g, m, s.width, s.height, 0, p, d, s.data);
                                r.generateMipmaps = !1,
                                t.__maxMipLevel = v.length - 1
                            } else
                                i.texImage2D(3553, 0, m, u.width, u.height, 0, p, d, u.data),
                                t.__maxMipLevel = 0;
                        else if (r.isCompressedTexture) {
                            for (var M = 0, T = v.length; M < T; M++)
                                s = v[M],
                                r.format !== Ce && r.format !== Pe ? null !== p ? i.compressedTexImage2D(3553, M, m, s.width, s.height, 0, s.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()") : i.texImage2D(3553, M, m, s.width, s.height, 0, p, d, s.data);
                            t.__maxMipLevel = v.length - 1
                        } else if (r.isDataTexture2DArray)
                            i.texImage3D(35866, 0, m, u.width, u.height, u.depth, 0, p, d, u.data),
                            t.__maxMipLevel = 0;
                        else if (r.isDataTexture3D)
                            i.texImage3D(32879, 0, m, u.width, u.height, u.depth, 0, p, d, u.data),
                            t.__maxMipLevel = 0;
                        else if (v.length > 0 && h) {
                            for (var E = 0, A = v.length; E < A; E++)
                                s = v[E],
                                i.texImage2D(3553, E, m, p, d, s);
                            r.generateMipmaps = !1,
                            t.__maxMipLevel = v.length - 1
                        } else
                            i.texImage2D(3553, 0, m, p, d, u),
                            t.__maxMipLevel = 0;
                        b(r, h) && w(o, r, u.width, u.height),
                        t.__version = r.version,
                        r.onUpdate && r.onUpdate(r)
                    }
                    function R(t, n, o, s) {
                        var l = a.convert(n.texture.format)
                          , u = a.convert(n.texture.type)
                          , c = S(n.texture.internalFormat, l, u);
                        i.texImage2D(s, 0, c, n.width, n.height, 0, l, u, null),
                        e.bindFramebuffer(36160, t),
                        e.framebufferTexture2D(36160, o, s, r.get(n.texture).__webglTexture, 0),
                        e.bindFramebuffer(36160, null)
                    }
                    function O(t, i, r) {
                        if (e.bindRenderbuffer(36161, t),
                        i.depthBuffer && !i.stencilBuffer) {
                            var n = 33189;
                            if (r) {
                                var o = i.depthTexture;
                                o && o.isDepthTexture && (o.type === Te ? n = 36012 : o.type === Me && (n = 33190));
                                var s = B(i);
                                e.renderbufferStorageMultisample(36161, s, n, i.width, i.height)
                            } else
                                e.renderbufferStorage(36161, n, i.width, i.height);
                            e.framebufferRenderbuffer(36160, 36096, 36161, t)
                        } else if (i.depthBuffer && i.stencilBuffer) {
                            if (r) {
                                var l = B(i);
                                e.renderbufferStorageMultisample(36161, l, 35056, i.width, i.height)
                            } else
                                e.renderbufferStorage(36161, 34041, i.width, i.height);
                            e.framebufferRenderbuffer(36160, 33306, 36161, t)
                        } else {
                            var u = a.convert(i.texture.format)
                              , c = a.convert(i.texture.type)
                              , h = S(i.texture.internalFormat, u, c);
                            if (r) {
                                var p = B(i);
                                e.renderbufferStorageMultisample(36161, p, h, i.width, i.height)
                            } else
                                e.renderbufferStorage(36161, h, i.width, i.height)
                        }
                        e.bindRenderbuffer(36161, null)
                    }
                    function B(e) {
                        return c && e.isWebGLMultisampleRenderTarget ? Math.min(d, e.samples) : 0
                    }
                    var F = !1
                      , N = !1;
                    this.allocateTextureUnit = function() {
                        var e = A;
                        return e >= h && console.warn("THREE.WebGLTextures: Trying to use " + e + " texture units while this GPU supports only " + h),
                        A += 1,
                        e
                    }
                    ,
                    this.resetTextureUnits = function() {
                        A = 0
                    }
                    ,
                    this.setTexture2D = P,
                    this.setTexture2DArray = function(e, t) {
                        var n = r.get(e);
                        e.version > 0 && n.__version !== e.version ? D(n, e, t) : (i.activeTexture(33984 + t),
                        i.bindTexture(35866, n.__webglTexture))
                    }
                    ,
                    this.setTexture3D = function(e, t) {
                        var n = r.get(e);
                        e.version > 0 && n.__version !== e.version ? D(n, e, t) : (i.activeTexture(33984 + t),
                        i.bindTexture(32879, n.__webglTexture))
                    }
                    ,
                    this.setTextureCube = C,
                    this.setupRenderTarget = function(t) {
                        var n = r.get(t)
                          , s = r.get(t.texture);
                        t.addEventListener("dispose", E),
                        s.__webglTexture = e.createTexture(),
                        o.memory.textures++;
                        var l = !0 === t.isWebGLCubeRenderTarget
                          , u = !0 === t.isWebGLMultisampleRenderTarget
                          , h = x(t) || c;
                        if (!c || t.texture.format !== Pe || t.texture.type !== Te && t.texture.type !== Ee || (t.texture.format = Ce,
                        console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),
                        l) {
                            n.__webglFramebuffer = [];
                            for (var p = 0; p < 6; p++)
                                n.__webglFramebuffer[p] = e.createFramebuffer()
                        } else if (n.__webglFramebuffer = e.createFramebuffer(),
                        u)
                            if (c) {
                                n.__webglMultisampledFramebuffer = e.createFramebuffer(),
                                n.__webglColorRenderbuffer = e.createRenderbuffer(),
                                e.bindRenderbuffer(36161, n.__webglColorRenderbuffer);
                                var f = a.convert(t.texture.format)
                                  , d = a.convert(t.texture.type)
                                  , m = S(t.texture.internalFormat, f, d)
                                  , v = B(t);
                                e.renderbufferStorageMultisample(36161, v, m, t.width, t.height),
                                e.bindFramebuffer(36160, n.__webglMultisampledFramebuffer),
                                e.framebufferRenderbuffer(36160, 36064, 36161, n.__webglColorRenderbuffer),
                                e.bindRenderbuffer(36161, null),
                                t.depthBuffer && (n.__webglDepthRenderbuffer = e.createRenderbuffer(),
                                O(n.__webglDepthRenderbuffer, t, !0)),
                                e.bindFramebuffer(36160, null)
                            } else
                                console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");
                        if (l) {
                            i.bindTexture(34067, s.__webglTexture),
                            k(34067, t.texture, h);
                            for (var g = 0; g < 6; g++)
                                R(n.__webglFramebuffer[g], t, 36064, 34069 + g);
                            b(t.texture, h) && w(34067, t.texture, t.width, t.height),
                            i.bindTexture(34067, null)
                        } else
                            i.bindTexture(3553, s.__webglTexture),
                            k(3553, t.texture, h),
                            R(n.__webglFramebuffer, t, 36064, 3553),
                            b(t.texture, h) && w(3553, t.texture, t.width, t.height),
                            i.bindTexture(3553, null);
                        t.depthBuffer && function(t) {
                            var i = r.get(t)
                              , n = !0 === t.isWebGLCubeRenderTarget;
                            if (t.depthTexture) {
                                if (n)
                                    throw new Error("target.depthTexture not supported in Cube render targets");
                                !function(t, i) {
                                    if (i && i.isWebGLCubeRenderTarget)
                                        throw new Error("Depth Texture with cube render targets is not supported");
                                    if (e.bindFramebuffer(36160, t),
                                    !i.depthTexture || !i.depthTexture.isDepthTexture)
                                        throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");
                                    r.get(i.depthTexture).__webglTexture && i.depthTexture.image.width === i.width && i.depthTexture.image.height === i.height || (i.depthTexture.image.width = i.width,
                                    i.depthTexture.image.height = i.height,
                                    i.depthTexture.needsUpdate = !0),
                                    P(i.depthTexture, 0);
                                    var n = r.get(i.depthTexture).__webglTexture;
                                    if (i.depthTexture.format === Le)
                                        e.framebufferTexture2D(36160, 36096, 3553, n, 0);
                                    else {
                                        if (i.depthTexture.format !== Ie)
                                            throw new Error("Unknown depthTexture format");
                                        e.framebufferTexture2D(36160, 33306, 3553, n, 0)
                                    }
                                }(i.__webglFramebuffer, t)
                            } else if (n) {
                                i.__webglDepthbuffer = [];
                                for (var a = 0; a < 6; a++)
                                    e.bindFramebuffer(36160, i.__webglFramebuffer[a]),
                                    i.__webglDepthbuffer[a] = e.createRenderbuffer(),
                                    O(i.__webglDepthbuffer[a], t, !1)
                            } else
                                e.bindFramebuffer(36160, i.__webglFramebuffer),
                                i.__webglDepthbuffer = e.createRenderbuffer(),
                                O(i.__webglDepthbuffer, t, !1);
                            e.bindFramebuffer(36160, null)
                        }(t)
                    }
                    ,
                    this.updateRenderTargetMipmap = function(e) {
                        var t = e.texture;
                        if (b(t, x(e) || c)) {
                            var n = e.isWebGLCubeRenderTarget ? 34067 : 3553
                              , a = r.get(t).__webglTexture;
                            i.bindTexture(n, a),
                            w(n, t, e.width, e.height),
                            i.bindTexture(n, null)
                        }
                    }
                    ,
                    this.updateMultisampleRenderTarget = function(t) {
                        if (t.isWebGLMultisampleRenderTarget)
                            if (c) {
                                var i = r.get(t);
                                e.bindFramebuffer(36008, i.__webglMultisampledFramebuffer),
                                e.bindFramebuffer(36009, i.__webglFramebuffer);
                                var n = t.width
                                  , a = t.height
                                  , o = 16384;
                                t.depthBuffer && (o |= 256),
                                t.stencilBuffer && (o |= 1024),
                                e.blitFramebuffer(0, 0, n, a, 0, 0, n, a, o, 9728),
                                e.bindFramebuffer(36160, i.__webglMultisampledFramebuffer)
                            } else
                                console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")
                    }
                    ,
                    this.safeSetTexture2D = function(e, t) {
                        e && e.isWebGLRenderTarget && (!1 === F && (console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),
                        F = !0),
                        e = e.texture),
                        P(e, t)
                    }
                    ,
                    this.safeSetTextureCube = function(e, t) {
                        e && e.isWebGLCubeRenderTarget && (!1 === N && (console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),
                        N = !0),
                        e = e.texture),
                        C(e, t)
                    }
                }
                function Da(e, t, i) {
                    var r = i.isWebGL2;
                    return {
                        convert: function(e) {
                            var i;
                            if (e === we)
                                return 5121;
                            if (1017 === e)
                                return 32819;
                            if (1018 === e)
                                return 32820;
                            if (1019 === e)
                                return 33635;
                            if (1010 === e)
                                return 5120;
                            if (1011 === e)
                                return 5122;
                            if (e === Se)
                                return 5123;
                            if (1013 === e)
                                return 5124;
                            if (e === Me)
                                return 5125;
                            if (e === Te)
                                return 5126;
                            if (e === Ee)
                                return r ? 5131 : null !== (i = t.get("OES_texture_half_float")) ? i.HALF_FLOAT_OES : null;
                            if (1021 === e)
                                return 6406;
                            if (e === Pe)
                                return 6407;
                            if (e === Ce)
                                return 6408;
                            if (1024 === e)
                                return 6409;
                            if (1025 === e)
                                return 6410;
                            if (e === Le)
                                return 6402;
                            if (e === Ie)
                                return 34041;
                            if (1028 === e)
                                return 6403;
                            if (1029 === e)
                                return 36244;
                            if (1030 === e)
                                return 33319;
                            if (1031 === e)
                                return 33320;
                            if (1032 === e)
                                return 36248;
                            if (1033 === e)
                                return 36249;
                            if (33776 === e || 33777 === e || 33778 === e || 33779 === e) {
                                if (null === (i = t.get("WEBGL_compressed_texture_s3tc")))
                                    return null;
                                if (33776 === e)
                                    return i.COMPRESSED_RGB_S3TC_DXT1_EXT;
                                if (33777 === e)
                                    return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;
                                if (33778 === e)
                                    return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;
                                if (33779 === e)
                                    return i.COMPRESSED_RGBA_S3TC_DXT5_EXT
                            }
                            if (35840 === e || 35841 === e || 35842 === e || 35843 === e) {
                                if (null === (i = t.get("WEBGL_compressed_texture_pvrtc")))
                                    return null;
                                if (35840 === e)
                                    return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
                                if (35841 === e)
                                    return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
                                if (35842 === e)
                                    return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
                                if (35843 === e)
                                    return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG
                            }
                            if (36196 === e)
                                return null !== (i = t.get("WEBGL_compressed_texture_etc1")) ? i.COMPRESSED_RGB_ETC1_WEBGL : null;
                            if ((37492 === e || 37496 === e) && null !== (i = t.get("WEBGL_compressed_texture_etc"))) {
                                if (37492 === e)
                                    return i.COMPRESSED_RGB8_ETC2;
                                if (37496 === e)
                                    return i.COMPRESSED_RGBA8_ETC2_EAC
                            }
                            return 37808 === e || 37809 === e || 37810 === e || 37811 === e || 37812 === e || 37813 === e || 37814 === e || 37815 === e || 37816 === e || 37817 === e || 37818 === e || 37819 === e || 37820 === e || 37821 === e || 37840 === e || 37841 === e || 37842 === e || 37843 === e || 37844 === e || 37845 === e || 37846 === e || 37847 === e || 37848 === e || 37849 === e || 37850 === e || 37851 === e || 37852 === e || 37853 === e ? null !== (i = t.get("WEBGL_compressed_texture_astc")) ? e : null : 36492 === e ? null !== (i = t.get("EXT_texture_compression_bptc")) ? e : null : e === Ae ? r ? 34042 : null !== (i = t.get("WEBGL_depth_texture")) ? i.UNSIGNED_INT_24_8_WEBGL : null : void 0
                        }
                    }
                }
                function Ra() {
                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [];
                    Fr.call(this),
                    this.cameras = e
                }
                function Oa() {
                    ae.call(this),
                    this.type = "Group"
                }
                function Ba() {
                    this._targetRay = null,
                    this._grip = null,
                    this._hand = null
                }
                function Fa(e, t) {
                    var i = this
                      , r = null
                      , n = 1
                      , a = null
                      , o = "local-floor"
                      , s = null
                      , l = []
                      , u = new Map
                      , c = new Fr;
                    c.layers.enable(1),
                    c.viewport = new at;
                    var h = new Fr;
                    h.layers.enable(2),
                    h.viewport = new at;
                    var p = [c, h]
                      , f = new Ra;
                    f.layers.enable(1),
                    f.layers.enable(2);
                    var d = null
                      , m = null;
                    function v(e) {
                        var t = u.get(e.inputSource);
                        t && t.dispatchEvent({
                            type: e.type,
                            data: e.inputSource
                        })
                    }
                    function g() {
                        u.forEach((function(e, t) {
                            e.disconnect(t)
                        }
                        )),
                        u.clear(),
                        e.setFramebuffer(null),
                        e.setRenderTarget(e.getRenderTarget()),
                        T.stop(),
                        i.isPresenting = !1,
                        i.dispatchEvent({
                            type: "sessionend"
                        })
                    }
                    function y(e) {
                        a = e,
                        T.setContext(r),
                        T.start(),
                        i.isPresenting = !0,
                        i.dispatchEvent({
                            type: "sessionstart"
                        })
                    }
                    function _(e) {
                        for (var t = r.inputSources, i = 0; i < l.length; i++)
                            u.set(t[i], l[i]);
                        for (var n = 0; n < e.removed.length; n++) {
                            var a = e.removed[n]
                              , o = u.get(a);
                            o && (o.dispatchEvent({
                                type: "disconnected",
                                data: a
                            }),
                            u.delete(a))
                        }
                        for (var s = 0; s < e.added.length; s++) {
                            var c = e.added[s]
                              , h = u.get(c);
                            h && h.dispatchEvent({
                                type: "connected",
                                data: c
                            })
                        }
                    }
                    this.enabled = !1,
                    this.isPresenting = !1,
                    this.getController = function(e) {
                        var t = l[e];
                        return void 0 === t && (t = new Ba,
                        l[e] = t),
                        t.getTargetRaySpace()
                    }
                    ,
                    this.getControllerGrip = function(e) {
                        var t = l[e];
                        return void 0 === t && (t = new Ba,
                        l[e] = t),
                        t.getGripSpace()
                    }
                    ,
                    this.getHand = function(e) {
                        var t = l[e];
                        return void 0 === t && (t = new Ba,
                        l[e] = t),
                        t.getHandSpace()
                    }
                    ,
                    this.setFramebufferScaleFactor = function(e) {
                        n = e,
                        !0 === i.isPresenting && console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")
                    }
                    ,
                    this.setReferenceSpaceType = function(e) {
                        o = e,
                        !0 === i.isPresenting && console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")
                    }
                    ,
                    this.getReferenceSpace = function() {
                        return a
                    }
                    ,
                    this.getSession = function() {
                        return r
                    }
                    ,
                    this.setSession = function(e) {
                        if (null !== (r = e)) {
                            r.addEventListener("select", v),
                            r.addEventListener("selectstart", v),
                            r.addEventListener("selectend", v),
                            r.addEventListener("squeeze", v),
                            r.addEventListener("squeezestart", v),
                            r.addEventListener("squeezeend", v),
                            r.addEventListener("end", g);
                            var i = t.getContextAttributes();
                            !0 !== i.xrCompatible && t.makeXRCompatible();
                            var a = {
                                antialias: i.antialias,
                                alpha: i.alpha,
                                depth: i.depth,
                                stencil: i.stencil,
                                framebufferScaleFactor: n
                            }
                              , s = new XRWebGLLayer(r,t,a);
                            r.updateRenderState({
                                baseLayer: s
                            }),
                            r.requestReferenceSpace(o).then(y),
                            r.addEventListener("inputsourceschange", _)
                        }
                    }
                    ;
                    var x = new w
                      , b = new w;
                    function S(e, t) {
                        null === t ? e.matrixWorld.copy(e.matrix) : e.matrixWorld.multiplyMatrices(t.matrixWorld, e.matrix),
                        e.matrixWorldInverse.copy(e.matrixWorld).invert()
                    }
                    this.getCamera = function(e) {
                        f.near = h.near = c.near = e.near,
                        f.far = h.far = c.far = e.far,
                        d === f.near && m === f.far || (r.updateRenderState({
                            depthNear: f.near,
                            depthFar: f.far
                        }),
                        d = f.near,
                        m = f.far);
                        var t = e.parent
                          , i = f.cameras;
                        S(f, t);
                        for (var n = 0; n < i.length; n++)
                            S(i[n], t);
                        e.matrixWorld.copy(f.matrixWorld);
                        for (var a = e.children, o = 0, s = a.length; o < s; o++)
                            a[o].updateMatrixWorld(!0);
                        return 2 === i.length ? function(e, t, i) {
                            x.setFromMatrixPosition(t.matrixWorld),
                            b.setFromMatrixPosition(i.matrixWorld);
                            var r = x.distanceTo(b)
                              , n = t.projectionMatrix.elements
                              , a = i.projectionMatrix.elements
                              , o = n[14] / (n[10] - 1)
                              , s = n[14] / (n[10] + 1)
                              , l = (n[9] + 1) / n[5]
                              , u = (n[9] - 1) / n[5]
                              , c = (n[8] - 1) / n[0]
                              , h = (a[8] + 1) / a[0]
                              , p = o * c
                              , f = o * h
                              , d = r / (-c + h)
                              , m = d * -c;
                            t.matrixWorld.decompose(e.position, e.quaternion, e.scale),
                            e.translateX(m),
                            e.translateZ(d),
                            e.matrixWorld.compose(e.position, e.quaternion, e.scale),
                            e.matrixWorldInverse.copy(e.matrixWorld).invert();
                            var v = o + d
                              , g = s + d
                              , y = p - m
                              , _ = f + (r - m)
                              , w = l * s / g * v
                              , S = u * s / g * v;
                            e.projectionMatrix.makePerspective(y, _, w, S, v, g)
                        }(f, c, h) : f.projectionMatrix.copy(c.projectionMatrix),
                        f
                    }
                    ;
                    var M = null
                      , T = new br;
                    T.setAnimationLoop((function(t, i) {
                        if (null !== (s = i.getViewerPose(a))) {
                            var n = s.views
                              , o = r.renderState.baseLayer;
                            e.setFramebuffer(o.framebuffer);
                            var u = !1;
                            n.length !== f.cameras.length && (f.cameras.length = 0,
                            u = !0);
                            for (var c = 0; c < n.length; c++) {
                                var h = n[c]
                                  , d = o.getViewport(h)
                                  , m = p[c];
                                m.matrix.fromArray(h.transform.matrix),
                                m.projectionMatrix.fromArray(h.projectionMatrix),
                                m.viewport.set(d.x, d.y, d.width, d.height),
                                0 === c && f.matrix.copy(m.matrix),
                                !0 === u && f.cameras.push(m)
                            }
                        }
                        for (var v = r.inputSources, g = 0; g < l.length; g++) {
                            var y = l[g]
                              , _ = v[g];
                            y.update(_, i, a)
                        }
                        M && M(t, i)
                    }
                    )),
                    this.setAnimationLoop = function(e) {
                        M = e
                    }
                    ,
                    this.dispose = function() {}
                }
                function Na(e) {
                    function t(t, i) {
                        t.opacity.value = i.opacity,
                        i.color && t.diffuse.value.copy(i.color),
                        i.emissive && t.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),
                        i.map && (t.map.value = i.map),
                        i.alphaMap && (t.alphaMap.value = i.alphaMap),
                        i.specularMap && (t.specularMap.value = i.specularMap);
                        var r, n, a = e.get(i).envMap;
                        if (a) {
                            t.envMap.value = a,
                            t.flipEnvMap.value = a.isCubeTexture && a._needsFlipEnvMap ? -1 : 1,
                            t.reflectivity.value = i.reflectivity,
                            t.refractionRatio.value = i.refractionRatio;
                            var o = e.get(a).__maxMipLevel;
                            void 0 !== o && (t.maxMipLevel.value = o)
                        }
                        i.lightMap && (t.lightMap.value = i.lightMap,
                        t.lightMapIntensity.value = i.lightMapIntensity),
                        i.aoMap && (t.aoMap.value = i.aoMap,
                        t.aoMapIntensity.value = i.aoMapIntensity),
                        i.map ? r = i.map : i.specularMap ? r = i.specularMap : i.displacementMap ? r = i.displacementMap : i.normalMap ? r = i.normalMap : i.bumpMap ? r = i.bumpMap : i.roughnessMap ? r = i.roughnessMap : i.metalnessMap ? r = i.metalnessMap : i.alphaMap ? r = i.alphaMap : i.emissiveMap ? r = i.emissiveMap : i.clearcoatMap ? r = i.clearcoatMap : i.clearcoatNormalMap ? r = i.clearcoatNormalMap : i.clearcoatRoughnessMap && (r = i.clearcoatRoughnessMap),
                        void 0 !== r && (r.isWebGLRenderTarget && (r = r.texture),
                        !0 === r.matrixAutoUpdate && r.updateMatrix(),
                        t.uvTransform.value.copy(r.matrix)),
                        i.aoMap ? n = i.aoMap : i.lightMap && (n = i.lightMap),
                        void 0 !== n && (n.isWebGLRenderTarget && (n = n.texture),
                        !0 === n.matrixAutoUpdate && n.updateMatrix(),
                        t.uv2Transform.value.copy(n.matrix))
                    }
                    function i(t, i) {
                        t.roughness.value = i.roughness,
                        t.metalness.value = i.metalness,
                        i.roughnessMap && (t.roughnessMap.value = i.roughnessMap),
                        i.metalnessMap && (t.metalnessMap.value = i.metalnessMap),
                        i.emissiveMap && (t.emissiveMap.value = i.emissiveMap),
                        i.bumpMap && (t.bumpMap.value = i.bumpMap,
                        t.bumpScale.value = i.bumpScale,
                        1 === i.side && (t.bumpScale.value *= -1)),
                        i.normalMap && (t.normalMap.value = i.normalMap,
                        t.normalScale.value.copy(i.normalScale),
                        1 === i.side && t.normalScale.value.negate()),
                        i.displacementMap && (t.displacementMap.value = i.displacementMap,
                        t.displacementScale.value = i.displacementScale,
                        t.displacementBias.value = i.displacementBias),
                        e.get(i).envMap && (t.envMapIntensity.value = i.envMapIntensity)
                    }
                    return {
                        refreshFogUniforms: function(e, t) {
                            e.fogColor.value.copy(t.color),
                            t.isFog ? (e.fogNear.value = t.near,
                            e.fogFar.value = t.far) : t.isFogExp2 && (e.fogDensity.value = t.density)
                        },
                        refreshMaterialUniforms: function(e, r, n, a) {
                            r.isMeshBasicMaterial ? t(e, r) : r.isMeshLambertMaterial ? (t(e, r),
                            function(e, t) {
                                t.emissiveMap && (e.emissiveMap.value = t.emissiveMap)
                            }(e, r)) : r.isMeshToonMaterial ? (t(e, r),
                            function(e, t) {
                                t.gradientMap && (e.gradientMap.value = t.gradientMap),
                                t.emissiveMap && (e.emissiveMap.value = t.emissiveMap),
                                t.bumpMap && (e.bumpMap.value = t.bumpMap,
                                e.bumpScale.value = t.bumpScale,
                                1 === t.side && (e.bumpScale.value *= -1)),
                                t.normalMap && (e.normalMap.value = t.normalMap,
                                e.normalScale.value.copy(t.normalScale),
                                1 === t.side && e.normalScale.value.negate()),
                                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                                e.displacementScale.value = t.displacementScale,
                                e.displacementBias.value = t.displacementBias)
                            }(e, r)) : r.isMeshPhongMaterial ? (t(e, r),
                            function(e, t) {
                                e.specular.value.copy(t.specular),
                                e.shininess.value = Math.max(t.shininess, 1e-4),
                                t.emissiveMap && (e.emissiveMap.value = t.emissiveMap),
                                t.bumpMap && (e.bumpMap.value = t.bumpMap,
                                e.bumpScale.value = t.bumpScale,
                                1 === t.side && (e.bumpScale.value *= -1)),
                                t.normalMap && (e.normalMap.value = t.normalMap,
                                e.normalScale.value.copy(t.normalScale),
                                1 === t.side && e.normalScale.value.negate()),
                                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                                e.displacementScale.value = t.displacementScale,
                                e.displacementBias.value = t.displacementBias)
                            }(e, r)) : r.isMeshStandardMaterial ? (t(e, r),
                            r.isMeshPhysicalMaterial ? function(e, t) {
                                i(e, t),
                                e.reflectivity.value = t.reflectivity,
                                e.clearcoat.value = t.clearcoat,
                                e.clearcoatRoughness.value = t.clearcoatRoughness,
                                t.sheen && e.sheen.value.copy(t.sheen),
                                t.clearcoatMap && (e.clearcoatMap.value = t.clearcoatMap),
                                t.clearcoatRoughnessMap && (e.clearcoatRoughnessMap.value = t.clearcoatRoughnessMap),
                                t.clearcoatNormalMap && (e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),
                                e.clearcoatNormalMap.value = t.clearcoatNormalMap,
                                1 === t.side && e.clearcoatNormalScale.value.negate()),
                                e.transmission.value = t.transmission,
                                t.transmissionMap && (e.transmissionMap.value = t.transmissionMap)
                            }(e, r) : i(e, r)) : r.isMeshMatcapMaterial ? (t(e, r),
                            function(e, t) {
                                t.matcap && (e.matcap.value = t.matcap),
                                t.bumpMap && (e.bumpMap.value = t.bumpMap,
                                e.bumpScale.value = t.bumpScale,
                                1 === t.side && (e.bumpScale.value *= -1)),
                                t.normalMap && (e.normalMap.value = t.normalMap,
                                e.normalScale.value.copy(t.normalScale),
                                1 === t.side && e.normalScale.value.negate()),
                                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                                e.displacementScale.value = t.displacementScale,
                                e.displacementBias.value = t.displacementBias)
                            }(e, r)) : r.isMeshDepthMaterial ? (t(e, r),
                            function(e, t) {
                                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                                e.displacementScale.value = t.displacementScale,
                                e.displacementBias.value = t.displacementBias)
                            }(e, r)) : r.isMeshDistanceMaterial ? (t(e, r),
                            function(e, t) {
                                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                                e.displacementScale.value = t.displacementScale,
                                e.displacementBias.value = t.displacementBias),
                                e.referencePosition.value.copy(t.referencePosition),
                                e.nearDistance.value = t.nearDistance,
                                e.farDistance.value = t.farDistance
                            }(e, r)) : r.isMeshNormalMaterial ? (t(e, r),
                            function(e, t) {
                                t.bumpMap && (e.bumpMap.value = t.bumpMap,
                                e.bumpScale.value = t.bumpScale,
                                1 === t.side && (e.bumpScale.value *= -1)),
                                t.normalMap && (e.normalMap.value = t.normalMap,
                                e.normalScale.value.copy(t.normalScale),
                                1 === t.side && e.normalScale.value.negate()),
                                t.displacementMap && (e.displacementMap.value = t.displacementMap,
                                e.displacementScale.value = t.displacementScale,
                                e.displacementBias.value = t.displacementBias)
                            }(e, r)) : r.isLineBasicMaterial ? (function(e, t) {
                                e.diffuse.value.copy(t.color),
                                e.opacity.value = t.opacity
                            }(e, r),
                            r.isLineDashedMaterial && function(e, t) {
                                e.dashSize.value = t.dashSize,
                                e.totalSize.value = t.dashSize + t.gapSize,
                                e.scale.value = t.scale
                            }(e, r)) : r.isPointsMaterial ? function(e, t, i, r) {
                                var n;
                                e.diffuse.value.copy(t.color),
                                e.opacity.value = t.opacity,
                                e.size.value = t.size * i,
                                e.scale.value = .5 * r,
                                t.map && (e.map.value = t.map),
                                t.alphaMap && (e.alphaMap.value = t.alphaMap),
                                t.map ? n = t.map : t.alphaMap && (n = t.alphaMap),
                                void 0 !== n && (!0 === n.matrixAutoUpdate && n.updateMatrix(),
                                e.uvTransform.value.copy(n.matrix))
                            }(e, r, n, a) : r.isSpriteMaterial ? function(e, t) {
                                var i;
                                e.diffuse.value.copy(t.color),
                                e.opacity.value = t.opacity,
                                e.rotation.value = t.rotation,
                                t.map && (e.map.value = t.map),
                                t.alphaMap && (e.alphaMap.value = t.alphaMap),
                                t.map ? i = t.map : t.alphaMap && (i = t.alphaMap),
                                void 0 !== i && (!0 === i.matrixAutoUpdate && i.updateMatrix(),
                                e.uvTransform.value.copy(i.matrix))
                            }(e, r) : r.isShadowMaterial ? (e.color.value.copy(r.color),
                            e.opacity.value = r.opacity) : r.isShaderMaterial && (r.uniformsNeedUpdate = !1)
                        }
                    }
                }
                function Ua(e) {
                    var t, i = void 0 !== (e = e || {}).canvas ? e.canvas : ((t = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas")).style.display = "block",
                    t), r = void 0 !== e.context ? e.context : null, n = void 0 !== e.alpha && e.alpha, a = void 0 === e.depth || e.depth, o = void 0 === e.stencil || e.stencil, s = void 0 !== e.antialias && e.antialias, l = void 0 === e.premultipliedAlpha || e.premultipliedAlpha, u = void 0 !== e.preserveDrawingBuffer && e.preserveDrawingBuffer, c = void 0 !== e.powerPreference ? e.powerPreference : "default", h = void 0 !== e.failIfMajorPerformanceCaveat && e.failIfMajorPerformanceCaveat, p = null, f = null, d = [];
                    this.domElement = i,
                    this.debug = {
                        checkShaderErrors: !0
                    },
                    this.autoClear = !0,
                    this.autoClearColor = !0,
                    this.autoClearDepth = !0,
                    this.autoClearStencil = !0,
                    this.sortObjects = !0,
                    this.clippingPlanes = [],
                    this.localClippingEnabled = !1,
                    this.gammaFactor = 2,
                    this.outputEncoding = ke,
                    this.physicallyCorrectLights = !1,
                    this.toneMapping = 0,
                    this.toneMappingExposure = 1,
                    this.maxMorphTargets = 8,
                    this.maxMorphNormals = 4;
                    var m = this
                      , g = !1
                      , y = null
                      , _ = 0
                      , x = 0
                      , b = null
                      , S = null
                      , M = -1
                      , T = null
                      , E = new at
                      , P = new at
                      , C = null
                      , L = i.width
                      , I = i.height
                      , k = 1
                      , z = null
                      , D = null
                      , R = new at(0,0,L,I)
                      , O = new at(0,0,L,I)
                      , B = !1
                      , F = new xr
                      , N = !1
                      , U = !1
                      , V = new A
                      , G = new w
                      , j = {
                        background: null,
                        fog: null,
                        environment: null,
                        overrideMaterial: null,
                        isScene: !0
                    };
                    function H() {
                        return null === b ? k : 1
                    }
                    var q, W, Z, X, Y, K, J, Q, $, ee, te, ie, re, ne, ae, oe, se, le, ue, ce, he, pe = r;
                    function fe(e, t) {
                        for (var r = 0; r < e.length; r++) {
                            var n = e[r]
                              , a = i.getContext(n, t);
                            if (null !== a)
                                return a
                        }
                        return null
                    }
                    try {
                        var de = {
                            alpha: n,
                            depth: a,
                            stencil: o,
                            antialias: s,
                            premultipliedAlpha: l,
                            preserveDrawingBuffer: u,
                            powerPreference: c,
                            failIfMajorPerformanceCaveat: h
                        };
                        if (i.addEventListener("webglcontextlost", _e, !1),
                        i.addEventListener("webglcontextrestored", xe, !1),
                        null === pe) {
                            var me = ["webgl2", "webgl", "experimental-webgl"];
                            if (!0 === m.isWebGL1Renderer && me.shift(),
                            null === (pe = fe(me, de)))
                                throw fe(me) ? new Error("Error creating WebGL context with your selected attributes.") : new Error("Error creating WebGL context.")
                        }
                        void 0 === pe.getShaderPrecisionFormat && (pe.getShaderPrecisionFormat = function() {
                            return {
                                rangeMin: 1,
                                rangeMax: 1,
                                precision: 1
                            }
                        }
                        )
                    } catch (e) {
                        throw console.error("THREE.WebGLRenderer: " + e.message),
                        e
                    }
                    function ve() {
                        q = new Hr(pe),
                        !1 === (W = new Rr(pe,q,e)).isWebGL2 && (q.get("WEBGL_depth_texture"),
                        q.get("OES_texture_float"),
                        q.get("OES_texture_half_float"),
                        q.get("OES_texture_half_float_linear"),
                        q.get("OES_standard_derivatives"),
                        q.get("OES_element_index_uint"),
                        q.get("OES_vertex_array_object"),
                        q.get("ANGLE_instanced_arrays")),
                        q.get("OES_texture_float_linear"),
                        ce = new Da(pe,q,W),
                        (Z = new Ia(pe,q,W)).scissor(P.copy(O).multiplyScalar(k).floor()),
                        Z.viewport(E.copy(R).multiplyScalar(k).floor()),
                        X = new Zr(pe),
                        Y = new va,
                        K = new za(pe,q,Z,Y,W,ce,X),
                        J = new jr(m),
                        Q = new wr(pe,W),
                        he = new zr(pe,q,Q,W),
                        $ = new qr(pe,Q,X,he),
                        ee = new Jr(pe,$,Q,X),
                        se = new Kr(pe),
                        ae = new Or(Y),
                        te = new ma(m,J,q,W,he,ae),
                        ie = new Na(Y),
                        re = new xa(Y),
                        ne = new Ea(q,W),
                        oe = new kr(m,J,Z,ee,l),
                        le = new Dr(pe,q,X,W),
                        ue = new Wr(pe,q,X,W),
                        X.programs = te.programs,
                        m.capabilities = W,
                        m.extensions = q,
                        m.properties = Y,
                        m.renderLists = re,
                        m.state = Z,
                        m.info = X
                    }
                    ve();
                    var ge = new Fa(m,pe);
                    this.xr = ge;
                    var ye = new Ca(m,ee,W.maxTextureSize);
                    function _e(e) {
                        e.preventDefault(),
                        console.log("THREE.WebGLRenderer: Context Lost."),
                        g = !0
                    }
                    function xe() {
                        console.log("THREE.WebGLRenderer: Context Restored."),
                        g = !1,
                        ve()
                    }
                    function be(e) {
                        var t = e.target;
                        t.removeEventListener("dispose", be),
                        function(e) {
                            Se(e),
                            Y.remove(e)
                        }(t)
                    }
                    function Se(e) {
                        var t = Y.get(e).program;
                        void 0 !== t && te.releaseProgram(t)
                    }
                    this.shadowMap = ye,
                    this.getContext = function() {
                        return pe
                    }
                    ,
                    this.getContextAttributes = function() {
                        return pe.getContextAttributes()
                    }
                    ,
                    this.forceContextLoss = function() {
                        var e = q.get("WEBGL_lose_context");
                        e && e.loseContext()
                    }
                    ,
                    this.forceContextRestore = function() {
                        var e = q.get("WEBGL_lose_context");
                        e && e.restoreContext()
                    }
                    ,
                    this.getPixelRatio = function() {
                        return k
                    }
                    ,
                    this.setPixelRatio = function(e) {
                        void 0 !== e && (k = e,
                        this.setSize(L, I, !1))
                    }
                    ,
                    this.getSize = function(e) {
                        return void 0 === e && (console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),
                        e = new lt),
                        e.set(L, I)
                    }
                    ,
                    this.setSize = function(e, t, r) {
                        ge.isPresenting ? console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.") : (L = e,
                        I = t,
                        i.width = Math.floor(e * k),
                        i.height = Math.floor(t * k),
                        !1 !== r && (i.style.width = e + "px",
                        i.style.height = t + "px"),
                        this.setViewport(0, 0, e, t))
                    }
                    ,
                    this.getDrawingBufferSize = function(e) {
                        return void 0 === e && (console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),
                        e = new lt),
                        e.set(L * k, I * k).floor()
                    }
                    ,
                    this.setDrawingBufferSize = function(e, t, r) {
                        L = e,
                        I = t,
                        k = r,
                        i.width = Math.floor(e * r),
                        i.height = Math.floor(t * r),
                        this.setViewport(0, 0, e, t)
                    }
                    ,
                    this.getCurrentViewport = function(e) {
                        return void 0 === e && (console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),
                        e = new at),
                        e.copy(E)
                    }
                    ,
                    this.getViewport = function(e) {
                        return e.copy(R)
                    }
                    ,
                    this.setViewport = function(e, t, i, r) {
                        e.isVector4 ? R.set(e.x, e.y, e.z, e.w) : R.set(e, t, i, r),
                        Z.viewport(E.copy(R).multiplyScalar(k).floor())
                    }
                    ,
                    this.getScissor = function(e) {
                        return e.copy(O)
                    }
                    ,
                    this.setScissor = function(e, t, i, r) {
                        e.isVector4 ? O.set(e.x, e.y, e.z, e.w) : O.set(e, t, i, r),
                        Z.scissor(P.copy(O).multiplyScalar(k).floor())
                    }
                    ,
                    this.getScissorTest = function() {
                        return B
                    }
                    ,
                    this.setScissorTest = function(e) {
                        Z.setScissorTest(B = e)
                    }
                    ,
                    this.setOpaqueSort = function(e) {
                        z = e
                    }
                    ,
                    this.setTransparentSort = function(e) {
                        D = e
                    }
                    ,
                    this.getClearColor = function(e) {
                        return void 0 === e && (console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),
                        e = new vt),
                        e.copy(oe.getClearColor())
                    }
                    ,
                    this.setClearColor = function() {
                        oe.setClearColor.apply(oe, arguments)
                    }
                    ,
                    this.getClearAlpha = function() {
                        return oe.getClearAlpha()
                    }
                    ,
                    this.setClearAlpha = function() {
                        oe.setClearAlpha.apply(oe, arguments)
                    }
                    ,
                    this.clear = function(e, t, i) {
                        var r = 0;
                        (void 0 === e || e) && (r |= 16384),
                        (void 0 === t || t) && (r |= 256),
                        (void 0 === i || i) && (r |= 1024),
                        pe.clear(r)
                    }
                    ,
                    this.clearColor = function() {
                        this.clear(!0, !1, !1)
                    }
                    ,
                    this.clearDepth = function() {
                        this.clear(!1, !0, !1)
                    }
                    ,
                    this.clearStencil = function() {
                        this.clear(!1, !1, !0)
                    }
                    ,
                    this.dispose = function() {
                        i.removeEventListener("webglcontextlost", _e, !1),
                        i.removeEventListener("webglcontextrestored", xe, !1),
                        re.dispose(),
                        ne.dispose(),
                        Y.dispose(),
                        J.dispose(),
                        ee.dispose(),
                        he.dispose(),
                        ge.dispose(),
                        Ae.stop()
                    }
                    ,
                    this.renderBufferImmediate = function(e, t) {
                        he.initAttributes();
                        var i = Y.get(e);
                        e.hasPositions && !i.position && (i.position = pe.createBuffer()),
                        e.hasNormals && !i.normal && (i.normal = pe.createBuffer()),
                        e.hasUvs && !i.uv && (i.uv = pe.createBuffer()),
                        e.hasColors && !i.color && (i.color = pe.createBuffer());
                        var r = t.getAttributes();
                        e.hasPositions && (pe.bindBuffer(34962, i.position),
                        pe.bufferData(34962, e.positionArray, 35048),
                        he.enableAttribute(r.position),
                        pe.vertexAttribPointer(r.position, 3, 5126, !1, 0, 0)),
                        e.hasNormals && (pe.bindBuffer(34962, i.normal),
                        pe.bufferData(34962, e.normalArray, 35048),
                        he.enableAttribute(r.normal),
                        pe.vertexAttribPointer(r.normal, 3, 5126, !1, 0, 0)),
                        e.hasUvs && (pe.bindBuffer(34962, i.uv),
                        pe.bufferData(34962, e.uvArray, 35048),
                        he.enableAttribute(r.uv),
                        pe.vertexAttribPointer(r.uv, 2, 5126, !1, 0, 0)),
                        e.hasColors && (pe.bindBuffer(34962, i.color),
                        pe.bufferData(34962, e.colorArray, 35048),
                        he.enableAttribute(r.color),
                        pe.vertexAttribPointer(r.color, 3, 5126, !1, 0, 0)),
                        he.disableUnusedAttributes(),
                        pe.drawArrays(4, 0, e.count),
                        e.count = 0
                    }
                    ,
                    this.renderBufferDirect = function(e, t, i, r, n, a) {
                        null === t && (t = j);
                        var o = n.isMesh && n.matrixWorld.determinant() < 0
                          , s = De(e, t, r, n);
                        Z.setMaterial(r, o);
                        var l = i.index
                          , u = i.attributes.position;
                        if (null === l) {
                            if (void 0 === u || 0 === u.count)
                                return
                        } else if (0 === l.count)
                            return;
                        var c, h = 1;
                        !0 === r.wireframe && (l = $.getWireframeAttribute(i),
                        h = 2),
                        (r.morphTargets || r.morphNormals) && se.update(n, i, r, s),
                        he.setup(n, r, s, i, l);
                        var p = le;
                        null !== l && (c = Q.get(l),
                        (p = ue).setIndex(c));
                        var f = null !== l ? l.count : u.count
                          , d = i.drawRange.start * h
                          , m = i.drawRange.count * h
                          , v = null !== a ? a.start * h : 0
                          , g = null !== a ? a.count * h : 1 / 0
                          , y = Math.max(d, v)
                          , _ = Math.min(f, d + m, v + g) - 1
                          , x = Math.max(0, _ - y + 1);
                        if (0 !== x) {
                            if (n.isMesh)
                                !0 === r.wireframe ? (Z.setLineWidth(r.wireframeLinewidth * H()),
                                p.setMode(1)) : p.setMode(4);
                            else if (n.isLine) {
                                var b = r.linewidth;
                                void 0 === b && (b = 1),
                                Z.setLineWidth(b * H()),
                                n.isLineSegments ? p.setMode(1) : n.isLineLoop ? p.setMode(2) : p.setMode(3)
                            } else
                                n.isPoints ? p.setMode(0) : n.isSprite && p.setMode(4);
                            if (n.isInstancedMesh)
                                p.renderInstances(y, x, n.count);
                            else if (i.isInstancedBufferGeometry) {
                                var w = Math.min(i.instanceCount, i._maxInstanceCount);
                                p.renderInstances(y, x, w)
                            } else
                                p.render(y, x)
                        }
                    }
                    ,
                    this.compile = function(e, t) {
                        (f = ne.get(e)).init(),
                        e.traverseVisible((function(e) {
                            e.isLight && e.layers.test(t.layers) && (f.pushLight(e),
                            e.castShadow && f.pushShadow(e))
                        }
                        )),
                        f.setupLights();
                        var i = new WeakMap;
                        e.traverse((function(t) {
                            var r = t.material;
                            if (r)
                                if (Array.isArray(r))
                                    for (var n = 0; n < r.length; n++) {
                                        var a = r[n];
                                        !1 === i.has(a) && (ze(a, e, t),
                                        i.set(a))
                                    }
                                else
                                    !1 === i.has(r) && (ze(r, e, t),
                                    i.set(r))
                        }
                        ))
                    }
                    ;
                    var Me = null
                      , Ae = new br;
                    function Pe(e, t, i, r) {
                        if (!1 !== e.visible) {
                            if (e.layers.test(t.layers))
                                if (e.isGroup)
                                    i = e.renderOrder;
                                else if (e.isLOD)
                                    !0 === e.autoUpdate && e.update(t);
                                else if (e.isLight)
                                    f.pushLight(e),
                                    e.castShadow && f.pushShadow(e);
                                else if (e.isSprite) {
                                    if (!e.frustumCulled || F.intersectsSprite(e)) {
                                        r && G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V);
                                        var n = ee.update(e)
                                          , a = e.material;
                                        a.visible && p.push(e, n, a, i, G.z, null)
                                    }
                                } else if (e.isImmediateRenderObject)
                                    r && G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V),
                                    p.push(e, null, e.material, i, G.z, null);
                                else if ((e.isMesh || e.isLine || e.isPoints) && (e.isSkinnedMesh && e.skeleton.frame !== X.render.frame && (e.skeleton.update(),
                                e.skeleton.frame = X.render.frame),
                                !e.frustumCulled || F.intersectsObject(e))) {
                                    r && G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V);
                                    var o = ee.update(e)
                                      , s = e.material;
                                    if (Array.isArray(s))
                                        for (var l = o.groups, u = 0, c = l.length; u < c; u++) {
                                            var h = l[u]
                                              , d = s[h.materialIndex];
                                            d && d.visible && p.push(e, o, d, i, G.z, h)
                                        }
                                    else
                                        s.visible && p.push(e, o, s, i, G.z, null)
                                }
                            for (var m = e.children, v = 0, g = m.length; v < g; v++)
                                Pe(m[v], t, i, r)
                        }
                    }
                    function Le(e, t, i) {
                        for (var r = !0 === t.isScene ? t.overrideMaterial : null, n = 0, a = e.length; n < a; n++) {
                            var o = e[n]
                              , s = o.object
                              , l = o.geometry
                              , u = null === r ? o.material : r
                              , c = o.group;
                            if (i.isArrayCamera)
                                for (var h = i.cameras, p = 0, d = h.length; p < d; p++) {
                                    var m = h[p];
                                    s.layers.test(m.layers) && (Z.viewport(E.copy(m.viewport)),
                                    f.setupLightsView(m),
                                    Ie(s, t, m, l, u, c))
                                }
                            else
                                Ie(s, t, i, l, u, c)
                        }
                    }
                    function Ie(e, t, i, r, n, a) {
                        if (e.onBeforeRender(m, t, i, r, n, a),
                        e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse, e.matrixWorld),
                        e.normalMatrix.getNormalMatrix(e.modelViewMatrix),
                        e.isImmediateRenderObject) {
                            var o = De(i, t, n, e);
                            Z.setMaterial(n),
                            he.reset(),
                            function(e, t) {
                                e.render((function(e) {
                                    m.renderBufferImmediate(e, t)
                                }
                                ))
                            }(e, o)
                        } else
                            m.renderBufferDirect(i, t, r, n, e, a);
                        e.onAfterRender(m, t, i, r, n, a)
                    }
                    function ze(e, t, i) {
                        !0 !== t.isScene && (t = j);
                        var r = Y.get(e)
                          , n = f.state.lights
                          , a = f.state.shadowsArray
                          , o = n.state.version
                          , s = te.getParameters(e, n.state, a, t, i)
                          , l = te.getProgramCacheKey(s)
                          , u = r.program
                          , c = !0;
                        if (void 0 === u)
                            e.addEventListener("dispose", be);
                        else if (u.cacheKey !== l)
                            Se(e);
                        else if (r.lightsStateVersion !== o)
                            c = !1;
                        else {
                            if (void 0 !== s.shaderID) {
                                var h = e.isMeshStandardMaterial ? t.environment : null;
                                return void (r.envMap = J.get(e.envMap || h))
                            }
                            c = !1
                        }
                        c && (s.uniforms = te.getUniforms(e),
                        e.onBeforeCompile(s, m),
                        u = te.acquireProgram(s, l),
                        r.program = u,
                        r.uniforms = s.uniforms,
                        r.outputEncoding = s.outputEncoding);
                        var p = r.uniforms;
                        (e.isShaderMaterial || e.isRawShaderMaterial) && !0 !== e.clipping || (r.numClippingPlanes = ae.numPlanes,
                        r.numIntersection = ae.numIntersection,
                        p.clippingPlanes = ae.uniform),
                        r.environment = e.isMeshStandardMaterial ? t.environment : null,
                        r.fog = t.fog,
                        r.envMap = J.get(e.envMap || r.environment),
                        r.needsLights = function(e) {
                            return e.isMeshLambertMaterial || e.isMeshToonMaterial || e.isMeshPhongMaterial || e.isMeshStandardMaterial || e.isShadowMaterial || e.isShaderMaterial && !0 === e.lights
                        }(e),
                        r.lightsStateVersion = o,
                        r.needsLights && (p.ambientLightColor.value = n.state.ambient,
                        p.lightProbe.value = n.state.probe,
                        p.directionalLights.value = n.state.directional,
                        p.directionalLightShadows.value = n.state.directionalShadow,
                        p.spotLights.value = n.state.spot,
                        p.spotLightShadows.value = n.state.spotShadow,
                        p.rectAreaLights.value = n.state.rectArea,
                        p.ltc_1.value = n.state.rectAreaLTC1,
                        p.ltc_2.value = n.state.rectAreaLTC2,
                        p.pointLights.value = n.state.point,
                        p.pointLightShadows.value = n.state.pointShadow,
                        p.hemisphereLights.value = n.state.hemi,
                        p.directionalShadowMap.value = n.state.directionalShadowMap,
                        p.directionalShadowMatrix.value = n.state.directionalShadowMatrix,
                        p.spotShadowMap.value = n.state.spotShadowMap,
                        p.spotShadowMatrix.value = n.state.spotShadowMatrix,
                        p.pointShadowMap.value = n.state.pointShadowMap,
                        p.pointShadowMatrix.value = n.state.pointShadowMatrix);
                        var d = r.program.getUniforms()
                          , v = Yn.seqWithValue(d.seq, p);
                        r.uniformsList = v
                    }
                    function De(e, t, i, r) {
                        !0 !== t.isScene && (t = j),
                        K.resetTextureUnits();
                        var n = t.fog
                          , a = i.isMeshStandardMaterial ? t.environment : null
                          , o = null === b ? m.outputEncoding : b.texture.encoding
                          , s = J.get(i.envMap || a)
                          , l = Y.get(i)
                          , u = f.state.lights;
                        if (!0 === N && (!0 === U || e !== T)) {
                            var c = e === T && i.id === M;
                            ae.setState(i, e, c)
                        }
                        i.version === l.__version ? i.fog && l.fog !== n || l.environment !== a || l.needsLights && l.lightsStateVersion !== u.state.version ? ze(i, t, r) : void 0 === l.numClippingPlanes || l.numClippingPlanes === ae.numPlanes && l.numIntersection === ae.numIntersection ? (l.outputEncoding !== o || l.envMap !== s) && ze(i, t, r) : ze(i, t, r) : (ze(i, t, r),
                        l.__version = i.version);
                        var h, p, d = !1, g = !1, y = !1, _ = l.program, x = _.getUniforms(), w = l.uniforms;
                        if (Z.useProgram(_.program) && (d = !0,
                        g = !0,
                        y = !0),
                        i.id !== M && (M = i.id,
                        g = !0),
                        d || T !== e) {
                            if (x.setValue(pe, "projectionMatrix", e.projectionMatrix),
                            W.logarithmicDepthBuffer && x.setValue(pe, "logDepthBufFC", 2 / (Math.log(e.far + 1) / Math.LN2)),
                            T !== e && (T = e,
                            g = !0,
                            y = !0),
                            i.isShaderMaterial || i.isMeshPhongMaterial || i.isMeshToonMaterial || i.isMeshStandardMaterial || i.envMap) {
                                var S = x.map.cameraPosition;
                                void 0 !== S && S.setValue(pe, G.setFromMatrixPosition(e.matrixWorld))
                            }
                            (i.isMeshPhongMaterial || i.isMeshToonMaterial || i.isMeshLambertMaterial || i.isMeshBasicMaterial || i.isMeshStandardMaterial || i.isShaderMaterial) && x.setValue(pe, "isOrthographic", !0 === e.isOrthographicCamera),
                            (i.isMeshPhongMaterial || i.isMeshToonMaterial || i.isMeshLambertMaterial || i.isMeshBasicMaterial || i.isMeshStandardMaterial || i.isShaderMaterial || i.isShadowMaterial || i.skinning) && x.setValue(pe, "viewMatrix", e.matrixWorldInverse)
                        }
                        if (i.skinning) {
                            x.setOptional(pe, r, "bindMatrix"),
                            x.setOptional(pe, r, "bindMatrixInverse");
                            var E = r.skeleton;
                            if (E) {
                                var A = E.bones;
                                if (W.floatVertexTextures) {
                                    if (null === E.boneTexture) {
                                        var P = Math.sqrt(4 * A.length);
                                        P = v.ceilPowerOfTwo(P),
                                        P = Math.max(P, 4);
                                        var C = new Float32Array(P * P * 4);
                                        C.set(E.boneMatrices);
                                        var L = new vr(C,P,P,Ce,Te);
                                        E.boneMatrices = C,
                                        E.boneTexture = L,
                                        E.boneTextureSize = P
                                    }
                                    x.setValue(pe, "boneTexture", E.boneTexture, K),
                                    x.setValue(pe, "boneTextureSize", E.boneTextureSize)
                                } else
                                    x.setOptional(pe, E, "boneMatrices")
                            }
                        }
                        return (g || l.receiveShadow !== r.receiveShadow) && (l.receiveShadow = r.receiveShadow,
                        x.setValue(pe, "receiveShadow", r.receiveShadow)),
                        g && (x.setValue(pe, "toneMappingExposure", m.toneMappingExposure),
                        l.needsLights && (p = y,
                        (h = w).ambientLightColor.needsUpdate = p,
                        h.lightProbe.needsUpdate = p,
                        h.directionalLights.needsUpdate = p,
                        h.directionalLightShadows.needsUpdate = p,
                        h.pointLights.needsUpdate = p,
                        h.pointLightShadows.needsUpdate = p,
                        h.spotLights.needsUpdate = p,
                        h.spotLightShadows.needsUpdate = p,
                        h.rectAreaLights.needsUpdate = p,
                        h.hemisphereLights.needsUpdate = p),
                        n && i.fog && ie.refreshFogUniforms(w, n),
                        ie.refreshMaterialUniforms(w, i, k, I),
                        Yn.upload(pe, l.uniformsList, w, K)),
                        i.isShaderMaterial && !0 === i.uniformsNeedUpdate && (Yn.upload(pe, l.uniformsList, w, K),
                        i.uniformsNeedUpdate = !1),
                        i.isSpriteMaterial && x.setValue(pe, "center", r.center),
                        x.setValue(pe, "modelViewMatrix", r.modelViewMatrix),
                        x.setValue(pe, "normalMatrix", r.normalMatrix),
                        x.setValue(pe, "modelMatrix", r.matrixWorld),
                        _
                    }
                    Ae.setAnimationLoop((function(e) {
                        ge.isPresenting || Me && Me(e)
                    }
                    )),
                    "undefined" != typeof window && Ae.setContext(window),
                    this.setAnimationLoop = function(e) {
                        Me = e,
                        ge.setAnimationLoop(e),
                        null === e ? Ae.stop() : Ae.start()
                    }
                    ,
                    this.render = function(e, t) {
                        var i, r;
                        if (void 0 !== arguments[2] && (console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),
                        i = arguments[2]),
                        void 0 !== arguments[3] && (console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),
                        r = arguments[3]),
                        void 0 === t || !0 === t.isCamera) {
                            if (!0 !== g) {
                                he.resetDefaultState(),
                                M = -1,
                                T = null,
                                !0 === e.autoUpdate && e.updateMatrixWorld(),
                                null === t.parent && t.updateMatrixWorld(),
                                !0 === ge.enabled && !0 === ge.isPresenting && (t = ge.getCamera(t)),
                                !0 === e.isScene && e.onBeforeRender(m, e, t, i || b),
                                (f = ne.get(e, d.length)).init(),
                                d.push(f),
                                V.multiplyMatrices(t.projectionMatrix, t.matrixWorldInverse),
                                F.setFromProjectionMatrix(V),
                                U = this.localClippingEnabled,
                                N = ae.init(this.clippingPlanes, U, t),
                                (p = re.get(e, t)).init(),
                                Pe(e, t, 0, m.sortObjects),
                                p.finish(),
                                !0 === m.sortObjects && p.sort(z, D),
                                !0 === N && ae.beginShadows();
                                var n = f.state.shadowsArray;
                                ye.render(n, e, t),
                                f.setupLights(),
                                f.setupLightsView(t),
                                !0 === N && ae.endShadows(),
                                !0 === this.info.autoReset && this.info.reset(),
                                void 0 !== i && this.setRenderTarget(i),
                                oe.render(p, e, t, r);
                                var a = p.opaque
                                  , o = p.transparent;
                                a.length > 0 && Le(a, e, t),
                                o.length > 0 && Le(o, e, t),
                                !0 === e.isScene && e.onAfterRender(m, e, t),
                                null !== b && (K.updateRenderTargetMipmap(b),
                                K.updateMultisampleRenderTarget(b)),
                                Z.buffers.depth.setTest(!0),
                                Z.buffers.depth.setMask(!0),
                                Z.buffers.color.setMask(!0),
                                Z.setPolygonOffset(!1),
                                d.pop(),
                                f = d.length > 0 ? d[d.length - 1] : null,
                                p = null
                            }
                        } else
                            console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")
                    }
                    ,
                    this.setFramebuffer = function(e) {
                        y !== e && null === b && pe.bindFramebuffer(36160, e),
                        y = e
                    }
                    ,
                    this.getActiveCubeFace = function() {
                        return _
                    }
                    ,
                    this.getActiveMipmapLevel = function() {
                        return x
                    }
                    ,
                    this.getRenderList = function() {
                        return p
                    }
                    ,
                    this.setRenderList = function(e) {
                        p = e
                    }
                    ,
                    this.getRenderTarget = function() {
                        return b
                    }
                    ,
                    this.setRenderTarget = function(e) {
                        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                          , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;
                        b = e,
                        _ = t,
                        x = i,
                        e && void 0 === Y.get(e).__webglFramebuffer && K.setupRenderTarget(e);
                        var r = y
                          , n = !1;
                        if (e) {
                            var a = Y.get(e).__webglFramebuffer;
                            e.isWebGLCubeRenderTarget ? (r = a[t],
                            n = !0) : r = e.isWebGLMultisampleRenderTarget ? Y.get(e).__webglMultisampledFramebuffer : a,
                            E.copy(e.viewport),
                            P.copy(e.scissor),
                            C = e.scissorTest
                        } else
                            E.copy(R).multiplyScalar(k).floor(),
                            P.copy(O).multiplyScalar(k).floor(),
                            C = B;
                        if (S !== r && (pe.bindFramebuffer(36160, r),
                        S = r),
                        Z.viewport(E),
                        Z.scissor(P),
                        Z.setScissorTest(C),
                        n) {
                            var o = Y.get(e.texture);
                            pe.framebufferTexture2D(36160, 36064, 34069 + t, o.__webglTexture, i)
                        }
                    }
                    ,
                    this.readRenderTargetPixels = function(e, t, i, r, n, a, o) {
                        if (e && e.isWebGLRenderTarget) {
                            var s = Y.get(e).__webglFramebuffer;
                            if (e.isWebGLCubeRenderTarget && void 0 !== o && (s = s[o]),
                            s) {
                                var l = !1;
                                s !== S && (pe.bindFramebuffer(36160, s),
                                l = !0);
                                try {
                                    var u = e.texture
                                      , c = u.format
                                      , h = u.type;
                                    if (c !== Ce && ce.convert(c) !== pe.getParameter(35739))
                                        return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");
                                    if (!(h === we || ce.convert(h) === pe.getParameter(35738) || h === Te && (W.isWebGL2 || q.get("OES_texture_float") || q.get("WEBGL_color_buffer_float")) || h === Ee && (W.isWebGL2 ? q.get("EXT_color_buffer_float") : q.get("EXT_color_buffer_half_float"))))
                                        return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");
                                    36053 === pe.checkFramebufferStatus(36160) ? t >= 0 && t <= e.width - r && i >= 0 && i <= e.height - n && pe.readPixels(t, i, r, n, ce.convert(c), ce.convert(h), a) : console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")
                                } finally {
                                    l && pe.bindFramebuffer(36160, S)
                                }
                            }
                        } else
                            console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")
                    }
                    ,
                    this.copyFramebufferToTexture = function(e, t) {
                        var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
                          , r = Math.pow(2, -i)
                          , n = Math.floor(t.image.width * r)
                          , a = Math.floor(t.image.height * r)
                          , o = ce.convert(t.format);
                        K.setTexture2D(t, 0),
                        pe.copyTexImage2D(3553, i, o, e.x, e.y, n, a, 0),
                        Z.unbindTexture()
                    }
                    ,
                    this.copyTextureToTexture = function(e, t, i) {
                        var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0
                          , n = t.image.width
                          , a = t.image.height
                          , o = ce.convert(i.format)
                          , s = ce.convert(i.type);
                        K.setTexture2D(i, 0),
                        pe.pixelStorei(37440, i.flipY),
                        pe.pixelStorei(37441, i.premultiplyAlpha),
                        pe.pixelStorei(3317, i.unpackAlignment),
                        t.isDataTexture ? pe.texSubImage2D(3553, r, e.x, e.y, n, a, o, s, t.image.data) : t.isCompressedTexture ? pe.compressedTexSubImage2D(3553, r, e.x, e.y, t.mipmaps[0].width, t.mipmaps[0].height, o, t.mipmaps[0].data) : pe.texSubImage2D(3553, r, e.x, e.y, o, s, t.image),
                        0 === r && i.generateMipmaps && pe.generateMipmap(3553),
                        Z.unbindTexture()
                    }
                    ,
                    this.initTexture = function(e) {
                        K.setTexture2D(e, 0),
                        Z.unbindTexture()
                    }
                    ,
                    this.resetState = function() {
                        Z.reset(),
                        he.reset()
                    }
                    ,
                    "undefined" != typeof __THREE_DEVTOOLS__ && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{
                        detail: this
                    }))
                }
                Aa.prototype = Object.create(Oe.prototype),
                Aa.prototype.constructor = Aa,
                Aa.prototype.isMeshDepthMaterial = !0,
                Aa.prototype.copy = function(e) {
                    return Oe.prototype.copy.call(this, e),
                    this.depthPacking = e.depthPacking,
                    this.skinning = e.skinning,
                    this.morphTargets = e.morphTargets,
                    this.map = e.map,
                    this.alphaMap = e.alphaMap,
                    this.displacementMap = e.displacementMap,
                    this.displacementScale = e.displacementScale,
                    this.displacementBias = e.displacementBias,
                    this.wireframe = e.wireframe,
                    this.wireframeLinewidth = e.wireframeLinewidth,
                    this
                }
                ,
                Pa.prototype = Object.create(Oe.prototype),
                Pa.prototype.constructor = Pa,
                Pa.prototype.isMeshDistanceMaterial = !0,
                Pa.prototype.copy = function(e) {
                    return Oe.prototype.copy.call(this, e),
                    this.referencePosition.copy(e.referencePosition),
                    this.nearDistance = e.nearDistance,
                    this.farDistance = e.farDistance,
                    this.skinning = e.skinning,
                    this.morphTargets = e.morphTargets,
                    this.map = e.map,
                    this.alphaMap = e.alphaMap,
                    this.displacementMap = e.displacementMap,
                    this.displacementScale = e.displacementScale,
                    this.displacementBias = e.displacementBias,
                    this
                }
                ,
                Ra.prototype = Object.assign(Object.create(Fr.prototype), {
                    constructor: Ra,
                    isArrayCamera: !0
                }),
                Oa.prototype = Object.assign(Object.create(ae.prototype), {
                    constructor: Oa,
                    isGroup: !0
                }),
                Object.assign(Ba.prototype, {
                    constructor: Ba,
                    getHandSpace: function() {
                        if (null === this._hand && (this._hand = new Oa,
                        this._hand.matrixAutoUpdate = !1,
                        this._hand.visible = !1,
                        this._hand.joints = [],
                        this._hand.inputState = {
                            pinching: !1
                        },
                        window.XRHand))
                            for (var e = 0; e <= window.XRHand.LITTLE_PHALANX_TIP; e++) {
                                var t = new Oa;
                                t.matrixAutoUpdate = !1,
                                t.visible = !1,
                                this._hand.joints.push(t),
                                this._hand.add(t)
                            }
                        return this._hand
                    },
                    getTargetRaySpace: function() {
                        return null === this._targetRay && (this._targetRay = new Oa,
                        this._targetRay.matrixAutoUpdate = !1,
                        this._targetRay.visible = !1),
                        this._targetRay
                    },
                    getGripSpace: function() {
                        return null === this._grip && (this._grip = new Oa,
                        this._grip.matrixAutoUpdate = !1,
                        this._grip.visible = !1),
                        this._grip
                    },
                    dispatchEvent: function(e) {
                        return null !== this._targetRay && this._targetRay.dispatchEvent(e),
                        null !== this._grip && this._grip.dispatchEvent(e),
                        null !== this._hand && this._hand.dispatchEvent(e),
                        this
                    },
                    disconnect: function(e) {
                        return this.dispatchEvent({
                            type: "disconnected",
                            data: e
                        }),
                        null !== this._targetRay && (this._targetRay.visible = !1),
                        null !== this._grip && (this._grip.visible = !1),
                        null !== this._hand && (this._hand.visible = !1),
                        this
                    },
                    update: function(e, t, i) {
                        var r = null
                          , n = null
                          , a = null
                          , o = this._targetRay
                          , s = this._grip
                          , l = this._hand;
                        if (e && "visible-blurred" !== t.session.visibilityState)
                            if (l && e.hand) {
                                a = !0;
                                for (var u = 0; u <= window.XRHand.LITTLE_PHALANX_TIP; u++)
                                    if (e.hand[u]) {
                                        var c = t.getJointPose(e.hand[u], i)
                                          , h = l.joints[u];
                                        null !== c && (h.matrix.fromArray(c.transform.matrix),
                                        h.matrix.decompose(h.position, h.rotation, h.scale),
                                        h.jointRadius = c.radius),
                                        h.visible = null !== c;
                                        var p = l.joints[window.XRHand.INDEX_PHALANX_TIP]
                                          , f = l.joints[window.XRHand.THUMB_PHALANX_TIP]
                                          , d = p.position.distanceTo(f.position);
                                        l.inputState.pinching && d > .025 ? (l.inputState.pinching = !1,
                                        this.dispatchEvent({
                                            type: "pinchend",
                                            handedness: e.handedness,
                                            target: this
                                        })) : !l.inputState.pinching && d <= .015 && (l.inputState.pinching = !0,
                                        this.dispatchEvent({
                                            type: "pinchstart",
                                            handedness: e.handedness,
                                            target: this
                                        }))
                                    }
                            } else
                                null !== o && null !== (r = t.getPose(e.targetRaySpace, i)) && (o.matrix.fromArray(r.transform.matrix),
                                o.matrix.decompose(o.position, o.rotation, o.scale)),
                                null !== s && e.gripSpace && null !== (n = t.getPose(e.gripSpace, i)) && (s.matrix.fromArray(n.transform.matrix),
                                s.matrix.decompose(s.position, s.rotation, s.scale));
                        return null !== o && (o.visible = null !== r),
                        null !== s && (s.visible = null !== n),
                        null !== l && (l.visible = null !== a),
                        this
                    }
                }),
                Object.assign(Fa.prototype, R.prototype);
                var Va = i(0)
                  , Ga = function() {
                    var e = function(t, i) {
                        return (e = Object.setPrototypeOf || {
                            __proto__: []
                        }instanceof Array && function(e, t) {
                            e.__proto__ = t
                        }
                        || function(e, t) {
                            for (var i in t)
                                Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i])
                        }
                        )(t, i)
                    };
                    return function(t, i) {
                        if ("function" != typeof i && null !== i)
                            throw new TypeError("Class extends value " + String(i) + " is not a constructor or null");
                        function r() {
                            this.constructor = t
                        }
                        e(t, i),
                        t.prototype = null === i ? Object.create(i) : (r.prototype = i.prototype,
                        new r)
                    }
                }()
                  , ja = function(e) {
                    function t() {
                        var t = e.call(this) || this;
                        return t._ = [],
                        t.M = 0,
                        t.S = 0,
                        t.L = 0,
                        t
                    }
                    return Ga(t, e),
                    t.prototype.addFrame = function(e, t) {
                        var i = this.T(e);
                        if (i < 0)
                            this._.unshift({
                                time: e,
                                data: t
                            });
                        else {
                            if (this._[i].time == e)
                                throw new Error("Frame with this time already exists");
                            this._.splice(i + 1, 0, {
                                time: e,
                                data: t
                            })
                        }
                        this.C()
                    }
                    ,
                    t.prototype.removeFrame = function(e) {
                        var t = this._.filter((function(t) {
                            return t.time == e
                        }
                        ));
                        return this._ = this._.filter((function(t) {
                            return t.time != e
                        }
                        )),
                        this.C(),
                        t
                    }
                    ,
                    t.prototype.forEachFrame = function(e) {
                        this._.forEach((function(t) {
                            return e(t)
                        }
                        ))
                    }
                    ,
                    t.prototype.getAnimationStart = function() {
                        return this._.length ? this._[0].time : 1 / 0
                    }
                    ,
                    t.prototype.getAnimationEnd = function() {
                        return this._.length ? this._[this._.length - 1].time : -1 / 0
                    }
                    ,
                    t.prototype.getAnimationTime = function() {
                        return this.M
                    }
                    ,
                    t.prototype.setAnimationTime = function(e) {
                        this.M = e,
                        this.C()
                    }
                    ,
                    t.prototype.C = function() {
                        this.M = Math.max(this.getAnimationStart(), Math.min(this.getAnimationEnd(), this.M))
                    }
                    ,
                    t.prototype.animate = function(e) {
                        this.S = e,
                        0 != this.S && (this.L = performance.now())
                    }
                    ,
                    t.prototype.animationTick = function() {
                        var e = performance.now();
                        if (this.S > 0 && this.L) {
                            var t = e - this.L;
                            this.M += this.S * (t / 1e3);
                            var i = this.getAnimationStart()
                              , r = this.getAnimationEnd();
                            this.M = i + (this.M - i) % (r - i),
                            isNaN(this.M) && (this.M = i),
                            this.emit("tick", {
                                time: this.M
                            })
                        }
                        this.L = e
                    }
                    ,
                    t.prototype.T = function(e) {
                        for (var t = this._.length - 1; t >= 0; --t)
                            if (this._[t].time <= e)
                                return t;
                        return -1
                    }
                    ,
                    t.prototype.getCurrentFrames = function() {
                        if (0 == this._.length)
                            return {
                                frameA: null,
                                frameB: null,
                                mix: 0
                            };
                        var e = this.T(this.M);
                        e < 0 && (e = 0);
                        var t = this._[e]
                          , i = this._[Math.min(this._.length - 1, e + 1)]
                          , r = i.time - t.time;
                        return {
                            frameA: t,
                            frameB: i,
                            mix: 0 == r ? 0 : (this.M - t.time) / r
                        }
                    }
                    ,
                    t.prototype.getNextFrame = function(e, t) {
                        var i = this._.findIndex((function(t) {
                            return t === e
                        }
                        ));
                        return i < 0 ? null : t < 0 ? i > 0 ? this._[i - 1] : null : i < this._.length - 1 ? this._[i + 1] : null
                    }
                    ,
                    t
                }(Va.EventEmitter)
                  , Ha = {
                    enabled: !1,
                    files: {},
                    add: function(e, t) {
                        !1 !== this.enabled && (this.files[e] = t)
                    },
                    get: function(e) {
                        if (!1 !== this.enabled)
                            return this.files[e]
                    },
                    remove: function(e) {
                        delete this.files[e]
                    },
                    clear: function() {
                        this.files = {}
                    }
                }
                  , qa = new function(e, t, i) {
                    var r = this
                      , n = !1
                      , a = 0
                      , o = 0
                      , s = void 0
                      , l = [];
                    this.onStart = void 0,
                    this.onLoad = void 0,
                    this.onProgress = void 0,
                    this.onError = void 0,
                    this.itemStart = function(e) {
                        o++,
                        !1 === n && void 0 !== r.onStart && r.onStart(e, a, o),
                        n = !0
                    }
                    ,
                    this.itemEnd = function(e) {
                        a++,
                        void 0 !== r.onProgress && r.onProgress(e, a, o),
                        a === o && (n = !1,
                        void 0 !== r.onLoad && r.onLoad())
                    }
                    ,
                    this.itemError = function(e) {
                        void 0 !== r.onError && r.onError(e)
                    }
                    ,
                    this.resolveURL = function(e) {
                        return s ? s(e) : e
                    }
                    ,
                    this.setURLModifier = function(e) {
                        return s = e,
                        this
                    }
                    ,
                    this.addHandler = function(e, t) {
                        return l.push(e, t),
                        this
                    }
                    ,
                    this.removeHandler = function(e) {
                        var t = l.indexOf(e);
                        return -1 !== t && l.splice(t, 2),
                        this
                    }
                    ,
                    this.getHandler = function(e) {
                        for (var t = 0, i = l.length; t < i; t += 2) {
                            var r = l[t]
                              , n = l[t + 1];
                            if (r.global && (r.lastIndex = 0),
                            r.test(e))
                                return n
                        }
                        return null
                    }
                }
                ;
                function Wa(e) {
                    this.manager = void 0 !== e ? e : qa,
                    this.crossOrigin = "anonymous",
                    this.withCredentials = !1,
                    this.path = "",
                    this.resourcePath = "",
                    this.requestHeader = {}
                }
                function Za(e) {
                    Wa.call(this, e)
                }
                Object.assign(Wa.prototype, {
                    load: function() {},
                    loadAsync: function(e, t) {
                        var i = this;
                        return new Promise((function(r, n) {
                            i.load(e, r, t, n)
                        }
                        ))
                    },
                    parse: function() {},
                    setCrossOrigin: function(e) {
                        return this.crossOrigin = e,
                        this
                    },
                    setWithCredentials: function(e) {
                        return this.withCredentials = e,
                        this
                    },
                    setPath: function(e) {
                        return this.path = e,
                        this
                    },
                    setResourcePath: function(e) {
                        return this.resourcePath = e,
                        this
                    },
                    setRequestHeader: function(e) {
                        return this.requestHeader = e,
                        this
                    }
                }),
                Za.prototype = Object.assign(Object.create(Wa.prototype), {
                    constructor: Za,
                    load: function(e, t, i, r) {
                        void 0 !== this.path && (e = this.path + e),
                        e = this.manager.resolveURL(e);
                        var n = this
                          , a = Ha.get(e);
                        if (void 0 !== a)
                            return n.manager.itemStart(e),
                            setTimeout((function() {
                                t && t(a),
                                n.manager.itemEnd(e)
                            }
                            ), 0),
                            a;
                        var o = document.createElementNS("http://www.w3.org/1999/xhtml", "img");
                        function s() {
                            o.removeEventListener("load", s, !1),
                            o.removeEventListener("error", l, !1),
                            Ha.add(e, this),
                            t && t(this),
                            n.manager.itemEnd(e)
                        }
                        function l(t) {
                            o.removeEventListener("load", s, !1),
                            o.removeEventListener("error", l, !1),
                            r && r(t),
                            n.manager.itemError(e),
                            n.manager.itemEnd(e)
                        }
                        return o.addEventListener("load", s, !1),
                        o.addEventListener("error", l, !1),
                        "data:" !== e.substr(0, 5) && void 0 !== this.crossOrigin && (o.crossOrigin = this.crossOrigin),
                        n.manager.itemStart(e),
                        o.src = e,
                        o
                    }
                });
                var Xa = "undefined" != typeof self
                  , Ya = Xa && !!self.OffscreenCanvas
                  , Ka = Xa && !!self.ImageBitmap
                  , Ja = Ya && Ka;
                var Qa = i(1)
                  , $a = i.n(Qa);
                function eo() {
                    return $a()('!function(n){var t={};function e(r){if(t[r])return t[r].exports;var u=t[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,e),u.l=!0,u.exports}e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var u in n)e.d(r,u,function(t){return n[t]}.bind(null,u));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=0)}([function(n,t,e){"use strict";e.r(t);var r="undefined"!=typeof self,u=r&&!!self.OffscreenCanvas,a=r&&!!self.ImageBitmap;function f(n,t){var e=n.width,r=n.height,f=Math.floor(e/t.textureTiling[0]),o=Math.floor(r/t.textureTiling[1]),i=Math.round(Math.min(f,t.maxTextureSize/t.textureTiling[0]/2)*t.scaleFactor),c=Math.round(Math.min(o,t.maxTextureSize/t.textureTiling[1]/2)*t.scaleFactor),l=function(n,t){if(u)return new OffscreenCanvas(n,t);var e=document.createElement("canvas");return e.width=n,e.height=t,e}(t.textureTiling[0]*i,t.textureTiling[1]*c).getContext("2d");if(null==l)throw new Error("Failed to obtain canvas 2d context");if(l.imageSmoothingEnabled=!1,l.imageSmoothingQuality="high",l.drawImage(n,0,0,t.textureTiling[0]*i,t.textureTiling[1]*c),a&&n instanceof ImageBitmap&&n.close(),t.isWebGL2){for(var v=new Uint8ClampedArray(i*c*t.textureSteps),d=0;d<Math.ceil(t.textureSteps/3);d++)for(var h=l.getImageData(d%t.textureTiling[0]*i,Math.floor(d/t.textureTiling[0])*c,i,c),s=0;s<3;s++){var b=3*d+s;if(b>=t.textureSteps)break;for(var m=b*i*c,M=0;M<h.data.length/4;M++)v[m+M]=h.data[4*M+s]}return{data:v,width:i,height:c}}return h=l.getImageData(0,0,t.textureTiling[0]*i,t.textureTiling[1]*c)}var o=self;o.onmessage=function(n){var t=n.data.options;fetch(n.data.url,{mode:"cors"}).then((function(n){return n.blob()})).then((function(n){return createImageBitmap(n)})).then((function(n){return f(n,t)})).then((function(n){o.postMessage(n)}))};t.default=null}]);', "Worker", void 0, void 0)
                }
                var to, io = function() {
                    var e = function(t, i) {
                        return (e = Object.setPrototypeOf || {
                            __proto__: []
                        }instanceof Array && function(e, t) {
                            e.__proto__ = t
                        }
                        || function(e, t) {
                            for (var i in t)
                                Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i])
                        }
                        )(t, i)
                    };
                    return function(t, i) {
                        if ("function" != typeof i && null !== i)
                            throw new TypeError("Class extends value " + String(i) + " is not a constructor or null");
                        function r() {
                            this.constructor = t
                        }
                        e(t, i),
                        t.prototype = null === i ? Object.create(i) : (r.prototype = i.prototype,
                        new r)
                    }
                }(), ro = function(e) {
                    function t(t, i, r, n) {
                        var a = e.call(this) || this;
                        return a.A = t,
                        a.P = i,
                        a.D = r,
                        a.R = n,
                        a.N = null,
                        Ja || (a.N = new Za(a.manager)),
                        a
                    }
                    return io(t, e),
                    t.prototype.shouldPreload = function() {
                        return Ja
                    }
                    ,
                    t.prototype.isReady = function() {
                        return !!this.D()
                    }
                    ,
                    t.prototype.k = function(e, t) {
                        var i;
                        return t.isWebGL2 ? ((i = new $r(e.data,e.width,e.height,this.A)).format = 1028,
                        i.unpackAlignment = 1) : (i = new vr(e.data,e.width,e.height)).format = Ce,
                        i.type = we,
                        i.wrapS = i.wrapT = ge,
                        i.minFilter = xe,
                        i.magFilter = xe,
                        i.generateMipmaps = !1,
                        i.needsUpdate = !0,
                        i
                    }
                    ,
                    t.prototype.load = function(e, t) {
                        var i = this
                          , r = this.D();
                        if (null == r)
                            throw new Error("Unknown device capabilities");
                        var n = {
                            isWebGL2: r.isWebGL2,
                            maxTextureSize: r.maxTextureSize,
                            scaleFactor: this.R,
                            textureTiling: this.P,
                            textureSteps: this.A
                        };
                        if (e = new URL(e,window.location.toString()).toString(),
                        Ja) {
                            var a = new eo;
                            a.postMessage({
                                options: n,
                                url: e
                            }),
                            a.onmessage = function(e) {
                                var r = e.data;
                                a.terminate(),
                                t(i.k(r, n))
                            }
                        } else {
                            if (null == this.N)
                                throw new Error("Image loader not ready");
                            this.N.load(e, (function(e) {
                                var r = function(e, t) {
                                    var i = e.width
                                      , r = e.height
                                      , n = Math.floor(i / t.textureTiling[0])
                                      , a = Math.floor(r / t.textureTiling[1])
                                      , o = Math.round(Math.min(n, t.maxTextureSize / t.textureTiling[0] / 2) * t.scaleFactor)
                                      , s = Math.round(Math.min(a, t.maxTextureSize / t.textureTiling[1] / 2) * t.scaleFactor)
                                      , l = function(e, t) {
                                        if (Ya)
                                            return new OffscreenCanvas(e,t);
                                        var i = document.createElement("canvas");
                                        return i.width = e,
                                        i.height = t,
                                        i
                                    }(t.textureTiling[0] * o, t.textureTiling[1] * s).getContext("2d");
                                    if (null == l)
                                        throw new Error("Failed to obtain canvas 2d context");
                                    if (l.imageSmoothingEnabled = !1,
                                    l.imageSmoothingQuality = "high",
                                    l.drawImage(e, 0, 0, t.textureTiling[0] * o, t.textureTiling[1] * s),
                                    Ka && e instanceof ImageBitmap && e.close(),
                                    t.isWebGL2) {
                                        for (var u = new Uint8ClampedArray(o * s * t.textureSteps), c = 0; c < Math.ceil(t.textureSteps / 3); c++)
                                            for (var h = l.getImageData(c % t.textureTiling[0] * o, Math.floor(c / t.textureTiling[0]) * s, o, s), p = 0; p < 3; p++) {
                                                var f = 3 * c + p;
                                                if (f >= t.textureSteps)
                                                    break;
                                                for (var d = f * o * s, m = 0; m < h.data.length / 4; m++)
                                                    u[d + m] = h.data[4 * m + p]
                                            }
                                        return {
                                            data: u,
                                            width: o,
                                            height: s
                                        }
                                    }
                                    return l.getImageData(0, 0, t.textureTiling[0] * o, t.textureTiling[1] * s)
                                }(e, n);
                                t(i.k(r, n))
                            }
                            ))
                        }
                    }
                    ,
                    t
                }(Wa), no = function() {
                    function e(e, t) {
                        var i = this;
                        if (this.I = e,
                        this.O = t,
                        this.U = !1,
                        this.G = null,
                        this.O.shouldPreload())
                            if (this.O.isReady())
                                this.get();
                            else
                                var r = setInterval((function() {
                                    i.O.isReady() && (i.get(),
                                    clearInterval(r))
                                }
                                ))
                    }
                    return e.prototype.get = function() {
                        return this.U || this.H(),
                        this.G
                    }
                    ,
                    e.prototype.H = function() {
                        var e = this;
                        this.O.isReady() && (this.U = !0,
                        this.O.load(this.I, (function(t) {
                            e.G = t
                        }
                        )))
                    }
                    ,
                    e.prototype.dispose = function() {
                        this.G && this.G.dispose()
                    }
                    ,
                    e
                }(), ao = function() {
                    var e = function(t, i) {
                        return (e = Object.setPrototypeOf || {
                            __proto__: []
                        }instanceof Array && function(e, t) {
                            e.__proto__ = t
                        }
                        || function(e, t) {
                            for (var i in t)
                                Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i])
                        }
                        )(t, i)
                    };
                    return function(t, i) {
                        if ("function" != typeof i && null !== i)
                            throw new TypeError("Class extends value " + String(i) + " is not a constructor or null");
                        function r() {
                            this.constructor = t
                        }
                        e(t, i),
                        t.prototype = null === i ? Object.create(i) : (r.prototype = i.prototype,
                        new r)
                    }
                }();
                !function(e) {
                    e.AUTO = "auto",
                    e.XY = "xy",
                    e.X = "x",
                    e.Y = "y",
                    e.Z = "z"
                }(to || (to = {}));
                var oo = function(e) {
                    function t(t, i, r) {
                        var n, o, l, u = e.call(this) || this;
                        u.F = i,
                        u.B = r,
                        u.type = "custom",
                        u.renderingMode = "2d",
                        u.V = new oe,
                        u.W = new de,
                        u.j = null,
                        u.q = null,
                        u.J = null,
                        u.K = null,
                        u.$ = [-180, -90, 0, -1 / 0],
                        u.ee = [180, 90, 1 / 0, 1 / 0],
                        u.te = [0, 0, 0, 0],
                        u.ne = [1, 1, 1, 1],
                        u.ie = [],
                        u.re = 1,
                        u.ae = null,
                        u.oe = u.onResize.bind(u),
                        u.id = t,
                        u.F.performance = null !== (n = u.F.performance) && void 0 !== n ? n : {},
                        u.F.performance.reuseCanvas || (u.ae = document.createElement("canvas"),
                        u.ae.style.position = "absolute",
                        u.ae.style.pointerEvents = "none"),
                        u.se = u.F.performance.renderScale || 1;
                        var c = null !== (o = i.bounds) && void 0 !== o ? o : [-180, -85.05, 180, 85.05];
                        u.ue = a(c[0], c[1]).concat(a(c[2], c[3])).concat((null !== (l = i.altitudeMin) && void 0 !== l ? l : 0) / s, i.altitudeMax / s),
                        u.le = new ro(i.textureSteps,i.textureTiling,u.D.bind(u),(i.performance || {}).dataScale || 1),
                        u.W.position.x = .5 + (u.ue[0] + u.ue[2]) / 2,
                        u.W.position.y = (u.ue[1] + u.ue[3]) / 2 - .5,
                        u.W.position.z = (u.ue[4] + u.ue[5]) / 2,
                        u.W.scale.x = u.ue[2] - u.ue[0],
                        u.W.scale.y = u.ue[3] - u.ue[1],
                        u.W.scale.z = u.ue[5] - u.ue[4];
                        var h = u.B.getCode("_cf_")
                          , p = "uniform float time;uniform float opacity;uniform float steps;uniform vec4 cutoffMin;uniform vec4 cutoffMax;uniform mat4 MVPMatrix;uniform mat4 MVPInverseMatrix;varying vec3 v_position;\n#ifdef WEBGL2\nprecision mediump sampler3D;uniform sampler3D tex0;uniform sampler3D tex1;float sample4D(vec3 texCoord){float sooner=textureCube(tex0,texCoord).r;float later=textureCube(tex1,texCoord).r;return mix(sooner,later,time);}\n#else\nuniform sampler2D tex0;uniform sampler2D tex1;const vec2 tiles=vec2(TEXTURE_TILING_X,TEXTURE_TILING_Y);const float slices=float(TEXTURE_STEPS);const float channels=3.;float sampleSlice(float sliceNumber,vec3 texCoord){float tile=floor(sliceNumber/channels);vec2 texCoordInSlice=vec2(texCoord.x+mod(tile,tiles.x),texCoord.y+floor(tile/tiles.x))/tiles;vec3 sooner=texture2D(tex0,texCoordInSlice).rgb;vec3 later=texture2D(tex1,texCoordInSlice).rgb;vec3 interpolated=mix(sooner,later,time);int channel=int(mod(sliceNumber,channels));vec3 channelPicker=vec3(channel==0,channel==1,channel==2);return dot(interpolated,channelPicker);}float sample4D(vec3 texCoord){float zSlice=texCoord.z*slices;float zSliceLower=floor(zSlice);float zSliceUpper=ceil(zSlice);float valueLower=sampleSlice(zSliceLower,texCoord);float valueUpper=sampleSlice(zSliceUpper,texCoord);return mix(valueLower,valueUpper,fract(zSlice));}\n#endif\nfloat sampleVolume(vec3 texCoord){if(any(lessThan(texCoord,cutoffMin.xyz))||any(greaterThan(texCoord,cutoffMax.xyz))){return 0.;}texCoord.y=1.-texCoord.y;return sample4D(texCoord);}COLORING_FRAGMENT_DEF const float EDGE_SIZE=0.01;vec4 colorize(float value){if(value<=cutoffMin.w||value>=cutoffMax.w){return vec4(0.);}float smoother=max(smoothstep(cutoffMin.w,cutoffMin.w+EDGE_SIZE,value),1.-smoothstep(cutoffMax.w-EDGE_SIZE,cutoffMax.w,value));vec4 color=_cf_(vec4(value));color.a*=smoother;return color;}\n#define MAX_STEPS 64\nvoid march(vec3 currentPosition,vec3 dir,float rayLength){float stepSize=rayLength/steps;vec3 step=normalize(dir)*stepSize;vec4 accumulatedColor=vec4(0.);float accumulatedLength=0.;for(int i=0;i<MAX_STEPS;i++){float sampleValue=sampleVolume(currentPosition);vec4 sampleColor=colorize(sampleValue);if(sampleColor.a>0.){sampleColor.a=min(1.,sampleColor.a/steps);float factor=sampleColor.a*(1.-accumulatedColor.a);accumulatedColor.rgb=(accumulatedColor.a*accumulatedColor.rgb+factor*sampleColor.rgb)/(accumulatedColor.a+factor);accumulatedColor.a=accumulatedColor.a+factor;}currentPosition+=step;accumulatedLength+=stepSize;if(accumulatedLength>=rayLength||accumulatedColor.a>=1.){break;}}gl_FragColor=accumulatedColor;gl_FragColor.a*=opacity;}void main(){vec4 pos_in_cam=MVPMatrix*vec4(v_position,1.);pos_in_cam.z=-pos_in_cam.w;vec4 v_nearpos=MVPInverseMatrix*pos_in_cam;pos_in_cam.z=pos_in_cam.w;vec4 v_farpos=MVPInverseMatrix*pos_in_cam;vec3 farpos=v_farpos.xyz/v_farpos.w;vec3 nearpos=v_nearpos.xyz/v_nearpos.w;vec3 dir=normalize(farpos-nearpos);float distance=dot(nearpos-v_position,dir);distance=max(distance,min((-0.5-v_position.x)/dir.x,(0.5-v_position.x)/dir.x));distance=max(distance,min((-0.5-v_position.y)/dir.y,(0.5-v_position.y)/dir.y));distance=max(distance,min((-0.5-v_position.z)/dir.z,(0.5-v_position.z)/dir.z));vec3 frontPos=v_position+dir*distance;vec3 currentPosition=frontPos+0.5;float rayLength=-distance;march(currentPosition,dir,rayLength);}".replace("COLORING_FRAGMENT_DEF", h);
                        u.ce = new Ue({
                            uniforms: {
                                opacity: {
                                    value: 1
                                },
                                time: {
                                    value: 0
                                },
                                steps: {
                                    value: u.F.performance.renderSteps || 32
                                },
                                cutoffMin: {
                                    value: u.te
                                },
                                cutoffMax: {
                                    value: u.ne
                                },
                                MVPMatrix: {
                                    value: null
                                },
                                MVPInverseMatrix: {
                                    value: null
                                },
                                tex0: {
                                    value: null
                                },
                                tex1: {
                                    value: null
                                }
                            },
                            vertexShader: "uniform mat4 MVPMatrix;varying vec3 v_position;void main(){gl_Position=MVPMatrix*vec4(position,1.);v_position=position;}",
                            fragmentShader: p,
                            defines: {
                                STEPS: Math.round(u.F.performance.renderSteps || 32),
                                WEBGL2: !1,
                                TEXTURE_STEPS: u.F.textureSteps,
                                TEXTURE_TILING_X: u.F.textureTiling[0],
                                TEXTURE_TILING_Y: u.F.textureTiling[1]
                            },
                            depthTest: !1,
                            depthWrite: !1,
                            side: 1,
                            precision: "highp",
                            transparent: !0
                        });
                        var f = new Kt(1,1,1);
                        if (u.he = new Hi(f,u.ce),
                        u.W.add(u.he),
                        u.F.boundsColor) {
                            var d = new tr(f);
                            u.j = new pr(d,new ir({
                                color: u.F.boundsColor,
                                opacity: .4,
                                transparent: !0,
                                linewidth: 1
                            })),
                            u.W.add(u.j),
                            u.q = new pr(d,new ir({
                                color: u.F.boundsColor,
                                linewidth: 2
                            })),
                            u.W.add(u.q)
                        }
                        return u.fe(),
                        u
                    }
                    return ao(t, e),
                    t.prototype.fe = function() {
                        var e = this
                          , t = function(e) {
                            return Math.max(0, Math.min(1, e))
                        }
                          , i = function(i) {
                            return t((i / 360 - e.ue[0]) / (e.ue[2] - e.ue[0]))
                        }
                          , r = function(i) {
                            return t((n(i) - e.ue[1]) / (e.ue[3] - e.ue[1]))
                        }
                          , a = function(i) {
                            return t((i / s - e.ue[4]) / (e.ue[5] - e.ue[4]))
                        }
                          , o = function(i) {
                            return t(e.B.codeValue(i))
                        };
                        this.te[0] = i(this.$[0]),
                        this.ne[0] = i(this.ee[0]),
                        this.te[1] = r(this.$[1]),
                        this.ne[1] = r(this.ee[1]),
                        this.te[2] = a(this.$[2]),
                        this.ne[2] = a(this.ee[2]),
                        this.te[3] = o(this.$[3]),
                        this.ne[3] = o(this.ee[3]),
                        this.q && (this.q.scale.set(this.ne[0] - this.te[0], this.ne[1] - this.te[1], this.ne[2] - this.te[2]),
                        this.q.position.set(this.te[0] - .5 + this.q.scale.x / 2, this.te[1] - .5 + this.q.scale.y / 2, this.te[2] - .5 + this.q.scale.z / 2))
                    }
                    ,
                    t.prototype.setVerticalExaggeration = function(e) {
                        this.re = e
                    }
                    ,
                    t.prototype.setCutoffValue = function(e, t) {
                        null != e && (this.$[3] = e),
                        null != t && (this.ee[3] = t),
                        this.fe()
                    }
                    ,
                    t.prototype.setCutoffX = function(e, t) {
                        null != e && (this.$[0] = e),
                        null != t && (this.ee[0] = t),
                        this.fe()
                    }
                    ,
                    t.prototype.setCutoffY = function(e, t) {
                        null != e && (this.$[1] = e),
                        null != t && (this.ee[1] = t),
                        this.fe()
                    }
                    ,
                    t.prototype.setCutoffZ = function(e, t) {
                        null != e && (this.$[2] = e),
                        null != t && (this.ee[2] = t),
                        this.fe()
                    }
                    ,
                    t.prototype.D = function() {
                        return this.K && this.K.capabilities
                    }
                    ,
                    t.prototype.addSource = function(t, i) {
                        e.prototype.addFrame.call(this, t, new no(i,this.le))
                    }
                    ,
                    t.prototype.removeSource = function(t) {
                        e.prototype.removeFrame.call(this, t).forEach((function(e) {
                            e.data.dispose()
                        }
                        ))
                    }
                    ,
                    t.prototype.onAdd = function(e, t) {
                        var i;
                        this.J = e,
                        this.J.on("resize", this.oe),
                        this.K = new Ua({
                            canvas: this.ae || e.getCanvas(),
                            depth: !1,
                            stencil: !1,
                            alpha: !0,
                            antialias: !0
                        }),
                        this.K.autoClear = !1,
                        this.K.sortObjects = !1,
                        this.K.debug.checkShaderErrors = !0,
                        this.ae && e.getCanvasContainer().appendChild(this.K.domElement),
                        this.ce.defines.WEBGL2 = null === (i = this.D()) || void 0 === i ? void 0 : i.isWebGL2,
                        this.K.compile(this.W, this.V),
                        this.onResize()
                    }
                    ,
                    t.prototype.onRemove = function(e, t) {
                        this.J && (this.J.off("resize", this.oe),
                        this.J = null),
                        this.K && (this.ae && this.K.domElement.remove(),
                        this.K.dispose(),
                        this.K = null),
                        this.forEachFrame((function(e) {
                            e.data.dispose()
                        }
                        )),
                        this.he.geometry.dispose(),
                        this.he.material.dispose(),
                        this.j && (this.j.geometry.dispose(),
                        this.j.material.dispose()),
                        this.q && (this.q.geometry.dispose(),
                        this.q.material.dispose())
                    }
                    ,
                    t.prototype.onResize = function() {
                        if (this.J && this.K) {
                            var e = this.J.getCanvas()
                              , t = e.width
                              , i = e.height;
                            this.ae ? (this.K.domElement.style.width = e.style.width,
                            this.K.domElement.style.height = e.style.height,
                            this.K.setDrawingBufferSize(t, i, this.se)) : this.K.setViewport(0, 0, t, i)
                        }
                    }
                    ,
                    t.prototype.setOpacity = function(e) {
                        this.ce.uniforms.opacity.value = e
                    }
                    ,
                    t.prototype.setRenderScale = function(e) {
                        this.se = e,
                        this.onResize()
                    }
                    ,
                    t.prototype.setRenderSteps = function(e) {
                        this.ce.uniforms.steps.value = e
                    }
                    ,
                    t.prototype.de = function() {
                        this.he.visible = !1;
                        var e = this.getCurrentFrames()
                          , t = e.frameA
                          , i = e.frameB
                          , r = e.mix;
                        if (t && i) {
                            var n = t.data
                              , a = i.data
                              , o = n.get()
                              , s = a.get();
                            if (o && !s && (s = o),
                            !o && s && (o = s),
                            !o || !s) {
                                for (var l = t; !o && (l = this.getNextFrame(l, -1)); )
                                    o = s = l.data.get();
                                if (!o)
                                    return
                            }
                            this.he.visible = !0,
                            this.ce.uniforms.tex0.value = o,
                            this.ce.uniforms.tex1.value = s,
                            this.ce.uniforms.time.value = r
                        }
                    }
                    ,
                    t.prototype.prerender = function(e, t) {
                        this.animationTick();
                        var i = (new A).fromArray(t)
                          , r = (new A).makeTranslation(0, 0, 0).scale(new w(1,-1,this.re));
                        this.V.projectionMatrix = i.multiply(r),
                        this.de();
                        var n = (new A).multiplyMatrices(this.V.projectionMatrix, this.he.modelViewMatrix)
                          , a = new A;
                        a.copy(n).invert(),
                        this.ce.uniforms.MVPMatrix.value = n,
                        this.ce.uniforms.MVPInverseMatrix.value = a
                    }
                    ,
                    t.prototype.render = function(e, t) {
                        this.J && this.K && (this.K.state.reset(),
                        this.K.render(this.W, this.V),
                        this.J.triggerRepaint())
                    }
                    ,
                    t.prototype.startCutoffPicking = function(e) {
                        var t = this;
                        if (void 0 === e && (e = to.AUTO),
                        this.J) {
                            var i = [this.$[0], this.$[1], this.ee[0], this.ee[1]]
                              , r = function(r) {
                                if (e == to.Z) {
                                    var n = 1 - r.point.y / r.target.getCanvas().clientHeight;
                                    n = 1.4 * n - .2,
                                    t.setCutoffZ(0, n * t.ue[5] * s)
                                } else {
                                    t.setCutoffX(i[0], i[2]),
                                    t.setCutoffY(i[1], i[3]);
                                    var a = r.target.getBearing();
                                    e == to.AUTO ? a < -135 || a > 135 ? t.setCutoffY(null, r.lngLat.lat) : a < -45 ? t.setCutoffX(null, r.lngLat.lng) : a < 45 ? t.setCutoffY(r.lngLat.lat, null) : a < 135 && t.setCutoffX(r.lngLat.lng, null) : (e != to.X && e != to.XY || (a < 0 ? t.setCutoffX(null, r.lngLat.lng) : t.setCutoffX(r.lngLat.lng, null)),
                                    e != to.Y && e != to.XY || (Math.abs(a) > 90 ? t.setCutoffY(null, r.lngLat.lat) : t.setCutoffY(r.lngLat.lat, null)))
                                }
                                t.listenerCount("cutoff") > 0 && t.emit("cutoff", {
                                    x: [t.$[0], t.ee[0]],
                                    y: [t.$[1], t.ee[1]],
                                    z: [t.$[2], t.ee[2]]
                                })
                            }
                              , n = this.endCutoffPicking.bind(this);
                            this.J.on("mousemove", r),
                            this.ie.push({
                                event: "mousemove",
                                listener: r
                            }),
                            this.J.once("click", n),
                            this.ie.push({
                                event: "click",
                                listener: n
                            });
                            var a = function(e) {
                                e.preventDefault(),
                                t.J && (t.J.on("touchmove", r),
                                t.ie.push({
                                    event: "touchmove",
                                    listener: r
                                }),
                                t.J.once("touchend", n),
                                t.ie.push({
                                    event: "touchend",
                                    listener: n
                                }))
                            };
                            this.J.once("touchstart", a),
                            this.ie.push({
                                event: "touchstart",
                                listener: a
                            })
                        }
                    }
                    ,
                    t.prototype.endCutoffPicking = function() {
                        var e = this;
                        this.ie.forEach((function(t) {
                            e.J && e.J.off(t.event, t.listener)
                        }
                        )),
                        this.ie.length = 0,
                        this.emit("cutoffend")
                    }
                    ,
                    t
                }(ja)
            }
            ])
        },
        637: function(e) {
            e.exports = function() {
                "use strict";
                var e, t, i;
                function r(r, n) {
                    if (e)
                        if (t) {
                            var a = "var sharedChunk = {}; (" + e + ")(sharedChunk); (" + t + ")(sharedChunk);"
                              , o = {};
                            e(o),
                            i = n(o),
                            "undefined" != typeof window && (i.workerUrl = window.URL.createObjectURL(new Blob([a],{
                                type: "text/javascript"
                            })))
                        } else
                            t = n;
                    else
                        e = n
                }
                return r(0, (function(e) {
                    function t(e, t) {
                        return e(t = {
                            exports: {}
                        }, t.exports),
                        t.exports
                    }
                    var i = r;
                    function r(e, t, i, r) {
                        this.cx = 3 * e,
                        this.bx = 3 * (i - e) - this.cx,
                        this.ax = 1 - this.cx - this.bx,
                        this.cy = 3 * t,
                        this.by = 3 * (r - t) - this.cy,
                        this.ay = 1 - this.cy - this.by,
                        this.p1x = e,
                        this.p1y = r,
                        this.p2x = i,
                        this.p2y = r
                    }
                    r.prototype.sampleCurveX = function(e) {
                        return ((this.ax * e + this.bx) * e + this.cx) * e
                    }
                    ,
                    r.prototype.sampleCurveY = function(e) {
                        return ((this.ay * e + this.by) * e + this.cy) * e
                    }
                    ,
                    r.prototype.sampleCurveDerivativeX = function(e) {
                        return (3 * this.ax * e + 2 * this.bx) * e + this.cx
                    }
                    ,
                    r.prototype.solveCurveX = function(e, t) {
                        var i, r, n, a, o;
                        for (void 0 === t && (t = 1e-6),
                        n = e,
                        o = 0; o < 8; o++) {
                            if (a = this.sampleCurveX(n) - e,
                            Math.abs(a) < t)
                                return n;
                            var s = this.sampleCurveDerivativeX(n);
                            if (Math.abs(s) < 1e-6)
                                break;
                            n -= a / s
                        }
                        if ((n = e) < (i = 0))
                            return i;
                        if (n > (r = 1))
                            return r;
                        for (; i < r; ) {
                            if (a = this.sampleCurveX(n),
                            Math.abs(a - e) < t)
                                return n;
                            e > a ? i = n : r = n,
                            n = .5 * (r - i) + i
                        }
                        return n
                    }
                    ,
                    r.prototype.solve = function(e, t) {
                        return this.sampleCurveY(this.solveCurveX(e, t))
                    }
                    ;
                    var n = a;
                    function a(e, t) {
                        this.x = e,
                        this.y = t
                    }
                    a.prototype = {
                        clone: function() {
                            return new a(this.x,this.y)
                        },
                        add: function(e) {
                            return this.clone()._add(e)
                        },
                        sub: function(e) {
                            return this.clone()._sub(e)
                        },
                        multByPoint: function(e) {
                            return this.clone()._multByPoint(e)
                        },
                        divByPoint: function(e) {
                            return this.clone()._divByPoint(e)
                        },
                        mult: function(e) {
                            return this.clone()._mult(e)
                        },
                        div: function(e) {
                            return this.clone()._div(e)
                        },
                        rotate: function(e) {
                            return this.clone()._rotate(e)
                        },
                        rotateAround: function(e, t) {
                            return this.clone()._rotateAround(e, t)
                        },
                        matMult: function(e) {
                            return this.clone()._matMult(e)
                        },
                        unit: function() {
                            return this.clone()._unit()
                        },
                        perp: function() {
                            return this.clone()._perp()
                        },
                        round: function() {
                            return this.clone()._round()
                        },
                        mag: function() {
                            return Math.sqrt(this.x * this.x + this.y * this.y)
                        },
                        equals: function(e) {
                            return this.x === e.x && this.y === e.y
                        },
                        dist: function(e) {
                            return Math.sqrt(this.distSqr(e))
                        },
                        distSqr: function(e) {
                            var t = e.x - this.x
                              , i = e.y - this.y;
                            return t * t + i * i
                        },
                        angle: function() {
                            return Math.atan2(this.y, this.x)
                        },
                        angleTo: function(e) {
                            return Math.atan2(this.y - e.y, this.x - e.x)
                        },
                        angleWith: function(e) {
                            return this.angleWithSep(e.x, e.y)
                        },
                        angleWithSep: function(e, t) {
                            return Math.atan2(this.x * t - this.y * e, this.x * e + this.y * t)
                        },
                        _matMult: function(e) {
                            var t = e[2] * this.x + e[3] * this.y;
                            return this.x = e[0] * this.x + e[1] * this.y,
                            this.y = t,
                            this
                        },
                        _add: function(e) {
                            return this.x += e.x,
                            this.y += e.y,
                            this
                        },
                        _sub: function(e) {
                            return this.x -= e.x,
                            this.y -= e.y,
                            this
                        },
                        _mult: function(e) {
                            return this.x *= e,
                            this.y *= e,
                            this
                        },
                        _div: function(e) {
                            return this.x /= e,
                            this.y /= e,
                            this
                        },
                        _multByPoint: function(e) {
                            return this.x *= e.x,
                            this.y *= e.y,
                            this
                        },
                        _divByPoint: function(e) {
                            return this.x /= e.x,
                            this.y /= e.y,
                            this
                        },
                        _unit: function() {
                            return this._div(this.mag()),
                            this
                        },
                        _perp: function() {
                            var e = this.y;
                            return this.y = this.x,
                            this.x = -e,
                            this
                        },
                        _rotate: function(e) {
                            var t = Math.cos(e)
                              , i = Math.sin(e)
                              , r = i * this.x + t * this.y;
                            return this.x = t * this.x - i * this.y,
                            this.y = r,
                            this
                        },
                        _rotateAround: function(e, t) {
                            var i = Math.cos(e)
                              , r = Math.sin(e)
                              , n = t.y + r * (this.x - t.x) + i * (this.y - t.y);
                            return this.x = t.x + i * (this.x - t.x) - r * (this.y - t.y),
                            this.y = n,
                            this
                        },
                        _round: function() {
                            return this.x = Math.round(this.x),
                            this.y = Math.round(this.y),
                            this
                        }
                    },
                    a.convert = function(e) {
                        return e instanceof a ? e : Array.isArray(e) ? new a(e[0],e[1]) : e
                    }
                    ;
                    var o = "undefined" != typeof self ? self : {}
                      , s = Math.pow(2, 53) - 1;
                    function l(e, t, r, n) {
                        var a = new i(e,t,r,n);
                        return function(e) {
                            return a.solve(e)
                        }
                    }
                    var u = l(.25, .1, .25, 1);
                    function c(e, t, i) {
                        return Math.min(i, Math.max(t, e))
                    }
                    function h(e, t, i) {
                        var r = i - t
                          , n = ((e - t) % r + r) % r + t;
                        return n === t ? i : n
                    }
                    function p(e) {
                        for (var t = [], i = arguments.length - 1; i-- > 0; )
                            t[i] = arguments[i + 1];
                        for (var r = 0, n = t; r < n.length; r += 1) {
                            var a = n[r];
                            for (var o in a)
                                e[o] = a[o]
                        }
                        return e
                    }
                    var f = 1;
                    function d() {
                        return f++
                    }
                    function m() {
                        return function e(t) {
                            return t ? (t ^ 16 * Math.random() >> t / 4).toString(16) : ([1e7] + -[1e3] + -4e3 + -8e3 + -1e11).replace(/[018]/g, e)
                        }()
                    }
                    function v(e) {
                        return !!e && /^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)
                    }
                    function g(e, t) {
                        e.forEach((function(e) {
                            t[e] && (t[e] = t[e].bind(t))
                        }
                        ))
                    }
                    function y(e, t) {
                        return -1 !== e.indexOf(t, e.length - t.length)
                    }
                    function _(e, t, i) {
                        var r = {};
                        for (var n in e)
                            r[n] = t.call(i || this, e[n], n, e);
                        return r
                    }
                    function x(e, t, i) {
                        var r = {};
                        for (var n in e)
                            t.call(i || this, e[n], n, e) && (r[n] = e[n]);
                        return r
                    }
                    function b(e) {
                        return Array.isArray(e) ? e.map(b) : "object" == typeof e && e ? _(e, b) : e
                    }
                    var w = {};
                    function S(e) {
                        w[e] || ("undefined" != typeof console && console.warn(e),
                        w[e] = !0)
                    }
                    function M(e, t, i) {
                        return (i.y - e.y) * (t.x - e.x) > (t.y - e.y) * (i.x - e.x)
                    }
                    function T(e) {
                        for (var t = 0, i = 0, r = e.length, n = r - 1, a = void 0, o = void 0; i < r; n = i++)
                            t += ((o = e[n]).x - (a = e[i]).x) * (a.y + o.y);
                        return t
                    }
                    function E() {
                        return "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope
                    }
                    function A(e) {
                        var t = {};
                        if (e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g, (function(e, i, r, n) {
                            var a = r || n;
                            return t[i] = !a || a.toLowerCase(),
                            ""
                        }
                        )),
                        t["max-age"]) {
                            var i = parseInt(t["max-age"], 10);
                            isNaN(i) ? delete t["max-age"] : t["max-age"] = i
                        }
                        return t
                    }
                    var P = null;
                    function C(e) {
                        if (null == P) {
                            var t = e.navigator ? e.navigator.userAgent : null;
                            P = !!e.safari || !(!t || !(/\b(iPad|iPhone|iPod)\b/.test(t) || t.match("Safari") && !t.match("Chrome")))
                        }
                        return P
                    }
                    function L(e) {
                        try {
                            var t = o[e];
                            return t.setItem("_mapbox_test_", 1),
                            t.removeItem("_mapbox_test_"),
                            !0
                        } catch (e) {
                            return !1
                        }
                    }
                    var I, k, z, D, R = o.performance && o.performance.now ? o.performance.now.bind(o.performance) : Date.now.bind(Date), O = o.requestAnimationFrame || o.mozRequestAnimationFrame || o.webkitRequestAnimationFrame || o.msRequestAnimationFrame, B = o.cancelAnimationFrame || o.mozCancelAnimationFrame || o.webkitCancelAnimationFrame || o.msCancelAnimationFrame, F = {
                        now: R,
                        frame: function(e) {
                            var t = O(e);
                            return {
                                cancel: function() {
                                    return B(t)
                                }
                            }
                        },
                        getImageData: function(e, t) {
                            void 0 === t && (t = 0);
                            var i = o.document.createElement("canvas")
                              , r = i.getContext("2d");
                            if (!r)
                                throw new Error("failed to create canvas 2d context");
                            return i.width = e.width,
                            i.height = e.height,
                            r.drawImage(e, 0, 0, e.width, e.height),
                            r.getImageData(-t, -t, e.width + 2 * t, e.height + 2 * t)
                        },
                        resolveURL: function(e) {
                            return I || (I = o.document.createElement("a")),
                            I.href = e,
                            I.href
                        },
                        hardwareConcurrency: o.navigator && o.navigator.hardwareConcurrency || 4,
                        get devicePixelRatio() {
                            return o.devicePixelRatio
                        },
                        get prefersReducedMotion() {
                            return !!o.matchMedia && (null == k && (k = o.matchMedia("(prefers-reduced-motion: reduce)")),
                            k.matches)
                        }
                    }, N = {
                        API_URL: "https://api.mapbox.com",
                        get EVENTS_URL() {
                            return this.API_URL ? 0 === this.API_URL.indexOf("https://api.mapbox.cn") ? "https://events.mapbox.cn/events/v2" : 0 === this.API_URL.indexOf("https://api.mapbox.com") ? "https://events.mapbox.com/events/v2" : null : null
                        },
                        FEEDBACK_URL: "https://apps.mapbox.com/feedback",
                        REQUIRE_ACCESS_TOKEN: !0,
                        ACCESS_TOKEN: null,
                        MAX_PARALLEL_IMAGE_REQUESTS: 16
                    }, U = {
                        supported: !1,
                        testSupport: function(e) {
                            !V && D && (G ? j(e) : z = e)
                        }
                    }, V = !1, G = !1;
                    function j(e) {
                        var t = e.createTexture();
                        e.bindTexture(e.TEXTURE_2D, t);
                        try {
                            if (e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, e.RGBA, e.UNSIGNED_BYTE, D),
                            e.isContextLost())
                                return;
                            U.supported = !0
                        } catch (e) {}
                        e.deleteTexture(t),
                        V = !0
                    }
                    o.document && ((D = o.document.createElement("img")).onload = function() {
                        z && j(z),
                        z = null,
                        G = !0
                    }
                    ,
                    D.onerror = function() {
                        V = !0,
                        z = null
                    }
                    ,
                    D.src = "data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");
                    var H = "01"
                      , q = function(e, t) {
                        this._transformRequestFn = e,
                        this._customAccessToken = t,
                        this._createSkuToken()
                    };
                    function W(e) {
                        return 0 === e.indexOf("mapbox:")
                    }
                    q.prototype._createSkuToken = function() {
                        var e = function() {
                            for (var e = "", t = 0; t < 10; t++)
                                e += "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62 * Math.random())];
                            return {
                                token: ["1", H, e].join(""),
                                tokenExpiresAt: Date.now() + 432e5
                            }
                        }();
                        this._skuToken = e.token,
                        this._skuTokenExpiresAt = e.tokenExpiresAt
                    }
                    ,
                    q.prototype._isSkuTokenExpired = function() {
                        return Date.now() > this._skuTokenExpiresAt
                    }
                    ,
                    q.prototype.transformRequest = function(e, t) {
                        return this._transformRequestFn && this._transformRequestFn(e, t) || {
                            url: e
                        }
                    }
                    ,
                    q.prototype.normalizeStyleURL = function(e, t) {
                        if (!W(e))
                            return e;
                        var i = K(e);
                        return i.path = "/styles/v1" + i.path,
                        this._makeAPIURL(i, this._customAccessToken || t)
                    }
                    ,
                    q.prototype.normalizeGlyphsURL = function(e, t) {
                        if (!W(e))
                            return e;
                        var i = K(e);
                        return i.path = "/fonts/v1" + i.path,
                        this._makeAPIURL(i, this._customAccessToken || t)
                    }
                    ,
                    q.prototype.normalizeSourceURL = function(e, t) {
                        if (!W(e))
                            return e;
                        var i = K(e);
                        return i.path = "/v4/" + i.authority + ".json",
                        i.params.push("secure"),
                        this._makeAPIURL(i, this._customAccessToken || t)
                    }
                    ,
                    q.prototype.normalizeSpriteURL = function(e, t, i, r) {
                        var n = K(e);
                        return W(e) ? (n.path = "/styles/v1" + n.path + "/sprite" + t + i,
                        this._makeAPIURL(n, this._customAccessToken || r)) : (n.path += "" + t + i,
                        J(n))
                    }
                    ,
                    q.prototype.normalizeTileURL = function(e, t) {
                        if (this._isSkuTokenExpired() && this._createSkuToken(),
                        e && !W(e))
                            return e;
                        var i = K(e);
                        i.path = i.path.replace(/(\.(png|jpg)\d*)(?=$)/, (F.devicePixelRatio >= 2 || 512 === t ? "@2x" : "") + (U.supported ? ".webp" : "$1")),
                        i.path = i.path.replace(/^.+\/v4\//, "/"),
                        i.path = "/v4" + i.path;
                        var r = this._customAccessToken || function(e) {
                            for (var t = 0, i = e; t < i.length; t += 1) {
                                var r = i[t].match(/^access_token=(.*)$/);
                                if (r)
                                    return r[1]
                            }
                            return null
                        }(i.params) || N.ACCESS_TOKEN;
                        return N.REQUIRE_ACCESS_TOKEN && r && this._skuToken && i.params.push("sku=" + this._skuToken),
                        this._makeAPIURL(i, r)
                    }
                    ,
                    q.prototype.canonicalizeTileURL = function(e, t) {
                        var i = K(e);
                        if (!i.path.match(/(^\/v4\/)/) || !i.path.match(/\.[\w]+$/))
                            return e;
                        var r = "mapbox://tiles/";
                        r += i.path.replace("/v4/", "");
                        var n = i.params;
                        return t && (n = n.filter((function(e) {
                            return !e.match(/^access_token=/)
                        }
                        ))),
                        n.length && (r += "?" + n.join("&")),
                        r
                    }
                    ,
                    q.prototype.canonicalizeTileset = function(e, t) {
                        for (var i = !!t && W(t), r = [], n = 0, a = e.tiles || []; n < a.length; n += 1) {
                            var o = a[n];
                            X(o) ? r.push(this.canonicalizeTileURL(o, i)) : r.push(o)
                        }
                        return r
                    }
                    ,
                    q.prototype._makeAPIURL = function(e, t) {
                        var i = "See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"
                          , r = K(N.API_URL);
                        if (e.protocol = r.protocol,
                        e.authority = r.authority,
                        "http" === e.protocol) {
                            var n = e.params.indexOf("secure");
                            n >= 0 && e.params.splice(n, 1)
                        }
                        if ("/" !== r.path && (e.path = "" + r.path + e.path),
                        !N.REQUIRE_ACCESS_TOKEN)
                            return J(e);
                        if (!(t = t || N.ACCESS_TOKEN))
                            throw new Error("An API access token is required to use Mapbox GL. " + i);
                        if ("s" === t[0])
                            throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). " + i);
                        return e.params = e.params.filter((function(e) {
                            return -1 === e.indexOf("access_token")
                        }
                        )),
                        e.params.push("access_token=" + t),
                        J(e)
                    }
                    ;
                    var Z = /^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;
                    function X(e) {
                        return Z.test(e)
                    }
                    var Y = /^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;
                    function K(e) {
                        var t = e.match(Y);
                        if (!t)
                            throw new Error("Unable to parse URL object");
                        return {
                            protocol: t[1],
                            authority: t[2],
                            path: t[3] || "/",
                            params: t[4] ? t[4].split("&") : []
                        }
                    }
                    function J(e) {
                        var t = e.params.length ? "?" + e.params.join("&") : "";
                        return e.protocol + "://" + e.authority + e.path + t
                    }
                    function Q(e) {
                        if (!e)
                            return null;
                        var t = e.split(".");
                        if (!t || 3 !== t.length)
                            return null;
                        try {
                            return JSON.parse(decodeURIComponent(o.atob(t[1]).split("").map((function(e) {
                                return "%" + ("00" + e.charCodeAt(0).toString(16)).slice(-2)
                            }
                            )).join("")))
                        } catch (e) {
                            return null
                        }
                    }
                    var $ = function(e) {
                        this.type = e,
                        this.anonId = null,
                        this.eventData = {},
                        this.queue = [],
                        this.pendingRequest = null
                    };
                    $.prototype.getStorageKey = function(e) {
                        var t, i = Q(N.ACCESS_TOKEN);
                        return t = i && i.u ? o.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g, (function(e, t) {
                            return String.fromCharCode(Number("0x" + t))
                        }
                        ))) : N.ACCESS_TOKEN || "",
                        e ? "mapbox.eventData." + e + ":" + t : "mapbox.eventData:" + t
                    }
                    ,
                    $.prototype.fetchEventData = function() {
                        var e = L("localStorage")
                          , t = this.getStorageKey()
                          , i = this.getStorageKey("uuid");
                        if (e)
                            try {
                                var r = o.localStorage.getItem(t);
                                r && (this.eventData = JSON.parse(r));
                                var n = o.localStorage.getItem(i);
                                n && (this.anonId = n)
                            } catch (e) {
                                S("Unable to read from LocalStorage")
                            }
                    }
                    ,
                    $.prototype.saveEventData = function() {
                        var e = L("localStorage")
                          , t = this.getStorageKey()
                          , i = this.getStorageKey("uuid");
                        if (e)
                            try {
                                o.localStorage.setItem(i, this.anonId),
                                Object.keys(this.eventData).length >= 1 && o.localStorage.setItem(t, JSON.stringify(this.eventData))
                            } catch (e) {
                                S("Unable to write to LocalStorage")
                            }
                    }
                    ,
                    $.prototype.processRequests = function(e) {}
                    ,
                    $.prototype.postEvent = function(e, t, i, r) {
                        var n = this;
                        if (N.EVENTS_URL) {
                            var a = K(N.EVENTS_URL);
                            a.params.push("access_token=" + (r || N.ACCESS_TOKEN || ""));
                            var o = {
                                event: this.type,
                                created: new Date(e).toISOString(),
                                sdkIdentifier: "mapbox-gl-js",
                                sdkVersion: "1.14.0",
                                skuId: H,
                                userId: this.anonId
                            }
                              , s = t ? p(o, t) : o
                              , l = {
                                url: J(a),
                                headers: {
                                    "Content-Type": "text/plain"
                                },
                                body: JSON.stringify([s])
                            };
                            this.pendingRequest = be(l, (function(e) {
                                n.pendingRequest = null,
                                i(e),
                                n.saveEventData(),
                                n.processRequests(r)
                            }
                            ))
                        }
                    }
                    ,
                    $.prototype.queueRequest = function(e, t) {
                        this.queue.push(e),
                        this.processRequests(t)
                    }
                    ;
                    var ee, te, ie = function(e) {
                        function t() {
                            e.call(this, "map.load"),
                            this.success = {},
                            this.skuToken = ""
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.postMapLoadEvent = function(e, t, i, r) {
                            this.skuToken = i,
                            (N.EVENTS_URL && r || N.ACCESS_TOKEN && Array.isArray(e) && e.some((function(e) {
                                return W(e) || X(e)
                            }
                            ))) && this.queueRequest({
                                id: t,
                                timestamp: Date.now()
                            }, r)
                        }
                        ,
                        t.prototype.processRequests = function(e) {
                            var t = this;
                            if (!this.pendingRequest && 0 !== this.queue.length) {
                                var i = this.queue.shift()
                                  , r = i.id
                                  , n = i.timestamp;
                                r && this.success[r] || (this.anonId || this.fetchEventData(),
                                v(this.anonId) || (this.anonId = m()),
                                this.postEvent(n, {
                                    skuToken: this.skuToken
                                }, (function(e) {
                                    e || r && (t.success[r] = !0)
                                }
                                ), e))
                            }
                        }
                        ,
                        t
                    }($), re = new (function(e) {
                        function t(t) {
                            e.call(this, "appUserTurnstile"),
                            this._customAccessToken = t
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.postTurnstileEvent = function(e, t) {
                            N.EVENTS_URL && N.ACCESS_TOKEN && Array.isArray(e) && e.some((function(e) {
                                return W(e) || X(e)
                            }
                            )) && this.queueRequest(Date.now(), t)
                        }
                        ,
                        t.prototype.processRequests = function(e) {
                            var t = this;
                            if (!this.pendingRequest && 0 !== this.queue.length) {
                                this.anonId && this.eventData.lastSuccess && this.eventData.tokenU || this.fetchEventData();
                                var i = Q(N.ACCESS_TOKEN)
                                  , r = i ? i.u : N.ACCESS_TOKEN
                                  , n = r !== this.eventData.tokenU;
                                v(this.anonId) || (this.anonId = m(),
                                n = !0);
                                var a = this.queue.shift();
                                if (this.eventData.lastSuccess) {
                                    var o = new Date(this.eventData.lastSuccess)
                                      , s = new Date(a)
                                      , l = (a - this.eventData.lastSuccess) / 864e5;
                                    n = n || l >= 1 || l < -1 || o.getDate() !== s.getDate()
                                } else
                                    n = !0;
                                if (!n)
                                    return this.processRequests();
                                this.postEvent(a, {
                                    "enabled.telemetry": !1
                                }, (function(e) {
                                    e || (t.eventData.lastSuccess = a,
                                    t.eventData.tokenU = r)
                                }
                                ), e)
                            }
                        }
                        ,
                        t
                    }($)), ne = re.postTurnstileEvent.bind(re), ae = new ie, oe = ae.postMapLoadEvent.bind(ae), se = 500, le = 50;
                    function ue() {
                        o.caches && !ee && (ee = o.caches.open("mapbox-tiles"))
                    }
                    function ce(e) {
                        var t = e.indexOf("?");
                        return t < 0 ? e : e.slice(0, t)
                    }
                    var he, pe = 1 / 0;
                    function fe() {
                        return null == he && (he = o.OffscreenCanvas && new o.OffscreenCanvas(1,1).getContext("2d") && "function" == typeof o.createImageBitmap),
                        he
                    }
                    var de = {
                        Unknown: "Unknown",
                        Style: "Style",
                        Source: "Source",
                        Tile: "Tile",
                        Glyphs: "Glyphs",
                        SpriteImage: "SpriteImage",
                        SpriteJSON: "SpriteJSON",
                        Image: "Image"
                    };
                    "function" == typeof Object.freeze && Object.freeze(de);
                    var me, ve, ge = function(e) {
                        function t(t, i, r) {
                            401 === i && X(r) && (t += ": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),
                            e.call(this, t),
                            this.status = i,
                            this.url = r,
                            this.name = this.constructor.name,
                            this.message = t
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.toString = function() {
                            return this.name + ": " + this.message + " (" + this.status + "): " + this.url
                        }
                        ,
                        t
                    }(Error), ye = E() ? function() {
                        return self.worker && self.worker.referrer
                    }
                    : function() {
                        return ("blob:" === o.location.protocol ? o.parent : o).location.href
                    }
                    , _e = function(e, t) {
                        if (!(/^file:/.test(i = e.url) || /^file:/.test(ye()) && !/^\w+:/.test(i))) {
                            if (o.fetch && o.Request && o.AbortController && o.Request.prototype.hasOwnProperty("signal"))
                                return function(e, t) {
                                    var i, r = new o.AbortController, n = new o.Request(e.url,{
                                        method: e.method || "GET",
                                        body: e.body,
                                        credentials: e.credentials,
                                        headers: e.headers,
                                        referrer: ye(),
                                        signal: r.signal
                                    }), a = !1, s = !1, l = (i = n.url).indexOf("sku=") > 0 && X(i);
                                    "json" === e.type && n.headers.set("Accept", "application/json");
                                    var u = function(i, r, a) {
                                        if (!s) {
                                            if (i && "SecurityError" !== i.message && S(i),
                                            r && a)
                                                return c(r);
                                            var u = Date.now();
                                            o.fetch(n).then((function(i) {
                                                if (i.ok) {
                                                    var r = l ? i.clone() : null;
                                                    return c(i, r, u)
                                                }
                                                return t(new ge(i.statusText,i.status,e.url))
                                            }
                                            )).catch((function(e) {
                                                20 !== e.code && t(new Error(e.message))
                                            }
                                            ))
                                        }
                                    }
                                      , c = function(i, r, l) {
                                        ("arrayBuffer" === e.type ? i.arrayBuffer() : "json" === e.type ? i.json() : i.text()).then((function(e) {
                                            s || (r && l && function(e, t, i) {
                                                if (ue(),
                                                ee) {
                                                    var r = {
                                                        status: t.status,
                                                        statusText: t.statusText,
                                                        headers: new o.Headers
                                                    };
                                                    t.headers.forEach((function(e, t) {
                                                        return r.headers.set(t, e)
                                                    }
                                                    ));
                                                    var n = A(t.headers.get("Cache-Control") || "");
                                                    n["no-store"] || (n["max-age"] && r.headers.set("Expires", new Date(i + 1e3 * n["max-age"]).toUTCString()),
                                                    new Date(r.headers.get("Expires")).getTime() - i < 42e4 || function(e, t) {
                                                        if (void 0 === te)
                                                            try {
                                                                new Response(new ReadableStream),
                                                                te = !0
                                                            } catch (e) {
                                                                te = !1
                                                            }
                                                        te ? t(e.body) : e.blob().then(t)
                                                    }(t, (function(t) {
                                                        var i = new o.Response(t,r);
                                                        ue(),
                                                        ee && ee.then((function(t) {
                                                            return t.put(ce(e.url), i)
                                                        }
                                                        )).catch((function(e) {
                                                            return S(e.message)
                                                        }
                                                        ))
                                                    }
                                                    )))
                                                }
                                            }(n, r, l),
                                            a = !0,
                                            t(null, e, i.headers.get("Cache-Control"), i.headers.get("Expires")))
                                        }
                                        )).catch((function(e) {
                                            s || t(new Error(e.message))
                                        }
                                        ))
                                    };
                                    return l ? function(e, t) {
                                        if (ue(),
                                        !ee)
                                            return t(null);
                                        var i = ce(e.url);
                                        ee.then((function(e) {
                                            e.match(i).then((function(r) {
                                                var n = function(e) {
                                                    if (!e)
                                                        return !1;
                                                    var t = new Date(e.headers.get("Expires") || 0)
                                                      , i = A(e.headers.get("Cache-Control") || "");
                                                    return t > Date.now() && !i["no-cache"]
                                                }(r);
                                                e.delete(i),
                                                n && e.put(i, r.clone()),
                                                t(null, r, n)
                                            }
                                            )).catch(t)
                                        }
                                        )).catch(t)
                                    }(n, u) : u(null, null),
                                    {
                                        cancel: function() {
                                            s = !0,
                                            a || r.abort()
                                        }
                                    }
                                }(e, t);
                            if (E() && self.worker && self.worker.actor)
                                return self.worker.actor.send("getResource", e, t, void 0, !0)
                        }
                        var i;
                        return function(e, t) {
                            var i = new o.XMLHttpRequest;
                            for (var r in i.open(e.method || "GET", e.url, !0),
                            "arrayBuffer" === e.type && (i.responseType = "arraybuffer"),
                            e.headers)
                                i.setRequestHeader(r, e.headers[r]);
                            return "json" === e.type && (i.responseType = "text",
                            i.setRequestHeader("Accept", "application/json")),
                            i.withCredentials = "include" === e.credentials,
                            i.onerror = function() {
                                t(new Error(i.statusText))
                            }
                            ,
                            i.onload = function() {
                                if ((i.status >= 200 && i.status < 300 || 0 === i.status) && null !== i.response) {
                                    var r = i.response;
                                    if ("json" === e.type)
                                        try {
                                            r = JSON.parse(i.response)
                                        } catch (e) {
                                            return t(e)
                                        }
                                    t(null, r, i.getResponseHeader("Cache-Control"), i.getResponseHeader("Expires"))
                                } else
                                    t(new ge(i.statusText,i.status,e.url))
                            }
                            ,
                            i.send(e.body),
                            {
                                cancel: function() {
                                    return i.abort()
                                }
                            }
                        }(e, t)
                    }, xe = function(e, t) {
                        return _e(p(e, {
                            type: "arrayBuffer"
                        }), t)
                    }, be = function(e, t) {
                        return _e(p(e, {
                            method: "POST"
                        }), t)
                    }, we = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";
                    me = [],
                    ve = 0;
                    var Se = function(e, t) {
                        if (U.supported && (e.headers || (e.headers = {}),
                        e.headers.accept = "image/webp,*/*"),
                        ve >= N.MAX_PARALLEL_IMAGE_REQUESTS) {
                            var i = {
                                requestParameters: e,
                                callback: t,
                                cancelled: !1,
                                cancel: function() {
                                    this.cancelled = !0
                                }
                            };
                            return me.push(i),
                            i
                        }
                        ve++;
                        var r = !1
                          , n = function() {
                            if (!r)
                                for (r = !0,
                                ve--; me.length && ve < N.MAX_PARALLEL_IMAGE_REQUESTS; ) {
                                    var e = me.shift();
                                    e.cancelled || (e.cancel = Se(e.requestParameters, e.callback).cancel)
                                }
                        }
                          , a = xe(e, (function(e, i, r, a) {
                            n(),
                            e ? t(e) : i && (fe() ? function(e, t) {
                                var i = new o.Blob([new Uint8Array(e)],{
                                    type: "image/png"
                                });
                                o.createImageBitmap(i).then((function(e) {
                                    t(null, e)
                                }
                                )).catch((function(e) {
                                    t(new Error("Could not load image because of " + e.message + ". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))
                                }
                                ))
                            }(i, t) : function(e, t, i, r) {
                                var n = new o.Image
                                  , a = o.URL;
                                n.onload = function() {
                                    t(null, n),
                                    a.revokeObjectURL(n.src),
                                    n.onload = null,
                                    o.requestAnimationFrame((function() {
                                        n.src = we
                                    }
                                    ))
                                }
                                ,
                                n.onerror = function() {
                                    return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))
                                }
                                ;
                                var s = new o.Blob([new Uint8Array(e)],{
                                    type: "image/png"
                                });
                                n.cacheControl = i,
                                n.expires = r,
                                n.src = e.byteLength ? a.createObjectURL(s) : we
                            }(i, t, r, a))
                        }
                        ));
                        return {
                            cancel: function() {
                                a.cancel(),
                                n()
                            }
                        }
                    };
                    function Me(e, t, i) {
                        i[e] && -1 !== i[e].indexOf(t) || (i[e] = i[e] || [],
                        i[e].push(t))
                    }
                    function Te(e, t, i) {
                        if (i && i[e]) {
                            var r = i[e].indexOf(t);
                            -1 !== r && i[e].splice(r, 1)
                        }
                    }
                    var Ee = function(e, t) {
                        void 0 === t && (t = {}),
                        p(this, t),
                        this.type = e
                    }
                      , Ae = function(e) {
                        function t(t, i) {
                            void 0 === i && (i = {}),
                            e.call(this, "error", p({
                                error: t
                            }, i))
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t
                    }(Ee)
                      , Pe = function() {};
                    Pe.prototype.on = function(e, t) {
                        return this._listeners = this._listeners || {},
                        Me(e, t, this._listeners),
                        this
                    }
                    ,
                    Pe.prototype.off = function(e, t) {
                        return Te(e, t, this._listeners),
                        Te(e, t, this._oneTimeListeners),
                        this
                    }
                    ,
                    Pe.prototype.once = function(e, t) {
                        return this._oneTimeListeners = this._oneTimeListeners || {},
                        Me(e, t, this._oneTimeListeners),
                        this
                    }
                    ,
                    Pe.prototype.fire = function(e, t) {
                        "string" == typeof e && (e = new Ee(e,t || {}));
                        var i = e.type;
                        if (this.listens(i)) {
                            e.target = this;
                            for (var r = 0, n = this._listeners && this._listeners[i] ? this._listeners[i].slice() : []; r < n.length; r += 1)
                                n[r].call(this, e);
                            for (var a = 0, o = this._oneTimeListeners && this._oneTimeListeners[i] ? this._oneTimeListeners[i].slice() : []; a < o.length; a += 1) {
                                var s = o[a];
                                Te(i, s, this._oneTimeListeners),
                                s.call(this, e)
                            }
                            var l = this._eventedParent;
                            l && (p(e, "function" == typeof this._eventedParentData ? this._eventedParentData() : this._eventedParentData),
                            l.fire(e))
                        } else
                            e instanceof Ae && console.error(e.error);
                        return this
                    }
                    ,
                    Pe.prototype.listens = function(e) {
                        return this._listeners && this._listeners[e] && this._listeners[e].length > 0 || this._oneTimeListeners && this._oneTimeListeners[e] && this._oneTimeListeners[e].length > 0 || this._eventedParent && this._eventedParent.listens(e)
                    }
                    ,
                    Pe.prototype.setEventedParent = function(e, t) {
                        return this._eventedParent = e,
                        this._eventedParentData = t,
                        this
                    }
                    ;
                    var Ce = {
                        $version: 8,
                        $root: {
                            version: {
                                required: !0,
                                type: "enum",
                                values: [8]
                            },
                            name: {
                                type: "string"
                            },
                            metadata: {
                                type: "*"
                            },
                            center: {
                                type: "array",
                                value: "number"
                            },
                            zoom: {
                                type: "number"
                            },
                            bearing: {
                                type: "number",
                                default: 0,
                                period: 360,
                                units: "degrees"
                            },
                            pitch: {
                                type: "number",
                                default: 0,
                                units: "degrees"
                            },
                            light: {
                                type: "light"
                            },
                            sources: {
                                required: !0,
                                type: "sources"
                            },
                            sprite: {
                                type: "string"
                            },
                            glyphs: {
                                type: "string"
                            },
                            transition: {
                                type: "transition"
                            },
                            layers: {
                                required: !0,
                                type: "array",
                                value: "layer"
                            }
                        },
                        sources: {
                            "*": {
                                type: "source"
                            }
                        },
                        source: ["source_vector", "source_raster", "source_raster_dem", "source_geojson", "source_video", "source_image"],
                        source_vector: {
                            type: {
                                required: !0,
                                type: "enum",
                                values: {
                                    vector: {}
                                }
                            },
                            url: {
                                type: "string"
                            },
                            tiles: {
                                type: "array",
                                value: "string"
                            },
                            bounds: {
                                type: "array",
                                value: "number",
                                length: 4,
                                default: [-180, -85.051129, 180, 85.051129]
                            },
                            scheme: {
                                type: "enum",
                                values: {
                                    xyz: {},
                                    tms: {}
                                },
                                default: "xyz"
                            },
                            minzoom: {
                                type: "number",
                                default: 0
                            },
                            maxzoom: {
                                type: "number",
                                default: 22
                            },
                            attribution: {
                                type: "string"
                            },
                            promoteId: {
                                type: "promoteId"
                            },
                            volatile: {
                                type: "boolean",
                                default: !1
                            },
                            "*": {
                                type: "*"
                            }
                        },
                        source_raster: {
                            type: {
                                required: !0,
                                type: "enum",
                                values: {
                                    raster: {}
                                }
                            },
                            url: {
                                type: "string"
                            },
                            tiles: {
                                type: "array",
                                value: "string"
                            },
                            bounds: {
                                type: "array",
                                value: "number",
                                length: 4,
                                default: [-180, -85.051129, 180, 85.051129]
                            },
                            minzoom: {
                                type: "number",
                                default: 0
                            },
                            maxzoom: {
                                type: "number",
                                default: 22
                            },
                            tileSize: {
                                type: "number",
                                default: 512,
                                units: "pixels"
                            },
                            scheme: {
                                type: "enum",
                                values: {
                                    xyz: {},
                                    tms: {}
                                },
                                default: "xyz"
                            },
                            attribution: {
                                type: "string"
                            },
                            volatile: {
                                type: "boolean",
                                default: !1
                            },
                            "*": {
                                type: "*"
                            }
                        },
                        source_raster_dem: {
                            type: {
                                required: !0,
                                type: "enum",
                                values: {
                                    "raster-dem": {}
                                }
                            },
                            url: {
                                type: "string"
                            },
                            tiles: {
                                type: "array",
                                value: "string"
                            },
                            bounds: {
                                type: "array",
                                value: "number",
                                length: 4,
                                default: [-180, -85.051129, 180, 85.051129]
                            },
                            minzoom: {
                                type: "number",
                                default: 0
                            },
                            maxzoom: {
                                type: "number",
                                default: 22
                            },
                            tileSize: {
                                type: "number",
                                default: 512,
                                units: "pixels"
                            },
                            attribution: {
                                type: "string"
                            },
                            encoding: {
                                type: "enum",
                                values: {
                                    terrarium: {},
                                    mapbox: {}
                                },
                                default: "mapbox"
                            },
                            volatile: {
                                type: "boolean",
                                default: !1
                            },
                            "*": {
                                type: "*"
                            }
                        },
                        source_geojson: {
                            type: {
                                required: !0,
                                type: "enum",
                                values: {
                                    geojson: {}
                                }
                            },
                            data: {
                                type: "*"
                            },
                            maxzoom: {
                                type: "number",
                                default: 18
                            },
                            attribution: {
                                type: "string"
                            },
                            buffer: {
                                type: "number",
                                default: 128,
                                maximum: 512,
                                minimum: 0
                            },
                            filter: {
                                type: "*"
                            },
                            tolerance: {
                                type: "number",
                                default: .375
                            },
                            cluster: {
                                type: "boolean",
                                default: !1
                            },
                            clusterRadius: {
                                type: "number",
                                default: 50,
                                minimum: 0
                            },
                            clusterMaxZoom: {
                                type: "number"
                            },
                            clusterMinPoints: {
                                type: "number"
                            },
                            clusterProperties: {
                                type: "*"
                            },
                            lineMetrics: {
                                type: "boolean",
                                default: !1
                            },
                            generateId: {
                                type: "boolean",
                                default: !1
                            },
                            promoteId: {
                                type: "promoteId"
                            }
                        },
                        source_video: {
                            type: {
                                required: !0,
                                type: "enum",
                                values: {
                                    video: {}
                                }
                            },
                            urls: {
                                required: !0,
                                type: "array",
                                value: "string"
                            },
                            coordinates: {
                                required: !0,
                                type: "array",
                                length: 4,
                                value: {
                                    type: "array",
                                    length: 2,
                                    value: "number"
                                }
                            }
                        },
                        source_image: {
                            type: {
                                required: !0,
                                type: "enum",
                                values: {
                                    image: {}
                                }
                            },
                            url: {
                                required: !0,
                                type: "string"
                            },
                            coordinates: {
                                required: !0,
                                type: "array",
                                length: 4,
                                value: {
                                    type: "array",
                                    length: 2,
                                    value: "number"
                                }
                            }
                        },
                        layer: {
                            id: {
                                type: "string",
                                required: !0
                            },
                            type: {
                                type: "enum",
                                values: {
                                    fill: {},
                                    line: {},
                                    symbol: {},
                                    circle: {},
                                    heatmap: {},
                                    "fill-extrusion": {},
                                    raster: {},
                                    hillshade: {},
                                    background: {}
                                },
                                required: !0
                            },
                            metadata: {
                                type: "*"
                            },
                            source: {
                                type: "string"
                            },
                            "source-layer": {
                                type: "string"
                            },
                            minzoom: {
                                type: "number",
                                minimum: 0,
                                maximum: 24
                            },
                            maxzoom: {
                                type: "number",
                                minimum: 0,
                                maximum: 24
                            },
                            filter: {
                                type: "filter"
                            },
                            layout: {
                                type: "layout"
                            },
                            paint: {
                                type: "paint"
                            }
                        },
                        layout: ["layout_fill", "layout_line", "layout_circle", "layout_heatmap", "layout_fill-extrusion", "layout_symbol", "layout_raster", "layout_hillshade", "layout_background"],
                        layout_background: {
                            visibility: {
                                type: "enum",
                                values: {
                                    visible: {},
                                    none: {}
                                },
                                default: "visible",
                                "property-type": "constant"
                            }
                        },
                        layout_fill: {
                            "fill-sort-key": {
                                type: "number",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            visibility: {
                                type: "enum",
                                values: {
                                    visible: {},
                                    none: {}
                                },
                                default: "visible",
                                "property-type": "constant"
                            }
                        },
                        layout_circle: {
                            "circle-sort-key": {
                                type: "number",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            visibility: {
                                type: "enum",
                                values: {
                                    visible: {},
                                    none: {}
                                },
                                default: "visible",
                                "property-type": "constant"
                            }
                        },
                        layout_heatmap: {
                            visibility: {
                                type: "enum",
                                values: {
                                    visible: {},
                                    none: {}
                                },
                                default: "visible",
                                "property-type": "constant"
                            }
                        },
                        "layout_fill-extrusion": {
                            visibility: {
                                type: "enum",
                                values: {
                                    visible: {},
                                    none: {}
                                },
                                default: "visible",
                                "property-type": "constant"
                            }
                        },
                        layout_line: {
                            "line-cap": {
                                type: "enum",
                                values: {
                                    butt: {},
                                    round: {},
                                    square: {}
                                },
                                default: "butt",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "line-join": {
                                type: "enum",
                                values: {
                                    bevel: {},
                                    round: {},
                                    miter: {}
                                },
                                default: "miter",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "line-miter-limit": {
                                type: "number",
                                default: 2,
                                requires: [{
                                    "line-join": "miter"
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "line-round-limit": {
                                type: "number",
                                default: 1.05,
                                requires: [{
                                    "line-join": "round"
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "line-sort-key": {
                                type: "number",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            visibility: {
                                type: "enum",
                                values: {
                                    visible: {},
                                    none: {}
                                },
                                default: "visible",
                                "property-type": "constant"
                            }
                        },
                        layout_symbol: {
                            "symbol-placement": {
                                type: "enum",
                                values: {
                                    point: {},
                                    line: {},
                                    "line-center": {}
                                },
                                default: "point",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "symbol-spacing": {
                                type: "number",
                                default: 250,
                                minimum: 1,
                                units: "pixels",
                                requires: [{
                                    "symbol-placement": "line"
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "symbol-avoid-edges": {
                                type: "boolean",
                                default: !1,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "symbol-sort-key": {
                                type: "number",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "symbol-z-order": {
                                type: "enum",
                                values: {
                                    auto: {},
                                    "viewport-y": {},
                                    source: {}
                                },
                                default: "auto",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-allow-overlap": {
                                type: "boolean",
                                default: !1,
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-ignore-placement": {
                                type: "boolean",
                                default: !1,
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-optional": {
                                type: "boolean",
                                default: !1,
                                requires: ["icon-image", "text-field"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-rotation-alignment": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {},
                                    auto: {}
                                },
                                default: "auto",
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-size": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                units: "factor of the original icon size",
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-text-fit": {
                                type: "enum",
                                values: {
                                    none: {},
                                    width: {},
                                    height: {},
                                    both: {}
                                },
                                default: "none",
                                requires: ["icon-image", "text-field"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-text-fit-padding": {
                                type: "array",
                                value: "number",
                                length: 4,
                                default: [0, 0, 0, 0],
                                units: "pixels",
                                requires: ["icon-image", "text-field", {
                                    "icon-text-fit": ["both", "width", "height"]
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-image": {
                                type: "resolvedImage",
                                tokens: !0,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-rotate": {
                                type: "number",
                                default: 0,
                                period: 360,
                                units: "degrees",
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-padding": {
                                type: "number",
                                default: 2,
                                minimum: 0,
                                units: "pixels",
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-keep-upright": {
                                type: "boolean",
                                default: !1,
                                requires: ["icon-image", {
                                    "icon-rotation-alignment": "map"
                                }, {
                                    "symbol-placement": ["line", "line-center"]
                                }],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-offset": {
                                type: "array",
                                value: "number",
                                length: 2,
                                default: [0, 0],
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-anchor": {
                                type: "enum",
                                values: {
                                    center: {},
                                    left: {},
                                    right: {},
                                    top: {},
                                    bottom: {},
                                    "top-left": {},
                                    "top-right": {},
                                    "bottom-left": {},
                                    "bottom-right": {}
                                },
                                default: "center",
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-pitch-alignment": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {},
                                    auto: {}
                                },
                                default: "auto",
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-pitch-alignment": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {},
                                    auto: {}
                                },
                                default: "auto",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-rotation-alignment": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {},
                                    auto: {}
                                },
                                default: "auto",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-field": {
                                type: "formatted",
                                default: "",
                                tokens: !0,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-font": {
                                type: "array",
                                value: "string",
                                default: ["Open Sans Regular", "Arial Unicode MS Regular"],
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-size": {
                                type: "number",
                                default: 16,
                                minimum: 0,
                                units: "pixels",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-max-width": {
                                type: "number",
                                default: 10,
                                minimum: 0,
                                units: "ems",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-line-height": {
                                type: "number",
                                default: 1.2,
                                units: "ems",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-letter-spacing": {
                                type: "number",
                                default: 0,
                                units: "ems",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-justify": {
                                type: "enum",
                                values: {
                                    auto: {},
                                    left: {},
                                    center: {},
                                    right: {}
                                },
                                default: "center",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-radial-offset": {
                                type: "number",
                                units: "ems",
                                default: 0,
                                requires: ["text-field"],
                                "property-type": "data-driven",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature"]
                                }
                            },
                            "text-variable-anchor": {
                                type: "array",
                                value: "enum",
                                values: {
                                    center: {},
                                    left: {},
                                    right: {},
                                    top: {},
                                    bottom: {},
                                    "top-left": {},
                                    "top-right": {},
                                    "bottom-left": {},
                                    "bottom-right": {}
                                },
                                requires: ["text-field", {
                                    "symbol-placement": ["point"]
                                }],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-anchor": {
                                type: "enum",
                                values: {
                                    center: {},
                                    left: {},
                                    right: {},
                                    top: {},
                                    bottom: {},
                                    "top-left": {},
                                    "top-right": {},
                                    "bottom-left": {},
                                    "bottom-right": {}
                                },
                                default: "center",
                                requires: ["text-field", {
                                    "!": "text-variable-anchor"
                                }],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-max-angle": {
                                type: "number",
                                default: 45,
                                units: "degrees",
                                requires: ["text-field", {
                                    "symbol-placement": ["line", "line-center"]
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-writing-mode": {
                                type: "array",
                                value: "enum",
                                values: {
                                    horizontal: {},
                                    vertical: {}
                                },
                                requires: ["text-field", {
                                    "symbol-placement": ["point"]
                                }],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-rotate": {
                                type: "number",
                                default: 0,
                                period: 360,
                                units: "degrees",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-padding": {
                                type: "number",
                                default: 2,
                                minimum: 0,
                                units: "pixels",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-keep-upright": {
                                type: "boolean",
                                default: !0,
                                requires: ["text-field", {
                                    "text-rotation-alignment": "map"
                                }, {
                                    "symbol-placement": ["line", "line-center"]
                                }],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-transform": {
                                type: "enum",
                                values: {
                                    none: {},
                                    uppercase: {},
                                    lowercase: {}
                                },
                                default: "none",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-offset": {
                                type: "array",
                                value: "number",
                                units: "ems",
                                length: 2,
                                default: [0, 0],
                                requires: ["text-field", {
                                    "!": "text-radial-offset"
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-allow-overlap": {
                                type: "boolean",
                                default: !1,
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-ignore-placement": {
                                type: "boolean",
                                default: !1,
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-optional": {
                                type: "boolean",
                                default: !1,
                                requires: ["text-field", "icon-image"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            visibility: {
                                type: "enum",
                                values: {
                                    visible: {},
                                    none: {}
                                },
                                default: "visible",
                                "property-type": "constant"
                            }
                        },
                        layout_raster: {
                            visibility: {
                                type: "enum",
                                values: {
                                    visible: {},
                                    none: {}
                                },
                                default: "visible",
                                "property-type": "constant"
                            }
                        },
                        layout_hillshade: {
                            visibility: {
                                type: "enum",
                                values: {
                                    visible: {},
                                    none: {}
                                },
                                default: "visible",
                                "property-type": "constant"
                            }
                        },
                        filter: {
                            type: "array",
                            value: "*"
                        },
                        filter_operator: {
                            type: "enum",
                            values: {
                                "==": {},
                                "!=": {},
                                ">": {},
                                ">=": {},
                                "<": {},
                                "<=": {},
                                in: {},
                                "!in": {},
                                all: {},
                                any: {},
                                none: {},
                                has: {},
                                "!has": {},
                                within: {}
                            }
                        },
                        geometry_type: {
                            type: "enum",
                            values: {
                                Point: {},
                                LineString: {},
                                Polygon: {}
                            }
                        },
                        function: {
                            expression: {
                                type: "expression"
                            },
                            stops: {
                                type: "array",
                                value: "function_stop"
                            },
                            base: {
                                type: "number",
                                default: 1,
                                minimum: 0
                            },
                            property: {
                                type: "string",
                                default: "$zoom"
                            },
                            type: {
                                type: "enum",
                                values: {
                                    identity: {},
                                    exponential: {},
                                    interval: {},
                                    categorical: {}
                                },
                                default: "exponential"
                            },
                            colorSpace: {
                                type: "enum",
                                values: {
                                    rgb: {},
                                    lab: {},
                                    hcl: {}
                                },
                                default: "rgb"
                            },
                            default: {
                                type: "*",
                                required: !1
                            }
                        },
                        function_stop: {
                            type: "array",
                            minimum: 0,
                            maximum: 24,
                            value: ["number", "color"],
                            length: 2
                        },
                        expression: {
                            type: "array",
                            value: "*",
                            minimum: 1
                        },
                        light: {
                            anchor: {
                                type: "enum",
                                default: "viewport",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                "property-type": "data-constant",
                                transition: !1,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                }
                            },
                            position: {
                                type: "array",
                                default: [1.15, 210, 30],
                                length: 3,
                                value: "number",
                                "property-type": "data-constant",
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                }
                            },
                            color: {
                                type: "color",
                                "property-type": "data-constant",
                                default: "#ffffff",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                transition: !0
                            },
                            intensity: {
                                type: "number",
                                "property-type": "data-constant",
                                default: .5,
                                minimum: 0,
                                maximum: 1,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                transition: !0
                            }
                        },
                        paint: ["paint_fill", "paint_line", "paint_circle", "paint_heatmap", "paint_fill-extrusion", "paint_symbol", "paint_raster", "paint_hillshade", "paint_background"],
                        paint_fill: {
                            "fill-antialias": {
                                type: "boolean",
                                default: !0,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "fill-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "fill-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                requires: [{
                                    "!": "fill-pattern"
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "fill-outline-color": {
                                type: "color",
                                transition: !0,
                                requires: [{
                                    "!": "fill-pattern"
                                }, {
                                    "fill-antialias": !0
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "fill-translate": {
                                type: "array",
                                value: "number",
                                length: 2,
                                default: [0, 0],
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "fill-translate-anchor": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                default: "map",
                                requires: ["fill-translate"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "fill-pattern": {
                                type: "resolvedImage",
                                transition: !0,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "cross-faded-data-driven"
                            }
                        },
                        "paint_fill-extrusion": {
                            "fill-extrusion-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "fill-extrusion-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                requires: [{
                                    "!": "fill-extrusion-pattern"
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "fill-extrusion-translate": {
                                type: "array",
                                value: "number",
                                length: 2,
                                default: [0, 0],
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "fill-extrusion-translate-anchor": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                default: "map",
                                requires: ["fill-extrusion-translate"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "fill-extrusion-pattern": {
                                type: "resolvedImage",
                                transition: !0,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "cross-faded-data-driven"
                            },
                            "fill-extrusion-height": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                units: "meters",
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "fill-extrusion-base": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                units: "meters",
                                transition: !0,
                                requires: ["fill-extrusion-height"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "fill-extrusion-vertical-gradient": {
                                type: "boolean",
                                default: !0,
                                transition: !1,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            }
                        },
                        paint_line: {
                            "line-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "line-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                requires: [{
                                    "!": "line-pattern"
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "line-translate": {
                                type: "array",
                                value: "number",
                                length: 2,
                                default: [0, 0],
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "line-translate-anchor": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                default: "map",
                                requires: ["line-translate"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "line-width": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "line-gap-width": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "line-offset": {
                                type: "number",
                                default: 0,
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "line-blur": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "line-dasharray": {
                                type: "array",
                                value: "number",
                                minimum: 0,
                                transition: !0,
                                units: "line widths",
                                requires: [{
                                    "!": "line-pattern"
                                }],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "cross-faded"
                            },
                            "line-pattern": {
                                type: "resolvedImage",
                                transition: !0,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom", "feature"]
                                },
                                "property-type": "cross-faded-data-driven"
                            },
                            "line-gradient": {
                                type: "color",
                                transition: !1,
                                requires: [{
                                    "!": "line-dasharray"
                                }, {
                                    "!": "line-pattern"
                                }, {
                                    source: "geojson",
                                    has: {
                                        lineMetrics: !0
                                    }
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["line-progress"]
                                },
                                "property-type": "color-ramp"
                            }
                        },
                        paint_circle: {
                            "circle-radius": {
                                type: "number",
                                default: 5,
                                minimum: 0,
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "circle-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "circle-blur": {
                                type: "number",
                                default: 0,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "circle-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "circle-translate": {
                                type: "array",
                                value: "number",
                                length: 2,
                                default: [0, 0],
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "circle-translate-anchor": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                default: "map",
                                requires: ["circle-translate"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "circle-pitch-scale": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                default: "map",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "circle-pitch-alignment": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                default: "viewport",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "circle-stroke-width": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "circle-stroke-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "circle-stroke-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            }
                        },
                        paint_heatmap: {
                            "heatmap-radius": {
                                type: "number",
                                default: 30,
                                minimum: 1,
                                transition: !0,
                                units: "pixels",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "heatmap-weight": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                transition: !1,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "heatmap-intensity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "heatmap-color": {
                                type: "color",
                                default: ["interpolate", ["linear"], ["heatmap-density"], 0, "rgba(0, 0, 255, 0)", .1, "royalblue", .3, "cyan", .5, "lime", .7, "yellow", 1, "red"],
                                transition: !1,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["heatmap-density"]
                                },
                                "property-type": "color-ramp"
                            },
                            "heatmap-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            }
                        },
                        paint_symbol: {
                            "icon-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-halo-color": {
                                type: "color",
                                default: "rgba(0, 0, 0, 0)",
                                transition: !0,
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-halo-width": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                transition: !0,
                                units: "pixels",
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-halo-blur": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                transition: !0,
                                units: "pixels",
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "icon-translate": {
                                type: "array",
                                value: "number",
                                length: 2,
                                default: [0, 0],
                                transition: !0,
                                units: "pixels",
                                requires: ["icon-image"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "icon-translate-anchor": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                default: "map",
                                requires: ["icon-image", "icon-translate"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                overridable: !0,
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-halo-color": {
                                type: "color",
                                default: "rgba(0, 0, 0, 0)",
                                transition: !0,
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-halo-width": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                transition: !0,
                                units: "pixels",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-halo-blur": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                transition: !0,
                                units: "pixels",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom", "feature", "feature-state"]
                                },
                                "property-type": "data-driven"
                            },
                            "text-translate": {
                                type: "array",
                                value: "number",
                                length: 2,
                                default: [0, 0],
                                transition: !0,
                                units: "pixels",
                                requires: ["text-field"],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "text-translate-anchor": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                default: "map",
                                requires: ["text-field", "text-translate"],
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            }
                        },
                        paint_raster: {
                            "raster-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "raster-hue-rotate": {
                                type: "number",
                                default: 0,
                                period: 360,
                                transition: !0,
                                units: "degrees",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "raster-brightness-min": {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "raster-brightness-max": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "raster-saturation": {
                                type: "number",
                                default: 0,
                                minimum: -1,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "raster-contrast": {
                                type: "number",
                                default: 0,
                                minimum: -1,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "raster-resampling": {
                                type: "enum",
                                values: {
                                    linear: {},
                                    nearest: {}
                                },
                                default: "linear",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "raster-fade-duration": {
                                type: "number",
                                default: 300,
                                minimum: 0,
                                transition: !1,
                                units: "milliseconds",
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            }
                        },
                        paint_hillshade: {
                            "hillshade-illumination-direction": {
                                type: "number",
                                default: 335,
                                minimum: 0,
                                maximum: 359,
                                transition: !1,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "hillshade-illumination-anchor": {
                                type: "enum",
                                values: {
                                    map: {},
                                    viewport: {}
                                },
                                default: "viewport",
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "hillshade-exaggeration": {
                                type: "number",
                                default: .5,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "hillshade-shadow-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "hillshade-highlight-color": {
                                type: "color",
                                default: "#FFFFFF",
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "hillshade-accent-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            }
                        },
                        paint_background: {
                            "background-color": {
                                type: "color",
                                default: "#000000",
                                transition: !0,
                                requires: [{
                                    "!": "background-pattern"
                                }],
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            },
                            "background-pattern": {
                                type: "resolvedImage",
                                transition: !0,
                                expression: {
                                    interpolated: !1,
                                    parameters: ["zoom"]
                                },
                                "property-type": "cross-faded"
                            },
                            "background-opacity": {
                                type: "number",
                                default: 1,
                                minimum: 0,
                                maximum: 1,
                                transition: !0,
                                expression: {
                                    interpolated: !0,
                                    parameters: ["zoom"]
                                },
                                "property-type": "data-constant"
                            }
                        },
                        transition: {
                            duration: {
                                type: "number",
                                default: 300,
                                minimum: 0,
                                units: "milliseconds"
                            },
                            delay: {
                                type: "number",
                                default: 0,
                                minimum: 0,
                                units: "milliseconds"
                            }
                        },
                        "property-type": {
                            "data-driven": {
                                type: "property-type"
                            },
                            "cross-faded": {
                                type: "property-type"
                            },
                            "cross-faded-data-driven": {
                                type: "property-type"
                            },
                            "color-ramp": {
                                type: "property-type"
                            },
                            "data-constant": {
                                type: "property-type"
                            },
                            constant: {
                                type: "property-type"
                            }
                        },
                        promoteId: {
                            "*": {
                                type: "string"
                            }
                        }
                    }
                      , Le = function(e, t, i, r) {
                        this.message = (e ? e + ": " : "") + i,
                        r && (this.identifier = r),
                        null != t && t.__line__ && (this.line = t.__line__)
                    };
                    function Ie(e) {
                        var t = e.value;
                        return t ? [new Le(e.key,t,"constants have been deprecated as of v8")] : []
                    }
                    function ke(e) {
                        for (var t = [], i = arguments.length - 1; i-- > 0; )
                            t[i] = arguments[i + 1];
                        for (var r = 0, n = t; r < n.length; r += 1) {
                            var a = n[r];
                            for (var o in a)
                                e[o] = a[o]
                        }
                        return e
                    }
                    function ze(e) {
                        return e instanceof Number || e instanceof String || e instanceof Boolean ? e.valueOf() : e
                    }
                    function De(e) {
                        if (Array.isArray(e))
                            return e.map(De);
                        if (e instanceof Object && !(e instanceof Number || e instanceof String || e instanceof Boolean)) {
                            var t = {};
                            for (var i in e)
                                t[i] = De(e[i]);
                            return t
                        }
                        return ze(e)
                    }
                    var Re = function(e) {
                        function t(t, i) {
                            e.call(this, i),
                            this.message = i,
                            this.key = t
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t
                    }(Error)
                      , Oe = function(e, t) {
                        void 0 === t && (t = []),
                        this.parent = e,
                        this.bindings = {};
                        for (var i = 0, r = t; i < r.length; i += 1) {
                            var n = r[i];
                            this.bindings[n[0]] = n[1]
                        }
                    };
                    Oe.prototype.concat = function(e) {
                        return new Oe(this,e)
                    }
                    ,
                    Oe.prototype.get = function(e) {
                        if (this.bindings[e])
                            return this.bindings[e];
                        if (this.parent)
                            return this.parent.get(e);
                        throw new Error(e + " not found in scope.")
                    }
                    ,
                    Oe.prototype.has = function(e) {
                        return !!this.bindings[e] || !!this.parent && this.parent.has(e)
                    }
                    ;
                    var Be = {
                        kind: "null"
                    }
                      , Fe = {
                        kind: "number"
                    }
                      , Ne = {
                        kind: "string"
                    }
                      , Ue = {
                        kind: "boolean"
                    }
                      , Ve = {
                        kind: "color"
                    }
                      , Ge = {
                        kind: "object"
                    }
                      , je = {
                        kind: "value"
                    }
                      , He = {
                        kind: "collator"
                    }
                      , qe = {
                        kind: "formatted"
                    }
                      , We = {
                        kind: "resolvedImage"
                    };
                    function Ze(e, t) {
                        return {
                            kind: "array",
                            itemType: e,
                            N: t
                        }
                    }
                    function Xe(e) {
                        if ("array" === e.kind) {
                            var t = Xe(e.itemType);
                            return "number" == typeof e.N ? "array<" + t + ", " + e.N + ">" : "value" === e.itemType.kind ? "array" : "array<" + t + ">"
                        }
                        return e.kind
                    }
                    var Ye = [Be, Fe, Ne, Ue, Ve, qe, Ge, Ze(je), We];
                    function Ke(e, t) {
                        if ("error" === t.kind)
                            return null;
                        if ("array" === e.kind) {
                            if ("array" === t.kind && (0 === t.N && "value" === t.itemType.kind || !Ke(e.itemType, t.itemType)) && ("number" != typeof e.N || e.N === t.N))
                                return null
                        } else {
                            if (e.kind === t.kind)
                                return null;
                            if ("value" === e.kind)
                                for (var i = 0, r = Ye; i < r.length; i += 1)
                                    if (!Ke(r[i], t))
                                        return null
                        }
                        return "Expected " + Xe(e) + " but found " + Xe(t) + " instead."
                    }
                    function Je(e, t) {
                        return t.some((function(t) {
                            return t.kind === e.kind
                        }
                        ))
                    }
                    function Qe(e, t) {
                        return t.some((function(t) {
                            return "null" === t ? null === e : "array" === t ? Array.isArray(e) : "object" === t ? e && !Array.isArray(e) && "object" == typeof e : t === typeof e
                        }
                        ))
                    }
                    var $e = t((function(e, t) {
                        var i = {
                            transparent: [0, 0, 0, 0],
                            aliceblue: [240, 248, 255, 1],
                            antiquewhite: [250, 235, 215, 1],
                            aqua: [0, 255, 255, 1],
                            aquamarine: [127, 255, 212, 1],
                            azure: [240, 255, 255, 1],
                            beige: [245, 245, 220, 1],
                            bisque: [255, 228, 196, 1],
                            black: [0, 0, 0, 1],
                            blanchedalmond: [255, 235, 205, 1],
                            blue: [0, 0, 255, 1],
                            blueviolet: [138, 43, 226, 1],
                            brown: [165, 42, 42, 1],
                            burlywood: [222, 184, 135, 1],
                            cadetblue: [95, 158, 160, 1],
                            chartreuse: [127, 255, 0, 1],
                            chocolate: [210, 105, 30, 1],
                            coral: [255, 127, 80, 1],
                            cornflowerblue: [100, 149, 237, 1],
                            cornsilk: [255, 248, 220, 1],
                            crimson: [220, 20, 60, 1],
                            cyan: [0, 255, 255, 1],
                            darkblue: [0, 0, 139, 1],
                            darkcyan: [0, 139, 139, 1],
                            darkgoldenrod: [184, 134, 11, 1],
                            darkgray: [169, 169, 169, 1],
                            darkgreen: [0, 100, 0, 1],
                            darkgrey: [169, 169, 169, 1],
                            darkkhaki: [189, 183, 107, 1],
                            darkmagenta: [139, 0, 139, 1],
                            darkolivegreen: [85, 107, 47, 1],
                            darkorange: [255, 140, 0, 1],
                            darkorchid: [153, 50, 204, 1],
                            darkred: [139, 0, 0, 1],
                            darksalmon: [233, 150, 122, 1],
                            darkseagreen: [143, 188, 143, 1],
                            darkslateblue: [72, 61, 139, 1],
                            darkslategray: [47, 79, 79, 1],
                            darkslategrey: [47, 79, 79, 1],
                            darkturquoise: [0, 206, 209, 1],
                            darkviolet: [148, 0, 211, 1],
                            deeppink: [255, 20, 147, 1],
                            deepskyblue: [0, 191, 255, 1],
                            dimgray: [105, 105, 105, 1],
                            dimgrey: [105, 105, 105, 1],
                            dodgerblue: [30, 144, 255, 1],
                            firebrick: [178, 34, 34, 1],
                            floralwhite: [255, 250, 240, 1],
                            forestgreen: [34, 139, 34, 1],
                            fuchsia: [255, 0, 255, 1],
                            gainsboro: [220, 220, 220, 1],
                            ghostwhite: [248, 248, 255, 1],
                            gold: [255, 215, 0, 1],
                            goldenrod: [218, 165, 32, 1],
                            gray: [128, 128, 128, 1],
                            green: [0, 128, 0, 1],
                            greenyellow: [173, 255, 47, 1],
                            grey: [128, 128, 128, 1],
                            honeydew: [240, 255, 240, 1],
                            hotpink: [255, 105, 180, 1],
                            indianred: [205, 92, 92, 1],
                            indigo: [75, 0, 130, 1],
                            ivory: [255, 255, 240, 1],
                            khaki: [240, 230, 140, 1],
                            lavender: [230, 230, 250, 1],
                            lavenderblush: [255, 240, 245, 1],
                            lawngreen: [124, 252, 0, 1],
                            lemonchiffon: [255, 250, 205, 1],
                            lightblue: [173, 216, 230, 1],
                            lightcoral: [240, 128, 128, 1],
                            lightcyan: [224, 255, 255, 1],
                            lightgoldenrodyellow: [250, 250, 210, 1],
                            lightgray: [211, 211, 211, 1],
                            lightgreen: [144, 238, 144, 1],
                            lightgrey: [211, 211, 211, 1],
                            lightpink: [255, 182, 193, 1],
                            lightsalmon: [255, 160, 122, 1],
                            lightseagreen: [32, 178, 170, 1],
                            lightskyblue: [135, 206, 250, 1],
                            lightslategray: [119, 136, 153, 1],
                            lightslategrey: [119, 136, 153, 1],
                            lightsteelblue: [176, 196, 222, 1],
                            lightyellow: [255, 255, 224, 1],
                            lime: [0, 255, 0, 1],
                            limegreen: [50, 205, 50, 1],
                            linen: [250, 240, 230, 1],
                            magenta: [255, 0, 255, 1],
                            maroon: [128, 0, 0, 1],
                            mediumaquamarine: [102, 205, 170, 1],
                            mediumblue: [0, 0, 205, 1],
                            mediumorchid: [186, 85, 211, 1],
                            mediumpurple: [147, 112, 219, 1],
                            mediumseagreen: [60, 179, 113, 1],
                            mediumslateblue: [123, 104, 238, 1],
                            mediumspringgreen: [0, 250, 154, 1],
                            mediumturquoise: [72, 209, 204, 1],
                            mediumvioletred: [199, 21, 133, 1],
                            midnightblue: [25, 25, 112, 1],
                            mintcream: [245, 255, 250, 1],
                            mistyrose: [255, 228, 225, 1],
                            moccasin: [255, 228, 181, 1],
                            navajowhite: [255, 222, 173, 1],
                            navy: [0, 0, 128, 1],
                            oldlace: [253, 245, 230, 1],
                            olive: [128, 128, 0, 1],
                            olivedrab: [107, 142, 35, 1],
                            orange: [255, 165, 0, 1],
                            orangered: [255, 69, 0, 1],
                            orchid: [218, 112, 214, 1],
                            palegoldenrod: [238, 232, 170, 1],
                            palegreen: [152, 251, 152, 1],
                            paleturquoise: [175, 238, 238, 1],
                            palevioletred: [219, 112, 147, 1],
                            papayawhip: [255, 239, 213, 1],
                            peachpuff: [255, 218, 185, 1],
                            peru: [205, 133, 63, 1],
                            pink: [255, 192, 203, 1],
                            plum: [221, 160, 221, 1],
                            powderblue: [176, 224, 230, 1],
                            purple: [128, 0, 128, 1],
                            rebeccapurple: [102, 51, 153, 1],
                            red: [255, 0, 0, 1],
                            rosybrown: [188, 143, 143, 1],
                            royalblue: [65, 105, 225, 1],
                            saddlebrown: [139, 69, 19, 1],
                            salmon: [250, 128, 114, 1],
                            sandybrown: [244, 164, 96, 1],
                            seagreen: [46, 139, 87, 1],
                            seashell: [255, 245, 238, 1],
                            sienna: [160, 82, 45, 1],
                            silver: [192, 192, 192, 1],
                            skyblue: [135, 206, 235, 1],
                            slateblue: [106, 90, 205, 1],
                            slategray: [112, 128, 144, 1],
                            slategrey: [112, 128, 144, 1],
                            snow: [255, 250, 250, 1],
                            springgreen: [0, 255, 127, 1],
                            steelblue: [70, 130, 180, 1],
                            tan: [210, 180, 140, 1],
                            teal: [0, 128, 128, 1],
                            thistle: [216, 191, 216, 1],
                            tomato: [255, 99, 71, 1],
                            turquoise: [64, 224, 208, 1],
                            violet: [238, 130, 238, 1],
                            wheat: [245, 222, 179, 1],
                            white: [255, 255, 255, 1],
                            whitesmoke: [245, 245, 245, 1],
                            yellow: [255, 255, 0, 1],
                            yellowgreen: [154, 205, 50, 1]
                        };
                        function r(e) {
                            return (e = Math.round(e)) < 0 ? 0 : e > 255 ? 255 : e
                        }
                        function n(e) {
                            return r("%" === e[e.length - 1] ? parseFloat(e) / 100 * 255 : parseInt(e))
                        }
                        function a(e) {
                            return (t = "%" === e[e.length - 1] ? parseFloat(e) / 100 : parseFloat(e)) < 0 ? 0 : t > 1 ? 1 : t;
                            var t
                        }
                        function o(e, t, i) {
                            return i < 0 ? i += 1 : i > 1 && (i -= 1),
                            6 * i < 1 ? e + (t - e) * i * 6 : 2 * i < 1 ? t : 3 * i < 2 ? e + (t - e) * (2 / 3 - i) * 6 : e
                        }
                        try {
                            t.parseCSSColor = function(e) {
                                var t, s = e.replace(/ /g, "").toLowerCase();
                                if (s in i)
                                    return i[s].slice();
                                if ("#" === s[0])
                                    return 4 === s.length ? (t = parseInt(s.substr(1), 16)) >= 0 && t <= 4095 ? [(3840 & t) >> 4 | (3840 & t) >> 8, 240 & t | (240 & t) >> 4, 15 & t | (15 & t) << 4, 1] : null : 7 === s.length && (t = parseInt(s.substr(1), 16)) >= 0 && t <= 16777215 ? [(16711680 & t) >> 16, (65280 & t) >> 8, 255 & t, 1] : null;
                                var l = s.indexOf("(")
                                  , u = s.indexOf(")");
                                if (-1 !== l && u + 1 === s.length) {
                                    var c = s.substr(0, l)
                                      , h = s.substr(l + 1, u - (l + 1)).split(",")
                                      , p = 1;
                                    switch (c) {
                                    case "rgba":
                                        if (4 !== h.length)
                                            return null;
                                        p = a(h.pop());
                                    case "rgb":
                                        return 3 !== h.length ? null : [n(h[0]), n(h[1]), n(h[2]), p];
                                    case "hsla":
                                        if (4 !== h.length)
                                            return null;
                                        p = a(h.pop());
                                    case "hsl":
                                        if (3 !== h.length)
                                            return null;
                                        var f = (parseFloat(h[0]) % 360 + 360) % 360 / 360
                                          , d = a(h[1])
                                          , m = a(h[2])
                                          , v = m <= .5 ? m * (d + 1) : m + d - m * d
                                          , g = 2 * m - v;
                                        return [r(255 * o(g, v, f + 1 / 3)), r(255 * o(g, v, f)), r(255 * o(g, v, f - 1 / 3)), p];
                                    default:
                                        return null
                                    }
                                }
                                return null
                            }
                        } catch (e) {}
                    }
                    )).parseCSSColor
                      , et = function(e, t, i, r) {
                        void 0 === r && (r = 1),
                        this.r = e,
                        this.g = t,
                        this.b = i,
                        this.a = r
                    };
                    et.parse = function(e) {
                        if (e) {
                            if (e instanceof et)
                                return e;
                            if ("string" == typeof e) {
                                var t = $e(e);
                                if (t)
                                    return new et(t[0] / 255 * t[3],t[1] / 255 * t[3],t[2] / 255 * t[3],t[3])
                            }
                        }
                    }
                    ,
                    et.prototype.toString = function() {
                        var e = this.toArray()
                          , t = e[1]
                          , i = e[2]
                          , r = e[3];
                        return "rgba(" + Math.round(e[0]) + "," + Math.round(t) + "," + Math.round(i) + "," + r + ")"
                    }
                    ,
                    et.prototype.toArray = function() {
                        var e = this.a;
                        return 0 === e ? [0, 0, 0, 0] : [255 * this.r / e, 255 * this.g / e, 255 * this.b / e, e]
                    }
                    ,
                    et.black = new et(0,0,0,1),
                    et.white = new et(1,1,1,1),
                    et.transparent = new et(0,0,0,0),
                    et.red = new et(1,0,0,1);
                    var tt = function(e, t, i) {
                        this.sensitivity = e ? t ? "variant" : "case" : t ? "accent" : "base",
                        this.locale = i,
                        this.collator = new Intl.Collator(this.locale ? this.locale : [],{
                            sensitivity: this.sensitivity,
                            usage: "search"
                        })
                    };
                    tt.prototype.compare = function(e, t) {
                        return this.collator.compare(e, t)
                    }
                    ,
                    tt.prototype.resolvedLocale = function() {
                        return new Intl.Collator(this.locale ? this.locale : []).resolvedOptions().locale
                    }
                    ;
                    var it = function(e, t, i, r, n) {
                        this.text = e,
                        this.image = t,
                        this.scale = i,
                        this.fontStack = r,
                        this.textColor = n
                    }
                      , rt = function(e) {
                        this.sections = e
                    };
                    rt.fromString = function(e) {
                        return new rt([new it(e,null,null,null,null)])
                    }
                    ,
                    rt.prototype.isEmpty = function() {
                        return 0 === this.sections.length || !this.sections.some((function(e) {
                            return 0 !== e.text.length || e.image && 0 !== e.image.name.length
                        }
                        ))
                    }
                    ,
                    rt.factory = function(e) {
                        return e instanceof rt ? e : rt.fromString(e)
                    }
                    ,
                    rt.prototype.toString = function() {
                        return 0 === this.sections.length ? "" : this.sections.map((function(e) {
                            return e.text
                        }
                        )).join("")
                    }
                    ,
                    rt.prototype.serialize = function() {
                        for (var e = ["format"], t = 0, i = this.sections; t < i.length; t += 1) {
                            var r = i[t];
                            if (r.image)
                                e.push(["image", r.image.name]);
                            else {
                                e.push(r.text);
                                var n = {};
                                r.fontStack && (n["text-font"] = ["literal", r.fontStack.split(",")]),
                                r.scale && (n["font-scale"] = r.scale),
                                r.textColor && (n["text-color"] = ["rgba"].concat(r.textColor.toArray())),
                                e.push(n)
                            }
                        }
                        return e
                    }
                    ;
                    var nt = function(e) {
                        this.name = e.name,
                        this.available = e.available
                    };
                    function at(e, t, i, r) {
                        return "number" == typeof e && e >= 0 && e <= 255 && "number" == typeof t && t >= 0 && t <= 255 && "number" == typeof i && i >= 0 && i <= 255 ? void 0 === r || "number" == typeof r && r >= 0 && r <= 1 ? null : "Invalid rgba value [" + [e, t, i, r].join(", ") + "]: 'a' must be between 0 and 1." : "Invalid rgba value [" + ("number" == typeof r ? [e, t, i, r] : [e, t, i]).join(", ") + "]: 'r', 'g', and 'b' must be between 0 and 255."
                    }
                    function ot(e) {
                        if (null === e)
                            return !0;
                        if ("string" == typeof e)
                            return !0;
                        if ("boolean" == typeof e)
                            return !0;
                        if ("number" == typeof e)
                            return !0;
                        if (e instanceof et)
                            return !0;
                        if (e instanceof tt)
                            return !0;
                        if (e instanceof rt)
                            return !0;
                        if (e instanceof nt)
                            return !0;
                        if (Array.isArray(e)) {
                            for (var t = 0, i = e; t < i.length; t += 1)
                                if (!ot(i[t]))
                                    return !1;
                            return !0
                        }
                        if ("object" == typeof e) {
                            for (var r in e)
                                if (!ot(e[r]))
                                    return !1;
                            return !0
                        }
                        return !1
                    }
                    function st(e) {
                        if (null === e)
                            return Be;
                        if ("string" == typeof e)
                            return Ne;
                        if ("boolean" == typeof e)
                            return Ue;
                        if ("number" == typeof e)
                            return Fe;
                        if (e instanceof et)
                            return Ve;
                        if (e instanceof tt)
                            return He;
                        if (e instanceof rt)
                            return qe;
                        if (e instanceof nt)
                            return We;
                        if (Array.isArray(e)) {
                            for (var t, i = e.length, r = 0, n = e; r < n.length; r += 1) {
                                var a = st(n[r]);
                                if (t) {
                                    if (t === a)
                                        continue;
                                    t = je;
                                    break
                                }
                                t = a
                            }
                            return Ze(t || je, i)
                        }
                        return Ge
                    }
                    function lt(e) {
                        var t = typeof e;
                        return null === e ? "" : "string" === t || "number" === t || "boolean" === t ? String(e) : e instanceof et || e instanceof rt || e instanceof nt ? e.toString() : JSON.stringify(e)
                    }
                    nt.prototype.toString = function() {
                        return this.name
                    }
                    ,
                    nt.fromString = function(e) {
                        return e ? new nt({
                            name: e,
                            available: !1
                        }) : null
                    }
                    ,
                    nt.prototype.serialize = function() {
                        return ["image", this.name]
                    }
                    ;
                    var ut = function(e, t) {
                        this.type = e,
                        this.value = t
                    };
                    ut.parse = function(e, t) {
                        if (2 !== e.length)
                            return t.error("'literal' expression requires exactly one argument, but found " + (e.length - 1) + " instead.");
                        if (!ot(e[1]))
                            return t.error("invalid value");
                        var i = e[1]
                          , r = st(i)
                          , n = t.expectedType;
                        return "array" !== r.kind || 0 !== r.N || !n || "array" !== n.kind || "number" == typeof n.N && 0 !== n.N || (r = n),
                        new ut(r,i)
                    }
                    ,
                    ut.prototype.evaluate = function() {
                        return this.value
                    }
                    ,
                    ut.prototype.eachChild = function() {}
                    ,
                    ut.prototype.outputDefined = function() {
                        return !0
                    }
                    ,
                    ut.prototype.serialize = function() {
                        return "array" === this.type.kind || "object" === this.type.kind ? ["literal", this.value] : this.value instanceof et ? ["rgba"].concat(this.value.toArray()) : this.value instanceof rt ? this.value.serialize() : this.value
                    }
                    ;
                    var ct = function(e) {
                        this.name = "ExpressionEvaluationError",
                        this.message = e
                    };
                    ct.prototype.toJSON = function() {
                        return this.message
                    }
                    ;
                    var ht = {
                        string: Ne,
                        number: Fe,
                        boolean: Ue,
                        object: Ge
                    }
                      , pt = function(e, t) {
                        this.type = e,
                        this.args = t
                    };
                    pt.parse = function(e, t) {
                        if (e.length < 2)
                            return t.error("Expected at least one argument.");
                        var i, r = 1, n = e[0];
                        if ("array" === n) {
                            var a, o;
                            if (e.length > 2) {
                                var s = e[1];
                                if ("string" != typeof s || !(s in ht) || "object" === s)
                                    return t.error('The item type argument of "array" must be one of string, number, boolean', 1);
                                a = ht[s],
                                r++
                            } else
                                a = je;
                            if (e.length > 3) {
                                if (null !== e[2] && ("number" != typeof e[2] || e[2] < 0 || e[2] !== Math.floor(e[2])))
                                    return t.error('The length argument to "array" must be a positive integer literal', 2);
                                o = e[2],
                                r++
                            }
                            i = Ze(a, o)
                        } else
                            i = ht[n];
                        for (var l = []; r < e.length; r++) {
                            var u = t.parse(e[r], r, je);
                            if (!u)
                                return null;
                            l.push(u)
                        }
                        return new pt(i,l)
                    }
                    ,
                    pt.prototype.evaluate = function(e) {
                        for (var t = 0; t < this.args.length; t++) {
                            var i = this.args[t].evaluate(e);
                            if (!Ke(this.type, st(i)))
                                return i;
                            if (t === this.args.length - 1)
                                throw new ct("Expected value to be of type " + Xe(this.type) + ", but found " + Xe(st(i)) + " instead.")
                        }
                        return null
                    }
                    ,
                    pt.prototype.eachChild = function(e) {
                        this.args.forEach(e)
                    }
                    ,
                    pt.prototype.outputDefined = function() {
                        return this.args.every((function(e) {
                            return e.outputDefined()
                        }
                        ))
                    }
                    ,
                    pt.prototype.serialize = function() {
                        var e = this.type
                          , t = [e.kind];
                        if ("array" === e.kind) {
                            var i = e.itemType;
                            if ("string" === i.kind || "number" === i.kind || "boolean" === i.kind) {
                                t.push(i.kind);
                                var r = e.N;
                                ("number" == typeof r || this.args.length > 1) && t.push(r)
                            }
                        }
                        return t.concat(this.args.map((function(e) {
                            return e.serialize()
                        }
                        )))
                    }
                    ;
                    var ft = function(e) {
                        this.type = qe,
                        this.sections = e
                    };
                    ft.parse = function(e, t) {
                        if (e.length < 2)
                            return t.error("Expected at least one argument.");
                        var i = e[1];
                        if (!Array.isArray(i) && "object" == typeof i)
                            return t.error("First argument must be an image or text section.");
                        for (var r = [], n = !1, a = 1; a <= e.length - 1; ++a) {
                            var o = e[a];
                            if (n && "object" == typeof o && !Array.isArray(o)) {
                                n = !1;
                                var s = null;
                                if (o["font-scale"] && !(s = t.parse(o["font-scale"], 1, Fe)))
                                    return null;
                                var l = null;
                                if (o["text-font"] && !(l = t.parse(o["text-font"], 1, Ze(Ne))))
                                    return null;
                                var u = null;
                                if (o["text-color"] && !(u = t.parse(o["text-color"], 1, Ve)))
                                    return null;
                                var c = r[r.length - 1];
                                c.scale = s,
                                c.font = l,
                                c.textColor = u
                            } else {
                                var h = t.parse(e[a], 1, je);
                                if (!h)
                                    return null;
                                var p = h.type.kind;
                                if ("string" !== p && "value" !== p && "null" !== p && "resolvedImage" !== p)
                                    return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");
                                n = !0,
                                r.push({
                                    content: h,
                                    scale: null,
                                    font: null,
                                    textColor: null
                                })
                            }
                        }
                        return new ft(r)
                    }
                    ,
                    ft.prototype.evaluate = function(e) {
                        return new rt(this.sections.map((function(t) {
                            var i = t.content.evaluate(e);
                            return st(i) === We ? new it("",i,null,null,null) : new it(lt(i),null,t.scale ? t.scale.evaluate(e) : null,t.font ? t.font.evaluate(e).join(",") : null,t.textColor ? t.textColor.evaluate(e) : null)
                        }
                        )))
                    }
                    ,
                    ft.prototype.eachChild = function(e) {
                        for (var t = 0, i = this.sections; t < i.length; t += 1) {
                            var r = i[t];
                            e(r.content),
                            r.scale && e(r.scale),
                            r.font && e(r.font),
                            r.textColor && e(r.textColor)
                        }
                    }
                    ,
                    ft.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    ft.prototype.serialize = function() {
                        for (var e = ["format"], t = 0, i = this.sections; t < i.length; t += 1) {
                            var r = i[t];
                            e.push(r.content.serialize());
                            var n = {};
                            r.scale && (n["font-scale"] = r.scale.serialize()),
                            r.font && (n["text-font"] = r.font.serialize()),
                            r.textColor && (n["text-color"] = r.textColor.serialize()),
                            e.push(n)
                        }
                        return e
                    }
                    ;
                    var dt = function(e) {
                        this.type = We,
                        this.input = e
                    };
                    dt.parse = function(e, t) {
                        if (2 !== e.length)
                            return t.error("Expected two arguments.");
                        var i = t.parse(e[1], 1, Ne);
                        return i ? new dt(i) : t.error("No image name provided.")
                    }
                    ,
                    dt.prototype.evaluate = function(e) {
                        var t = this.input.evaluate(e)
                          , i = nt.fromString(t);
                        return i && e.availableImages && (i.available = e.availableImages.indexOf(t) > -1),
                        i
                    }
                    ,
                    dt.prototype.eachChild = function(e) {
                        e(this.input)
                    }
                    ,
                    dt.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    dt.prototype.serialize = function() {
                        return ["image", this.input.serialize()]
                    }
                    ;
                    var mt = {
                        "to-boolean": Ue,
                        "to-color": Ve,
                        "to-number": Fe,
                        "to-string": Ne
                    }
                      , vt = function(e, t) {
                        this.type = e,
                        this.args = t
                    };
                    vt.parse = function(e, t) {
                        if (e.length < 2)
                            return t.error("Expected at least one argument.");
                        var i = e[0];
                        if (("to-boolean" === i || "to-string" === i) && 2 !== e.length)
                            return t.error("Expected one argument.");
                        for (var r = mt[i], n = [], a = 1; a < e.length; a++) {
                            var o = t.parse(e[a], a, je);
                            if (!o)
                                return null;
                            n.push(o)
                        }
                        return new vt(r,n)
                    }
                    ,
                    vt.prototype.evaluate = function(e) {
                        if ("boolean" === this.type.kind)
                            return Boolean(this.args[0].evaluate(e));
                        if ("color" === this.type.kind) {
                            for (var t, i, r = 0, n = this.args; r < n.length; r += 1) {
                                if (i = null,
                                (t = n[r].evaluate(e))instanceof et)
                                    return t;
                                if ("string" == typeof t) {
                                    var a = e.parseColor(t);
                                    if (a)
                                        return a
                                } else if (Array.isArray(t) && !(i = t.length < 3 || t.length > 4 ? "Invalid rbga value " + JSON.stringify(t) + ": expected an array containing either three or four numeric values." : at(t[0], t[1], t[2], t[3])))
                                    return new et(t[0] / 255,t[1] / 255,t[2] / 255,t[3])
                            }
                            throw new ct(i || "Could not parse color from value '" + ("string" == typeof t ? t : String(JSON.stringify(t))) + "'")
                        }
                        if ("number" === this.type.kind) {
                            for (var o = null, s = 0, l = this.args; s < l.length; s += 1) {
                                if (null === (o = l[s].evaluate(e)))
                                    return 0;
                                var u = Number(o);
                                if (!isNaN(u))
                                    return u
                            }
                            throw new ct("Could not convert " + JSON.stringify(o) + " to number.")
                        }
                        return "formatted" === this.type.kind ? rt.fromString(lt(this.args[0].evaluate(e))) : "resolvedImage" === this.type.kind ? nt.fromString(lt(this.args[0].evaluate(e))) : lt(this.args[0].evaluate(e))
                    }
                    ,
                    vt.prototype.eachChild = function(e) {
                        this.args.forEach(e)
                    }
                    ,
                    vt.prototype.outputDefined = function() {
                        return this.args.every((function(e) {
                            return e.outputDefined()
                        }
                        ))
                    }
                    ,
                    vt.prototype.serialize = function() {
                        if ("formatted" === this.type.kind)
                            return new ft([{
                                content: this.args[0],
                                scale: null,
                                font: null,
                                textColor: null
                            }]).serialize();
                        if ("resolvedImage" === this.type.kind)
                            return new dt(this.args[0]).serialize();
                        var e = ["to-" + this.type.kind];
                        return this.eachChild((function(t) {
                            e.push(t.serialize())
                        }
                        )),
                        e
                    }
                    ;
                    var gt = ["Unknown", "Point", "LineString", "Polygon"]
                      , yt = function() {
                        this.globals = null,
                        this.feature = null,
                        this.featureState = null,
                        this.formattedSection = null,
                        this._parseColorCache = {},
                        this.availableImages = null,
                        this.canonical = null
                    };
                    yt.prototype.id = function() {
                        return this.feature && "id"in this.feature ? this.feature.id : null
                    }
                    ,
                    yt.prototype.geometryType = function() {
                        return this.feature ? "number" == typeof this.feature.type ? gt[this.feature.type] : this.feature.type : null
                    }
                    ,
                    yt.prototype.geometry = function() {
                        return this.feature && "geometry"in this.feature ? this.feature.geometry : null
                    }
                    ,
                    yt.prototype.canonicalID = function() {
                        return this.canonical
                    }
                    ,
                    yt.prototype.properties = function() {
                        return this.feature && this.feature.properties || {}
                    }
                    ,
                    yt.prototype.parseColor = function(e) {
                        var t = this._parseColorCache[e];
                        return t || (t = this._parseColorCache[e] = et.parse(e)),
                        t
                    }
                    ;
                    var _t = function(e, t, i, r) {
                        this.name = e,
                        this.type = t,
                        this._evaluate = i,
                        this.args = r
                    };
                    _t.prototype.evaluate = function(e) {
                        return this._evaluate(e, this.args)
                    }
                    ,
                    _t.prototype.eachChild = function(e) {
                        this.args.forEach(e)
                    }
                    ,
                    _t.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    _t.prototype.serialize = function() {
                        return [this.name].concat(this.args.map((function(e) {
                            return e.serialize()
                        }
                        )))
                    }
                    ,
                    _t.parse = function(e, t) {
                        var i, r = e[0], n = _t.definitions[r];
                        if (!n)
                            return t.error('Unknown expression "' + r + '". If you wanted a literal array, use ["literal", [...]].', 0);
                        for (var a = Array.isArray(n) ? n[0] : n.type, o = Array.isArray(n) ? [[n[1], n[2]]] : n.overloads, s = o.filter((function(t) {
                            var i = t[0];
                            return !Array.isArray(i) || i.length === e.length - 1
                        }
                        )), l = null, u = 0, c = s; u < c.length; u += 1) {
                            var h = c[u]
                              , p = h[0]
                              , f = h[1];
                            l = new Vt(t.registry,t.path,null,t.scope);
                            for (var d = [], m = !1, v = 1; v < e.length; v++) {
                                var g = e[v]
                                  , y = Array.isArray(p) ? p[v - 1] : p.type
                                  , _ = l.parse(g, 1 + d.length, y);
                                if (!_) {
                                    m = !0;
                                    break
                                }
                                d.push(_)
                            }
                            if (!m)
                                if (Array.isArray(p) && p.length !== d.length)
                                    l.error("Expected " + p.length + " arguments, but found " + d.length + " instead.");
                                else {
                                    for (var x = 0; x < d.length; x++) {
                                        var b = Array.isArray(p) ? p[x] : p.type
                                          , w = d[x];
                                        l.concat(x + 1).checkSubtype(b, w.type)
                                    }
                                    if (0 === l.errors.length)
                                        return new _t(r,a,f,d)
                                }
                        }
                        if (1 === s.length)
                            (i = t.errors).push.apply(i, l.errors);
                        else {
                            for (var S = (s.length ? s : o).map((function(e) {
                                var t;
                                return t = e[0],
                                Array.isArray(t) ? "(" + t.map(Xe).join(", ") + ")" : "(" + Xe(t.type) + "...)"
                            }
                            )).join(" | "), M = [], T = 1; T < e.length; T++) {
                                var E = t.parse(e[T], 1 + M.length);
                                if (!E)
                                    return null;
                                M.push(Xe(E.type))
                            }
                            t.error("Expected arguments of type " + S + ", but found (" + M.join(", ") + ") instead.")
                        }
                        return null
                    }
                    ,
                    _t.register = function(e, t) {
                        for (var i in _t.definitions = t,
                        t)
                            e[i] = _t
                    }
                    ;
                    var xt = function(e, t, i) {
                        this.type = He,
                        this.locale = i,
                        this.caseSensitive = e,
                        this.diacriticSensitive = t
                    };
                    function bt(e, t) {
                        e[0] = Math.min(e[0], t[0]),
                        e[1] = Math.min(e[1], t[1]),
                        e[2] = Math.max(e[2], t[0]),
                        e[3] = Math.max(e[3], t[1])
                    }
                    function wt(e, t) {
                        return !(e[0] <= t[0] || e[2] >= t[2] || e[1] <= t[1] || e[3] >= t[3])
                    }
                    function St(e, t) {
                        var i = (180 + e[0]) / 360
                          , r = (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + e[1] * Math.PI / 360))) / 360
                          , n = Math.pow(2, t.z);
                        return [Math.round(i * n * 8192), Math.round(r * n * 8192)]
                    }
                    function Mt(e, t, i) {
                        return t[1] > e[1] != i[1] > e[1] && e[0] < (i[0] - t[0]) * (e[1] - t[1]) / (i[1] - t[1]) + t[0]
                    }
                    function Tt(e, t) {
                        for (var i, r, n, a, o, s, l, u = !1, c = 0, h = t.length; c < h; c++)
                            for (var p = t[c], f = 0, d = p.length; f < d - 1; f++) {
                                if ((a = (i = e)[0] - (r = p[f])[0]) * (l = i[1] - (n = p[f + 1])[1]) - (s = i[0] - n[0]) * (o = i[1] - r[1]) == 0 && a * s <= 0 && o * l <= 0)
                                    return !1;
                                Mt(e, p[f], p[f + 1]) && (u = !u)
                            }
                        return u
                    }
                    function Et(e, t) {
                        for (var i = 0; i < t.length; i++)
                            if (Tt(e, t[i]))
                                return !0;
                        return !1
                    }
                    function At(e, t, i, r) {
                        var n = r[0] - i[0]
                          , a = r[1] - i[1]
                          , o = (e[0] - i[0]) * a - n * (e[1] - i[1])
                          , s = (t[0] - i[0]) * a - n * (t[1] - i[1]);
                        return o > 0 && s < 0 || o < 0 && s > 0
                    }
                    function Pt(e, t, i) {
                        for (var r = 0, n = i; r < n.length; r += 1)
                            for (var a = n[r], o = 0; o < a.length - 1; ++o)
                                if (0 != (h = [(c = a[o + 1])[0] - (u = a[o])[0], c[1] - u[1]])[0] * (p = [(l = t)[0] - (s = e)[0], l[1] - s[1]])[1] - h[1] * p[0] && At(s, l, u, c) && At(u, c, s, l))
                                    return !0;
                        var s, l, u, c, h, p;
                        return !1
                    }
                    function Ct(e, t) {
                        for (var i = 0; i < e.length; ++i)
                            if (!Tt(e[i], t))
                                return !1;
                        for (var r = 0; r < e.length - 1; ++r)
                            if (Pt(e[r], e[r + 1], t))
                                return !1;
                        return !0
                    }
                    function Lt(e, t) {
                        for (var i = 0; i < t.length; i++)
                            if (Ct(e, t[i]))
                                return !0;
                        return !1
                    }
                    function It(e, t, i) {
                        for (var r = [], n = 0; n < e.length; n++) {
                            for (var a = [], o = 0; o < e[n].length; o++) {
                                var s = St(e[n][o], i);
                                bt(t, s),
                                a.push(s)
                            }
                            r.push(a)
                        }
                        return r
                    }
                    function kt(e, t, i) {
                        for (var r = [], n = 0; n < e.length; n++) {
                            var a = It(e[n], t, i);
                            r.push(a)
                        }
                        return r
                    }
                    function zt(e, t, i, r) {
                        if (e[0] < i[0] || e[0] > i[2]) {
                            var n = .5 * r
                              , a = e[0] - i[0] > n ? -r : i[0] - e[0] > n ? r : 0;
                            0 === a && (a = e[0] - i[2] > n ? -r : i[2] - e[0] > n ? r : 0),
                            e[0] += a
                        }
                        bt(t, e)
                    }
                    function Dt(e, t, i, r) {
                        for (var n = 8192 * Math.pow(2, r.z), a = [8192 * r.x, 8192 * r.y], o = [], s = 0, l = e; s < l.length; s += 1)
                            for (var u = 0, c = l[s]; u < c.length; u += 1) {
                                var h = c[u]
                                  , p = [h.x + a[0], h.y + a[1]];
                                zt(p, t, i, n),
                                o.push(p)
                            }
                        return o
                    }
                    function Rt(e, t, i, r) {
                        for (var n, a = 8192 * Math.pow(2, r.z), o = [8192 * r.x, 8192 * r.y], s = [], l = 0, u = e; l < u.length; l += 1) {
                            for (var c = [], h = 0, p = u[l]; h < p.length; h += 1) {
                                var f = p[h]
                                  , d = [f.x + o[0], f.y + o[1]];
                                bt(t, d),
                                c.push(d)
                            }
                            s.push(c)
                        }
                        if (t[2] - t[0] <= a / 2) {
                            (n = t)[0] = n[1] = 1 / 0,
                            n[2] = n[3] = -1 / 0;
                            for (var m = 0, v = s; m < v.length; m += 1)
                                for (var g = 0, y = v[m]; g < y.length; g += 1)
                                    zt(y[g], t, i, a)
                        }
                        return s
                    }
                    xt.parse = function(e, t) {
                        if (2 !== e.length)
                            return t.error("Expected one argument.");
                        var i = e[1];
                        if ("object" != typeof i || Array.isArray(i))
                            return t.error("Collator options argument must be an object.");
                        var r = t.parse(void 0 !== i["case-sensitive"] && i["case-sensitive"], 1, Ue);
                        if (!r)
                            return null;
                        var n = t.parse(void 0 !== i["diacritic-sensitive"] && i["diacritic-sensitive"], 1, Ue);
                        if (!n)
                            return null;
                        var a = null;
                        return i.locale && !(a = t.parse(i.locale, 1, Ne)) ? null : new xt(r,n,a)
                    }
                    ,
                    xt.prototype.evaluate = function(e) {
                        return new tt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale ? this.locale.evaluate(e) : null)
                    }
                    ,
                    xt.prototype.eachChild = function(e) {
                        e(this.caseSensitive),
                        e(this.diacriticSensitive),
                        this.locale && e(this.locale)
                    }
                    ,
                    xt.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    xt.prototype.serialize = function() {
                        var e = {};
                        return e["case-sensitive"] = this.caseSensitive.serialize(),
                        e["diacritic-sensitive"] = this.diacriticSensitive.serialize(),
                        this.locale && (e.locale = this.locale.serialize()),
                        ["collator", e]
                    }
                    ;
                    var Ot = function(e, t) {
                        this.type = Ue,
                        this.geojson = e,
                        this.geometries = t
                    };
                    function Bt(e) {
                        if (e instanceof _t) {
                            if ("get" === e.name && 1 === e.args.length)
                                return !1;
                            if ("feature-state" === e.name)
                                return !1;
                            if ("has" === e.name && 1 === e.args.length)
                                return !1;
                            if ("properties" === e.name || "geometry-type" === e.name || "id" === e.name)
                                return !1;
                            if (/^filter-/.test(e.name))
                                return !1
                        }
                        if (e instanceof Ot)
                            return !1;
                        var t = !0;
                        return e.eachChild((function(e) {
                            t && !Bt(e) && (t = !1)
                        }
                        )),
                        t
                    }
                    function Ft(e) {
                        if (e instanceof _t && "feature-state" === e.name)
                            return !1;
                        var t = !0;
                        return e.eachChild((function(e) {
                            t && !Ft(e) && (t = !1)
                        }
                        )),
                        t
                    }
                    function Nt(e, t) {
                        if (e instanceof _t && t.indexOf(e.name) >= 0)
                            return !1;
                        var i = !0;
                        return e.eachChild((function(e) {
                            i && !Nt(e, t) && (i = !1)
                        }
                        )),
                        i
                    }
                    Ot.parse = function(e, t) {
                        if (2 !== e.length)
                            return t.error("'within' expression requires exactly one argument, but found " + (e.length - 1) + " instead.");
                        if (ot(e[1])) {
                            var i = e[1];
                            if ("FeatureCollection" === i.type)
                                for (var r = 0; r < i.features.length; ++r) {
                                    var n = i.features[r].geometry.type;
                                    if ("Polygon" === n || "MultiPolygon" === n)
                                        return new Ot(i,i.features[r].geometry)
                                }
                            else if ("Feature" === i.type) {
                                var a = i.geometry.type;
                                if ("Polygon" === a || "MultiPolygon" === a)
                                    return new Ot(i,i.geometry)
                            } else if ("Polygon" === i.type || "MultiPolygon" === i.type)
                                return new Ot(i,i)
                        }
                        return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")
                    }
                    ,
                    Ot.prototype.evaluate = function(e) {
                        if (null != e.geometry() && null != e.canonicalID()) {
                            if ("Point" === e.geometryType())
                                return function(e, t) {
                                    var i = [1 / 0, 1 / 0, -1 / 0, -1 / 0]
                                      , r = [1 / 0, 1 / 0, -1 / 0, -1 / 0]
                                      , n = e.canonicalID();
                                    if ("Polygon" === t.type) {
                                        var a = It(t.coordinates, r, n)
                                          , o = Dt(e.geometry(), i, r, n);
                                        if (!wt(i, r))
                                            return !1;
                                        for (var s = 0, l = o; s < l.length; s += 1)
                                            if (!Tt(l[s], a))
                                                return !1
                                    }
                                    if ("MultiPolygon" === t.type) {
                                        var u = kt(t.coordinates, r, n)
                                          , c = Dt(e.geometry(), i, r, n);
                                        if (!wt(i, r))
                                            return !1;
                                        for (var h = 0, p = c; h < p.length; h += 1)
                                            if (!Et(p[h], u))
                                                return !1
                                    }
                                    return !0
                                }(e, this.geometries);
                            if ("LineString" === e.geometryType())
                                return function(e, t) {
                                    var i = [1 / 0, 1 / 0, -1 / 0, -1 / 0]
                                      , r = [1 / 0, 1 / 0, -1 / 0, -1 / 0]
                                      , n = e.canonicalID();
                                    if ("Polygon" === t.type) {
                                        var a = It(t.coordinates, r, n)
                                          , o = Rt(e.geometry(), i, r, n);
                                        if (!wt(i, r))
                                            return !1;
                                        for (var s = 0, l = o; s < l.length; s += 1)
                                            if (!Ct(l[s], a))
                                                return !1
                                    }
                                    if ("MultiPolygon" === t.type) {
                                        var u = kt(t.coordinates, r, n)
                                          , c = Rt(e.geometry(), i, r, n);
                                        if (!wt(i, r))
                                            return !1;
                                        for (var h = 0, p = c; h < p.length; h += 1)
                                            if (!Lt(p[h], u))
                                                return !1
                                    }
                                    return !0
                                }(e, this.geometries)
                        }
                        return !1
                    }
                    ,
                    Ot.prototype.eachChild = function() {}
                    ,
                    Ot.prototype.outputDefined = function() {
                        return !0
                    }
                    ,
                    Ot.prototype.serialize = function() {
                        return ["within", this.geojson]
                    }
                    ;
                    var Ut = function(e, t) {
                        this.type = t.type,
                        this.name = e,
                        this.boundExpression = t
                    };
                    Ut.parse = function(e, t) {
                        if (2 !== e.length || "string" != typeof e[1])
                            return t.error("'var' expression requires exactly one string literal argument.");
                        var i = e[1];
                        return t.scope.has(i) ? new Ut(i,t.scope.get(i)) : t.error('Unknown variable "' + i + '". Make sure "' + i + '" has been bound in an enclosing "let" expression before using it.', 1)
                    }
                    ,
                    Ut.prototype.evaluate = function(e) {
                        return this.boundExpression.evaluate(e)
                    }
                    ,
                    Ut.prototype.eachChild = function() {}
                    ,
                    Ut.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    Ut.prototype.serialize = function() {
                        return ["var", this.name]
                    }
                    ;
                    var Vt = function(e, t, i, r, n) {
                        void 0 === t && (t = []),
                        void 0 === r && (r = new Oe),
                        void 0 === n && (n = []),
                        this.registry = e,
                        this.path = t,
                        this.key = t.map((function(e) {
                            return "[" + e + "]"
                        }
                        )).join(""),
                        this.scope = r,
                        this.errors = n,
                        this.expectedType = i
                    };
                    function Gt(e, t) {
                        for (var i, r = e.length - 1, n = 0, a = r, o = 0; n <= a; )
                            if ((i = e[o = Math.floor((n + a) / 2)]) <= t) {
                                if (o === r || t < e[o + 1])
                                    return o;
                                n = o + 1
                            } else {
                                if (!(i > t))
                                    throw new ct("Input is not a number.");
                                a = o - 1
                            }
                        return 0
                    }
                    Vt.prototype.parse = function(e, t, i, r, n) {
                        return void 0 === n && (n = {}),
                        t ? this.concat(t, i, r)._parse(e, n) : this._parse(e, n)
                    }
                    ,
                    Vt.prototype._parse = function(e, t) {
                        function i(e, t, i) {
                            return "assert" === i ? new pt(t,[e]) : "coerce" === i ? new vt(t,[e]) : e
                        }
                        if (null !== e && "string" != typeof e && "boolean" != typeof e && "number" != typeof e || (e = ["literal", e]),
                        Array.isArray(e)) {
                            if (0 === e.length)
                                return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');
                            var r = e[0];
                            if ("string" != typeof r)
                                return this.error("Expression name must be a string, but found " + typeof r + ' instead. If you wanted a literal array, use ["literal", [...]].', 0),
                                null;
                            var n = this.registry[r];
                            if (n) {
                                var a = n.parse(e, this);
                                if (!a)
                                    return null;
                                if (this.expectedType) {
                                    var o = this.expectedType
                                      , s = a.type;
                                    if ("string" !== o.kind && "number" !== o.kind && "boolean" !== o.kind && "object" !== o.kind && "array" !== o.kind || "value" !== s.kind)
                                        if ("color" !== o.kind && "formatted" !== o.kind && "resolvedImage" !== o.kind || "value" !== s.kind && "string" !== s.kind) {
                                            if (this.checkSubtype(o, s))
                                                return null
                                        } else
                                            a = i(a, o, t.typeAnnotation || "coerce");
                                    else
                                        a = i(a, o, t.typeAnnotation || "assert")
                                }
                                if (!(a instanceof ut) && "resolvedImage" !== a.type.kind && function e(t) {
                                    if (t instanceof Ut)
                                        return e(t.boundExpression);
                                    if (t instanceof _t && "error" === t.name)
                                        return !1;
                                    if (t instanceof xt)
                                        return !1;
                                    if (t instanceof Ot)
                                        return !1;
                                    var i = t instanceof vt || t instanceof pt
                                      , r = !0;
                                    return t.eachChild((function(t) {
                                        r = i ? r && e(t) : r && t instanceof ut
                                    }
                                    )),
                                    !!r && Bt(t) && Nt(t, ["zoom", "heatmap-density", "line-progress", "accumulated", "is-supported-script"])
                                }(a)) {
                                    var l = new yt;
                                    try {
                                        a = new ut(a.type,a.evaluate(l))
                                    } catch (e) {
                                        return this.error(e.message),
                                        null
                                    }
                                }
                                return a
                            }
                            return this.error('Unknown expression "' + r + '". If you wanted a literal array, use ["literal", [...]].', 0)
                        }
                        return this.error(void 0 === e ? "'undefined' value invalid. Use null instead." : "object" == typeof e ? 'Bare objects invalid. Use ["literal", {...}] instead.' : "Expected an array, but found " + typeof e + " instead.")
                    }
                    ,
                    Vt.prototype.concat = function(e, t, i) {
                        var r = "number" == typeof e ? this.path.concat(e) : this.path
                          , n = i ? this.scope.concat(i) : this.scope;
                        return new Vt(this.registry,r,t || null,n,this.errors)
                    }
                    ,
                    Vt.prototype.error = function(e) {
                        for (var t = [], i = arguments.length - 1; i-- > 0; )
                            t[i] = arguments[i + 1];
                        var r = "" + this.key + t.map((function(e) {
                            return "[" + e + "]"
                        }
                        )).join("");
                        this.errors.push(new Re(r,e))
                    }
                    ,
                    Vt.prototype.checkSubtype = function(e, t) {
                        var i = Ke(e, t);
                        return i && this.error(i),
                        i
                    }
                    ;
                    var jt = function(e, t, i) {
                        this.type = e,
                        this.input = t,
                        this.labels = [],
                        this.outputs = [];
                        for (var r = 0, n = i; r < n.length; r += 1) {
                            var a = n[r]
                              , o = a[1];
                            this.labels.push(a[0]),
                            this.outputs.push(o)
                        }
                    };
                    function Ht(e, t, i) {
                        return e * (1 - i) + t * i
                    }
                    jt.parse = function(e, t) {
                        if (e.length - 1 < 4)
                            return t.error("Expected at least 4 arguments, but found only " + (e.length - 1) + ".");
                        if ((e.length - 1) % 2 != 0)
                            return t.error("Expected an even number of arguments.");
                        var i = t.parse(e[1], 1, Fe);
                        if (!i)
                            return null;
                        var r = []
                          , n = null;
                        t.expectedType && "value" !== t.expectedType.kind && (n = t.expectedType);
                        for (var a = 1; a < e.length; a += 2) {
                            var o = 1 === a ? -1 / 0 : e[a]
                              , s = e[a + 1]
                              , l = a
                              , u = a + 1;
                            if ("number" != typeof o)
                                return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.', l);
                            if (r.length && r[r.length - 1][0] >= o)
                                return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.', l);
                            var c = t.parse(s, u, n);
                            if (!c)
                                return null;
                            n = n || c.type,
                            r.push([o, c])
                        }
                        return new jt(n,i,r)
                    }
                    ,
                    jt.prototype.evaluate = function(e) {
                        var t = this.labels
                          , i = this.outputs;
                        if (1 === t.length)
                            return i[0].evaluate(e);
                        var r = this.input.evaluate(e);
                        if (r <= t[0])
                            return i[0].evaluate(e);
                        var n = t.length;
                        return r >= t[n - 1] ? i[n - 1].evaluate(e) : i[Gt(t, r)].evaluate(e)
                    }
                    ,
                    jt.prototype.eachChild = function(e) {
                        e(this.input);
                        for (var t = 0, i = this.outputs; t < i.length; t += 1)
                            e(i[t])
                    }
                    ,
                    jt.prototype.outputDefined = function() {
                        return this.outputs.every((function(e) {
                            return e.outputDefined()
                        }
                        ))
                    }
                    ,
                    jt.prototype.serialize = function() {
                        for (var e = ["step", this.input.serialize()], t = 0; t < this.labels.length; t++)
                            t > 0 && e.push(this.labels[t]),
                            e.push(this.outputs[t].serialize());
                        return e
                    }
                    ;
                    var qt = Object.freeze({
                        __proto__: null,
                        number: Ht,
                        color: function(e, t, i) {
                            return new et(Ht(e.r, t.r, i),Ht(e.g, t.g, i),Ht(e.b, t.b, i),Ht(e.a, t.a, i))
                        },
                        array: function(e, t, i) {
                            return e.map((function(e, r) {
                                return Ht(e, t[r], i)
                            }
                            ))
                        }
                    })
                      , Wt = 6 / 29 * 3 * (6 / 29)
                      , Zt = Math.PI / 180
                      , Xt = 180 / Math.PI;
                    function Yt(e) {
                        return e > .008856451679035631 ? Math.pow(e, 1 / 3) : e / Wt + 4 / 29
                    }
                    function Kt(e) {
                        return e > 6 / 29 ? e * e * e : Wt * (e - 4 / 29)
                    }
                    function Jt(e) {
                        return 255 * (e <= .0031308 ? 12.92 * e : 1.055 * Math.pow(e, 1 / 2.4) - .055)
                    }
                    function Qt(e) {
                        return (e /= 255) <= .04045 ? e / 12.92 : Math.pow((e + .055) / 1.055, 2.4)
                    }
                    function $t(e) {
                        var t = Qt(e.r)
                          , i = Qt(e.g)
                          , r = Qt(e.b)
                          , n = Yt((.4124564 * t + .3575761 * i + .1804375 * r) / .95047)
                          , a = Yt((.2126729 * t + .7151522 * i + .072175 * r) / 1);
                        return {
                            l: 116 * a - 16,
                            a: 500 * (n - a),
                            b: 200 * (a - Yt((.0193339 * t + .119192 * i + .9503041 * r) / 1.08883)),
                            alpha: e.a
                        }
                    }
                    function ei(e) {
                        var t = (e.l + 16) / 116
                          , i = isNaN(e.a) ? t : t + e.a / 500
                          , r = isNaN(e.b) ? t : t - e.b / 200;
                        return t = 1 * Kt(t),
                        i = .95047 * Kt(i),
                        r = 1.08883 * Kt(r),
                        new et(Jt(3.2404542 * i - 1.5371385 * t - .4985314 * r),Jt(-.969266 * i + 1.8760108 * t + .041556 * r),Jt(.0556434 * i - .2040259 * t + 1.0572252 * r),e.alpha)
                    }
                    function ti(e, t, i) {
                        var r = t - e;
                        return e + i * (r > 180 || r < -180 ? r - 360 * Math.round(r / 360) : r)
                    }
                    var ii = {
                        forward: $t,
                        reverse: ei,
                        interpolate: function(e, t, i) {
                            return {
                                l: Ht(e.l, t.l, i),
                                a: Ht(e.a, t.a, i),
                                b: Ht(e.b, t.b, i),
                                alpha: Ht(e.alpha, t.alpha, i)
                            }
                        }
                    }
                      , ri = {
                        forward: function(e) {
                            var t = $t(e)
                              , i = t.l
                              , r = t.a
                              , n = t.b
                              , a = Math.atan2(n, r) * Xt;
                            return {
                                h: a < 0 ? a + 360 : a,
                                c: Math.sqrt(r * r + n * n),
                                l: i,
                                alpha: e.a
                            }
                        },
                        reverse: function(e) {
                            var t = e.h * Zt
                              , i = e.c;
                            return ei({
                                l: e.l,
                                a: Math.cos(t) * i,
                                b: Math.sin(t) * i,
                                alpha: e.alpha
                            })
                        },
                        interpolate: function(e, t, i) {
                            return {
                                h: ti(e.h, t.h, i),
                                c: Ht(e.c, t.c, i),
                                l: Ht(e.l, t.l, i),
                                alpha: Ht(e.alpha, t.alpha, i)
                            }
                        }
                    }
                      , ni = Object.freeze({
                        __proto__: null,
                        lab: ii,
                        hcl: ri
                    })
                      , ai = function(e, t, i, r, n) {
                        this.type = e,
                        this.operator = t,
                        this.interpolation = i,
                        this.input = r,
                        this.labels = [],
                        this.outputs = [];
                        for (var a = 0, o = n; a < o.length; a += 1) {
                            var s = o[a]
                              , l = s[1];
                            this.labels.push(s[0]),
                            this.outputs.push(l)
                        }
                    };
                    function oi(e, t, i, r) {
                        var n = r - i
                          , a = e - i;
                        return 0 === n ? 0 : 1 === t ? a / n : (Math.pow(t, a) - 1) / (Math.pow(t, n) - 1)
                    }
                    ai.interpolationFactor = function(e, t, r, n) {
                        var a = 0;
                        if ("exponential" === e.name)
                            a = oi(t, e.base, r, n);
                        else if ("linear" === e.name)
                            a = oi(t, 1, r, n);
                        else if ("cubic-bezier" === e.name) {
                            var o = e.controlPoints;
                            a = new i(o[0],o[1],o[2],o[3]).solve(oi(t, 1, r, n))
                        }
                        return a
                    }
                    ,
                    ai.parse = function(e, t) {
                        var i = e[0]
                          , r = e[1]
                          , n = e[2]
                          , a = e.slice(3);
                        if (!Array.isArray(r) || 0 === r.length)
                            return t.error("Expected an interpolation type expression.", 1);
                        if ("linear" === r[0])
                            r = {
                                name: "linear"
                            };
                        else if ("exponential" === r[0]) {
                            var o = r[1];
                            if ("number" != typeof o)
                                return t.error("Exponential interpolation requires a numeric base.", 1, 1);
                            r = {
                                name: "exponential",
                                base: o
                            }
                        } else {
                            if ("cubic-bezier" !== r[0])
                                return t.error("Unknown interpolation type " + String(r[0]), 1, 0);
                            var s = r.slice(1);
                            if (4 !== s.length || s.some((function(e) {
                                return "number" != typeof e || e < 0 || e > 1
                            }
                            )))
                                return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.", 1);
                            r = {
                                name: "cubic-bezier",
                                controlPoints: s
                            }
                        }
                        if (e.length - 1 < 4)
                            return t.error("Expected at least 4 arguments, but found only " + (e.length - 1) + ".");
                        if ((e.length - 1) % 2 != 0)
                            return t.error("Expected an even number of arguments.");
                        if (!(n = t.parse(n, 2, Fe)))
                            return null;
                        var l = []
                          , u = null;
                        "interpolate-hcl" === i || "interpolate-lab" === i ? u = Ve : t.expectedType && "value" !== t.expectedType.kind && (u = t.expectedType);
                        for (var c = 0; c < a.length; c += 2) {
                            var h = a[c]
                              , p = a[c + 1]
                              , f = c + 3
                              , d = c + 4;
                            if ("number" != typeof h)
                                return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.', f);
                            if (l.length && l[l.length - 1][0] >= h)
                                return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.', f);
                            var m = t.parse(p, d, u);
                            if (!m)
                                return null;
                            u = u || m.type,
                            l.push([h, m])
                        }
                        return "number" === u.kind || "color" === u.kind || "array" === u.kind && "number" === u.itemType.kind && "number" == typeof u.N ? new ai(u,i,r,n,l) : t.error("Type " + Xe(u) + " is not interpolatable.")
                    }
                    ,
                    ai.prototype.evaluate = function(e) {
                        var t = this.labels
                          , i = this.outputs;
                        if (1 === t.length)
                            return i[0].evaluate(e);
                        var r = this.input.evaluate(e);
                        if (r <= t[0])
                            return i[0].evaluate(e);
                        var n = t.length;
                        if (r >= t[n - 1])
                            return i[n - 1].evaluate(e);
                        var a = Gt(t, r)
                          , o = ai.interpolationFactor(this.interpolation, r, t[a], t[a + 1])
                          , s = i[a].evaluate(e)
                          , l = i[a + 1].evaluate(e);
                        return "interpolate" === this.operator ? qt[this.type.kind.toLowerCase()](s, l, o) : "interpolate-hcl" === this.operator ? ri.reverse(ri.interpolate(ri.forward(s), ri.forward(l), o)) : ii.reverse(ii.interpolate(ii.forward(s), ii.forward(l), o))
                    }
                    ,
                    ai.prototype.eachChild = function(e) {
                        e(this.input);
                        for (var t = 0, i = this.outputs; t < i.length; t += 1)
                            e(i[t])
                    }
                    ,
                    ai.prototype.outputDefined = function() {
                        return this.outputs.every((function(e) {
                            return e.outputDefined()
                        }
                        ))
                    }
                    ,
                    ai.prototype.serialize = function() {
                        var e;
                        e = "linear" === this.interpolation.name ? ["linear"] : "exponential" === this.interpolation.name ? 1 === this.interpolation.base ? ["linear"] : ["exponential", this.interpolation.base] : ["cubic-bezier"].concat(this.interpolation.controlPoints);
                        for (var t = [this.operator, e, this.input.serialize()], i = 0; i < this.labels.length; i++)
                            t.push(this.labels[i], this.outputs[i].serialize());
                        return t
                    }
                    ;
                    var si = function(e, t) {
                        this.type = e,
                        this.args = t
                    };
                    si.parse = function(e, t) {
                        if (e.length < 2)
                            return t.error("Expectected at least one argument.");
                        var i = null
                          , r = t.expectedType;
                        r && "value" !== r.kind && (i = r);
                        for (var n = [], a = 0, o = e.slice(1); a < o.length; a += 1) {
                            var s = t.parse(o[a], 1 + n.length, i, void 0, {
                                typeAnnotation: "omit"
                            });
                            if (!s)
                                return null;
                            i = i || s.type,
                            n.push(s)
                        }
                        var l = r && n.some((function(e) {
                            return Ke(r, e.type)
                        }
                        ));
                        return new si(l ? je : i,n)
                    }
                    ,
                    si.prototype.evaluate = function(e) {
                        for (var t, i = null, r = 0, n = 0, a = this.args; n < a.length && (r++,
                        (i = a[n].evaluate(e)) && i instanceof nt && !i.available && (t || (t = i.name),
                        i = null,
                        r === this.args.length && (i = t)),
                        null === i); n += 1)
                            ;
                        return i
                    }
                    ,
                    si.prototype.eachChild = function(e) {
                        this.args.forEach(e)
                    }
                    ,
                    si.prototype.outputDefined = function() {
                        return this.args.every((function(e) {
                            return e.outputDefined()
                        }
                        ))
                    }
                    ,
                    si.prototype.serialize = function() {
                        var e = ["coalesce"];
                        return this.eachChild((function(t) {
                            e.push(t.serialize())
                        }
                        )),
                        e
                    }
                    ;
                    var li = function(e, t) {
                        this.type = t.type,
                        this.bindings = [].concat(e),
                        this.result = t
                    };
                    li.prototype.evaluate = function(e) {
                        return this.result.evaluate(e)
                    }
                    ,
                    li.prototype.eachChild = function(e) {
                        for (var t = 0, i = this.bindings; t < i.length; t += 1)
                            e(i[t][1]);
                        e(this.result)
                    }
                    ,
                    li.parse = function(e, t) {
                        if (e.length < 4)
                            return t.error("Expected at least 3 arguments, but found " + (e.length - 1) + " instead.");
                        for (var i = [], r = 1; r < e.length - 1; r += 2) {
                            var n = e[r];
                            if ("string" != typeof n)
                                return t.error("Expected string, but found " + typeof n + " instead.", r);
                            if (/[^a-zA-Z0-9_]/.test(n))
                                return t.error("Variable names must contain only alphanumeric characters or '_'.", r);
                            var a = t.parse(e[r + 1], r + 1);
                            if (!a)
                                return null;
                            i.push([n, a])
                        }
                        var o = t.parse(e[e.length - 1], e.length - 1, t.expectedType, i);
                        return o ? new li(i,o) : null
                    }
                    ,
                    li.prototype.outputDefined = function() {
                        return this.result.outputDefined()
                    }
                    ,
                    li.prototype.serialize = function() {
                        for (var e = ["let"], t = 0, i = this.bindings; t < i.length; t += 1) {
                            var r = i[t];
                            e.push(r[0], r[1].serialize())
                        }
                        return e.push(this.result.serialize()),
                        e
                    }
                    ;
                    var ui = function(e, t, i) {
                        this.type = e,
                        this.index = t,
                        this.input = i
                    };
                    ui.parse = function(e, t) {
                        if (3 !== e.length)
                            return t.error("Expected 2 arguments, but found " + (e.length - 1) + " instead.");
                        var i = t.parse(e[1], 1, Fe)
                          , r = t.parse(e[2], 2, Ze(t.expectedType || je));
                        return i && r ? new ui(r.type.itemType,i,r) : null
                    }
                    ,
                    ui.prototype.evaluate = function(e) {
                        var t = this.index.evaluate(e)
                          , i = this.input.evaluate(e);
                        if (t < 0)
                            throw new ct("Array index out of bounds: " + t + " < 0.");
                        if (t >= i.length)
                            throw new ct("Array index out of bounds: " + t + " > " + (i.length - 1) + ".");
                        if (t !== Math.floor(t))
                            throw new ct("Array index must be an integer, but found " + t + " instead.");
                        return i[t]
                    }
                    ,
                    ui.prototype.eachChild = function(e) {
                        e(this.index),
                        e(this.input)
                    }
                    ,
                    ui.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    ui.prototype.serialize = function() {
                        return ["at", this.index.serialize(), this.input.serialize()]
                    }
                    ;
                    var ci = function(e, t) {
                        this.type = Ue,
                        this.needle = e,
                        this.haystack = t
                    };
                    ci.parse = function(e, t) {
                        if (3 !== e.length)
                            return t.error("Expected 2 arguments, but found " + (e.length - 1) + " instead.");
                        var i = t.parse(e[1], 1, je)
                          , r = t.parse(e[2], 2, je);
                        return i && r ? Je(i.type, [Ue, Ne, Fe, Be, je]) ? new ci(i,r) : t.error("Expected first argument to be of type boolean, string, number or null, but found " + Xe(i.type) + " instead") : null
                    }
                    ,
                    ci.prototype.evaluate = function(e) {
                        var t = this.needle.evaluate(e)
                          , i = this.haystack.evaluate(e);
                        if (!i)
                            return !1;
                        if (!Qe(t, ["boolean", "string", "number", "null"]))
                            throw new ct("Expected first argument to be of type boolean, string, number or null, but found " + Xe(st(t)) + " instead.");
                        if (!Qe(i, ["string", "array"]))
                            throw new ct("Expected second argument to be of type array or string, but found " + Xe(st(i)) + " instead.");
                        return i.indexOf(t) >= 0
                    }
                    ,
                    ci.prototype.eachChild = function(e) {
                        e(this.needle),
                        e(this.haystack)
                    }
                    ,
                    ci.prototype.outputDefined = function() {
                        return !0
                    }
                    ,
                    ci.prototype.serialize = function() {
                        return ["in", this.needle.serialize(), this.haystack.serialize()]
                    }
                    ;
                    var hi = function(e, t, i) {
                        this.type = Fe,
                        this.needle = e,
                        this.haystack = t,
                        this.fromIndex = i
                    };
                    hi.parse = function(e, t) {
                        if (e.length <= 2 || e.length >= 5)
                            return t.error("Expected 3 or 4 arguments, but found " + (e.length - 1) + " instead.");
                        var i = t.parse(e[1], 1, je)
                          , r = t.parse(e[2], 2, je);
                        if (!i || !r)
                            return null;
                        if (!Je(i.type, [Ue, Ne, Fe, Be, je]))
                            return t.error("Expected first argument to be of type boolean, string, number or null, but found " + Xe(i.type) + " instead");
                        if (4 === e.length) {
                            var n = t.parse(e[3], 3, Fe);
                            return n ? new hi(i,r,n) : null
                        }
                        return new hi(i,r)
                    }
                    ,
                    hi.prototype.evaluate = function(e) {
                        var t = this.needle.evaluate(e)
                          , i = this.haystack.evaluate(e);
                        if (!Qe(t, ["boolean", "string", "number", "null"]))
                            throw new ct("Expected first argument to be of type boolean, string, number or null, but found " + Xe(st(t)) + " instead.");
                        if (!Qe(i, ["string", "array"]))
                            throw new ct("Expected second argument to be of type array or string, but found " + Xe(st(i)) + " instead.");
                        if (this.fromIndex) {
                            var r = this.fromIndex.evaluate(e);
                            return i.indexOf(t, r)
                        }
                        return i.indexOf(t)
                    }
                    ,
                    hi.prototype.eachChild = function(e) {
                        e(this.needle),
                        e(this.haystack),
                        this.fromIndex && e(this.fromIndex)
                    }
                    ,
                    hi.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    hi.prototype.serialize = function() {
                        if (null != this.fromIndex && void 0 !== this.fromIndex) {
                            var e = this.fromIndex.serialize();
                            return ["index-of", this.needle.serialize(), this.haystack.serialize(), e]
                        }
                        return ["index-of", this.needle.serialize(), this.haystack.serialize()]
                    }
                    ;
                    var pi = function(e, t, i, r, n, a) {
                        this.inputType = e,
                        this.type = t,
                        this.input = i,
                        this.cases = r,
                        this.outputs = n,
                        this.otherwise = a
                    };
                    pi.parse = function(e, t) {
                        if (e.length < 5)
                            return t.error("Expected at least 4 arguments, but found only " + (e.length - 1) + ".");
                        if (e.length % 2 != 1)
                            return t.error("Expected an even number of arguments.");
                        var i, r;
                        t.expectedType && "value" !== t.expectedType.kind && (r = t.expectedType);
                        for (var n = {}, a = [], o = 2; o < e.length - 1; o += 2) {
                            var s = e[o]
                              , l = e[o + 1];
                            Array.isArray(s) || (s = [s]);
                            var u = t.concat(o);
                            if (0 === s.length)
                                return u.error("Expected at least one branch label.");
                            for (var c = 0, h = s; c < h.length; c += 1) {
                                var p = h[c];
                                if ("number" != typeof p && "string" != typeof p)
                                    return u.error("Branch labels must be numbers or strings.");
                                if ("number" == typeof p && Math.abs(p) > Number.MAX_SAFE_INTEGER)
                                    return u.error("Branch labels must be integers no larger than " + Number.MAX_SAFE_INTEGER + ".");
                                if ("number" == typeof p && Math.floor(p) !== p)
                                    return u.error("Numeric branch labels must be integer values.");
                                if (i) {
                                    if (u.checkSubtype(i, st(p)))
                                        return null
                                } else
                                    i = st(p);
                                if (void 0 !== n[String(p)])
                                    return u.error("Branch labels must be unique.");
                                n[String(p)] = a.length
                            }
                            var f = t.parse(l, o, r);
                            if (!f)
                                return null;
                            r = r || f.type,
                            a.push(f)
                        }
                        var d = t.parse(e[1], 1, je);
                        if (!d)
                            return null;
                        var m = t.parse(e[e.length - 1], e.length - 1, r);
                        return m ? "value" !== d.type.kind && t.concat(1).checkSubtype(i, d.type) ? null : new pi(i,r,d,n,a,m) : null
                    }
                    ,
                    pi.prototype.evaluate = function(e) {
                        var t = this.input.evaluate(e);
                        return (st(t) === this.inputType && this.outputs[this.cases[t]] || this.otherwise).evaluate(e)
                    }
                    ,
                    pi.prototype.eachChild = function(e) {
                        e(this.input),
                        this.outputs.forEach(e),
                        e(this.otherwise)
                    }
                    ,
                    pi.prototype.outputDefined = function() {
                        return this.outputs.every((function(e) {
                            return e.outputDefined()
                        }
                        )) && this.otherwise.outputDefined()
                    }
                    ,
                    pi.prototype.serialize = function() {
                        for (var e = this, t = ["match", this.input.serialize()], i = [], r = {}, n = 0, a = Object.keys(this.cases).sort(); n < a.length; n += 1) {
                            var o = a[n];
                            void 0 === (h = r[this.cases[o]]) ? (r[this.cases[o]] = i.length,
                            i.push([this.cases[o], [o]])) : i[h][1].push(o)
                        }
                        for (var s = function(t) {
                            return "number" === e.inputType.kind ? Number(t) : t
                        }, l = 0, u = i; l < u.length; l += 1) {
                            var c = u[l]
                              , h = c[0]
                              , p = c[1];
                            t.push(1 === p.length ? s(p[0]) : p.map(s)),
                            t.push(this.outputs[outputIndex$1].serialize())
                        }
                        return t.push(this.otherwise.serialize()),
                        t
                    }
                    ;
                    var fi = function(e, t, i) {
                        this.type = e,
                        this.branches = t,
                        this.otherwise = i
                    };
                    fi.parse = function(e, t) {
                        if (e.length < 4)
                            return t.error("Expected at least 3 arguments, but found only " + (e.length - 1) + ".");
                        if (e.length % 2 != 0)
                            return t.error("Expected an odd number of arguments.");
                        var i;
                        t.expectedType && "value" !== t.expectedType.kind && (i = t.expectedType);
                        for (var r = [], n = 1; n < e.length - 1; n += 2) {
                            var a = t.parse(e[n], n, Ue);
                            if (!a)
                                return null;
                            var o = t.parse(e[n + 1], n + 1, i);
                            if (!o)
                                return null;
                            r.push([a, o]),
                            i = i || o.type
                        }
                        var s = t.parse(e[e.length - 1], e.length - 1, i);
                        return s ? new fi(i,r,s) : null
                    }
                    ,
                    fi.prototype.evaluate = function(e) {
                        for (var t = 0, i = this.branches; t < i.length; t += 1) {
                            var r = i[t]
                              , n = r[1];
                            if (r[0].evaluate(e))
                                return n.evaluate(e)
                        }
                        return this.otherwise.evaluate(e)
                    }
                    ,
                    fi.prototype.eachChild = function(e) {
                        for (var t = 0, i = this.branches; t < i.length; t += 1) {
                            var r = i[t]
                              , n = r[1];
                            e(r[0]),
                            e(n)
                        }
                        e(this.otherwise)
                    }
                    ,
                    fi.prototype.outputDefined = function() {
                        return this.branches.every((function(e) {
                            return e[1].outputDefined()
                        }
                        )) && this.otherwise.outputDefined()
                    }
                    ,
                    fi.prototype.serialize = function() {
                        var e = ["case"];
                        return this.eachChild((function(t) {
                            e.push(t.serialize())
                        }
                        )),
                        e
                    }
                    ;
                    var di = function(e, t, i, r) {
                        this.type = e,
                        this.input = t,
                        this.beginIndex = i,
                        this.endIndex = r
                    };
                    function mi(e, t) {
                        return "==" === e || "!=" === e ? "boolean" === t.kind || "string" === t.kind || "number" === t.kind || "null" === t.kind || "value" === t.kind : "string" === t.kind || "number" === t.kind || "value" === t.kind
                    }
                    function vi(e, t, i, r) {
                        return 0 === r.compare(t, i)
                    }
                    function gi(e, t, i) {
                        var r = "==" !== e && "!=" !== e;
                        return function() {
                            function n(e, t, i) {
                                this.type = Ue,
                                this.lhs = e,
                                this.rhs = t,
                                this.collator = i,
                                this.hasUntypedArgument = "value" === e.type.kind || "value" === t.type.kind
                            }
                            return n.parse = function(e, t) {
                                if (3 !== e.length && 4 !== e.length)
                                    return t.error("Expected two or three arguments.");
                                var i = e[0]
                                  , a = t.parse(e[1], 1, je);
                                if (!a)
                                    return null;
                                if (!mi(i, a.type))
                                    return t.concat(1).error('"' + i + "\" comparisons are not supported for type '" + Xe(a.type) + "'.");
                                var o = t.parse(e[2], 2, je);
                                if (!o)
                                    return null;
                                if (!mi(i, o.type))
                                    return t.concat(2).error('"' + i + "\" comparisons are not supported for type '" + Xe(o.type) + "'.");
                                if (a.type.kind !== o.type.kind && "value" !== a.type.kind && "value" !== o.type.kind)
                                    return t.error("Cannot compare types '" + Xe(a.type) + "' and '" + Xe(o.type) + "'.");
                                r && ("value" === a.type.kind && "value" !== o.type.kind ? a = new pt(o.type,[a]) : "value" !== a.type.kind && "value" === o.type.kind && (o = new pt(a.type,[o])));
                                var s = null;
                                if (4 === e.length) {
                                    if ("string" !== a.type.kind && "string" !== o.type.kind && "value" !== a.type.kind && "value" !== o.type.kind)
                                        return t.error("Cannot use collator to compare non-string types.");
                                    if (!(s = t.parse(e[3], 3, He)))
                                        return null
                                }
                                return new n(a,o,s)
                            }
                            ,
                            n.prototype.evaluate = function(n) {
                                var a = this.lhs.evaluate(n)
                                  , o = this.rhs.evaluate(n);
                                if (r && this.hasUntypedArgument) {
                                    var s = st(a)
                                      , l = st(o);
                                    if (s.kind !== l.kind || "string" !== s.kind && "number" !== s.kind)
                                        throw new ct('Expected arguments for "' + e + '" to be (string, string) or (number, number), but found (' + s.kind + ", " + l.kind + ") instead.")
                                }
                                if (this.collator && !r && this.hasUntypedArgument) {
                                    var u = st(a)
                                      , c = st(o);
                                    if ("string" !== u.kind || "string" !== c.kind)
                                        return t(n, a, o)
                                }
                                return this.collator ? i(n, a, o, this.collator.evaluate(n)) : t(n, a, o)
                            }
                            ,
                            n.prototype.eachChild = function(e) {
                                e(this.lhs),
                                e(this.rhs),
                                this.collator && e(this.collator)
                            }
                            ,
                            n.prototype.outputDefined = function() {
                                return !0
                            }
                            ,
                            n.prototype.serialize = function() {
                                var t = [e];
                                return this.eachChild((function(e) {
                                    t.push(e.serialize())
                                }
                                )),
                                t
                            }
                            ,
                            n
                        }()
                    }
                    di.parse = function(e, t) {
                        if (e.length <= 2 || e.length >= 5)
                            return t.error("Expected 3 or 4 arguments, but found " + (e.length - 1) + " instead.");
                        var i = t.parse(e[1], 1, je)
                          , r = t.parse(e[2], 2, Fe);
                        if (!i || !r)
                            return null;
                        if (!Je(i.type, [Ze(je), Ne, je]))
                            return t.error("Expected first argument to be of type array or string, but found " + Xe(i.type) + " instead");
                        if (4 === e.length) {
                            var n = t.parse(e[3], 3, Fe);
                            return n ? new di(i.type,i,r,n) : null
                        }
                        return new di(i.type,i,r)
                    }
                    ,
                    di.prototype.evaluate = function(e) {
                        var t = this.input.evaluate(e)
                          , i = this.beginIndex.evaluate(e);
                        if (!Qe(t, ["string", "array"]))
                            throw new ct("Expected first argument to be of type array or string, but found " + Xe(st(t)) + " instead.");
                        if (this.endIndex) {
                            var r = this.endIndex.evaluate(e);
                            return t.slice(i, r)
                        }
                        return t.slice(i)
                    }
                    ,
                    di.prototype.eachChild = function(e) {
                        e(this.input),
                        e(this.beginIndex),
                        this.endIndex && e(this.endIndex)
                    }
                    ,
                    di.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    di.prototype.serialize = function() {
                        if (null != this.endIndex && void 0 !== this.endIndex) {
                            var e = this.endIndex.serialize();
                            return ["slice", this.input.serialize(), this.beginIndex.serialize(), e]
                        }
                        return ["slice", this.input.serialize(), this.beginIndex.serialize()]
                    }
                    ;
                    var yi = gi("==", (function(e, t, i) {
                        return t === i
                    }
                    ), vi)
                      , _i = gi("!=", (function(e, t, i) {
                        return t !== i
                    }
                    ), (function(e, t, i, r) {
                        return !vi(0, t, i, r)
                    }
                    ))
                      , xi = gi("<", (function(e, t, i) {
                        return t < i
                    }
                    ), (function(e, t, i, r) {
                        return r.compare(t, i) < 0
                    }
                    ))
                      , bi = gi(">", (function(e, t, i) {
                        return t > i
                    }
                    ), (function(e, t, i, r) {
                        return r.compare(t, i) > 0
                    }
                    ))
                      , wi = gi("<=", (function(e, t, i) {
                        return t <= i
                    }
                    ), (function(e, t, i, r) {
                        return r.compare(t, i) <= 0
                    }
                    ))
                      , Si = gi(">=", (function(e, t, i) {
                        return t >= i
                    }
                    ), (function(e, t, i, r) {
                        return r.compare(t, i) >= 0
                    }
                    ))
                      , Mi = function(e, t, i, r, n) {
                        this.type = Ne,
                        this.number = e,
                        this.locale = t,
                        this.currency = i,
                        this.minFractionDigits = r,
                        this.maxFractionDigits = n
                    };
                    Mi.parse = function(e, t) {
                        if (3 !== e.length)
                            return t.error("Expected two arguments.");
                        var i = t.parse(e[1], 1, Fe);
                        if (!i)
                            return null;
                        var r = e[2];
                        if ("object" != typeof r || Array.isArray(r))
                            return t.error("NumberFormat options argument must be an object.");
                        var n = null;
                        if (r.locale && !(n = t.parse(r.locale, 1, Ne)))
                            return null;
                        var a = null;
                        if (r.currency && !(a = t.parse(r.currency, 1, Ne)))
                            return null;
                        var o = null;
                        if (r["min-fraction-digits"] && !(o = t.parse(r["min-fraction-digits"], 1, Fe)))
                            return null;
                        var s = null;
                        return r["max-fraction-digits"] && !(s = t.parse(r["max-fraction-digits"], 1, Fe)) ? null : new Mi(i,n,a,o,s)
                    }
                    ,
                    Mi.prototype.evaluate = function(e) {
                        return new Intl.NumberFormat(this.locale ? this.locale.evaluate(e) : [],{
                            style: this.currency ? "currency" : "decimal",
                            currency: this.currency ? this.currency.evaluate(e) : void 0,
                            minimumFractionDigits: this.minFractionDigits ? this.minFractionDigits.evaluate(e) : void 0,
                            maximumFractionDigits: this.maxFractionDigits ? this.maxFractionDigits.evaluate(e) : void 0
                        }).format(this.number.evaluate(e))
                    }
                    ,
                    Mi.prototype.eachChild = function(e) {
                        e(this.number),
                        this.locale && e(this.locale),
                        this.currency && e(this.currency),
                        this.minFractionDigits && e(this.minFractionDigits),
                        this.maxFractionDigits && e(this.maxFractionDigits)
                    }
                    ,
                    Mi.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    Mi.prototype.serialize = function() {
                        var e = {};
                        return this.locale && (e.locale = this.locale.serialize()),
                        this.currency && (e.currency = this.currency.serialize()),
                        this.minFractionDigits && (e["min-fraction-digits"] = this.minFractionDigits.serialize()),
                        this.maxFractionDigits && (e["max-fraction-digits"] = this.maxFractionDigits.serialize()),
                        ["number-format", this.number.serialize(), e]
                    }
                    ;
                    var Ti = function(e) {
                        this.type = Fe,
                        this.input = e
                    };
                    Ti.parse = function(e, t) {
                        if (2 !== e.length)
                            return t.error("Expected 1 argument, but found " + (e.length - 1) + " instead.");
                        var i = t.parse(e[1], 1);
                        return i ? "array" !== i.type.kind && "string" !== i.type.kind && "value" !== i.type.kind ? t.error("Expected argument of type string or array, but found " + Xe(i.type) + " instead.") : new Ti(i) : null
                    }
                    ,
                    Ti.prototype.evaluate = function(e) {
                        var t = this.input.evaluate(e);
                        if ("string" == typeof t)
                            return t.length;
                        if (Array.isArray(t))
                            return t.length;
                        throw new ct("Expected value to be of type string or array, but found " + Xe(st(t)) + " instead.")
                    }
                    ,
                    Ti.prototype.eachChild = function(e) {
                        e(this.input)
                    }
                    ,
                    Ti.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    Ti.prototype.serialize = function() {
                        var e = ["length"];
                        return this.eachChild((function(t) {
                            e.push(t.serialize())
                        }
                        )),
                        e
                    }
                    ;
                    var Ei = {
                        "==": yi,
                        "!=": _i,
                        ">": bi,
                        "<": xi,
                        ">=": Si,
                        "<=": wi,
                        array: pt,
                        at: ui,
                        boolean: pt,
                        case: fi,
                        coalesce: si,
                        collator: xt,
                        format: ft,
                        image: dt,
                        in: ci,
                        "index-of": hi,
                        interpolate: ai,
                        "interpolate-hcl": ai,
                        "interpolate-lab": ai,
                        length: Ti,
                        let: li,
                        literal: ut,
                        match: pi,
                        number: pt,
                        "number-format": Mi,
                        object: pt,
                        slice: di,
                        step: jt,
                        string: pt,
                        "to-boolean": vt,
                        "to-color": vt,
                        "to-number": vt,
                        "to-string": vt,
                        var: Ut,
                        within: Ot
                    };
                    function Ai(e, t) {
                        var i = t[0]
                          , r = t[1]
                          , n = t[2]
                          , a = t[3];
                        i = i.evaluate(e),
                        r = r.evaluate(e),
                        n = n.evaluate(e);
                        var o = a ? a.evaluate(e) : 1
                          , s = at(i, r, n, o);
                        if (s)
                            throw new ct(s);
                        return new et(i / 255 * o,r / 255 * o,n / 255 * o,o)
                    }
                    function Pi(e, t) {
                        return e in t
                    }
                    function Ci(e, t) {
                        var i = t[e];
                        return void 0 === i ? null : i
                    }
                    function Li(e) {
                        return {
                            type: e
                        }
                    }
                    function Ii(e) {
                        return {
                            result: "success",
                            value: e
                        }
                    }
                    function ki(e) {
                        return {
                            result: "error",
                            value: e
                        }
                    }
                    function zi(e) {
                        return "data-driven" === e["property-type"] || "cross-faded-data-driven" === e["property-type"]
                    }
                    function Di(e) {
                        return !!e.expression && e.expression.parameters.indexOf("zoom") > -1
                    }
                    function Ri(e) {
                        return !!e.expression && e.expression.interpolated
                    }
                    function Oi(e) {
                        return e instanceof Number ? "number" : e instanceof String ? "string" : e instanceof Boolean ? "boolean" : Array.isArray(e) ? "array" : null === e ? "null" : typeof e
                    }
                    function Bi(e) {
                        return "object" == typeof e && null !== e && !Array.isArray(e)
                    }
                    function Fi(e) {
                        return e
                    }
                    function Ni(e, t, i) {
                        return void 0 !== e ? e : void 0 !== t ? t : void 0 !== i ? i : void 0
                    }
                    function Ui(e, t, i, r, n) {
                        return Ni(typeof i === n ? r[i] : void 0, e.default, t.default)
                    }
                    function Vi(e, t, i) {
                        if ("number" !== Oi(i))
                            return Ni(e.default, t.default);
                        var r = e.stops.length;
                        if (1 === r)
                            return e.stops[0][1];
                        if (i <= e.stops[0][0])
                            return e.stops[0][1];
                        if (i >= e.stops[r - 1][0])
                            return e.stops[r - 1][1];
                        var n = Gt(e.stops.map((function(e) {
                            return e[0]
                        }
                        )), i);
                        return e.stops[n][1]
                    }
                    function Gi(e, t, i) {
                        var r = void 0 !== e.base ? e.base : 1;
                        if ("number" !== Oi(i))
                            return Ni(e.default, t.default);
                        var n = e.stops.length;
                        if (1 === n)
                            return e.stops[0][1];
                        if (i <= e.stops[0][0])
                            return e.stops[0][1];
                        if (i >= e.stops[n - 1][0])
                            return e.stops[n - 1][1];
                        var a = Gt(e.stops.map((function(e) {
                            return e[0]
                        }
                        )), i)
                          , o = function(e, t, i, r) {
                            var n = r - i
                              , a = e - i;
                            return 0 === n ? 0 : 1 === t ? a / n : (Math.pow(t, a) - 1) / (Math.pow(t, n) - 1)
                        }(i, r, e.stops[a][0], e.stops[a + 1][0])
                          , s = e.stops[a][1]
                          , l = e.stops[a + 1][1]
                          , u = qt[t.type] || Fi;
                        if (e.colorSpace && "rgb" !== e.colorSpace) {
                            var c = ni[e.colorSpace];
                            u = function(e, t) {
                                return c.reverse(c.interpolate(c.forward(e), c.forward(t), o))
                            }
                        }
                        return "function" == typeof s.evaluate ? {
                            evaluate: function() {
                                for (var e = [], t = arguments.length; t--; )
                                    e[t] = arguments[t];
                                var i = s.evaluate.apply(void 0, e)
                                  , r = l.evaluate.apply(void 0, e);
                                if (void 0 !== i && void 0 !== r)
                                    return u(i, r, o)
                            }
                        } : u(s, l, o)
                    }
                    function ji(e, t, i) {
                        return "color" === t.type ? i = et.parse(i) : "formatted" === t.type ? i = rt.fromString(i.toString()) : "resolvedImage" === t.type ? i = nt.fromString(i.toString()) : Oi(i) === t.type || "enum" === t.type && t.values[i] || (i = void 0),
                        Ni(i, e.default, t.default)
                    }
                    _t.register(Ei, {
                        error: [{
                            kind: "error"
                        }, [Ne], function(e, t) {
                            throw new ct(t[0].evaluate(e))
                        }
                        ],
                        typeof: [Ne, [je], function(e, t) {
                            return Xe(st(t[0].evaluate(e)))
                        }
                        ],
                        "to-rgba": [Ze(Fe, 4), [Ve], function(e, t) {
                            return t[0].evaluate(e).toArray()
                        }
                        ],
                        rgb: [Ve, [Fe, Fe, Fe], Ai],
                        rgba: [Ve, [Fe, Fe, Fe, Fe], Ai],
                        has: {
                            type: Ue,
                            overloads: [[[Ne], function(e, t) {
                                return Pi(t[0].evaluate(e), e.properties())
                            }
                            ], [[Ne, Ge], function(e, t) {
                                var i = t[1];
                                return Pi(t[0].evaluate(e), i.evaluate(e))
                            }
                            ]]
                        },
                        get: {
                            type: je,
                            overloads: [[[Ne], function(e, t) {
                                return Ci(t[0].evaluate(e), e.properties())
                            }
                            ], [[Ne, Ge], function(e, t) {
                                var i = t[1];
                                return Ci(t[0].evaluate(e), i.evaluate(e))
                            }
                            ]]
                        },
                        "feature-state": [je, [Ne], function(e, t) {
                            return Ci(t[0].evaluate(e), e.featureState || {})
                        }
                        ],
                        properties: [Ge, [], function(e) {
                            return e.properties()
                        }
                        ],
                        "geometry-type": [Ne, [], function(e) {
                            return e.geometryType()
                        }
                        ],
                        id: [je, [], function(e) {
                            return e.id()
                        }
                        ],
                        zoom: [Fe, [], function(e) {
                            return e.globals.zoom
                        }
                        ],
                        "heatmap-density": [Fe, [], function(e) {
                            return e.globals.heatmapDensity || 0
                        }
                        ],
                        "line-progress": [Fe, [], function(e) {
                            return e.globals.lineProgress || 0
                        }
                        ],
                        accumulated: [je, [], function(e) {
                            return void 0 === e.globals.accumulated ? null : e.globals.accumulated
                        }
                        ],
                        "+": [Fe, Li(Fe), function(e, t) {
                            for (var i = 0, r = 0, n = t; r < n.length; r += 1)
                                i += n[r].evaluate(e);
                            return i
                        }
                        ],
                        "*": [Fe, Li(Fe), function(e, t) {
                            for (var i = 1, r = 0, n = t; r < n.length; r += 1)
                                i *= n[r].evaluate(e);
                            return i
                        }
                        ],
                        "-": {
                            type: Fe,
                            overloads: [[[Fe, Fe], function(e, t) {
                                var i = t[1];
                                return t[0].evaluate(e) - i.evaluate(e)
                            }
                            ], [[Fe], function(e, t) {
                                return -t[0].evaluate(e)
                            }
                            ]]
                        },
                        "/": [Fe, [Fe, Fe], function(e, t) {
                            var i = t[1];
                            return t[0].evaluate(e) / i.evaluate(e)
                        }
                        ],
                        "%": [Fe, [Fe, Fe], function(e, t) {
                            var i = t[1];
                            return t[0].evaluate(e) % i.evaluate(e)
                        }
                        ],
                        ln2: [Fe, [], function() {
                            return Math.LN2
                        }
                        ],
                        pi: [Fe, [], function() {
                            return Math.PI
                        }
                        ],
                        e: [Fe, [], function() {
                            return Math.E
                        }
                        ],
                        "^": [Fe, [Fe, Fe], function(e, t) {
                            var i = t[1];
                            return Math.pow(t[0].evaluate(e), i.evaluate(e))
                        }
                        ],
                        sqrt: [Fe, [Fe], function(e, t) {
                            return Math.sqrt(t[0].evaluate(e))
                        }
                        ],
                        log10: [Fe, [Fe], function(e, t) {
                            return Math.log(t[0].evaluate(e)) / Math.LN10
                        }
                        ],
                        ln: [Fe, [Fe], function(e, t) {
                            return Math.log(t[0].evaluate(e))
                        }
                        ],
                        log2: [Fe, [Fe], function(e, t) {
                            return Math.log(t[0].evaluate(e)) / Math.LN2
                        }
                        ],
                        sin: [Fe, [Fe], function(e, t) {
                            return Math.sin(t[0].evaluate(e))
                        }
                        ],
                        cos: [Fe, [Fe], function(e, t) {
                            return Math.cos(t[0].evaluate(e))
                        }
                        ],
                        tan: [Fe, [Fe], function(e, t) {
                            return Math.tan(t[0].evaluate(e))
                        }
                        ],
                        asin: [Fe, [Fe], function(e, t) {
                            return Math.asin(t[0].evaluate(e))
                        }
                        ],
                        acos: [Fe, [Fe], function(e, t) {
                            return Math.acos(t[0].evaluate(e))
                        }
                        ],
                        atan: [Fe, [Fe], function(e, t) {
                            return Math.atan(t[0].evaluate(e))
                        }
                        ],
                        min: [Fe, Li(Fe), function(e, t) {
                            return Math.min.apply(Math, t.map((function(t) {
                                return t.evaluate(e)
                            }
                            )))
                        }
                        ],
                        max: [Fe, Li(Fe), function(e, t) {
                            return Math.max.apply(Math, t.map((function(t) {
                                return t.evaluate(e)
                            }
                            )))
                        }
                        ],
                        abs: [Fe, [Fe], function(e, t) {
                            return Math.abs(t[0].evaluate(e))
                        }
                        ],
                        round: [Fe, [Fe], function(e, t) {
                            var i = t[0].evaluate(e);
                            return i < 0 ? -Math.round(-i) : Math.round(i)
                        }
                        ],
                        floor: [Fe, [Fe], function(e, t) {
                            return Math.floor(t[0].evaluate(e))
                        }
                        ],
                        ceil: [Fe, [Fe], function(e, t) {
                            return Math.ceil(t[0].evaluate(e))
                        }
                        ],
                        "filter-==": [Ue, [Ne, je], function(e, t) {
                            var i = t[0]
                              , r = t[1];
                            return e.properties()[i.value] === r.value
                        }
                        ],
                        "filter-id-==": [Ue, [je], function(e, t) {
                            var i = t[0];
                            return e.id() === i.value
                        }
                        ],
                        "filter-type-==": [Ue, [Ne], function(e, t) {
                            var i = t[0];
                            return e.geometryType() === i.value
                        }
                        ],
                        "filter-<": [Ue, [Ne, je], function(e, t) {
                            var i = t[0]
                              , r = t[1]
                              , n = e.properties()[i.value]
                              , a = r.value;
                            return typeof n == typeof a && n < a
                        }
                        ],
                        "filter-id-<": [Ue, [je], function(e, t) {
                            var i = t[0]
                              , r = e.id()
                              , n = i.value;
                            return typeof r == typeof n && r < n
                        }
                        ],
                        "filter->": [Ue, [Ne, je], function(e, t) {
                            var i = t[0]
                              , r = t[1]
                              , n = e.properties()[i.value]
                              , a = r.value;
                            return typeof n == typeof a && n > a
                        }
                        ],
                        "filter-id->": [Ue, [je], function(e, t) {
                            var i = t[0]
                              , r = e.id()
                              , n = i.value;
                            return typeof r == typeof n && r > n
                        }
                        ],
                        "filter-<=": [Ue, [Ne, je], function(e, t) {
                            var i = t[0]
                              , r = t[1]
                              , n = e.properties()[i.value]
                              , a = r.value;
                            return typeof n == typeof a && n <= a
                        }
                        ],
                        "filter-id-<=": [Ue, [je], function(e, t) {
                            var i = t[0]
                              , r = e.id()
                              , n = i.value;
                            return typeof r == typeof n && r <= n
                        }
                        ],
                        "filter->=": [Ue, [Ne, je], function(e, t) {
                            var i = t[0]
                              , r = t[1]
                              , n = e.properties()[i.value]
                              , a = r.value;
                            return typeof n == typeof a && n >= a
                        }
                        ],
                        "filter-id->=": [Ue, [je], function(e, t) {
                            var i = t[0]
                              , r = e.id()
                              , n = i.value;
                            return typeof r == typeof n && r >= n
                        }
                        ],
                        "filter-has": [Ue, [je], function(e, t) {
                            return t[0].value in e.properties()
                        }
                        ],
                        "filter-has-id": [Ue, [], function(e) {
                            return null !== e.id() && void 0 !== e.id()
                        }
                        ],
                        "filter-type-in": [Ue, [Ze(Ne)], function(e, t) {
                            return t[0].value.indexOf(e.geometryType()) >= 0
                        }
                        ],
                        "filter-id-in": [Ue, [Ze(je)], function(e, t) {
                            return t[0].value.indexOf(e.id()) >= 0
                        }
                        ],
                        "filter-in-small": [Ue, [Ne, Ze(je)], function(e, t) {
                            var i = t[0];
                            return t[1].value.indexOf(e.properties()[i.value]) >= 0
                        }
                        ],
                        "filter-in-large": [Ue, [Ne, Ze(je)], function(e, t) {
                            var i = t[0]
                              , r = t[1];
                            return function(e, t, i, r) {
                                for (; i <= r; ) {
                                    var n = i + r >> 1;
                                    if (t[n] === e)
                                        return !0;
                                    t[n] > e ? r = n - 1 : i = n + 1
                                }
                                return !1
                            }(e.properties()[i.value], r.value, 0, r.value.length - 1)
                        }
                        ],
                        all: {
                            type: Ue,
                            overloads: [[[Ue, Ue], function(e, t) {
                                var i = t[1];
                                return t[0].evaluate(e) && i.evaluate(e)
                            }
                            ], [Li(Ue), function(e, t) {
                                for (var i = 0, r = t; i < r.length; i += 1)
                                    if (!r[i].evaluate(e))
                                        return !1;
                                return !0
                            }
                            ]]
                        },
                        any: {
                            type: Ue,
                            overloads: [[[Ue, Ue], function(e, t) {
                                var i = t[1];
                                return t[0].evaluate(e) || i.evaluate(e)
                            }
                            ], [Li(Ue), function(e, t) {
                                for (var i = 0, r = t; i < r.length; i += 1)
                                    if (r[i].evaluate(e))
                                        return !0;
                                return !1
                            }
                            ]]
                        },
                        "!": [Ue, [Ue], function(e, t) {
                            return !t[0].evaluate(e)
                        }
                        ],
                        "is-supported-script": [Ue, [Ne], function(e, t) {
                            var i = e.globals && e.globals.isSupportedScript;
                            return !i || i(t[0].evaluate(e))
                        }
                        ],
                        upcase: [Ne, [Ne], function(e, t) {
                            return t[0].evaluate(e).toUpperCase()
                        }
                        ],
                        downcase: [Ne, [Ne], function(e, t) {
                            return t[0].evaluate(e).toLowerCase()
                        }
                        ],
                        concat: [Ne, Li(je), function(e, t) {
                            return t.map((function(t) {
                                return lt(t.evaluate(e))
                            }
                            )).join("")
                        }
                        ],
                        "resolved-locale": [Ne, [He], function(e, t) {
                            return t[0].evaluate(e).resolvedLocale()
                        }
                        ]
                    });
                    var Hi = function(e, t) {
                        this.expression = e,
                        this._warningHistory = {},
                        this._evaluator = new yt,
                        this._defaultValue = t ? function(e) {
                            return "color" === e.type && Bi(e.default) ? new et(0,0,0,0) : "color" === e.type ? et.parse(e.default) || null : void 0 === e.default ? null : e.default
                        }(t) : null,
                        this._enumValues = t && "enum" === t.type ? t.values : null
                    };
                    function qi(e) {
                        return Array.isArray(e) && e.length > 0 && "string" == typeof e[0] && e[0]in Ei
                    }
                    function Wi(e, t) {
                        var i = new Vt(Ei,[],t ? function(e) {
                            var t = {
                                color: Ve,
                                string: Ne,
                                number: Fe,
                                enum: Ne,
                                boolean: Ue,
                                formatted: qe,
                                resolvedImage: We
                            };
                            return "array" === e.type ? Ze(t[e.value] || je, e.length) : t[e.type]
                        }(t) : void 0)
                          , r = i.parse(e, void 0, void 0, void 0, t && "string" === t.type ? {
                            typeAnnotation: "coerce"
                        } : void 0);
                        return r ? Ii(new Hi(r,t)) : ki(i.errors)
                    }
                    Hi.prototype.evaluateWithoutErrorHandling = function(e, t, i, r, n, a) {
                        return this._evaluator.globals = e,
                        this._evaluator.feature = t,
                        this._evaluator.featureState = i,
                        this._evaluator.canonical = r,
                        this._evaluator.availableImages = n || null,
                        this._evaluator.formattedSection = a,
                        this.expression.evaluate(this._evaluator)
                    }
                    ,
                    Hi.prototype.evaluate = function(e, t, i, r, n, a) {
                        this._evaluator.globals = e,
                        this._evaluator.feature = t || null,
                        this._evaluator.featureState = i || null,
                        this._evaluator.canonical = r,
                        this._evaluator.availableImages = n || null,
                        this._evaluator.formattedSection = a || null;
                        try {
                            var o = this.expression.evaluate(this._evaluator);
                            if (null == o || "number" == typeof o && o != o)
                                return this._defaultValue;
                            if (this._enumValues && !(o in this._enumValues))
                                throw new ct("Expected value to be one of " + Object.keys(this._enumValues).map((function(e) {
                                    return JSON.stringify(e)
                                }
                                )).join(", ") + ", but found " + JSON.stringify(o) + " instead.");
                            return o
                        } catch (e) {
                            return this._warningHistory[e.message] || (this._warningHistory[e.message] = !0,
                            "undefined" != typeof console && console.warn(e.message)),
                            this._defaultValue
                        }
                    }
                    ;
                    var Zi = function(e, t) {
                        this.kind = e,
                        this._styleExpression = t,
                        this.isStateDependent = "constant" !== e && !Ft(t.expression)
                    };
                    Zi.prototype.evaluateWithoutErrorHandling = function(e, t, i, r, n, a) {
                        return this._styleExpression.evaluateWithoutErrorHandling(e, t, i, r, n, a)
                    }
                    ,
                    Zi.prototype.evaluate = function(e, t, i, r, n, a) {
                        return this._styleExpression.evaluate(e, t, i, r, n, a)
                    }
                    ;
                    var Xi = function(e, t, i, r) {
                        this.kind = e,
                        this.zoomStops = i,
                        this._styleExpression = t,
                        this.isStateDependent = "camera" !== e && !Ft(t.expression),
                        this.interpolationType = r
                    };
                    function Yi(e, t) {
                        if ("error" === (e = Wi(e, t)).result)
                            return e;
                        var i = e.value.expression
                          , r = Bt(i);
                        if (!r && !zi(t))
                            return ki([new Re("","data expressions not supported")]);
                        var n = Nt(i, ["zoom"]);
                        if (!n && !Di(t))
                            return ki([new Re("","zoom expressions not supported")]);
                        var a = function e(t) {
                            var i = null;
                            if (t instanceof li)
                                i = e(t.result);
                            else if (t instanceof si)
                                for (var r = 0, n = t.args; r < n.length && !(i = e(n[r])); r += 1)
                                    ;
                            else
                                (t instanceof jt || t instanceof ai) && t.input instanceof _t && "zoom" === t.input.name && (i = t);
                            return i instanceof Re || t.eachChild((function(t) {
                                var r = e(t);
                                r instanceof Re ? i = r : !i && r ? i = new Re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.') : i && r && i !== r && (i = new Re("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))
                            }
                            )),
                            i
                        }(i);
                        return a || n ? a instanceof Re ? ki([a]) : a instanceof ai && !Ri(t) ? ki([new Re("",'"interpolate" expressions cannot be used with this property')]) : Ii(a ? new Xi(r ? "camera" : "composite",e.value,a.labels,a instanceof ai ? a.interpolation : void 0) : new Zi(r ? "constant" : "source",e.value)) : ki([new Re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])
                    }
                    Xi.prototype.evaluateWithoutErrorHandling = function(e, t, i, r, n, a) {
                        return this._styleExpression.evaluateWithoutErrorHandling(e, t, i, r, n, a)
                    }
                    ,
                    Xi.prototype.evaluate = function(e, t, i, r, n, a) {
                        return this._styleExpression.evaluate(e, t, i, r, n, a)
                    }
                    ,
                    Xi.prototype.interpolationFactor = function(e, t, i) {
                        return this.interpolationType ? ai.interpolationFactor(this.interpolationType, e, t, i) : 0
                    }
                    ;
                    var Ki = function(e, t) {
                        this._parameters = e,
                        this._specification = t,
                        ke(this, function e(t, i) {
                            var r, n, a, o = "color" === i.type, s = t.stops && "object" == typeof t.stops[0][0], l = s || !(s || void 0 !== t.property), u = t.type || (Ri(i) ? "exponential" : "interval");
                            if (o && ((t = ke({}, t)).stops && (t.stops = t.stops.map((function(e) {
                                return [e[0], et.parse(e[1])]
                            }
                            ))),
                            t.default = et.parse(t.default ? t.default : i.default)),
                            t.colorSpace && "rgb" !== t.colorSpace && !ni[t.colorSpace])
                                throw new Error("Unknown color space: " + t.colorSpace);
                            if ("exponential" === u)
                                r = Gi;
                            else if ("interval" === u)
                                r = Vi;
                            else if ("categorical" === u) {
                                r = Ui,
                                n = Object.create(null);
                                for (var c = 0, h = t.stops; c < h.length; c += 1) {
                                    var p = h[c];
                                    n[p[0]] = p[1]
                                }
                                a = typeof t.stops[0][0]
                            } else {
                                if ("identity" !== u)
                                    throw new Error('Unknown function type "' + u + '"');
                                r = ji
                            }
                            if (s) {
                                for (var f = {}, d = [], m = 0; m < t.stops.length; m++) {
                                    var v = t.stops[m]
                                      , g = v[0].zoom;
                                    void 0 === f[g] && (f[g] = {
                                        zoom: g,
                                        type: t.type,
                                        property: t.property,
                                        default: t.default,
                                        stops: []
                                    },
                                    d.push(g)),
                                    f[g].stops.push([v[0].value, v[1]])
                                }
                                for (var y = [], _ = 0, x = d; _ < x.length; _ += 1) {
                                    var b = x[_];
                                    y.push([f[b].zoom, e(f[b], i)])
                                }
                                var w = {
                                    name: "linear"
                                };
                                return {
                                    kind: "composite",
                                    interpolationType: w,
                                    interpolationFactor: ai.interpolationFactor.bind(void 0, w),
                                    zoomStops: y.map((function(e) {
                                        return e[0]
                                    }
                                    )),
                                    evaluate: function(e, r) {
                                        var n = e.zoom;
                                        return Gi({
                                            stops: y,
                                            base: t.base
                                        }, i, n).evaluate(n, r)
                                    }
                                }
                            }
                            if (l) {
                                var S = "exponential" === u ? {
                                    name: "exponential",
                                    base: void 0 !== t.base ? t.base : 1
                                } : null;
                                return {
                                    kind: "camera",
                                    interpolationType: S,
                                    interpolationFactor: ai.interpolationFactor.bind(void 0, S),
                                    zoomStops: t.stops.map((function(e) {
                                        return e[0]
                                    }
                                    )),
                                    evaluate: function(e) {
                                        return r(t, i, e.zoom, n, a)
                                    }
                                }
                            }
                            return {
                                kind: "source",
                                evaluate: function(e, o) {
                                    var s = o && o.properties ? o.properties[t.property] : void 0;
                                    return void 0 === s ? Ni(t.default, i.default) : r(t, i, s, n, a)
                                }
                            }
                        }(this._parameters, this._specification))
                    };
                    function Ji(e) {
                        var t = e.key
                          , i = e.value
                          , r = e.valueSpec || {}
                          , n = e.objectElementValidators || {}
                          , a = e.style
                          , o = e.styleSpec
                          , s = []
                          , l = Oi(i);
                        if ("object" !== l)
                            return [new Le(t,i,"object expected, " + l + " found")];
                        for (var u in i) {
                            var c = u.split(".")[0]
                              , h = r[c] || r["*"]
                              , p = void 0;
                            if (n[c])
                                p = n[c];
                            else if (r[c])
                                p = wr;
                            else if (n["*"])
                                p = n["*"];
                            else {
                                if (!r["*"]) {
                                    s.push(new Le(t,i[u],'unknown property "' + u + '"'));
                                    continue
                                }
                                p = wr
                            }
                            s = s.concat(p({
                                key: (t ? t + "." : t) + u,
                                value: i[u],
                                valueSpec: h,
                                style: a,
                                styleSpec: o,
                                object: i,
                                objectKey: u
                            }, i))
                        }
                        for (var f in r)
                            n[f] || r[f].required && void 0 === r[f].default && void 0 === i[f] && s.push(new Le(t,i,'missing required property "' + f + '"'));
                        return s
                    }
                    function Qi(e) {
                        var t = e.value
                          , i = e.valueSpec
                          , r = e.style
                          , n = e.styleSpec
                          , a = e.key
                          , o = e.arrayElementValidator || wr;
                        if ("array" !== Oi(t))
                            return [new Le(a,t,"array expected, " + Oi(t) + " found")];
                        if (i.length && t.length !== i.length)
                            return [new Le(a,t,"array length " + i.length + " expected, length " + t.length + " found")];
                        if (i["min-length"] && t.length < i["min-length"])
                            return [new Le(a,t,"array length at least " + i["min-length"] + " expected, length " + t.length + " found")];
                        var s = {
                            type: i.value,
                            values: i.values
                        };
                        n.$version < 7 && (s.function = i.function),
                        "object" === Oi(i.value) && (s = i.value);
                        for (var l = [], u = 0; u < t.length; u++)
                            l = l.concat(o({
                                array: t,
                                arrayIndex: u,
                                value: t[u],
                                valueSpec: s,
                                style: r,
                                styleSpec: n,
                                key: a + "[" + u + "]"
                            }));
                        return l
                    }
                    function $i(e) {
                        var t = e.key
                          , i = e.value
                          , r = e.valueSpec
                          , n = Oi(i);
                        return "number" === n && i != i && (n = "NaN"),
                        "number" !== n ? [new Le(t,i,"number expected, " + n + " found")] : "minimum"in r && i < r.minimum ? [new Le(t,i,i + " is less than the minimum value " + r.minimum)] : "maximum"in r && i > r.maximum ? [new Le(t,i,i + " is greater than the maximum value " + r.maximum)] : []
                    }
                    function er(e) {
                        var t, i, r, n = e.valueSpec, a = ze(e.value.type), o = {}, s = "categorical" !== a && void 0 === e.value.property, l = !s, u = "array" === Oi(e.value.stops) && "array" === Oi(e.value.stops[0]) && "object" === Oi(e.value.stops[0][0]), c = Ji({
                            key: e.key,
                            value: e.value,
                            valueSpec: e.styleSpec.function,
                            style: e.style,
                            styleSpec: e.styleSpec,
                            objectElementValidators: {
                                stops: function(e) {
                                    if ("identity" === a)
                                        return [new Le(e.key,e.value,'identity function may not have a "stops" property')];
                                    var t = []
                                      , i = e.value;
                                    return t = t.concat(Qi({
                                        key: e.key,
                                        value: i,
                                        valueSpec: e.valueSpec,
                                        style: e.style,
                                        styleSpec: e.styleSpec,
                                        arrayElementValidator: h
                                    })),
                                    "array" === Oi(i) && 0 === i.length && t.push(new Le(e.key,i,"array must have at least one stop")),
                                    t
                                },
                                default: function(e) {
                                    return wr({
                                        key: e.key,
                                        value: e.value,
                                        valueSpec: n,
                                        style: e.style,
                                        styleSpec: e.styleSpec
                                    })
                                }
                            }
                        });
                        return "identity" === a && s && c.push(new Le(e.key,e.value,'missing required property "property"')),
                        "identity" === a || e.value.stops || c.push(new Le(e.key,e.value,'missing required property "stops"')),
                        "exponential" === a && e.valueSpec.expression && !Ri(e.valueSpec) && c.push(new Le(e.key,e.value,"exponential functions not supported")),
                        e.styleSpec.$version >= 8 && (l && !zi(e.valueSpec) ? c.push(new Le(e.key,e.value,"property functions not supported")) : s && !Di(e.valueSpec) && c.push(new Le(e.key,e.value,"zoom functions not supported"))),
                        "categorical" !== a && !u || void 0 !== e.value.property || c.push(new Le(e.key,e.value,'"property" property is required')),
                        c;
                        function h(e) {
                            var t = []
                              , a = e.value
                              , s = e.key;
                            if ("array" !== Oi(a))
                                return [new Le(s,a,"array expected, " + Oi(a) + " found")];
                            if (2 !== a.length)
                                return [new Le(s,a,"array length 2 expected, length " + a.length + " found")];
                            if (u) {
                                if ("object" !== Oi(a[0]))
                                    return [new Le(s,a,"object expected, " + Oi(a[0]) + " found")];
                                if (void 0 === a[0].zoom)
                                    return [new Le(s,a,"object stop key must have zoom")];
                                if (void 0 === a[0].value)
                                    return [new Le(s,a,"object stop key must have value")];
                                if (r && r > ze(a[0].zoom))
                                    return [new Le(s,a[0].zoom,"stop zoom values must appear in ascending order")];
                                ze(a[0].zoom) !== r && (r = ze(a[0].zoom),
                                i = void 0,
                                o = {}),
                                t = t.concat(Ji({
                                    key: s + "[0]",
                                    value: a[0],
                                    valueSpec: {
                                        zoom: {}
                                    },
                                    style: e.style,
                                    styleSpec: e.styleSpec,
                                    objectElementValidators: {
                                        zoom: $i,
                                        value: p
                                    }
                                }))
                            } else
                                t = t.concat(p({
                                    key: s + "[0]",
                                    value: a[0],
                                    valueSpec: {},
                                    style: e.style,
                                    styleSpec: e.styleSpec
                                }, a));
                            return qi(De(a[1])) ? t.concat([new Le(s + "[1]",a[1],"expressions are not allowed in function stops.")]) : t.concat(wr({
                                key: s + "[1]",
                                value: a[1],
                                valueSpec: n,
                                style: e.style,
                                styleSpec: e.styleSpec
                            }))
                        }
                        function p(e, r) {
                            var s = Oi(e.value)
                              , l = ze(e.value)
                              , u = null !== e.value ? e.value : r;
                            if (t) {
                                if (s !== t)
                                    return [new Le(e.key,u,s + " stop domain type must match previous stop domain type " + t)]
                            } else
                                t = s;
                            if ("number" !== s && "string" !== s && "boolean" !== s)
                                return [new Le(e.key,u,"stop domain value must be a number, string, or boolean")];
                            if ("number" !== s && "categorical" !== a) {
                                var c = "number expected, " + s + " found";
                                return zi(n) && void 0 === a && (c += '\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),
                                [new Le(e.key,u,c)]
                            }
                            return "categorical" !== a || "number" !== s || isFinite(l) && Math.floor(l) === l ? "categorical" !== a && "number" === s && void 0 !== i && l < i ? [new Le(e.key,u,"stop domain values must appear in ascending order")] : (i = l,
                            "categorical" === a && l in o ? [new Le(e.key,u,"stop domain values must be unique")] : (o[l] = !0,
                            [])) : [new Le(e.key,u,"integer expected, found " + l)]
                        }
                    }
                    function tr(e) {
                        var t = ("property" === e.expressionContext ? Yi : Wi)(De(e.value), e.valueSpec);
                        if ("error" === t.result)
                            return t.value.map((function(t) {
                                return new Le("" + e.key + t.key,e.value,t.message)
                            }
                            ));
                        var i = t.value.expression || t.value._styleExpression.expression;
                        if ("property" === e.expressionContext && "text-font" === e.propertyKey && !i.outputDefined())
                            return [new Le(e.key,e.value,'Invalid data expression for "' + e.propertyKey + '". Output values must be contained as literals within the expression.')];
                        if ("property" === e.expressionContext && "layout" === e.propertyType && !Ft(i))
                            return [new Le(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];
                        if ("filter" === e.expressionContext && !Ft(i))
                            return [new Le(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];
                        if (e.expressionContext && 0 === e.expressionContext.indexOf("cluster")) {
                            if (!Nt(i, ["zoom", "feature-state"]))
                                return [new Le(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];
                            if ("cluster-initial" === e.expressionContext && !Bt(i))
                                return [new Le(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]
                        }
                        return []
                    }
                    function ir(e) {
                        var t = e.key
                          , i = e.value
                          , r = e.valueSpec
                          , n = [];
                        return Array.isArray(r.values) ? -1 === r.values.indexOf(ze(i)) && n.push(new Le(t,i,"expected one of [" + r.values.join(", ") + "], " + JSON.stringify(i) + " found")) : -1 === Object.keys(r.values).indexOf(ze(i)) && n.push(new Le(t,i,"expected one of [" + Object.keys(r.values).join(", ") + "], " + JSON.stringify(i) + " found")),
                        n
                    }
                    function rr(e) {
                        if (!0 === e || !1 === e)
                            return !0;
                        if (!Array.isArray(e) || 0 === e.length)
                            return !1;
                        switch (e[0]) {
                        case "has":
                            return e.length >= 2 && "$id" !== e[1] && "$type" !== e[1];
                        case "in":
                            return e.length >= 3 && ("string" != typeof e[1] || Array.isArray(e[2]));
                        case "!in":
                        case "!has":
                        case "none":
                            return !1;
                        case "==":
                        case "!=":
                        case ">":
                        case ">=":
                        case "<":
                        case "<=":
                            return 3 !== e.length || Array.isArray(e[1]) || Array.isArray(e[2]);
                        case "any":
                        case "all":
                            for (var t = 0, i = e.slice(1); t < i.length; t += 1) {
                                var r = i[t];
                                if (!rr(r) && "boolean" != typeof r)
                                    return !1
                            }
                            return !0;
                        default:
                            return !0
                        }
                    }
                    Ki.deserialize = function(e) {
                        return new Ki(e._parameters,e._specification)
                    }
                    ,
                    Ki.serialize = function(e) {
                        return {
                            _parameters: e._parameters,
                            _specification: e._specification
                        }
                    }
                    ;
                    var nr = {
                        type: "boolean",
                        default: !1,
                        transition: !1,
                        "property-type": "data-driven",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        }
                    };
                    function ar(e) {
                        if (null == e)
                            return {
                                filter: function() {
                                    return !0
                                },
                                needGeometry: !1
                            };
                        rr(e) || (e = sr(e));
                        var t = Wi(e, nr);
                        if ("error" === t.result)
                            throw new Error(t.value.map((function(e) {
                                return e.key + ": " + e.message
                            }
                            )).join(", "));
                        return {
                            filter: function(e, i, r) {
                                return t.value.evaluate(e, i, {}, r)
                            },
                            needGeometry: function e(t) {
                                if (!Array.isArray(t))
                                    return !1;
                                if ("within" === t[0])
                                    return !0;
                                for (var i = 1; i < t.length; i++)
                                    if (e(t[i]))
                                        return !0;
                                return !1
                            }(e)
                        }
                    }
                    function or(e, t) {
                        return e < t ? -1 : e > t ? 1 : 0
                    }
                    function sr(e) {
                        if (!e)
                            return !0;
                        var t, i = e[0];
                        return e.length <= 1 ? "any" !== i : "==" === i ? lr(e[1], e[2], "==") : "!=" === i ? hr(lr(e[1], e[2], "==")) : "<" === i || ">" === i || "<=" === i || ">=" === i ? lr(e[1], e[2], i) : "any" === i ? (t = e.slice(1),
                        ["any"].concat(t.map(sr))) : "all" === i ? ["all"].concat(e.slice(1).map(sr)) : "none" === i ? ["all"].concat(e.slice(1).map(sr).map(hr)) : "in" === i ? ur(e[1], e.slice(2)) : "!in" === i ? hr(ur(e[1], e.slice(2))) : "has" === i ? cr(e[1]) : "!has" === i ? hr(cr(e[1])) : "within" !== i || e
                    }
                    function lr(e, t, i) {
                        switch (e) {
                        case "$type":
                            return ["filter-type-" + i, t];
                        case "$id":
                            return ["filter-id-" + i, t];
                        default:
                            return ["filter-" + i, e, t]
                        }
                    }
                    function ur(e, t) {
                        if (0 === t.length)
                            return !1;
                        switch (e) {
                        case "$type":
                            return ["filter-type-in", ["literal", t]];
                        case "$id":
                            return ["filter-id-in", ["literal", t]];
                        default:
                            return t.length > 200 && !t.some((function(e) {
                                return typeof e != typeof t[0]
                            }
                            )) ? ["filter-in-large", e, ["literal", t.sort(or)]] : ["filter-in-small", e, ["literal", t]]
                        }
                    }
                    function cr(e) {
                        switch (e) {
                        case "$type":
                            return !0;
                        case "$id":
                            return ["filter-has-id"];
                        default:
                            return ["filter-has", e]
                        }
                    }
                    function hr(e) {
                        return ["!", e]
                    }
                    function pr(e) {
                        return rr(De(e.value)) ? tr(ke({}, e, {
                            expressionContext: "filter",
                            valueSpec: {
                                value: "boolean"
                            }
                        })) : function e(t) {
                            var i = t.value
                              , r = t.key;
                            if ("array" !== Oi(i))
                                return [new Le(r,i,"array expected, " + Oi(i) + " found")];
                            var n, a = t.styleSpec, o = [];
                            if (i.length < 1)
                                return [new Le(r,i,"filter array must have at least 1 element")];
                            switch (o = o.concat(ir({
                                key: r + "[0]",
                                value: i[0],
                                valueSpec: a.filter_operator,
                                style: t.style,
                                styleSpec: t.styleSpec
                            })),
                            ze(i[0])) {
                            case "<":
                            case "<=":
                            case ">":
                            case ">=":
                                i.length >= 2 && "$type" === ze(i[1]) && o.push(new Le(r,i,'"$type" cannot be use with operator "' + i[0] + '"'));
                            case "==":
                            case "!=":
                                3 !== i.length && o.push(new Le(r,i,'filter array for operator "' + i[0] + '" must have 3 elements'));
                            case "in":
                            case "!in":
                                i.length >= 2 && "string" !== (n = Oi(i[1])) && o.push(new Le(r + "[1]",i[1],"string expected, " + n + " found"));
                                for (var s = 2; s < i.length; s++)
                                    n = Oi(i[s]),
                                    "$type" === ze(i[1]) ? o = o.concat(ir({
                                        key: r + "[" + s + "]",
                                        value: i[s],
                                        valueSpec: a.geometry_type,
                                        style: t.style,
                                        styleSpec: t.styleSpec
                                    })) : "string" !== n && "number" !== n && "boolean" !== n && o.push(new Le(r + "[" + s + "]",i[s],"string, number, or boolean expected, " + n + " found"));
                                break;
                            case "any":
                            case "all":
                            case "none":
                                for (var l = 1; l < i.length; l++)
                                    o = o.concat(e({
                                        key: r + "[" + l + "]",
                                        value: i[l],
                                        style: t.style,
                                        styleSpec: t.styleSpec
                                    }));
                                break;
                            case "has":
                            case "!has":
                                n = Oi(i[1]),
                                2 !== i.length ? o.push(new Le(r,i,'filter array for "' + i[0] + '" operator must have 2 elements')) : "string" !== n && o.push(new Le(r + "[1]",i[1],"string expected, " + n + " found"));
                                break;
                            case "within":
                                n = Oi(i[1]),
                                2 !== i.length ? o.push(new Le(r,i,'filter array for "' + i[0] + '" operator must have 2 elements')) : "object" !== n && o.push(new Le(r + "[1]",i[1],"object expected, " + n + " found"))
                            }
                            return o
                        }(e)
                    }
                    function fr(e, t) {
                        var i = e.key
                          , r = e.style
                          , n = e.styleSpec
                          , a = e.value
                          , o = e.objectKey
                          , s = n[t + "_" + e.layerType];
                        if (!s)
                            return [];
                        var l = o.match(/^(.*)-transition$/);
                        if ("paint" === t && l && s[l[1]] && s[l[1]].transition)
                            return wr({
                                key: i,
                                value: a,
                                valueSpec: n.transition,
                                style: r,
                                styleSpec: n
                            });
                        var u, c = e.valueSpec || s[o];
                        if (!c)
                            return [new Le(i,a,'unknown property "' + o + '"')];
                        if ("string" === Oi(a) && zi(c) && !c.tokens && (u = /^{([^}]+)}$/.exec(a)))
                            return [new Le(i,a,'"' + o + '" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": ' + JSON.stringify(u[1]) + " }`.")];
                        var h = [];
                        return "symbol" === e.layerType && ("text-field" === o && r && !r.glyphs && h.push(new Le(i,a,'use of "text-field" requires a style "glyphs" property')),
                        "text-font" === o && Bi(De(a)) && "identity" === ze(a.type) && h.push(new Le(i,a,'"text-font" does not support identity functions'))),
                        h.concat(wr({
                            key: e.key,
                            value: a,
                            valueSpec: c,
                            style: r,
                            styleSpec: n,
                            expressionContext: "property",
                            propertyType: t,
                            propertyKey: o
                        }))
                    }
                    function dr(e) {
                        return fr(e, "paint")
                    }
                    function mr(e) {
                        return fr(e, "layout")
                    }
                    function vr(e) {
                        var t = []
                          , i = e.value
                          , r = e.key
                          , n = e.style
                          , a = e.styleSpec;
                        i.type || i.ref || t.push(new Le(r,i,'either "type" or "ref" is required'));
                        var o, s = ze(i.type), l = ze(i.ref);
                        if (i.id)
                            for (var u = ze(i.id), c = 0; c < e.arrayIndex; c++) {
                                var h = n.layers[c];
                                ze(h.id) === u && t.push(new Le(r,i.id,'duplicate layer id "' + i.id + '", previously used at line ' + h.id.__line__))
                            }
                        if ("ref"in i)
                            ["type", "source", "source-layer", "filter", "layout"].forEach((function(e) {
                                e in i && t.push(new Le(r,i[e],'"' + e + '" is prohibited for ref layers'))
                            }
                            )),
                            n.layers.forEach((function(e) {
                                ze(e.id) === l && (o = e)
                            }
                            )),
                            o ? o.ref ? t.push(new Le(r,i.ref,"ref cannot reference another ref layer")) : s = ze(o.type) : t.push(new Le(r,i.ref,'ref layer "' + l + '" not found'));
                        else if ("background" !== s)
                            if (i.source) {
                                var p = n.sources && n.sources[i.source]
                                  , f = p && ze(p.type);
                                p ? "vector" === f && "raster" === s ? t.push(new Le(r,i.source,'layer "' + i.id + '" requires a raster source')) : "raster" === f && "raster" !== s ? t.push(new Le(r,i.source,'layer "' + i.id + '" requires a vector source')) : "vector" !== f || i["source-layer"] ? "raster-dem" === f && "hillshade" !== s ? t.push(new Le(r,i.source,"raster-dem source can only be used with layer type 'hillshade'.")) : "line" !== s || !i.paint || !i.paint["line-gradient"] || "geojson" === f && p.lineMetrics || t.push(new Le(r,i,'layer "' + i.id + '" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')) : t.push(new Le(r,i,'layer "' + i.id + '" must specify a "source-layer"')) : t.push(new Le(r,i.source,'source "' + i.source + '" not found'))
                            } else
                                t.push(new Le(r,i,'missing required property "source"'));
                        return t = t.concat(Ji({
                            key: r,
                            value: i,
                            valueSpec: a.layer,
                            style: e.style,
                            styleSpec: e.styleSpec,
                            objectElementValidators: {
                                "*": function() {
                                    return []
                                },
                                type: function() {
                                    return wr({
                                        key: r + ".type",
                                        value: i.type,
                                        valueSpec: a.layer.type,
                                        style: e.style,
                                        styleSpec: e.styleSpec,
                                        object: i,
                                        objectKey: "type"
                                    })
                                },
                                filter: pr,
                                layout: function(e) {
                                    return Ji({
                                        layer: i,
                                        key: e.key,
                                        value: e.value,
                                        style: e.style,
                                        styleSpec: e.styleSpec,
                                        objectElementValidators: {
                                            "*": function(e) {
                                                return mr(ke({
                                                    layerType: s
                                                }, e))
                                            }
                                        }
                                    })
                                },
                                paint: function(e) {
                                    return Ji({
                                        layer: i,
                                        key: e.key,
                                        value: e.value,
                                        style: e.style,
                                        styleSpec: e.styleSpec,
                                        objectElementValidators: {
                                            "*": function(e) {
                                                return dr(ke({
                                                    layerType: s
                                                }, e))
                                            }
                                        }
                                    })
                                }
                            }
                        }))
                    }
                    function gr(e) {
                        var t = e.value
                          , i = e.key
                          , r = Oi(t);
                        return "string" !== r ? [new Le(i,t,"string expected, " + r + " found")] : []
                    }
                    var yr = {
                        promoteId: function(e) {
                            var t = e.key
                              , i = e.value;
                            if ("string" === Oi(i))
                                return gr({
                                    key: t,
                                    value: i
                                });
                            var r = [];
                            for (var n in i)
                                r.push.apply(r, gr({
                                    key: t + "." + n,
                                    value: i[n]
                                }));
                            return r
                        }
                    };
                    function _r(e) {
                        var t = e.value
                          , i = e.key
                          , r = e.styleSpec
                          , n = e.style;
                        if (!t.type)
                            return [new Le(i,t,'"type" is required')];
                        var a, o = ze(t.type);
                        switch (o) {
                        case "vector":
                        case "raster":
                        case "raster-dem":
                            return Ji({
                                key: i,
                                value: t,
                                valueSpec: r["source_" + o.replace("-", "_")],
                                style: e.style,
                                styleSpec: r,
                                objectElementValidators: yr
                            });
                        case "geojson":
                            if (a = Ji({
                                key: i,
                                value: t,
                                valueSpec: r.source_geojson,
                                style: n,
                                styleSpec: r,
                                objectElementValidators: yr
                            }),
                            t.cluster)
                                for (var s in t.clusterProperties) {
                                    var l = t.clusterProperties[s]
                                      , u = l[0]
                                      , c = "string" == typeof u ? [u, ["accumulated"], ["get", s]] : u;
                                    a.push.apply(a, tr({
                                        key: i + "." + s + ".map",
                                        value: l[1],
                                        expressionContext: "cluster-map"
                                    })),
                                    a.push.apply(a, tr({
                                        key: i + "." + s + ".reduce",
                                        value: c,
                                        expressionContext: "cluster-reduce"
                                    }))
                                }
                            return a;
                        case "video":
                            return Ji({
                                key: i,
                                value: t,
                                valueSpec: r.source_video,
                                style: n,
                                styleSpec: r
                            });
                        case "image":
                            return Ji({
                                key: i,
                                value: t,
                                valueSpec: r.source_image,
                                style: n,
                                styleSpec: r
                            });
                        case "canvas":
                            return [new Le(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];
                        default:
                            return ir({
                                key: i + ".type",
                                value: t.type,
                                valueSpec: {
                                    values: ["vector", "raster", "raster-dem", "geojson", "video", "image"]
                                },
                                style: n,
                                styleSpec: r
                            })
                        }
                    }
                    function xr(e) {
                        var t = e.value
                          , i = e.styleSpec
                          , r = i.light
                          , n = e.style
                          , a = []
                          , o = Oi(t);
                        if (void 0 === t)
                            return a;
                        if ("object" !== o)
                            return a.concat([new Le("light",t,"object expected, " + o + " found")]);
                        for (var s in t) {
                            var l = s.match(/^(.*)-transition$/);
                            a = a.concat(l && r[l[1]] && r[l[1]].transition ? wr({
                                key: s,
                                value: t[s],
                                valueSpec: i.transition,
                                style: n,
                                styleSpec: i
                            }) : r[s] ? wr({
                                key: s,
                                value: t[s],
                                valueSpec: r[s],
                                style: n,
                                styleSpec: i
                            }) : [new Le(s,t[s],'unknown property "' + s + '"')])
                        }
                        return a
                    }
                    var br = {
                        "*": function() {
                            return []
                        },
                        array: Qi,
                        boolean: function(e) {
                            var t = e.value
                              , i = e.key
                              , r = Oi(t);
                            return "boolean" !== r ? [new Le(i,t,"boolean expected, " + r + " found")] : []
                        },
                        number: $i,
                        color: function(e) {
                            var t = e.key
                              , i = e.value
                              , r = Oi(i);
                            return "string" !== r ? [new Le(t,i,"color expected, " + r + " found")] : null === $e(i) ? [new Le(t,i,'color expected, "' + i + '" found')] : []
                        },
                        constants: Ie,
                        enum: ir,
                        filter: pr,
                        function: er,
                        layer: vr,
                        object: Ji,
                        source: _r,
                        light: xr,
                        string: gr,
                        formatted: function(e) {
                            return 0 === gr(e).length ? [] : tr(e)
                        },
                        resolvedImage: function(e) {
                            return 0 === gr(e).length ? [] : tr(e)
                        }
                    };
                    function wr(e) {
                        var t = e.value
                          , i = e.valueSpec
                          , r = e.styleSpec;
                        return i.expression && Bi(ze(t)) ? er(e) : i.expression && qi(De(t)) ? tr(e) : i.type && br[i.type] ? br[i.type](e) : Ji(ke({}, e, {
                            valueSpec: i.type ? r[i.type] : i
                        }))
                    }
                    function Sr(e) {
                        var t = e.value
                          , i = e.key
                          , r = gr(e);
                        return r.length || (-1 === t.indexOf("{fontstack}") && r.push(new Le(i,t,'"glyphs" url must include a "{fontstack}" token')),
                        -1 === t.indexOf("{range}") && r.push(new Le(i,t,'"glyphs" url must include a "{range}" token'))),
                        r
                    }
                    function Mr(e, t) {
                        void 0 === t && (t = Ce);
                        var i = [];
                        return i = i.concat(wr({
                            key: "",
                            value: e,
                            valueSpec: t.$root,
                            styleSpec: t,
                            style: e,
                            objectElementValidators: {
                                glyphs: Sr,
                                "*": function() {
                                    return []
                                }
                            }
                        })),
                        e.constants && (i = i.concat(Ie({
                            key: "constants",
                            value: e.constants,
                            style: e,
                            styleSpec: t
                        }))),
                        Tr(i)
                    }
                    function Tr(e) {
                        return [].concat(e).sort((function(e, t) {
                            return e.line - t.line
                        }
                        ))
                    }
                    function Er(e) {
                        return function() {
                            for (var t = [], i = arguments.length; i--; )
                                t[i] = arguments[i];
                            return Tr(e.apply(this, t))
                        }
                    }
                    Mr.source = Er(_r),
                    Mr.light = Er(xr),
                    Mr.layer = Er(vr),
                    Mr.filter = Er(pr),
                    Mr.paintProperty = Er(dr),
                    Mr.layoutProperty = Er(mr);
                    var Ar = Mr
                      , Pr = Ar.light
                      , Cr = Ar.paintProperty
                      , Lr = Ar.layoutProperty;
                    function Ir(e, t) {
                        var i = !1;
                        if (t && t.length)
                            for (var r = 0, n = t; r < n.length; r += 1)
                                e.fire(new Ae(new Error(n[r].message))),
                                i = !0;
                        return i
                    }
                    var kr = zr;
                    function zr(e, t, i) {
                        var r = this.cells = [];
                        if (e instanceof ArrayBuffer) {
                            this.arrayBuffer = e;
                            var n = new Int32Array(this.arrayBuffer);
                            e = n[0],
                            this.d = (t = n[1]) + 2 * (i = n[2]);
                            for (var a = 0; a < this.d * this.d; a++) {
                                var o = n[3 + a]
                                  , s = n[3 + a + 1];
                                r.push(o === s ? null : n.subarray(o, s))
                            }
                            var l = n[3 + r.length + 1];
                            this.keys = n.subarray(n[3 + r.length], l),
                            this.bboxes = n.subarray(l),
                            this.insert = this._insertReadonly
                        } else {
                            this.d = t + 2 * i;
                            for (var u = 0; u < this.d * this.d; u++)
                                r.push([]);
                            this.keys = [],
                            this.bboxes = []
                        }
                        this.n = t,
                        this.extent = e,
                        this.padding = i,
                        this.scale = t / e,
                        this.uid = 0;
                        var c = i / t * e;
                        this.min = -c,
                        this.max = e + c
                    }
                    zr.prototype.insert = function(e, t, i, r, n) {
                        this._forEachCell(t, i, r, n, this._insertCell, this.uid++),
                        this.keys.push(e),
                        this.bboxes.push(t),
                        this.bboxes.push(i),
                        this.bboxes.push(r),
                        this.bboxes.push(n)
                    }
                    ,
                    zr.prototype._insertReadonly = function() {
                        throw "Cannot insert into a GridIndex created from an ArrayBuffer."
                    }
                    ,
                    zr.prototype._insertCell = function(e, t, i, r, n, a) {
                        this.cells[n].push(a)
                    }
                    ,
                    zr.prototype.query = function(e, t, i, r, n) {
                        var a = this.min
                          , o = this.max;
                        if (e <= a && t <= a && o <= i && o <= r && !n)
                            return Array.prototype.slice.call(this.keys);
                        var s = [];
                        return this._forEachCell(e, t, i, r, this._queryCell, s, {}, n),
                        s
                    }
                    ,
                    zr.prototype._queryCell = function(e, t, i, r, n, a, o, s) {
                        var l = this.cells[n];
                        if (null !== l)
                            for (var u = this.keys, c = this.bboxes, h = 0; h < l.length; h++) {
                                var p = l[h];
                                if (void 0 === o[p]) {
                                    var f = 4 * p;
                                    (s ? s(c[f + 0], c[f + 1], c[f + 2], c[f + 3]) : e <= c[f + 2] && t <= c[f + 3] && i >= c[f + 0] && r >= c[f + 1]) ? (o[p] = !0,
                                    a.push(u[p])) : o[p] = !1
                                }
                            }
                    }
                    ,
                    zr.prototype._forEachCell = function(e, t, i, r, n, a, o, s) {
                        for (var l = this._convertToCellCoord(e), u = this._convertToCellCoord(t), c = this._convertToCellCoord(i), h = this._convertToCellCoord(r), p = l; p <= c; p++)
                            for (var f = u; f <= h; f++) {
                                var d = this.d * f + p;
                                if ((!s || s(this._convertFromCellCoord(p), this._convertFromCellCoord(f), this._convertFromCellCoord(p + 1), this._convertFromCellCoord(f + 1))) && n.call(this, e, t, i, r, d, a, o, s))
                                    return
                            }
                    }
                    ,
                    zr.prototype._convertFromCellCoord = function(e) {
                        return (e - this.padding) / this.scale
                    }
                    ,
                    zr.prototype._convertToCellCoord = function(e) {
                        return Math.max(0, Math.min(this.d - 1, Math.floor(e * this.scale) + this.padding))
                    }
                    ,
                    zr.prototype.toArrayBuffer = function() {
                        if (this.arrayBuffer)
                            return this.arrayBuffer;
                        for (var e = this.cells, t = 3 + this.cells.length + 1 + 1, i = 0, r = 0; r < this.cells.length; r++)
                            i += this.cells[r].length;
                        var n = new Int32Array(t + i + this.keys.length + this.bboxes.length);
                        n[0] = this.extent,
                        n[1] = this.n,
                        n[2] = this.padding;
                        for (var a = t, o = 0; o < e.length; o++) {
                            var s = e[o];
                            n[3 + o] = a,
                            n.set(s, a),
                            a += s.length
                        }
                        return n[3 + e.length] = a,
                        n.set(this.keys, a),
                        n[3 + e.length + 1] = a += this.keys.length,
                        n.set(this.bboxes, a),
                        a += this.bboxes.length,
                        n.buffer
                    }
                    ;
                    var Dr = o.ImageData
                      , Rr = o.ImageBitmap
                      , Or = {};
                    function Br(e, t, i) {
                        void 0 === i && (i = {}),
                        Object.defineProperty(t, "_classRegistryKey", {
                            value: e,
                            writeable: !1
                        }),
                        Or[e] = {
                            klass: t,
                            omit: i.omit || [],
                            shallow: i.shallow || []
                        }
                    }
                    for (var Fr in Br("Object", Object),
                    kr.serialize = function(e, t) {
                        var i = e.toArrayBuffer();
                        return t && t.push(i),
                        {
                            buffer: i
                        }
                    }
                    ,
                    kr.deserialize = function(e) {
                        return new kr(e.buffer)
                    }
                    ,
                    Br("Grid", kr),
                    Br("Color", et),
                    Br("Error", Error),
                    Br("ResolvedImage", nt),
                    Br("StylePropertyFunction", Ki),
                    Br("StyleExpression", Hi, {
                        omit: ["_evaluator"]
                    }),
                    Br("ZoomDependentExpression", Xi),
                    Br("ZoomConstantExpression", Zi),
                    Br("CompoundExpression", _t, {
                        omit: ["_evaluate"]
                    }),
                    Ei)
                        Ei[Fr]._classRegistryKey || Br("Expression_" + Fr, Ei[Fr]);
                    function Nr(e) {
                        return e && "undefined" != typeof ArrayBuffer && (e instanceof ArrayBuffer || e.constructor && "ArrayBuffer" === e.constructor.name)
                    }
                    function Ur(e) {
                        return Rr && e instanceof Rr
                    }
                    function Vr(e, t) {
                        if (null == e || "boolean" == typeof e || "number" == typeof e || "string" == typeof e || e instanceof Boolean || e instanceof Number || e instanceof String || e instanceof Date || e instanceof RegExp)
                            return e;
                        if (Nr(e) || Ur(e))
                            return t && t.push(e),
                            e;
                        if (ArrayBuffer.isView(e)) {
                            var i = e;
                            return t && t.push(i.buffer),
                            i
                        }
                        if (e instanceof Dr)
                            return t && t.push(e.data.buffer),
                            e;
                        if (Array.isArray(e)) {
                            for (var r = [], n = 0, a = e; n < a.length; n += 1)
                                r.push(Vr(a[n], t));
                            return r
                        }
                        if ("object" == typeof e) {
                            var o = e.constructor
                              , s = o._classRegistryKey;
                            if (!s)
                                throw new Error("can't serialize object of unregistered class");
                            var l = o.serialize ? o.serialize(e, t) : {};
                            if (!o.serialize) {
                                for (var u in e)
                                    if (e.hasOwnProperty(u) && !(Or[s].omit.indexOf(u) >= 0)) {
                                        var c = e[u];
                                        l[u] = Or[s].shallow.indexOf(u) >= 0 ? c : Vr(c, t)
                                    }
                                e instanceof Error && (l.message = e.message)
                            }
                            if (l.$name)
                                throw new Error("$name property is reserved for worker serialization logic.");
                            return "Object" !== s && (l.$name = s),
                            l
                        }
                        throw new Error("can't serialize object of type " + typeof e)
                    }
                    function Gr(e) {
                        if (null == e || "boolean" == typeof e || "number" == typeof e || "string" == typeof e || e instanceof Boolean || e instanceof Number || e instanceof String || e instanceof Date || e instanceof RegExp || Nr(e) || Ur(e) || ArrayBuffer.isView(e) || e instanceof Dr)
                            return e;
                        if (Array.isArray(e))
                            return e.map(Gr);
                        if ("object" == typeof e) {
                            var t = e.$name || "Object"
                              , i = Or[t].klass;
                            if (!i)
                                throw new Error("can't deserialize unregistered class " + t);
                            if (i.deserialize)
                                return i.deserialize(e);
                            for (var r = Object.create(i.prototype), n = 0, a = Object.keys(e); n < a.length; n += 1) {
                                var o = a[n];
                                if ("$name" !== o) {
                                    var s = e[o];
                                    r[o] = Or[t].shallow.indexOf(o) >= 0 ? s : Gr(s)
                                }
                            }
                            return r
                        }
                        throw new Error("can't deserialize object of type " + typeof e)
                    }
                    var jr = function() {
                        this.first = !0
                    };
                    jr.prototype.update = function(e, t) {
                        var i = Math.floor(e);
                        return this.first ? (this.first = !1,
                        this.lastIntegerZoom = i,
                        this.lastIntegerZoomTime = 0,
                        this.lastZoom = e,
                        this.lastFloorZoom = i,
                        !0) : (this.lastFloorZoom > i ? (this.lastIntegerZoom = i + 1,
                        this.lastIntegerZoomTime = t) : this.lastFloorZoom < i && (this.lastIntegerZoom = i,
                        this.lastIntegerZoomTime = t),
                        e !== this.lastZoom && (this.lastZoom = e,
                        this.lastFloorZoom = i,
                        !0))
                    }
                    ;
                    var Hr = {
                        "Latin-1 Supplement": function(e) {
                            return e >= 128 && e <= 255
                        },
                        Arabic: function(e) {
                            return e >= 1536 && e <= 1791
                        },
                        "Arabic Supplement": function(e) {
                            return e >= 1872 && e <= 1919
                        },
                        "Arabic Extended-A": function(e) {
                            return e >= 2208 && e <= 2303
                        },
                        "Hangul Jamo": function(e) {
                            return e >= 4352 && e <= 4607
                        },
                        "Unified Canadian Aboriginal Syllabics": function(e) {
                            return e >= 5120 && e <= 5759
                        },
                        Khmer: function(e) {
                            return e >= 6016 && e <= 6143
                        },
                        "Unified Canadian Aboriginal Syllabics Extended": function(e) {
                            return e >= 6320 && e <= 6399
                        },
                        "General Punctuation": function(e) {
                            return e >= 8192 && e <= 8303
                        },
                        "Letterlike Symbols": function(e) {
                            return e >= 8448 && e <= 8527
                        },
                        "Number Forms": function(e) {
                            return e >= 8528 && e <= 8591
                        },
                        "Miscellaneous Technical": function(e) {
                            return e >= 8960 && e <= 9215
                        },
                        "Control Pictures": function(e) {
                            return e >= 9216 && e <= 9279
                        },
                        "Optical Character Recognition": function(e) {
                            return e >= 9280 && e <= 9311
                        },
                        "Enclosed Alphanumerics": function(e) {
                            return e >= 9312 && e <= 9471
                        },
                        "Geometric Shapes": function(e) {
                            return e >= 9632 && e <= 9727
                        },
                        "Miscellaneous Symbols": function(e) {
                            return e >= 9728 && e <= 9983
                        },
                        "Miscellaneous Symbols and Arrows": function(e) {
                            return e >= 11008 && e <= 11263
                        },
                        "CJK Radicals Supplement": function(e) {
                            return e >= 11904 && e <= 12031
                        },
                        "Kangxi Radicals": function(e) {
                            return e >= 12032 && e <= 12255
                        },
                        "Ideographic Description Characters": function(e) {
                            return e >= 12272 && e <= 12287
                        },
                        "CJK Symbols and Punctuation": function(e) {
                            return e >= 12288 && e <= 12351
                        },
                        Hiragana: function(e) {
                            return e >= 12352 && e <= 12447
                        },
                        Katakana: function(e) {
                            return e >= 12448 && e <= 12543
                        },
                        Bopomofo: function(e) {
                            return e >= 12544 && e <= 12591
                        },
                        "Hangul Compatibility Jamo": function(e) {
                            return e >= 12592 && e <= 12687
                        },
                        Kanbun: function(e) {
                            return e >= 12688 && e <= 12703
                        },
                        "Bopomofo Extended": function(e) {
                            return e >= 12704 && e <= 12735
                        },
                        "CJK Strokes": function(e) {
                            return e >= 12736 && e <= 12783
                        },
                        "Katakana Phonetic Extensions": function(e) {
                            return e >= 12784 && e <= 12799
                        },
                        "Enclosed CJK Letters and Months": function(e) {
                            return e >= 12800 && e <= 13055
                        },
                        "CJK Compatibility": function(e) {
                            return e >= 13056 && e <= 13311
                        },
                        "CJK Unified Ideographs Extension A": function(e) {
                            return e >= 13312 && e <= 19903
                        },
                        "Yijing Hexagram Symbols": function(e) {
                            return e >= 19904 && e <= 19967
                        },
                        "CJK Unified Ideographs": function(e) {
                            return e >= 19968 && e <= 40959
                        },
                        "Yi Syllables": function(e) {
                            return e >= 40960 && e <= 42127
                        },
                        "Yi Radicals": function(e) {
                            return e >= 42128 && e <= 42191
                        },
                        "Hangul Jamo Extended-A": function(e) {
                            return e >= 43360 && e <= 43391
                        },
                        "Hangul Syllables": function(e) {
                            return e >= 44032 && e <= 55215
                        },
                        "Hangul Jamo Extended-B": function(e) {
                            return e >= 55216 && e <= 55295
                        },
                        "Private Use Area": function(e) {
                            return e >= 57344 && e <= 63743
                        },
                        "CJK Compatibility Ideographs": function(e) {
                            return e >= 63744 && e <= 64255
                        },
                        "Arabic Presentation Forms-A": function(e) {
                            return e >= 64336 && e <= 65023
                        },
                        "Vertical Forms": function(e) {
                            return e >= 65040 && e <= 65055
                        },
                        "CJK Compatibility Forms": function(e) {
                            return e >= 65072 && e <= 65103
                        },
                        "Small Form Variants": function(e) {
                            return e >= 65104 && e <= 65135
                        },
                        "Arabic Presentation Forms-B": function(e) {
                            return e >= 65136 && e <= 65279
                        },
                        "Halfwidth and Fullwidth Forms": function(e) {
                            return e >= 65280 && e <= 65519
                        }
                    };
                    function qr(e) {
                        for (var t = 0, i = e; t < i.length; t += 1)
                            if (Wr(i[t].charCodeAt(0)))
                                return !0;
                        return !1
                    }
                    function Wr(e) {
                        return !(746 !== e && 747 !== e && (e < 4352 || !(Hr["Bopomofo Extended"](e) || Hr.Bopomofo(e) || Hr["CJK Compatibility Forms"](e) && !(e >= 65097 && e <= 65103) || Hr["CJK Compatibility Ideographs"](e) || Hr["CJK Compatibility"](e) || Hr["CJK Radicals Supplement"](e) || Hr["CJK Strokes"](e) || !(!Hr["CJK Symbols and Punctuation"](e) || e >= 12296 && e <= 12305 || e >= 12308 && e <= 12319 || 12336 === e) || Hr["CJK Unified Ideographs Extension A"](e) || Hr["CJK Unified Ideographs"](e) || Hr["Enclosed CJK Letters and Months"](e) || Hr["Hangul Compatibility Jamo"](e) || Hr["Hangul Jamo Extended-A"](e) || Hr["Hangul Jamo Extended-B"](e) || Hr["Hangul Jamo"](e) || Hr["Hangul Syllables"](e) || Hr.Hiragana(e) || Hr["Ideographic Description Characters"](e) || Hr.Kanbun(e) || Hr["Kangxi Radicals"](e) || Hr["Katakana Phonetic Extensions"](e) || Hr.Katakana(e) && 12540 !== e || !(!Hr["Halfwidth and Fullwidth Forms"](e) || 65288 === e || 65289 === e || 65293 === e || e >= 65306 && e <= 65310 || 65339 === e || 65341 === e || 65343 === e || e >= 65371 && e <= 65503 || 65507 === e || e >= 65512 && e <= 65519) || !(!Hr["Small Form Variants"](e) || e >= 65112 && e <= 65118 || e >= 65123 && e <= 65126) || Hr["Unified Canadian Aboriginal Syllabics"](e) || Hr["Unified Canadian Aboriginal Syllabics Extended"](e) || Hr["Vertical Forms"](e) || Hr["Yijing Hexagram Symbols"](e) || Hr["Yi Syllables"](e) || Hr["Yi Radicals"](e))))
                    }
                    function Zr(e) {
                        return !(Wr(e) || function(e) {
                            return !!(Hr["Latin-1 Supplement"](e) && (167 === e || 169 === e || 174 === e || 177 === e || 188 === e || 189 === e || 190 === e || 215 === e || 247 === e) || Hr["General Punctuation"](e) && (8214 === e || 8224 === e || 8225 === e || 8240 === e || 8241 === e || 8251 === e || 8252 === e || 8258 === e || 8263 === e || 8264 === e || 8265 === e || 8273 === e) || Hr["Letterlike Symbols"](e) || Hr["Number Forms"](e) || Hr["Miscellaneous Technical"](e) && (e >= 8960 && e <= 8967 || e >= 8972 && e <= 8991 || e >= 8996 && e <= 9e3 || 9003 === e || e >= 9085 && e <= 9114 || e >= 9150 && e <= 9165 || 9167 === e || e >= 9169 && e <= 9179 || e >= 9186 && e <= 9215) || Hr["Control Pictures"](e) && 9251 !== e || Hr["Optical Character Recognition"](e) || Hr["Enclosed Alphanumerics"](e) || Hr["Geometric Shapes"](e) || Hr["Miscellaneous Symbols"](e) && !(e >= 9754 && e <= 9759) || Hr["Miscellaneous Symbols and Arrows"](e) && (e >= 11026 && e <= 11055 || e >= 11088 && e <= 11097 || e >= 11192 && e <= 11243) || Hr["CJK Symbols and Punctuation"](e) || Hr.Katakana(e) || Hr["Private Use Area"](e) || Hr["CJK Compatibility Forms"](e) || Hr["Small Form Variants"](e) || Hr["Halfwidth and Fullwidth Forms"](e) || 8734 === e || 8756 === e || 8757 === e || e >= 9984 && e <= 10087 || e >= 10102 && e <= 10131 || 65532 === e || 65533 === e)
                        }(e))
                    }
                    function Xr(e) {
                        return e >= 1424 && e <= 2303 || Hr["Arabic Presentation Forms-A"](e) || Hr["Arabic Presentation Forms-B"](e)
                    }
                    function Yr(e, t) {
                        return !(!t && Xr(e) || e >= 2304 && e <= 3583 || e >= 3840 && e <= 4255 || Hr.Khmer(e))
                    }
                    function Kr(e) {
                        for (var t = 0, i = e; t < i.length; t += 1)
                            if (Xr(i[t].charCodeAt(0)))
                                return !0;
                        return !1
                    }
                    var Jr = null
                      , Qr = "unavailable"
                      , $r = null
                      , en = function(e) {
                        e && "string" == typeof e && e.indexOf("NetworkError") > -1 && (Qr = "error"),
                        Jr && Jr(e)
                    };
                    function tn() {
                        rn.fire(new Ee("pluginStateChange",{
                            pluginStatus: Qr,
                            pluginURL: $r
                        }))
                    }
                    var rn = new Pe
                      , nn = function() {
                        return Qr
                    }
                      , an = function() {
                        if ("deferred" !== Qr || !$r)
                            throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");
                        Qr = "loading",
                        tn(),
                        $r && xe({
                            url: $r
                        }, (function(e) {
                            e ? en(e) : (Qr = "loaded",
                            tn())
                        }
                        ))
                    }
                      , on = {
                        applyArabicShaping: null,
                        processBidirectionalText: null,
                        processStyledBidirectionalText: null,
                        isLoaded: function() {
                            return "loaded" === Qr || null != on.applyArabicShaping
                        },
                        isLoading: function() {
                            return "loading" === Qr
                        },
                        setState: function(e) {
                            Qr = e.pluginStatus,
                            $r = e.pluginURL
                        },
                        isParsed: function() {
                            return null != on.applyArabicShaping && null != on.processBidirectionalText && null != on.processStyledBidirectionalText
                        },
                        getPluginURL: function() {
                            return $r
                        }
                    }
                      , sn = function(e, t) {
                        this.zoom = e,
                        t ? (this.now = t.now,
                        this.fadeDuration = t.fadeDuration,
                        this.zoomHistory = t.zoomHistory,
                        this.transition = t.transition) : (this.now = 0,
                        this.fadeDuration = 0,
                        this.zoomHistory = new jr,
                        this.transition = {})
                    };
                    sn.prototype.isSupportedScript = function(e) {
                        return function(e, t) {
                            for (var i = 0, r = e; i < r.length; i += 1)
                                if (!Yr(r[i].charCodeAt(0), t))
                                    return !1;
                            return !0
                        }(e, on.isLoaded())
                    }
                    ,
                    sn.prototype.crossFadingFactor = function() {
                        return 0 === this.fadeDuration ? 1 : Math.min((this.now - this.zoomHistory.lastIntegerZoomTime) / this.fadeDuration, 1)
                    }
                    ,
                    sn.prototype.getCrossfadeParameters = function() {
                        var e = this.zoom
                          , t = e - Math.floor(e)
                          , i = this.crossFadingFactor();
                        return e > this.zoomHistory.lastIntegerZoom ? {
                            fromScale: 2,
                            toScale: 1,
                            t: t + (1 - t) * i
                        } : {
                            fromScale: .5,
                            toScale: 1,
                            t: 1 - (1 - i) * t
                        }
                    }
                    ;
                    var ln = function(e, t) {
                        this.property = e,
                        this.value = t,
                        this.expression = function(e, t) {
                            if (Bi(e))
                                return new Ki(e,t);
                            if (qi(e)) {
                                var i = Yi(e, t);
                                if ("error" === i.result)
                                    throw new Error(i.value.map((function(e) {
                                        return e.key + ": " + e.message
                                    }
                                    )).join(", "));
                                return i.value
                            }
                            var r = e;
                            return "string" == typeof e && "color" === t.type && (r = et.parse(e)),
                            {
                                kind: "constant",
                                evaluate: function() {
                                    return r
                                }
                            }
                        }(void 0 === t ? e.specification.default : t, e.specification)
                    };
                    ln.prototype.isDataDriven = function() {
                        return "source" === this.expression.kind || "composite" === this.expression.kind
                    }
                    ,
                    ln.prototype.possiblyEvaluate = function(e, t, i) {
                        return this.property.possiblyEvaluate(this, e, t, i)
                    }
                    ;
                    var un = function(e) {
                        this.property = e,
                        this.value = new ln(e,void 0)
                    };
                    un.prototype.transitioned = function(e, t) {
                        return new hn(this.property,this.value,t,p({}, e.transition, this.transition),e.now)
                    }
                    ,
                    un.prototype.untransitioned = function() {
                        return new hn(this.property,this.value,null,{},0)
                    }
                    ;
                    var cn = function(e) {
                        this._properties = e,
                        this._values = Object.create(e.defaultTransitionablePropertyValues)
                    };
                    cn.prototype.getValue = function(e) {
                        return b(this._values[e].value.value)
                    }
                    ,
                    cn.prototype.setValue = function(e, t) {
                        this._values.hasOwnProperty(e) || (this._values[e] = new un(this._values[e].property)),
                        this._values[e].value = new ln(this._values[e].property,null === t ? void 0 : b(t))
                    }
                    ,
                    cn.prototype.getTransition = function(e) {
                        return b(this._values[e].transition)
                    }
                    ,
                    cn.prototype.setTransition = function(e, t) {
                        this._values.hasOwnProperty(e) || (this._values[e] = new un(this._values[e].property)),
                        this._values[e].transition = b(t) || void 0
                    }
                    ,
                    cn.prototype.serialize = function() {
                        for (var e = {}, t = 0, i = Object.keys(this._values); t < i.length; t += 1) {
                            var r = i[t]
                              , n = this.getValue(r);
                            void 0 !== n && (e[r] = n);
                            var a = this.getTransition(r);
                            void 0 !== a && (e[r + "-transition"] = a)
                        }
                        return e
                    }
                    ,
                    cn.prototype.transitioned = function(e, t) {
                        for (var i = new pn(this._properties), r = 0, n = Object.keys(this._values); r < n.length; r += 1) {
                            var a = n[r];
                            i._values[a] = this._values[a].transitioned(e, t._values[a])
                        }
                        return i
                    }
                    ,
                    cn.prototype.untransitioned = function() {
                        for (var e = new pn(this._properties), t = 0, i = Object.keys(this._values); t < i.length; t += 1) {
                            var r = i[t];
                            e._values[r] = this._values[r].untransitioned()
                        }
                        return e
                    }
                    ;
                    var hn = function(e, t, i, r, n) {
                        this.property = e,
                        this.value = t,
                        this.begin = n + r.delay || 0,
                        this.end = this.begin + r.duration || 0,
                        e.specification.transition && (r.delay || r.duration) && (this.prior = i)
                    };
                    hn.prototype.possiblyEvaluate = function(e, t, i) {
                        var r = e.now || 0
                          , n = this.value.possiblyEvaluate(e, t, i)
                          , a = this.prior;
                        if (a) {
                            if (r > this.end)
                                return this.prior = null,
                                n;
                            if (this.value.isDataDriven())
                                return this.prior = null,
                                n;
                            if (r < this.begin)
                                return a.possiblyEvaluate(e, t, i);
                            var o = (r - this.begin) / (this.end - this.begin);
                            return this.property.interpolate(a.possiblyEvaluate(e, t, i), n, function(e) {
                                if (e <= 0)
                                    return 0;
                                if (e >= 1)
                                    return 1;
                                var t = e * e
                                  , i = t * e;
                                return 4 * (e < .5 ? i : 3 * (e - t) + i - .75)
                            }(o))
                        }
                        return n
                    }
                    ;
                    var pn = function(e) {
                        this._properties = e,
                        this._values = Object.create(e.defaultTransitioningPropertyValues)
                    };
                    pn.prototype.possiblyEvaluate = function(e, t, i) {
                        for (var r = new mn(this._properties), n = 0, a = Object.keys(this._values); n < a.length; n += 1) {
                            var o = a[n];
                            r._values[o] = this._values[o].possiblyEvaluate(e, t, i)
                        }
                        return r
                    }
                    ,
                    pn.prototype.hasTransition = function() {
                        for (var e = 0, t = Object.keys(this._values); e < t.length; e += 1)
                            if (this._values[t[e]].prior)
                                return !0;
                        return !1
                    }
                    ;
                    var fn = function(e) {
                        this._properties = e,
                        this._values = Object.create(e.defaultPropertyValues)
                    };
                    fn.prototype.getValue = function(e) {
                        return b(this._values[e].value)
                    }
                    ,
                    fn.prototype.setValue = function(e, t) {
                        this._values[e] = new ln(this._values[e].property,null === t ? void 0 : b(t))
                    }
                    ,
                    fn.prototype.serialize = function() {
                        for (var e = {}, t = 0, i = Object.keys(this._values); t < i.length; t += 1) {
                            var r = i[t]
                              , n = this.getValue(r);
                            void 0 !== n && (e[r] = n)
                        }
                        return e
                    }
                    ,
                    fn.prototype.possiblyEvaluate = function(e, t, i) {
                        for (var r = new mn(this._properties), n = 0, a = Object.keys(this._values); n < a.length; n += 1) {
                            var o = a[n];
                            r._values[o] = this._values[o].possiblyEvaluate(e, t, i)
                        }
                        return r
                    }
                    ;
                    var dn = function(e, t, i) {
                        this.property = e,
                        this.value = t,
                        this.parameters = i
                    };
                    dn.prototype.isConstant = function() {
                        return "constant" === this.value.kind
                    }
                    ,
                    dn.prototype.constantOr = function(e) {
                        return "constant" === this.value.kind ? this.value.value : e
                    }
                    ,
                    dn.prototype.evaluate = function(e, t, i, r) {
                        return this.property.evaluate(this.value, this.parameters, e, t, i, r)
                    }
                    ;
                    var mn = function(e) {
                        this._properties = e,
                        this._values = Object.create(e.defaultPossiblyEvaluatedValues)
                    };
                    mn.prototype.get = function(e) {
                        return this._values[e]
                    }
                    ;
                    var vn = function(e) {
                        this.specification = e
                    };
                    vn.prototype.possiblyEvaluate = function(e, t) {
                        return e.expression.evaluate(t)
                    }
                    ,
                    vn.prototype.interpolate = function(e, t, i) {
                        var r = qt[this.specification.type];
                        return r ? r(e, t, i) : e
                    }
                    ;
                    var gn = function(e, t) {
                        this.specification = e,
                        this.overrides = t
                    };
                    gn.prototype.possiblyEvaluate = function(e, t, i, r) {
                        return new dn(this,"constant" === e.expression.kind || "camera" === e.expression.kind ? {
                            kind: "constant",
                            value: e.expression.evaluate(t, null, {}, i, r)
                        } : e.expression,t)
                    }
                    ,
                    gn.prototype.interpolate = function(e, t, i) {
                        if ("constant" !== e.value.kind || "constant" !== t.value.kind)
                            return e;
                        if (void 0 === e.value.value || void 0 === t.value.value)
                            return new dn(this,{
                                kind: "constant",
                                value: void 0
                            },e.parameters);
                        var r = qt[this.specification.type];
                        return r ? new dn(this,{
                            kind: "constant",
                            value: r(e.value.value, t.value.value, i)
                        },e.parameters) : e
                    }
                    ,
                    gn.prototype.evaluate = function(e, t, i, r, n, a) {
                        return "constant" === e.kind ? e.value : e.evaluate(t, i, r, n, a)
                    }
                    ;
                    var yn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.possiblyEvaluate = function(e, t, i, r) {
                            if (void 0 === e.value)
                                return new dn(this,{
                                    kind: "constant",
                                    value: void 0
                                },t);
                            if ("constant" === e.expression.kind) {
                                var n = e.expression.evaluate(t, null, {}, i, r)
                                  , a = "resolvedImage" === e.property.specification.type && "string" != typeof n ? n.name : n
                                  , o = this._calculate(a, a, a, t);
                                return new dn(this,{
                                    kind: "constant",
                                    value: o
                                },t)
                            }
                            if ("camera" === e.expression.kind) {
                                var s = this._calculate(e.expression.evaluate({
                                    zoom: t.zoom - 1
                                }), e.expression.evaluate({
                                    zoom: t.zoom
                                }), e.expression.evaluate({
                                    zoom: t.zoom + 1
                                }), t);
                                return new dn(this,{
                                    kind: "constant",
                                    value: s
                                },t)
                            }
                            return new dn(this,e.expression,t)
                        }
                        ,
                        t.prototype.evaluate = function(e, t, i, r, n, a) {
                            if ("source" === e.kind) {
                                var o = e.evaluate(t, i, r, n, a);
                                return this._calculate(o, o, o, t)
                            }
                            return "composite" === e.kind ? this._calculate(e.evaluate({
                                zoom: Math.floor(t.zoom) - 1
                            }, i, r), e.evaluate({
                                zoom: Math.floor(t.zoom)
                            }, i, r), e.evaluate({
                                zoom: Math.floor(t.zoom) + 1
                            }, i, r), t) : e.value
                        }
                        ,
                        t.prototype._calculate = function(e, t, i, r) {
                            return r.zoom > r.zoomHistory.lastIntegerZoom ? {
                                from: e,
                                to: t
                            } : {
                                from: i,
                                to: t
                            }
                        }
                        ,
                        t.prototype.interpolate = function(e) {
                            return e
                        }
                        ,
                        t
                    }(gn)
                      , _n = function(e) {
                        this.specification = e
                    };
                    _n.prototype.possiblyEvaluate = function(e, t, i, r) {
                        if (void 0 !== e.value) {
                            if ("constant" === e.expression.kind) {
                                var n = e.expression.evaluate(t, null, {}, i, r);
                                return this._calculate(n, n, n, t)
                            }
                            return this._calculate(e.expression.evaluate(new sn(Math.floor(t.zoom - 1),t)), e.expression.evaluate(new sn(Math.floor(t.zoom),t)), e.expression.evaluate(new sn(Math.floor(t.zoom + 1),t)), t)
                        }
                    }
                    ,
                    _n.prototype._calculate = function(e, t, i, r) {
                        return r.zoom > r.zoomHistory.lastIntegerZoom ? {
                            from: e,
                            to: t
                        } : {
                            from: i,
                            to: t
                        }
                    }
                    ,
                    _n.prototype.interpolate = function(e) {
                        return e
                    }
                    ;
                    var xn = function(e) {
                        this.specification = e
                    };
                    xn.prototype.possiblyEvaluate = function(e, t, i, r) {
                        return !!e.expression.evaluate(t, null, {}, i, r)
                    }
                    ,
                    xn.prototype.interpolate = function() {
                        return !1
                    }
                    ;
                    var bn = function(e) {
                        for (var t in this.properties = e,
                        this.defaultPropertyValues = {},
                        this.defaultTransitionablePropertyValues = {},
                        this.defaultTransitioningPropertyValues = {},
                        this.defaultPossiblyEvaluatedValues = {},
                        this.overridableProperties = [],
                        e) {
                            var i = e[t];
                            i.specification.overridable && this.overridableProperties.push(t);
                            var r = this.defaultPropertyValues[t] = new ln(i,void 0)
                              , n = this.defaultTransitionablePropertyValues[t] = new un(i);
                            this.defaultTransitioningPropertyValues[t] = n.untransitioned(),
                            this.defaultPossiblyEvaluatedValues[t] = r.possiblyEvaluate({})
                        }
                    };
                    Br("DataDrivenProperty", gn),
                    Br("DataConstantProperty", vn),
                    Br("CrossFadedDataDrivenProperty", yn),
                    Br("CrossFadedProperty", _n),
                    Br("ColorRampProperty", xn);
                    var wn = function(e) {
                        function t(t, i) {
                            if (e.call(this),
                            this.id = t.id,
                            this.type = t.type,
                            this._featureFilter = {
                                filter: function() {
                                    return !0
                                },
                                needGeometry: !1
                            },
                            "custom" !== t.type && (this.metadata = (t = t).metadata,
                            this.minzoom = t.minzoom,
                            this.maxzoom = t.maxzoom,
                            "background" !== t.type && (this.source = t.source,
                            this.sourceLayer = t["source-layer"],
                            this.filter = t.filter),
                            i.layout && (this._unevaluatedLayout = new fn(i.layout)),
                            i.paint)) {
                                for (var r in this._transitionablePaint = new cn(i.paint),
                                t.paint)
                                    this.setPaintProperty(r, t.paint[r], {
                                        validate: !1
                                    });
                                for (var n in t.layout)
                                    this.setLayoutProperty(n, t.layout[n], {
                                        validate: !1
                                    });
                                this._transitioningPaint = this._transitionablePaint.untransitioned(),
                                this.paint = new mn(i.paint)
                            }
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getCrossfadeParameters = function() {
                            return this._crossfadeParameters
                        }
                        ,
                        t.prototype.getLayoutProperty = function(e) {
                            return "visibility" === e ? this.visibility : this._unevaluatedLayout.getValue(e)
                        }
                        ,
                        t.prototype.setLayoutProperty = function(e, t, i) {
                            void 0 === i && (i = {}),
                            null != t && this._validate(Lr, "layers." + this.id + ".layout." + e, e, t, i) || ("visibility" !== e ? this._unevaluatedLayout.setValue(e, t) : this.visibility = t)
                        }
                        ,
                        t.prototype.getPaintProperty = function(e) {
                            return y(e, "-transition") ? this._transitionablePaint.getTransition(e.slice(0, -"-transition".length)) : this._transitionablePaint.getValue(e)
                        }
                        ,
                        t.prototype.setPaintProperty = function(e, t, i) {
                            if (void 0 === i && (i = {}),
                            null != t && this._validate(Cr, "layers." + this.id + ".paint." + e, e, t, i))
                                return !1;
                            if (y(e, "-transition"))
                                return this._transitionablePaint.setTransition(e.slice(0, -"-transition".length), t || void 0),
                                !1;
                            var r = this._transitionablePaint._values[e]
                              , n = "cross-faded-data-driven" === r.property.specification["property-type"]
                              , a = r.value.isDataDriven()
                              , o = r.value;
                            this._transitionablePaint.setValue(e, t),
                            this._handleSpecialPaintPropertyUpdate(e);
                            var s = this._transitionablePaint._values[e].value;
                            return s.isDataDriven() || a || n || this._handleOverridablePaintPropertyUpdate(e, o, s)
                        }
                        ,
                        t.prototype._handleSpecialPaintPropertyUpdate = function(e) {}
                        ,
                        t.prototype._handleOverridablePaintPropertyUpdate = function(e, t, i) {
                            return !1
                        }
                        ,
                        t.prototype.isHidden = function(e) {
                            return !!(this.minzoom && e < this.minzoom) || !!(this.maxzoom && e >= this.maxzoom) || "none" === this.visibility
                        }
                        ,
                        t.prototype.updateTransitions = function(e) {
                            this._transitioningPaint = this._transitionablePaint.transitioned(e, this._transitioningPaint)
                        }
                        ,
                        t.prototype.hasTransition = function() {
                            return this._transitioningPaint.hasTransition()
                        }
                        ,
                        t.prototype.recalculate = function(e, t) {
                            e.getCrossfadeParameters && (this._crossfadeParameters = e.getCrossfadeParameters()),
                            this._unevaluatedLayout && (this.layout = this._unevaluatedLayout.possiblyEvaluate(e, void 0, t)),
                            this.paint = this._transitioningPaint.possiblyEvaluate(e, void 0, t)
                        }
                        ,
                        t.prototype.serialize = function() {
                            var e = {
                                id: this.id,
                                type: this.type,
                                source: this.source,
                                "source-layer": this.sourceLayer,
                                metadata: this.metadata,
                                minzoom: this.minzoom,
                                maxzoom: this.maxzoom,
                                filter: this.filter,
                                layout: this._unevaluatedLayout && this._unevaluatedLayout.serialize(),
                                paint: this._transitionablePaint && this._transitionablePaint.serialize()
                            };
                            return this.visibility && (e.layout = e.layout || {},
                            e.layout.visibility = this.visibility),
                            x(e, (function(e, t) {
                                return !(void 0 === e || "layout" === t && !Object.keys(e).length || "paint" === t && !Object.keys(e).length)
                            }
                            ))
                        }
                        ,
                        t.prototype._validate = function(e, t, i, r, n) {
                            return void 0 === n && (n = {}),
                            (!n || !1 !== n.validate) && Ir(this, e.call(Ar, {
                                key: t,
                                layerType: this.type,
                                objectKey: i,
                                value: r,
                                styleSpec: Ce,
                                style: {
                                    glyphs: !0,
                                    sprite: !0
                                }
                            }))
                        }
                        ,
                        t.prototype.is3D = function() {
                            return !1
                        }
                        ,
                        t.prototype.isTileClipped = function() {
                            return !1
                        }
                        ,
                        t.prototype.hasOffscreenPass = function() {
                            return !1
                        }
                        ,
                        t.prototype.resize = function() {}
                        ,
                        t.prototype.isStateDependent = function() {
                            for (var e in this.paint._values) {
                                var t = this.paint.get(e);
                                if (t instanceof dn && zi(t.property.specification) && ("source" === t.value.kind || "composite" === t.value.kind) && t.value.isStateDependent)
                                    return !0
                            }
                            return !1
                        }
                        ,
                        t
                    }(Pe)
                      , Sn = {
                        Int8: Int8Array,
                        Uint8: Uint8Array,
                        Int16: Int16Array,
                        Uint16: Uint16Array,
                        Int32: Int32Array,
                        Uint32: Uint32Array,
                        Float32: Float32Array
                    }
                      , Mn = function(e, t) {
                        this._structArray = e,
                        this._pos1 = t * this.size,
                        this._pos2 = this._pos1 / 2,
                        this._pos4 = this._pos1 / 4,
                        this._pos8 = this._pos1 / 8
                    }
                      , Tn = function() {
                        this.isTransferred = !1,
                        this.capacity = -1,
                        this.resize(0)
                    };
                    function En(e, t) {
                        void 0 === t && (t = 1);
                        var i = 0
                          , r = 0;
                        return {
                            members: e.map((function(e) {
                                var n = Sn[e.type].BYTES_PER_ELEMENT
                                  , a = i = An(i, Math.max(t, n))
                                  , o = e.components || 1;
                                return r = Math.max(r, n),
                                i += n * o,
                                {
                                    name: e.name,
                                    type: e.type,
                                    components: o,
                                    offset: a
                                }
                            }
                            )),
                            size: An(i, Math.max(r, t)),
                            alignment: t
                        }
                    }
                    function An(e, t) {
                        return Math.ceil(e / t) * t
                    }
                    Tn.serialize = function(e, t) {
                        return e._trim(),
                        t && (e.isTransferred = !0,
                        t.push(e.arrayBuffer)),
                        {
                            length: e.length,
                            arrayBuffer: e.arrayBuffer
                        }
                    }
                    ,
                    Tn.deserialize = function(e) {
                        var t = Object.create(this.prototype);
                        return t.arrayBuffer = e.arrayBuffer,
                        t.length = e.length,
                        t.capacity = e.arrayBuffer.byteLength / t.bytesPerElement,
                        t._refreshViews(),
                        t
                    }
                    ,
                    Tn.prototype._trim = function() {
                        this.length !== this.capacity && (this.capacity = this.length,
                        this.arrayBuffer = this.arrayBuffer.slice(0, this.length * this.bytesPerElement),
                        this._refreshViews())
                    }
                    ,
                    Tn.prototype.clear = function() {
                        this.length = 0
                    }
                    ,
                    Tn.prototype.resize = function(e) {
                        this.reserve(e),
                        this.length = e
                    }
                    ,
                    Tn.prototype.reserve = function(e) {
                        if (e > this.capacity) {
                            this.capacity = Math.max(e, Math.floor(5 * this.capacity), 128),
                            this.arrayBuffer = new ArrayBuffer(this.capacity * this.bytesPerElement);
                            var t = this.uint8;
                            this._refreshViews(),
                            t && this.uint8.set(t)
                        }
                    }
                    ,
                    Tn.prototype._refreshViews = function() {
                        throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")
                    }
                    ;
                    var Pn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t) {
                            var i = this.length;
                            return this.resize(i + 1),
                            this.emplace(i, e, t)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i) {
                            var r = 2 * e;
                            return this.int16[r + 0] = t,
                            this.int16[r + 1] = i,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Pn.prototype.bytesPerElement = 4,
                    Br("StructArrayLayout2i4", Pn);
                    var Cn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r) {
                            var n = this.length;
                            return this.resize(n + 1),
                            this.emplace(n, e, t, i, r)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n) {
                            var a = 4 * e;
                            return this.int16[a + 0] = t,
                            this.int16[a + 1] = i,
                            this.int16[a + 2] = r,
                            this.int16[a + 3] = n,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Cn.prototype.bytesPerElement = 8,
                    Br("StructArrayLayout4i8", Cn);
                    var Ln = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r, n, a) {
                            var o = this.length;
                            return this.resize(o + 1),
                            this.emplace(o, e, t, i, r, n, a)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n, a, o) {
                            var s = 6 * e;
                            return this.int16[s + 0] = t,
                            this.int16[s + 1] = i,
                            this.int16[s + 2] = r,
                            this.int16[s + 3] = n,
                            this.int16[s + 4] = a,
                            this.int16[s + 5] = o,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Ln.prototype.bytesPerElement = 12,
                    Br("StructArrayLayout2i4i12", Ln);
                    var In = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r, n, a) {
                            var o = this.length;
                            return this.resize(o + 1),
                            this.emplace(o, e, t, i, r, n, a)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n, a, o) {
                            var s = 4 * e
                              , l = 8 * e;
                            return this.int16[s + 0] = t,
                            this.int16[s + 1] = i,
                            this.uint8[l + 4] = r,
                            this.uint8[l + 5] = n,
                            this.uint8[l + 6] = a,
                            this.uint8[l + 7] = o,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    In.prototype.bytesPerElement = 8,
                    Br("StructArrayLayout2i4ub8", In);
                    var kn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.float32 = new Float32Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t) {
                            var i = this.length;
                            return this.resize(i + 1),
                            this.emplace(i, e, t)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i) {
                            var r = 2 * e;
                            return this.float32[r + 0] = t,
                            this.float32[r + 1] = i,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    kn.prototype.bytesPerElement = 8,
                    Br("StructArrayLayout2f8", kn);
                    var zn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.uint16 = new Uint16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r, n, a, o, s, l, u) {
                            var c = this.length;
                            return this.resize(c + 1),
                            this.emplace(c, e, t, i, r, n, a, o, s, l, u)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n, a, o, s, l, u, c) {
                            var h = 10 * e;
                            return this.uint16[h + 0] = t,
                            this.uint16[h + 1] = i,
                            this.uint16[h + 2] = r,
                            this.uint16[h + 3] = n,
                            this.uint16[h + 4] = a,
                            this.uint16[h + 5] = o,
                            this.uint16[h + 6] = s,
                            this.uint16[h + 7] = l,
                            this.uint16[h + 8] = u,
                            this.uint16[h + 9] = c,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    zn.prototype.bytesPerElement = 20,
                    Br("StructArrayLayout10ui20", zn);
                    var Dn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer),
                            this.uint16 = new Uint16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r, n, a, o, s, l, u, c, h) {
                            var p = this.length;
                            return this.resize(p + 1),
                            this.emplace(p, e, t, i, r, n, a, o, s, l, u, c, h)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n, a, o, s, l, u, c, h, p) {
                            var f = 12 * e;
                            return this.int16[f + 0] = t,
                            this.int16[f + 1] = i,
                            this.int16[f + 2] = r,
                            this.int16[f + 3] = n,
                            this.uint16[f + 4] = a,
                            this.uint16[f + 5] = o,
                            this.uint16[f + 6] = s,
                            this.uint16[f + 7] = l,
                            this.int16[f + 8] = u,
                            this.int16[f + 9] = c,
                            this.int16[f + 10] = h,
                            this.int16[f + 11] = p,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Dn.prototype.bytesPerElement = 24,
                    Br("StructArrayLayout4i4ui4i24", Dn);
                    var Rn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.float32 = new Float32Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i) {
                            var r = this.length;
                            return this.resize(r + 1),
                            this.emplace(r, e, t, i)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r) {
                            var n = 3 * e;
                            return this.float32[n + 0] = t,
                            this.float32[n + 1] = i,
                            this.float32[n + 2] = r,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Rn.prototype.bytesPerElement = 12,
                    Br("StructArrayLayout3f12", Rn);
                    var On = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.uint32 = new Uint32Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e) {
                            var t = this.length;
                            return this.resize(t + 1),
                            this.emplace(t, e)
                        }
                        ,
                        t.prototype.emplace = function(e, t) {
                            return this.uint32[1 * e + 0] = t,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    On.prototype.bytesPerElement = 4,
                    Br("StructArrayLayout1ul4", On);
                    var Bn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer),
                            this.uint32 = new Uint32Array(this.arrayBuffer),
                            this.uint16 = new Uint16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r, n, a, o, s, l) {
                            var u = this.length;
                            return this.resize(u + 1),
                            this.emplace(u, e, t, i, r, n, a, o, s, l)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n, a, o, s, l, u) {
                            var c = 10 * e
                              , h = 5 * e;
                            return this.int16[c + 0] = t,
                            this.int16[c + 1] = i,
                            this.int16[c + 2] = r,
                            this.int16[c + 3] = n,
                            this.int16[c + 4] = a,
                            this.int16[c + 5] = o,
                            this.uint32[h + 3] = s,
                            this.uint16[c + 8] = l,
                            this.uint16[c + 9] = u,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Bn.prototype.bytesPerElement = 20,
                    Br("StructArrayLayout6i1ul2ui20", Bn);
                    var Fn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r, n, a) {
                            var o = this.length;
                            return this.resize(o + 1),
                            this.emplace(o, e, t, i, r, n, a)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n, a, o) {
                            var s = 6 * e;
                            return this.int16[s + 0] = t,
                            this.int16[s + 1] = i,
                            this.int16[s + 2] = r,
                            this.int16[s + 3] = n,
                            this.int16[s + 4] = a,
                            this.int16[s + 5] = o,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Fn.prototype.bytesPerElement = 12,
                    Br("StructArrayLayout2i2i2i12", Fn);
                    var Nn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.float32 = new Float32Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r, n) {
                            var a = this.length;
                            return this.resize(a + 1),
                            this.emplace(a, e, t, i, r, n)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n, a) {
                            var o = 4 * e
                              , s = 8 * e;
                            return this.float32[o + 0] = t,
                            this.float32[o + 1] = i,
                            this.float32[o + 2] = r,
                            this.int16[s + 6] = n,
                            this.int16[s + 7] = a,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Nn.prototype.bytesPerElement = 16,
                    Br("StructArrayLayout2f1f2i16", Nn);
                    var Un = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.float32 = new Float32Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r) {
                            var n = this.length;
                            return this.resize(n + 1),
                            this.emplace(n, e, t, i, r)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n) {
                            var a = 12 * e
                              , o = 3 * e;
                            return this.uint8[a + 0] = t,
                            this.uint8[a + 1] = i,
                            this.float32[o + 1] = r,
                            this.float32[o + 2] = n,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Un.prototype.bytesPerElement = 12,
                    Br("StructArrayLayout2ub2f12", Un);
                    var Vn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.uint16 = new Uint16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i) {
                            var r = this.length;
                            return this.resize(r + 1),
                            this.emplace(r, e, t, i)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r) {
                            var n = 3 * e;
                            return this.uint16[n + 0] = t,
                            this.uint16[n + 1] = i,
                            this.uint16[n + 2] = r,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Vn.prototype.bytesPerElement = 6,
                    Br("StructArrayLayout3ui6", Vn);
                    var Gn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer),
                            this.uint16 = new Uint16Array(this.arrayBuffer),
                            this.uint32 = new Uint32Array(this.arrayBuffer),
                            this.float32 = new Float32Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m, v) {
                            var g = this.length;
                            return this.resize(g + 1),
                            this.emplace(g, e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m, v)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m, v, g) {
                            var y = 24 * e
                              , _ = 12 * e
                              , x = 48 * e;
                            return this.int16[y + 0] = t,
                            this.int16[y + 1] = i,
                            this.uint16[y + 2] = r,
                            this.uint16[y + 3] = n,
                            this.uint32[_ + 2] = a,
                            this.uint32[_ + 3] = o,
                            this.uint32[_ + 4] = s,
                            this.uint16[y + 10] = l,
                            this.uint16[y + 11] = u,
                            this.uint16[y + 12] = c,
                            this.float32[_ + 7] = h,
                            this.float32[_ + 8] = p,
                            this.uint8[x + 36] = f,
                            this.uint8[x + 37] = d,
                            this.uint8[x + 38] = m,
                            this.uint32[_ + 10] = v,
                            this.int16[y + 22] = g,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Gn.prototype.bytesPerElement = 48,
                    Br("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48", Gn);
                    var jn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer),
                            this.uint16 = new Uint16Array(this.arrayBuffer),
                            this.uint32 = new Uint32Array(this.arrayBuffer),
                            this.float32 = new Float32Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m, v, g, y, _, x, b, w, S, M, T, E, A) {
                            var P = this.length;
                            return this.resize(P + 1),
                            this.emplace(P, e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m, v, g, y, _, x, b, w, S, M, T, E, A)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m, v, g, y, _, x, b, w, S, M, T, E, A, P) {
                            var C = 34 * e
                              , L = 17 * e;
                            return this.int16[C + 0] = t,
                            this.int16[C + 1] = i,
                            this.int16[C + 2] = r,
                            this.int16[C + 3] = n,
                            this.int16[C + 4] = a,
                            this.int16[C + 5] = o,
                            this.int16[C + 6] = s,
                            this.int16[C + 7] = l,
                            this.uint16[C + 8] = u,
                            this.uint16[C + 9] = c,
                            this.uint16[C + 10] = h,
                            this.uint16[C + 11] = p,
                            this.uint16[C + 12] = f,
                            this.uint16[C + 13] = d,
                            this.uint16[C + 14] = m,
                            this.uint16[C + 15] = v,
                            this.uint16[C + 16] = g,
                            this.uint16[C + 17] = y,
                            this.uint16[C + 18] = _,
                            this.uint16[C + 19] = x,
                            this.uint16[C + 20] = b,
                            this.uint16[C + 21] = w,
                            this.uint16[C + 22] = S,
                            this.uint32[L + 12] = M,
                            this.float32[L + 13] = T,
                            this.float32[L + 14] = E,
                            this.float32[L + 15] = A,
                            this.float32[L + 16] = P,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    jn.prototype.bytesPerElement = 68,
                    Br("StructArrayLayout8i15ui1ul4f68", jn);
                    var Hn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.float32 = new Float32Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e) {
                            var t = this.length;
                            return this.resize(t + 1),
                            this.emplace(t, e)
                        }
                        ,
                        t.prototype.emplace = function(e, t) {
                            return this.float32[1 * e + 0] = t,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Hn.prototype.bytesPerElement = 4,
                    Br("StructArrayLayout1f4", Hn);
                    var qn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.int16 = new Int16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i) {
                            var r = this.length;
                            return this.resize(r + 1),
                            this.emplace(r, e, t, i)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r) {
                            var n = 3 * e;
                            return this.int16[n + 0] = t,
                            this.int16[n + 1] = i,
                            this.int16[n + 2] = r,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    qn.prototype.bytesPerElement = 6,
                    Br("StructArrayLayout3i6", qn);
                    var Wn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.uint32 = new Uint32Array(this.arrayBuffer),
                            this.uint16 = new Uint16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i) {
                            var r = this.length;
                            return this.resize(r + 1),
                            this.emplace(r, e, t, i)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r) {
                            var n = 4 * e;
                            return this.uint32[2 * e + 0] = t,
                            this.uint16[n + 2] = i,
                            this.uint16[n + 3] = r,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Wn.prototype.bytesPerElement = 8,
                    Br("StructArrayLayout1ul2ui8", Wn);
                    var Zn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.uint16 = new Uint16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t) {
                            var i = this.length;
                            return this.resize(i + 1),
                            this.emplace(i, e, t)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i) {
                            var r = 2 * e;
                            return this.uint16[r + 0] = t,
                            this.uint16[r + 1] = i,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Zn.prototype.bytesPerElement = 4,
                    Br("StructArrayLayout2ui4", Zn);
                    var Xn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.uint16 = new Uint16Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e) {
                            var t = this.length;
                            return this.resize(t + 1),
                            this.emplace(t, e)
                        }
                        ,
                        t.prototype.emplace = function(e, t) {
                            return this.uint16[1 * e + 0] = t,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Xn.prototype.bytesPerElement = 2,
                    Br("StructArrayLayout1ui2", Xn);
                    var Yn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._refreshViews = function() {
                            this.uint8 = new Uint8Array(this.arrayBuffer),
                            this.float32 = new Float32Array(this.arrayBuffer)
                        }
                        ,
                        t.prototype.emplaceBack = function(e, t, i, r) {
                            var n = this.length;
                            return this.resize(n + 1),
                            this.emplace(n, e, t, i, r)
                        }
                        ,
                        t.prototype.emplace = function(e, t, i, r, n) {
                            var a = 4 * e;
                            return this.float32[a + 0] = t,
                            this.float32[a + 1] = i,
                            this.float32[a + 2] = r,
                            this.float32[a + 3] = n,
                            e
                        }
                        ,
                        t
                    }(Tn);
                    Yn.prototype.bytesPerElement = 16,
                    Br("StructArrayLayout4f16", Yn);
                    var Kn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t;
                        var i = {
                            anchorPointX: {
                                configurable: !0
                            },
                            anchorPointY: {
                                configurable: !0
                            },
                            x1: {
                                configurable: !0
                            },
                            y1: {
                                configurable: !0
                            },
                            x2: {
                                configurable: !0
                            },
                            y2: {
                                configurable: !0
                            },
                            featureIndex: {
                                configurable: !0
                            },
                            sourceLayerIndex: {
                                configurable: !0
                            },
                            bucketIndex: {
                                configurable: !0
                            },
                            anchorPoint: {
                                configurable: !0
                            }
                        };
                        return i.anchorPointX.get = function() {
                            return this._structArray.int16[this._pos2 + 0]
                        }
                        ,
                        i.anchorPointY.get = function() {
                            return this._structArray.int16[this._pos2 + 1]
                        }
                        ,
                        i.x1.get = function() {
                            return this._structArray.int16[this._pos2 + 2]
                        }
                        ,
                        i.y1.get = function() {
                            return this._structArray.int16[this._pos2 + 3]
                        }
                        ,
                        i.x2.get = function() {
                            return this._structArray.int16[this._pos2 + 4]
                        }
                        ,
                        i.y2.get = function() {
                            return this._structArray.int16[this._pos2 + 5]
                        }
                        ,
                        i.featureIndex.get = function() {
                            return this._structArray.uint32[this._pos4 + 3]
                        }
                        ,
                        i.sourceLayerIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 8]
                        }
                        ,
                        i.bucketIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 9]
                        }
                        ,
                        i.anchorPoint.get = function() {
                            return new n(this.anchorPointX,this.anchorPointY)
                        }
                        ,
                        Object.defineProperties(t.prototype, i),
                        t
                    }(Mn);
                    Kn.prototype.size = 20;
                    var Jn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.get = function(e) {
                            return new Kn(this,e)
                        }
                        ,
                        t
                    }(Bn);
                    Br("CollisionBoxArray", Jn);
                    var Qn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t;
                        var i = {
                            anchorX: {
                                configurable: !0
                            },
                            anchorY: {
                                configurable: !0
                            },
                            glyphStartIndex: {
                                configurable: !0
                            },
                            numGlyphs: {
                                configurable: !0
                            },
                            vertexStartIndex: {
                                configurable: !0
                            },
                            lineStartIndex: {
                                configurable: !0
                            },
                            lineLength: {
                                configurable: !0
                            },
                            segment: {
                                configurable: !0
                            },
                            lowerSize: {
                                configurable: !0
                            },
                            upperSize: {
                                configurable: !0
                            },
                            lineOffsetX: {
                                configurable: !0
                            },
                            lineOffsetY: {
                                configurable: !0
                            },
                            writingMode: {
                                configurable: !0
                            },
                            placedOrientation: {
                                configurable: !0
                            },
                            hidden: {
                                configurable: !0
                            },
                            crossTileID: {
                                configurable: !0
                            },
                            associatedIconIndex: {
                                configurable: !0
                            }
                        };
                        return i.anchorX.get = function() {
                            return this._structArray.int16[this._pos2 + 0]
                        }
                        ,
                        i.anchorY.get = function() {
                            return this._structArray.int16[this._pos2 + 1]
                        }
                        ,
                        i.glyphStartIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 2]
                        }
                        ,
                        i.numGlyphs.get = function() {
                            return this._structArray.uint16[this._pos2 + 3]
                        }
                        ,
                        i.vertexStartIndex.get = function() {
                            return this._structArray.uint32[this._pos4 + 2]
                        }
                        ,
                        i.lineStartIndex.get = function() {
                            return this._structArray.uint32[this._pos4 + 3]
                        }
                        ,
                        i.lineLength.get = function() {
                            return this._structArray.uint32[this._pos4 + 4]
                        }
                        ,
                        i.segment.get = function() {
                            return this._structArray.uint16[this._pos2 + 10]
                        }
                        ,
                        i.lowerSize.get = function() {
                            return this._structArray.uint16[this._pos2 + 11]
                        }
                        ,
                        i.upperSize.get = function() {
                            return this._structArray.uint16[this._pos2 + 12]
                        }
                        ,
                        i.lineOffsetX.get = function() {
                            return this._structArray.float32[this._pos4 + 7]
                        }
                        ,
                        i.lineOffsetY.get = function() {
                            return this._structArray.float32[this._pos4 + 8]
                        }
                        ,
                        i.writingMode.get = function() {
                            return this._structArray.uint8[this._pos1 + 36]
                        }
                        ,
                        i.placedOrientation.get = function() {
                            return this._structArray.uint8[this._pos1 + 37]
                        }
                        ,
                        i.placedOrientation.set = function(e) {
                            this._structArray.uint8[this._pos1 + 37] = e
                        }
                        ,
                        i.hidden.get = function() {
                            return this._structArray.uint8[this._pos1 + 38]
                        }
                        ,
                        i.hidden.set = function(e) {
                            this._structArray.uint8[this._pos1 + 38] = e
                        }
                        ,
                        i.crossTileID.get = function() {
                            return this._structArray.uint32[this._pos4 + 10]
                        }
                        ,
                        i.crossTileID.set = function(e) {
                            this._structArray.uint32[this._pos4 + 10] = e
                        }
                        ,
                        i.associatedIconIndex.get = function() {
                            return this._structArray.int16[this._pos2 + 22]
                        }
                        ,
                        Object.defineProperties(t.prototype, i),
                        t
                    }(Mn);
                    Qn.prototype.size = 48;
                    var $n = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.get = function(e) {
                            return new Qn(this,e)
                        }
                        ,
                        t
                    }(Gn);
                    Br("PlacedSymbolArray", $n);
                    var ea = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t;
                        var i = {
                            anchorX: {
                                configurable: !0
                            },
                            anchorY: {
                                configurable: !0
                            },
                            rightJustifiedTextSymbolIndex: {
                                configurable: !0
                            },
                            centerJustifiedTextSymbolIndex: {
                                configurable: !0
                            },
                            leftJustifiedTextSymbolIndex: {
                                configurable: !0
                            },
                            verticalPlacedTextSymbolIndex: {
                                configurable: !0
                            },
                            placedIconSymbolIndex: {
                                configurable: !0
                            },
                            verticalPlacedIconSymbolIndex: {
                                configurable: !0
                            },
                            key: {
                                configurable: !0
                            },
                            textBoxStartIndex: {
                                configurable: !0
                            },
                            textBoxEndIndex: {
                                configurable: !0
                            },
                            verticalTextBoxStartIndex: {
                                configurable: !0
                            },
                            verticalTextBoxEndIndex: {
                                configurable: !0
                            },
                            iconBoxStartIndex: {
                                configurable: !0
                            },
                            iconBoxEndIndex: {
                                configurable: !0
                            },
                            verticalIconBoxStartIndex: {
                                configurable: !0
                            },
                            verticalIconBoxEndIndex: {
                                configurable: !0
                            },
                            featureIndex: {
                                configurable: !0
                            },
                            numHorizontalGlyphVertices: {
                                configurable: !0
                            },
                            numVerticalGlyphVertices: {
                                configurable: !0
                            },
                            numIconVertices: {
                                configurable: !0
                            },
                            numVerticalIconVertices: {
                                configurable: !0
                            },
                            useRuntimeCollisionCircles: {
                                configurable: !0
                            },
                            crossTileID: {
                                configurable: !0
                            },
                            textBoxScale: {
                                configurable: !0
                            },
                            textOffset0: {
                                configurable: !0
                            },
                            textOffset1: {
                                configurable: !0
                            },
                            collisionCircleDiameter: {
                                configurable: !0
                            }
                        };
                        return i.anchorX.get = function() {
                            return this._structArray.int16[this._pos2 + 0]
                        }
                        ,
                        i.anchorY.get = function() {
                            return this._structArray.int16[this._pos2 + 1]
                        }
                        ,
                        i.rightJustifiedTextSymbolIndex.get = function() {
                            return this._structArray.int16[this._pos2 + 2]
                        }
                        ,
                        i.centerJustifiedTextSymbolIndex.get = function() {
                            return this._structArray.int16[this._pos2 + 3]
                        }
                        ,
                        i.leftJustifiedTextSymbolIndex.get = function() {
                            return this._structArray.int16[this._pos2 + 4]
                        }
                        ,
                        i.verticalPlacedTextSymbolIndex.get = function() {
                            return this._structArray.int16[this._pos2 + 5]
                        }
                        ,
                        i.placedIconSymbolIndex.get = function() {
                            return this._structArray.int16[this._pos2 + 6]
                        }
                        ,
                        i.verticalPlacedIconSymbolIndex.get = function() {
                            return this._structArray.int16[this._pos2 + 7]
                        }
                        ,
                        i.key.get = function() {
                            return this._structArray.uint16[this._pos2 + 8]
                        }
                        ,
                        i.textBoxStartIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 9]
                        }
                        ,
                        i.textBoxEndIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 10]
                        }
                        ,
                        i.verticalTextBoxStartIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 11]
                        }
                        ,
                        i.verticalTextBoxEndIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 12]
                        }
                        ,
                        i.iconBoxStartIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 13]
                        }
                        ,
                        i.iconBoxEndIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 14]
                        }
                        ,
                        i.verticalIconBoxStartIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 15]
                        }
                        ,
                        i.verticalIconBoxEndIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 16]
                        }
                        ,
                        i.featureIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 17]
                        }
                        ,
                        i.numHorizontalGlyphVertices.get = function() {
                            return this._structArray.uint16[this._pos2 + 18]
                        }
                        ,
                        i.numVerticalGlyphVertices.get = function() {
                            return this._structArray.uint16[this._pos2 + 19]
                        }
                        ,
                        i.numIconVertices.get = function() {
                            return this._structArray.uint16[this._pos2 + 20]
                        }
                        ,
                        i.numVerticalIconVertices.get = function() {
                            return this._structArray.uint16[this._pos2 + 21]
                        }
                        ,
                        i.useRuntimeCollisionCircles.get = function() {
                            return this._structArray.uint16[this._pos2 + 22]
                        }
                        ,
                        i.crossTileID.get = function() {
                            return this._structArray.uint32[this._pos4 + 12]
                        }
                        ,
                        i.crossTileID.set = function(e) {
                            this._structArray.uint32[this._pos4 + 12] = e
                        }
                        ,
                        i.textBoxScale.get = function() {
                            return this._structArray.float32[this._pos4 + 13]
                        }
                        ,
                        i.textOffset0.get = function() {
                            return this._structArray.float32[this._pos4 + 14]
                        }
                        ,
                        i.textOffset1.get = function() {
                            return this._structArray.float32[this._pos4 + 15]
                        }
                        ,
                        i.collisionCircleDiameter.get = function() {
                            return this._structArray.float32[this._pos4 + 16]
                        }
                        ,
                        Object.defineProperties(t.prototype, i),
                        t
                    }(Mn);
                    ea.prototype.size = 68;
                    var ta = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.get = function(e) {
                            return new ea(this,e)
                        }
                        ,
                        t
                    }(jn);
                    Br("SymbolInstanceArray", ta);
                    var ia = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getoffsetX = function(e) {
                            return this.float32[1 * e + 0]
                        }
                        ,
                        t
                    }(Hn);
                    Br("GlyphOffsetArray", ia);
                    var ra = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getx = function(e) {
                            return this.int16[3 * e + 0]
                        }
                        ,
                        t.prototype.gety = function(e) {
                            return this.int16[3 * e + 1]
                        }
                        ,
                        t.prototype.gettileUnitDistanceFromAnchor = function(e) {
                            return this.int16[3 * e + 2]
                        }
                        ,
                        t
                    }(qn);
                    Br("SymbolLineVertexArray", ra);
                    var na = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t;
                        var i = {
                            featureIndex: {
                                configurable: !0
                            },
                            sourceLayerIndex: {
                                configurable: !0
                            },
                            bucketIndex: {
                                configurable: !0
                            }
                        };
                        return i.featureIndex.get = function() {
                            return this._structArray.uint32[this._pos4 + 0]
                        }
                        ,
                        i.sourceLayerIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 2]
                        }
                        ,
                        i.bucketIndex.get = function() {
                            return this._structArray.uint16[this._pos2 + 3]
                        }
                        ,
                        Object.defineProperties(t.prototype, i),
                        t
                    }(Mn);
                    na.prototype.size = 8;
                    var aa = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.get = function(e) {
                            return new na(this,e)
                        }
                        ,
                        t
                    }(Wn);
                    Br("FeatureIndexArray", aa);
                    var oa = En([{
                        name: "a_pos",
                        components: 2,
                        type: "Int16"
                    }], 4).members
                      , sa = function(e) {
                        void 0 === e && (e = []),
                        this.segments = e
                    };
                    function la(e, t) {
                        return 256 * (e = c(Math.floor(e), 0, 255)) + c(Math.floor(t), 0, 255)
                    }
                    sa.prototype.prepareSegment = function(e, t, i, r) {
                        var n = this.segments[this.segments.length - 1];
                        return e > sa.MAX_VERTEX_ARRAY_LENGTH && S("Max vertices per segment is " + sa.MAX_VERTEX_ARRAY_LENGTH + ": bucket requested " + e),
                        (!n || n.vertexLength + e > sa.MAX_VERTEX_ARRAY_LENGTH || n.sortKey !== r) && (n = {
                            vertexOffset: t.length,
                            primitiveOffset: i.length,
                            vertexLength: 0,
                            primitiveLength: 0
                        },
                        void 0 !== r && (n.sortKey = r),
                        this.segments.push(n)),
                        n
                    }
                    ,
                    sa.prototype.get = function() {
                        return this.segments
                    }
                    ,
                    sa.prototype.destroy = function() {
                        for (var e = 0, t = this.segments; e < t.length; e += 1) {
                            var i = t[e];
                            for (var r in i.vaos)
                                i.vaos[r].destroy()
                        }
                    }
                    ,
                    sa.simpleSegment = function(e, t, i, r) {
                        return new sa([{
                            vertexOffset: e,
                            primitiveOffset: t,
                            vertexLength: i,
                            primitiveLength: r,
                            vaos: {},
                            sortKey: 0
                        }])
                    }
                    ,
                    sa.MAX_VERTEX_ARRAY_LENGTH = Math.pow(2, 16) - 1,
                    Br("SegmentVector", sa);
                    var ua = En([{
                        name: "a_pattern_from",
                        components: 4,
                        type: "Uint16"
                    }, {
                        name: "a_pattern_to",
                        components: 4,
                        type: "Uint16"
                    }, {
                        name: "a_pixel_ratio_from",
                        components: 1,
                        type: "Uint16"
                    }, {
                        name: "a_pixel_ratio_to",
                        components: 1,
                        type: "Uint16"
                    }])
                      , ca = t((function(e) {
                        e.exports = function(e, t) {
                            var i, r, n, a, o, s, l, u;
                            for (r = e.length - (i = 3 & e.length),
                            n = t,
                            o = 3432918353,
                            s = 461845907,
                            u = 0; u < r; )
                                l = 255 & e.charCodeAt(u) | (255 & e.charCodeAt(++u)) << 8 | (255 & e.charCodeAt(++u)) << 16 | (255 & e.charCodeAt(++u)) << 24,
                                ++u,
                                n = 27492 + (65535 & (a = 5 * (65535 & (n = (n ^= l = (65535 & (l = (l = (65535 & l) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * s + (((l >>> 16) * s & 65535) << 16) & 4294967295) << 13 | n >>> 19)) + ((5 * (n >>> 16) & 65535) << 16) & 4294967295)) + ((58964 + (a >>> 16) & 65535) << 16);
                            switch (l = 0,
                            i) {
                            case 3:
                                l ^= (255 & e.charCodeAt(u + 2)) << 16;
                            case 2:
                                l ^= (255 & e.charCodeAt(u + 1)) << 8;
                            case 1:
                                n ^= l = (65535 & (l = (l = (65535 & (l ^= 255 & e.charCodeAt(u))) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * s + (((l >>> 16) * s & 65535) << 16) & 4294967295
                            }
                            return n ^= e.length,
                            n = 2246822507 * (65535 & (n ^= n >>> 16)) + ((2246822507 * (n >>> 16) & 65535) << 16) & 4294967295,
                            n = 3266489909 * (65535 & (n ^= n >>> 13)) + ((3266489909 * (n >>> 16) & 65535) << 16) & 4294967295,
                            (n ^= n >>> 16) >>> 0
                        }
                    }
                    ))
                      , ha = t((function(e) {
                        e.exports = function(e, t) {
                            for (var i, r = e.length, n = t ^ r, a = 0; r >= 4; )
                                i = 1540483477 * (65535 & (i = 255 & e.charCodeAt(a) | (255 & e.charCodeAt(++a)) << 8 | (255 & e.charCodeAt(++a)) << 16 | (255 & e.charCodeAt(++a)) << 24)) + ((1540483477 * (i >>> 16) & 65535) << 16),
                                n = 1540483477 * (65535 & n) + ((1540483477 * (n >>> 16) & 65535) << 16) ^ (i = 1540483477 * (65535 & (i ^= i >>> 24)) + ((1540483477 * (i >>> 16) & 65535) << 16)),
                                r -= 4,
                                ++a;
                            switch (r) {
                            case 3:
                                n ^= (255 & e.charCodeAt(a + 2)) << 16;
                            case 2:
                                n ^= (255 & e.charCodeAt(a + 1)) << 8;
                            case 1:
                                n = 1540483477 * (65535 & (n ^= 255 & e.charCodeAt(a))) + ((1540483477 * (n >>> 16) & 65535) << 16)
                            }
                            return n = 1540483477 * (65535 & (n ^= n >>> 13)) + ((1540483477 * (n >>> 16) & 65535) << 16),
                            (n ^= n >>> 15) >>> 0
                        }
                    }
                    ))
                      , pa = ca
                      , fa = ha;
                    pa.murmur3 = ca,
                    pa.murmur2 = fa;
                    var da = function() {
                        this.ids = [],
                        this.positions = [],
                        this.indexed = !1
                    };
                    da.prototype.add = function(e, t, i, r) {
                        this.ids.push(va(e)),
                        this.positions.push(t, i, r)
                    }
                    ,
                    da.prototype.getPositions = function(e) {
                        for (var t = va(e), i = 0, r = this.ids.length - 1; i < r; ) {
                            var n = i + r >> 1;
                            this.ids[n] >= t ? r = n : i = n + 1
                        }
                        for (var a = []; this.ids[i] === t; )
                            a.push({
                                index: this.positions[3 * i],
                                start: this.positions[3 * i + 1],
                                end: this.positions[3 * i + 2]
                            }),
                            i++;
                        return a
                    }
                    ,
                    da.serialize = function(e, t) {
                        var i = new Float64Array(e.ids)
                          , r = new Uint32Array(e.positions);
                        return function e(t, i, r, n) {
                            for (; r < n; ) {
                                for (var a = t[r + n >> 1], o = r - 1, s = n + 1; ; ) {
                                    do {
                                        o++
                                    } while (t[o] < a);
                                    do {
                                        s--
                                    } while (t[s] > a);
                                    if (o >= s)
                                        break;
                                    ga(t, o, s),
                                    ga(i, 3 * o, 3 * s),
                                    ga(i, 3 * o + 1, 3 * s + 1),
                                    ga(i, 3 * o + 2, 3 * s + 2)
                                }
                                s - r < n - s ? (e(t, i, r, s),
                                r = s + 1) : (e(t, i, s + 1, n),
                                n = s)
                            }
                        }(i, r, 0, i.length - 1),
                        t && t.push(i.buffer, r.buffer),
                        {
                            ids: i,
                            positions: r
                        }
                    }
                    ,
                    da.deserialize = function(e) {
                        var t = new da;
                        return t.ids = e.ids,
                        t.positions = e.positions,
                        t.indexed = !0,
                        t
                    }
                    ;
                    var ma = Math.pow(2, 53) - 1;
                    function va(e) {
                        var t = +e;
                        return !isNaN(t) && t <= ma ? t : pa(String(e))
                    }
                    function ga(e, t, i) {
                        var r = e[t];
                        e[t] = e[i],
                        e[i] = r
                    }
                    Br("FeaturePositionMap", da);
                    var ya = function(e, t) {
                        this.gl = e.gl,
                        this.location = t
                    }
                      , _a = function(e) {
                        function t(t, i) {
                            e.call(this, t, i),
                            this.current = 0
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.set = function(e) {
                            this.current !== e && (this.current = e,
                            this.gl.uniform1i(this.location, e))
                        }
                        ,
                        t
                    }(ya)
                      , xa = function(e) {
                        function t(t, i) {
                            e.call(this, t, i),
                            this.current = 0
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.set = function(e) {
                            this.current !== e && (this.current = e,
                            this.gl.uniform1f(this.location, e))
                        }
                        ,
                        t
                    }(ya)
                      , ba = function(e) {
                        function t(t, i) {
                            e.call(this, t, i),
                            this.current = [0, 0]
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.set = function(e) {
                            e[0] === this.current[0] && e[1] === this.current[1] || (this.current = e,
                            this.gl.uniform2f(this.location, e[0], e[1]))
                        }
                        ,
                        t
                    }(ya)
                      , wa = function(e) {
                        function t(t, i) {
                            e.call(this, t, i),
                            this.current = [0, 0, 0]
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.set = function(e) {
                            e[0] === this.current[0] && e[1] === this.current[1] && e[2] === this.current[2] || (this.current = e,
                            this.gl.uniform3f(this.location, e[0], e[1], e[2]))
                        }
                        ,
                        t
                    }(ya)
                      , Sa = function(e) {
                        function t(t, i) {
                            e.call(this, t, i),
                            this.current = [0, 0, 0, 0]
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.set = function(e) {
                            e[0] === this.current[0] && e[1] === this.current[1] && e[2] === this.current[2] && e[3] === this.current[3] || (this.current = e,
                            this.gl.uniform4f(this.location, e[0], e[1], e[2], e[3]))
                        }
                        ,
                        t
                    }(ya)
                      , Ma = function(e) {
                        function t(t, i) {
                            e.call(this, t, i),
                            this.current = et.transparent
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.set = function(e) {
                            e.r === this.current.r && e.g === this.current.g && e.b === this.current.b && e.a === this.current.a || (this.current = e,
                            this.gl.uniform4f(this.location, e.r, e.g, e.b, e.a))
                        }
                        ,
                        t
                    }(ya)
                      , Ta = new Float32Array(16)
                      , Ea = function(e) {
                        function t(t, i) {
                            e.call(this, t, i),
                            this.current = Ta
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.set = function(e) {
                            if (e[12] !== this.current[12] || e[0] !== this.current[0])
                                return this.current = e,
                                void this.gl.uniformMatrix4fv(this.location, !1, e);
                            for (var t = 1; t < 16; t++)
                                if (e[t] !== this.current[t]) {
                                    this.current = e,
                                    this.gl.uniformMatrix4fv(this.location, !1, e);
                                    break
                                }
                        }
                        ,
                        t
                    }(ya);
                    function Aa(e) {
                        return [la(255 * e.r, 255 * e.g), la(255 * e.b, 255 * e.a)]
                    }
                    var Pa = function(e, t, i) {
                        this.value = e,
                        this.uniformNames = t.map((function(e) {
                            return "u_" + e
                        }
                        )),
                        this.type = i
                    };
                    Pa.prototype.setUniform = function(e, t, i) {
                        e.set(i.constantOr(this.value))
                    }
                    ,
                    Pa.prototype.getBinding = function(e, t, i) {
                        return "color" === this.type ? new Ma(e,t) : new xa(e,t)
                    }
                    ;
                    var Ca = function(e, t) {
                        this.uniformNames = t.map((function(e) {
                            return "u_" + e
                        }
                        )),
                        this.patternFrom = null,
                        this.patternTo = null,
                        this.pixelRatioFrom = 1,
                        this.pixelRatioTo = 1
                    };
                    Ca.prototype.setConstantPatternPositions = function(e, t) {
                        this.pixelRatioFrom = t.pixelRatio,
                        this.pixelRatioTo = e.pixelRatio,
                        this.patternFrom = t.tlbr,
                        this.patternTo = e.tlbr
                    }
                    ,
                    Ca.prototype.setUniform = function(e, t, i, r) {
                        var n = "u_pattern_to" === r ? this.patternTo : "u_pattern_from" === r ? this.patternFrom : "u_pixel_ratio_to" === r ? this.pixelRatioTo : "u_pixel_ratio_from" === r ? this.pixelRatioFrom : null;
                        n && e.set(n)
                    }
                    ,
                    Ca.prototype.getBinding = function(e, t, i) {
                        return "u_pattern" === i.substr(0, 9) ? new Sa(e,t) : new xa(e,t)
                    }
                    ;
                    var La = function(e, t, i, r) {
                        this.expression = e,
                        this.type = i,
                        this.maxValue = 0,
                        this.paintVertexAttributes = t.map((function(e) {
                            return {
                                name: "a_" + e,
                                type: "Float32",
                                components: "color" === i ? 2 : 1,
                                offset: 0
                            }
                        }
                        )),
                        this.paintVertexArray = new r
                    };
                    La.prototype.populatePaintArray = function(e, t, i, r, n) {
                        var a = this.paintVertexArray.length
                          , o = this.expression.evaluate(new sn(0), t, {}, r, [], n);
                        this.paintVertexArray.resize(e),
                        this._setPaintValue(a, e, o)
                    }
                    ,
                    La.prototype.updatePaintArray = function(e, t, i, r) {
                        var n = this.expression.evaluate({
                            zoom: 0
                        }, i, r);
                        this._setPaintValue(e, t, n)
                    }
                    ,
                    La.prototype._setPaintValue = function(e, t, i) {
                        if ("color" === this.type)
                            for (var r = Aa(i), n = e; n < t; n++)
                                this.paintVertexArray.emplace(n, r[0], r[1]);
                        else {
                            for (var a = e; a < t; a++)
                                this.paintVertexArray.emplace(a, i);
                            this.maxValue = Math.max(this.maxValue, Math.abs(i))
                        }
                    }
                    ,
                    La.prototype.upload = function(e) {
                        this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = e.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent))
                    }
                    ,
                    La.prototype.destroy = function() {
                        this.paintVertexBuffer && this.paintVertexBuffer.destroy()
                    }
                    ;
                    var Ia = function(e, t, i, r, n, a) {
                        this.expression = e,
                        this.uniformNames = t.map((function(e) {
                            return "u_" + e + "_t"
                        }
                        )),
                        this.type = i,
                        this.useIntegerZoom = r,
                        this.zoom = n,
                        this.maxValue = 0,
                        this.paintVertexAttributes = t.map((function(e) {
                            return {
                                name: "a_" + e,
                                type: "Float32",
                                components: "color" === i ? 4 : 2,
                                offset: 0
                            }
                        }
                        )),
                        this.paintVertexArray = new a
                    };
                    Ia.prototype.populatePaintArray = function(e, t, i, r, n) {
                        var a = this.expression.evaluate(new sn(this.zoom), t, {}, r, [], n)
                          , o = this.expression.evaluate(new sn(this.zoom + 1), t, {}, r, [], n)
                          , s = this.paintVertexArray.length;
                        this.paintVertexArray.resize(e),
                        this._setPaintValue(s, e, a, o)
                    }
                    ,
                    Ia.prototype.updatePaintArray = function(e, t, i, r) {
                        var n = this.expression.evaluate({
                            zoom: this.zoom
                        }, i, r)
                          , a = this.expression.evaluate({
                            zoom: this.zoom + 1
                        }, i, r);
                        this._setPaintValue(e, t, n, a)
                    }
                    ,
                    Ia.prototype._setPaintValue = function(e, t, i, r) {
                        if ("color" === this.type)
                            for (var n = Aa(i), a = Aa(r), o = e; o < t; o++)
                                this.paintVertexArray.emplace(o, n[0], n[1], a[0], a[1]);
                        else {
                            for (var s = e; s < t; s++)
                                this.paintVertexArray.emplace(s, i, r);
                            this.maxValue = Math.max(this.maxValue, Math.abs(i), Math.abs(r))
                        }
                    }
                    ,
                    Ia.prototype.upload = function(e) {
                        this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = e.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent))
                    }
                    ,
                    Ia.prototype.destroy = function() {
                        this.paintVertexBuffer && this.paintVertexBuffer.destroy()
                    }
                    ,
                    Ia.prototype.setUniform = function(e, t) {
                        var i = this.useIntegerZoom ? Math.floor(t.zoom) : t.zoom
                          , r = c(this.expression.interpolationFactor(i, this.zoom, this.zoom + 1), 0, 1);
                        e.set(r)
                    }
                    ,
                    Ia.prototype.getBinding = function(e, t, i) {
                        return new xa(e,t)
                    }
                    ;
                    var ka = function(e, t, i, r, n, a) {
                        this.expression = e,
                        this.type = t,
                        this.useIntegerZoom = i,
                        this.zoom = r,
                        this.layerId = a,
                        this.zoomInPaintVertexArray = new n,
                        this.zoomOutPaintVertexArray = new n
                    };
                    ka.prototype.populatePaintArray = function(e, t, i) {
                        var r = this.zoomInPaintVertexArray.length;
                        this.zoomInPaintVertexArray.resize(e),
                        this.zoomOutPaintVertexArray.resize(e),
                        this._setPaintValues(r, e, t.patterns && t.patterns[this.layerId], i)
                    }
                    ,
                    ka.prototype.updatePaintArray = function(e, t, i, r, n) {
                        this._setPaintValues(e, t, i.patterns && i.patterns[this.layerId], n)
                    }
                    ,
                    ka.prototype._setPaintValues = function(e, t, i, r) {
                        if (r && i) {
                            var n = r[i.min]
                              , a = r[i.mid]
                              , o = r[i.max];
                            if (n && a && o)
                                for (var s = e; s < t; s++)
                                    this.zoomInPaintVertexArray.emplace(s, a.tl[0], a.tl[1], a.br[0], a.br[1], n.tl[0], n.tl[1], n.br[0], n.br[1], a.pixelRatio, n.pixelRatio),
                                    this.zoomOutPaintVertexArray.emplace(s, a.tl[0], a.tl[1], a.br[0], a.br[1], o.tl[0], o.tl[1], o.br[0], o.br[1], a.pixelRatio, o.pixelRatio)
                        }
                    }
                    ,
                    ka.prototype.upload = function(e) {
                        this.zoomInPaintVertexArray && this.zoomInPaintVertexArray.arrayBuffer && this.zoomOutPaintVertexArray && this.zoomOutPaintVertexArray.arrayBuffer && (this.zoomInPaintVertexBuffer = e.createVertexBuffer(this.zoomInPaintVertexArray, ua.members, this.expression.isStateDependent),
                        this.zoomOutPaintVertexBuffer = e.createVertexBuffer(this.zoomOutPaintVertexArray, ua.members, this.expression.isStateDependent))
                    }
                    ,
                    ka.prototype.destroy = function() {
                        this.zoomOutPaintVertexBuffer && this.zoomOutPaintVertexBuffer.destroy(),
                        this.zoomInPaintVertexBuffer && this.zoomInPaintVertexBuffer.destroy()
                    }
                    ;
                    var za = function(e, t, i) {
                        this.binders = {},
                        this._buffers = [];
                        var r = [];
                        for (var n in e.paint._values)
                            if (i(n)) {
                                var a = e.paint.get(n);
                                if (a instanceof dn && zi(a.property.specification)) {
                                    var o = Ra(n, e.type)
                                      , s = a.value
                                      , l = a.property.specification.type
                                      , u = a.property.useIntegerZoom
                                      , c = a.property.specification["property-type"]
                                      , h = "cross-faded" === c || "cross-faded-data-driven" === c;
                                    if ("constant" === s.kind)
                                        this.binders[n] = h ? new Ca(s.value,o) : new Pa(s.value,o,l),
                                        r.push("/u_" + n);
                                    else if ("source" === s.kind || h) {
                                        var p = Oa(n, l, "source");
                                        this.binders[n] = h ? new ka(s,l,u,t,p,e.id) : new La(s,o,l,p),
                                        r.push("/a_" + n)
                                    } else {
                                        var f = Oa(n, l, "composite");
                                        this.binders[n] = new Ia(s,o,l,u,t,f),
                                        r.push("/z_" + n)
                                    }
                                }
                            }
                        this.cacheKey = r.sort().join("")
                    };
                    za.prototype.getMaxValue = function(e) {
                        var t = this.binders[e];
                        return t instanceof La || t instanceof Ia ? t.maxValue : 0
                    }
                    ,
                    za.prototype.populatePaintArrays = function(e, t, i, r, n) {
                        for (var a in this.binders) {
                            var o = this.binders[a];
                            (o instanceof La || o instanceof Ia || o instanceof ka) && o.populatePaintArray(e, t, i, r, n)
                        }
                    }
                    ,
                    za.prototype.setConstantPatternPositions = function(e, t) {
                        for (var i in this.binders) {
                            var r = this.binders[i];
                            r instanceof Ca && r.setConstantPatternPositions(e, t)
                        }
                    }
                    ,
                    za.prototype.updatePaintArrays = function(e, t, i, r, n) {
                        var a = !1;
                        for (var o in e)
                            for (var s = 0, l = t.getPositions(o); s < l.length; s += 1) {
                                var u = l[s]
                                  , c = i.feature(u.index);
                                for (var h in this.binders) {
                                    var p = this.binders[h];
                                    if ((p instanceof La || p instanceof Ia || p instanceof ka) && !0 === p.expression.isStateDependent) {
                                        var f = r.paint.get(h);
                                        p.expression = f.value,
                                        p.updatePaintArray(u.start, u.end, c, e[o], n),
                                        a = !0
                                    }
                                }
                            }
                        return a
                    }
                    ,
                    za.prototype.defines = function() {
                        var e = [];
                        for (var t in this.binders) {
                            var i = this.binders[t];
                            (i instanceof Pa || i instanceof Ca) && e.push.apply(e, i.uniformNames.map((function(e) {
                                return "#define HAS_UNIFORM_" + e
                            }
                            )))
                        }
                        return e
                    }
                    ,
                    za.prototype.getBinderAttributes = function() {
                        var e = [];
                        for (var t in this.binders) {
                            var i = this.binders[t];
                            if (i instanceof La || i instanceof Ia)
                                for (var r = 0; r < i.paintVertexAttributes.length; r++)
                                    e.push(i.paintVertexAttributes[r].name);
                            else if (i instanceof ka)
                                for (var n = 0; n < ua.members.length; n++)
                                    e.push(ua.members[n].name)
                        }
                        return e
                    }
                    ,
                    za.prototype.getBinderUniforms = function() {
                        var e = [];
                        for (var t in this.binders) {
                            var i = this.binders[t];
                            if (i instanceof Pa || i instanceof Ca || i instanceof Ia)
                                for (var r = 0, n = i.uniformNames; r < n.length; r += 1)
                                    e.push(n[r])
                        }
                        return e
                    }
                    ,
                    za.prototype.getPaintVertexBuffers = function() {
                        return this._buffers
                    }
                    ,
                    za.prototype.getUniforms = function(e, t) {
                        var i = [];
                        for (var r in this.binders) {
                            var n = this.binders[r];
                            if (n instanceof Pa || n instanceof Ca || n instanceof Ia)
                                for (var a = 0, o = n.uniformNames; a < o.length; a += 1) {
                                    var s = o[a];
                                    if (t[s]) {
                                        var l = n.getBinding(e, t[s], s);
                                        i.push({
                                            name: s,
                                            property: r,
                                            binding: l
                                        })
                                    }
                                }
                        }
                        return i
                    }
                    ,
                    za.prototype.setUniforms = function(e, t, i, r) {
                        for (var n = 0, a = t; n < a.length; n += 1) {
                            var o = a[n]
                              , s = o.name
                              , l = o.property;
                            this.binders[l].setUniform(o.binding, r, i.get(l), s)
                        }
                    }
                    ,
                    za.prototype.updatePaintBuffers = function(e) {
                        for (var t in this._buffers = [],
                        this.binders) {
                            var i = this.binders[t];
                            if (e && i instanceof ka) {
                                var r = 2 === e.fromScale ? i.zoomInPaintVertexBuffer : i.zoomOutPaintVertexBuffer;
                                r && this._buffers.push(r)
                            } else
                                (i instanceof La || i instanceof Ia) && i.paintVertexBuffer && this._buffers.push(i.paintVertexBuffer)
                        }
                    }
                    ,
                    za.prototype.upload = function(e) {
                        for (var t in this.binders) {
                            var i = this.binders[t];
                            (i instanceof La || i instanceof Ia || i instanceof ka) && i.upload(e)
                        }
                        this.updatePaintBuffers()
                    }
                    ,
                    za.prototype.destroy = function() {
                        for (var e in this.binders) {
                            var t = this.binders[e];
                            (t instanceof La || t instanceof Ia || t instanceof ka) && t.destroy()
                        }
                    }
                    ;
                    var Da = function(e, t, i) {
                        void 0 === i && (i = function() {
                            return !0
                        }
                        ),
                        this.programConfigurations = {};
                        for (var r = 0, n = e; r < n.length; r += 1) {
                            var a = n[r];
                            this.programConfigurations[a.id] = new za(a,t,i)
                        }
                        this.needsUpload = !1,
                        this._featureMap = new da,
                        this._bufferOffset = 0
                    };
                    function Ra(e, t) {
                        return {
                            "text-opacity": ["opacity"],
                            "icon-opacity": ["opacity"],
                            "text-color": ["fill_color"],
                            "icon-color": ["fill_color"],
                            "text-halo-color": ["halo_color"],
                            "icon-halo-color": ["halo_color"],
                            "text-halo-blur": ["halo_blur"],
                            "icon-halo-blur": ["halo_blur"],
                            "text-halo-width": ["halo_width"],
                            "icon-halo-width": ["halo_width"],
                            "line-gap-width": ["gapwidth"],
                            "line-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
                            "fill-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
                            "fill-extrusion-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"]
                        }[e] || [e.replace(t + "-", "").replace(/-/g, "_")]
                    }
                    function Oa(e, t, i) {
                        var r = {
                            color: {
                                source: kn,
                                composite: Yn
                            },
                            number: {
                                source: Hn,
                                composite: kn
                            }
                        }
                          , n = function(e) {
                            return {
                                "line-pattern": {
                                    source: zn,
                                    composite: zn
                                },
                                "fill-pattern": {
                                    source: zn,
                                    composite: zn
                                },
                                "fill-extrusion-pattern": {
                                    source: zn,
                                    composite: zn
                                }
                            }[e]
                        }(e);
                        return n && n[i] || r[t][i]
                    }
                    Da.prototype.populatePaintArrays = function(e, t, i, r, n, a) {
                        for (var o in this.programConfigurations)
                            this.programConfigurations[o].populatePaintArrays(e, t, r, n, a);
                        void 0 !== t.id && this._featureMap.add(t.id, i, this._bufferOffset, e),
                        this._bufferOffset = e,
                        this.needsUpload = !0
                    }
                    ,
                    Da.prototype.updatePaintArrays = function(e, t, i, r) {
                        for (var n = 0, a = i; n < a.length; n += 1) {
                            var o = a[n];
                            this.needsUpload = this.programConfigurations[o.id].updatePaintArrays(e, this._featureMap, t, o, r) || this.needsUpload
                        }
                    }
                    ,
                    Da.prototype.get = function(e) {
                        return this.programConfigurations[e]
                    }
                    ,
                    Da.prototype.upload = function(e) {
                        if (this.needsUpload) {
                            for (var t in this.programConfigurations)
                                this.programConfigurations[t].upload(e);
                            this.needsUpload = !1
                        }
                    }
                    ,
                    Da.prototype.destroy = function() {
                        for (var e in this.programConfigurations)
                            this.programConfigurations[e].destroy()
                    }
                    ,
                    Br("ConstantBinder", Pa),
                    Br("CrossFadedConstantBinder", Ca),
                    Br("SourceExpressionBinder", La),
                    Br("CrossFadedCompositeBinder", ka),
                    Br("CompositeExpressionBinder", Ia),
                    Br("ProgramConfiguration", za, {
                        omit: ["_buffers"]
                    }),
                    Br("ProgramConfigurationSet", Da);
                    var Ba = Math.pow(2, 14) - 1
                      , Fa = -Ba - 1;
                    function Na(e) {
                        for (var t = 8192 / e.extent, i = e.loadGeometry(), r = 0; r < i.length; r++)
                            for (var n = i[r], a = 0; a < n.length; a++) {
                                var o = n[a]
                                  , s = Math.round(o.x * t)
                                  , l = Math.round(o.y * t);
                                o.x = c(s, Fa, Ba),
                                o.y = c(l, Fa, Ba),
                                (s < o.x || s > o.x + 1 || l < o.y || l > o.y + 1) && S("Geometry exceeds allowed extent, reduce your vector tile buffer size")
                            }
                        return i
                    }
                    function Ua(e, t) {
                        return {
                            type: e.type,
                            id: e.id,
                            properties: e.properties,
                            geometry: t ? Na(e) : []
                        }
                    }
                    function Va(e, t, i, r, n) {
                        e.emplaceBack(2 * t + (r + 1) / 2, 2 * i + (n + 1) / 2)
                    }
                    var Ga = function(e) {
                        this.zoom = e.zoom,
                        this.overscaling = e.overscaling,
                        this.layers = e.layers,
                        this.layerIds = this.layers.map((function(e) {
                            return e.id
                        }
                        )),
                        this.index = e.index,
                        this.hasPattern = !1,
                        this.layoutVertexArray = new Pn,
                        this.indexArray = new Vn,
                        this.segments = new sa,
                        this.programConfigurations = new Da(e.layers,e.zoom),
                        this.stateDependentLayerIds = this.layers.filter((function(e) {
                            return e.isStateDependent()
                        }
                        )).map((function(e) {
                            return e.id
                        }
                        ))
                    };
                    function ja(e, t) {
                        for (var i = 0; i < e.length; i++)
                            if (Qa(t, e[i]))
                                return !0;
                        for (var r = 0; r < t.length; r++)
                            if (Qa(e, t[r]))
                                return !0;
                        return !!Za(e, t)
                    }
                    function Ha(e, t, i) {
                        return !!Qa(e, t) || !!Ya(t, e, i)
                    }
                    function qa(e, t) {
                        if (1 === e.length)
                            return Ja(t, e[0]);
                        for (var i = 0; i < t.length; i++)
                            for (var r = t[i], n = 0; n < r.length; n++)
                                if (Qa(e, r[n]))
                                    return !0;
                        for (var a = 0; a < e.length; a++)
                            if (Ja(t, e[a]))
                                return !0;
                        for (var o = 0; o < t.length; o++)
                            if (Za(e, t[o]))
                                return !0;
                        return !1
                    }
                    function Wa(e, t, i) {
                        if (e.length > 1) {
                            if (Za(e, t))
                                return !0;
                            for (var r = 0; r < t.length; r++)
                                if (Ya(t[r], e, i))
                                    return !0
                        }
                        for (var n = 0; n < e.length; n++)
                            if (Ya(e[n], t, i))
                                return !0;
                        return !1
                    }
                    function Za(e, t) {
                        if (0 === e.length || 0 === t.length)
                            return !1;
                        for (var i = 0; i < e.length - 1; i++)
                            for (var r = e[i], n = e[i + 1], a = 0; a < t.length - 1; a++)
                                if (Xa(r, n, t[a], t[a + 1]))
                                    return !0;
                        return !1
                    }
                    function Xa(e, t, i, r) {
                        return M(e, i, r) !== M(t, i, r) && M(e, t, i) !== M(e, t, r)
                    }
                    function Ya(e, t, i) {
                        var r = i * i;
                        if (1 === t.length)
                            return e.distSqr(t[0]) < r;
                        for (var n = 1; n < t.length; n++)
                            if (Ka(e, t[n - 1], t[n]) < r)
                                return !0;
                        return !1
                    }
                    function Ka(e, t, i) {
                        var r = t.distSqr(i);
                        if (0 === r)
                            return e.distSqr(t);
                        var n = ((e.x - t.x) * (i.x - t.x) + (e.y - t.y) * (i.y - t.y)) / r;
                        return e.distSqr(n < 0 ? t : n > 1 ? i : i.sub(t)._mult(n)._add(t))
                    }
                    function Ja(e, t) {
                        for (var i, r, n, a = !1, o = 0; o < e.length; o++)
                            for (var s = 0, l = (i = e[o]).length - 1; s < i.length; l = s++)
                                (r = i[s]).y > t.y != (n = i[l]).y > t.y && t.x < (n.x - r.x) * (t.y - r.y) / (n.y - r.y) + r.x && (a = !a);
                        return a
                    }
                    function Qa(e, t) {
                        for (var i = !1, r = 0, n = e.length - 1; r < e.length; n = r++) {
                            var a = e[r]
                              , o = e[n];
                            a.y > t.y != o.y > t.y && t.x < (o.x - a.x) * (t.y - a.y) / (o.y - a.y) + a.x && (i = !i)
                        }
                        return i
                    }
                    function $a(e, t, i) {
                        var r = i[0]
                          , n = i[2];
                        if (e.x < r.x && t.x < r.x || e.x > n.x && t.x > n.x || e.y < r.y && t.y < r.y || e.y > n.y && t.y > n.y)
                            return !1;
                        var a = M(e, t, i[0]);
                        return a !== M(e, t, i[1]) || a !== M(e, t, i[2]) || a !== M(e, t, i[3])
                    }
                    function eo(e, t, i) {
                        var r = t.paint.get(e).value;
                        return "constant" === r.kind ? r.value : i.programConfigurations.get(t.id).getMaxValue(e)
                    }
                    function to(e) {
                        return Math.sqrt(e[0] * e[0] + e[1] * e[1])
                    }
                    function io(e, t, i, r, a) {
                        if (!t[0] && !t[1])
                            return e;
                        var o = n.convert(t)._mult(a);
                        "viewport" === i && o._rotate(-r);
                        for (var s = [], l = 0; l < e.length; l++)
                            s.push(e[l].sub(o));
                        return s
                    }
                    Ga.prototype.populate = function(e, t, i) {
                        var r = this.layers[0]
                          , n = []
                          , a = null;
                        "circle" === r.type && (a = r.layout.get("circle-sort-key"));
                        for (var o = 0, s = e; o < s.length; o += 1) {
                            var l = s[o]
                              , u = l.feature
                              , c = l.id
                              , h = l.index
                              , p = l.sourceLayerIndex
                              , f = this.layers[0]._featureFilter.needGeometry
                              , d = Ua(u, f);
                            if (this.layers[0]._featureFilter.filter(new sn(this.zoom), d, i)) {
                                var m = a ? a.evaluate(d, {}, i) : void 0
                                  , v = {
                                    id: c,
                                    properties: u.properties,
                                    type: u.type,
                                    sourceLayerIndex: p,
                                    index: h,
                                    geometry: f ? d.geometry : Na(u),
                                    patterns: {},
                                    sortKey: m
                                };
                                n.push(v)
                            }
                        }
                        a && n.sort((function(e, t) {
                            return e.sortKey - t.sortKey
                        }
                        ));
                        for (var g = 0, y = n; g < y.length; g += 1) {
                            var _ = y[g]
                              , x = _.geometry
                              , b = _.index
                              , w = _.sourceLayerIndex
                              , S = e[b].feature;
                            this.addFeature(_, x, b, i),
                            t.featureIndex.insert(S, x, b, w, this.index)
                        }
                    }
                    ,
                    Ga.prototype.update = function(e, t, i) {
                        this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(e, t, this.stateDependentLayers, i)
                    }
                    ,
                    Ga.prototype.isEmpty = function() {
                        return 0 === this.layoutVertexArray.length
                    }
                    ,
                    Ga.prototype.uploadPending = function() {
                        return !this.uploaded || this.programConfigurations.needsUpload
                    }
                    ,
                    Ga.prototype.upload = function(e) {
                        this.uploaded || (this.layoutVertexBuffer = e.createVertexBuffer(this.layoutVertexArray, oa),
                        this.indexBuffer = e.createIndexBuffer(this.indexArray)),
                        this.programConfigurations.upload(e),
                        this.uploaded = !0
                    }
                    ,
                    Ga.prototype.destroy = function() {
                        this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(),
                        this.indexBuffer.destroy(),
                        this.programConfigurations.destroy(),
                        this.segments.destroy())
                    }
                    ,
                    Ga.prototype.addFeature = function(e, t, i, r) {
                        for (var n = 0, a = t; n < a.length; n += 1)
                            for (var o = 0, s = a[n]; o < s.length; o += 1) {
                                var l = s[o]
                                  , u = l.x
                                  , c = l.y;
                                if (!(u < 0 || u >= 8192 || c < 0 || c >= 8192)) {
                                    var h = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray, e.sortKey)
                                      , p = h.vertexLength;
                                    Va(this.layoutVertexArray, u, c, -1, -1),
                                    Va(this.layoutVertexArray, u, c, 1, -1),
                                    Va(this.layoutVertexArray, u, c, 1, 1),
                                    Va(this.layoutVertexArray, u, c, -1, 1),
                                    this.indexArray.emplaceBack(p, p + 1, p + 2),
                                    this.indexArray.emplaceBack(p, p + 3, p + 2),
                                    h.vertexLength += 4,
                                    h.primitiveLength += 2
                                }
                            }
                        this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, e, i, {}, r)
                    }
                    ,
                    Br("CircleBucket", Ga, {
                        omit: ["layers"]
                    });
                    var ro = new bn({
                        "circle-sort-key": new gn(Ce.layout_circle["circle-sort-key"])
                    })
                      , no = {
                        paint: new bn({
                            "circle-radius": new gn(Ce.paint_circle["circle-radius"]),
                            "circle-color": new gn(Ce.paint_circle["circle-color"]),
                            "circle-blur": new gn(Ce.paint_circle["circle-blur"]),
                            "circle-opacity": new gn(Ce.paint_circle["circle-opacity"]),
                            "circle-translate": new vn(Ce.paint_circle["circle-translate"]),
                            "circle-translate-anchor": new vn(Ce.paint_circle["circle-translate-anchor"]),
                            "circle-pitch-scale": new vn(Ce.paint_circle["circle-pitch-scale"]),
                            "circle-pitch-alignment": new vn(Ce.paint_circle["circle-pitch-alignment"]),
                            "circle-stroke-width": new gn(Ce.paint_circle["circle-stroke-width"]),
                            "circle-stroke-color": new gn(Ce.paint_circle["circle-stroke-color"]),
                            "circle-stroke-opacity": new gn(Ce.paint_circle["circle-stroke-opacity"])
                        }),
                        layout: ro
                    }
                      , ao = "undefined" != typeof Float32Array ? Float32Array : Array;
                    function oo(e) {
                        return e[0] = 1,
                        e[1] = 0,
                        e[2] = 0,
                        e[3] = 0,
                        e[4] = 0,
                        e[5] = 1,
                        e[6] = 0,
                        e[7] = 0,
                        e[8] = 0,
                        e[9] = 0,
                        e[10] = 1,
                        e[11] = 0,
                        e[12] = 0,
                        e[13] = 0,
                        e[14] = 0,
                        e[15] = 1,
                        e
                    }
                    function so(e, t, i) {
                        var r = t[0]
                          , n = t[1]
                          , a = t[2]
                          , o = t[3]
                          , s = t[4]
                          , l = t[5]
                          , u = t[6]
                          , c = t[7]
                          , h = t[8]
                          , p = t[9]
                          , f = t[10]
                          , d = t[11]
                          , m = t[12]
                          , v = t[13]
                          , g = t[14]
                          , y = t[15]
                          , _ = i[0]
                          , x = i[1]
                          , b = i[2]
                          , w = i[3];
                        return e[0] = _ * r + x * s + b * h + w * m,
                        e[1] = _ * n + x * l + b * p + w * v,
                        e[2] = _ * a + x * u + b * f + w * g,
                        e[3] = _ * o + x * c + b * d + w * y,
                        e[4] = (_ = i[4]) * r + (x = i[5]) * s + (b = i[6]) * h + (w = i[7]) * m,
                        e[5] = _ * n + x * l + b * p + w * v,
                        e[6] = _ * a + x * u + b * f + w * g,
                        e[7] = _ * o + x * c + b * d + w * y,
                        e[8] = (_ = i[8]) * r + (x = i[9]) * s + (b = i[10]) * h + (w = i[11]) * m,
                        e[9] = _ * n + x * l + b * p + w * v,
                        e[10] = _ * a + x * u + b * f + w * g,
                        e[11] = _ * o + x * c + b * d + w * y,
                        e[12] = (_ = i[12]) * r + (x = i[13]) * s + (b = i[14]) * h + (w = i[15]) * m,
                        e[13] = _ * n + x * l + b * p + w * v,
                        e[14] = _ * a + x * u + b * f + w * g,
                        e[15] = _ * o + x * c + b * d + w * y,
                        e
                    }
                    Math.hypot || (Math.hypot = function() {
                        for (var e = arguments, t = 0, i = arguments.length; i--; )
                            t += e[i] * e[i];
                        return Math.sqrt(t)
                    }
                    );
                    var lo, uo = so;
                    function co(e, t, i) {
                        var r = t[0]
                          , n = t[1]
                          , a = t[2]
                          , o = t[3];
                        return e[0] = i[0] * r + i[4] * n + i[8] * a + i[12] * o,
                        e[1] = i[1] * r + i[5] * n + i[9] * a + i[13] * o,
                        e[2] = i[2] * r + i[6] * n + i[10] * a + i[14] * o,
                        e[3] = i[3] * r + i[7] * n + i[11] * a + i[15] * o,
                        e
                    }
                    lo = new ao(3),
                    ao != Float32Array && (lo[0] = 0,
                    lo[1] = 0,
                    lo[2] = 0),
                    function() {
                        var e = new ao(4);
                        ao != Float32Array && (e[0] = 0,
                        e[1] = 0,
                        e[2] = 0,
                        e[3] = 0)
                    }();
                    var ho = (function() {
                        var e = new ao(2);
                        ao != Float32Array && (e[0] = 0,
                        e[1] = 0)
                    }(),
                    function(e) {
                        function t(t) {
                            e.call(this, t, no)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.createBucket = function(e) {
                            return new Ga(e)
                        }
                        ,
                        t.prototype.queryRadius = function(e) {
                            var t = e;
                            return eo("circle-radius", this, t) + eo("circle-stroke-width", this, t) + to(this.paint.get("circle-translate"))
                        }
                        ,
                        t.prototype.queryIntersectsFeature = function(e, t, i, r, n, a, o, s) {
                            for (var l = io(e, this.paint.get("circle-translate"), this.paint.get("circle-translate-anchor"), a.angle, o), u = this.paint.get("circle-radius").evaluate(t, i) + this.paint.get("circle-stroke-width").evaluate(t, i), c = "map" === this.paint.get("circle-pitch-alignment"), h = c ? l : function(e, t) {
                                return e.map((function(e) {
                                    return po(e, t)
                                }
                                ))
                            }(l, s), p = c ? u * o : u, f = 0, d = r; f < d.length; f += 1)
                                for (var m = 0, v = d[f]; m < v.length; m += 1) {
                                    var g = v[m]
                                      , y = c ? g : po(g, s)
                                      , _ = p
                                      , x = co([], [g.x, g.y, 0, 1], s);
                                    if ("viewport" === this.paint.get("circle-pitch-scale") && "map" === this.paint.get("circle-pitch-alignment") ? _ *= x[3] / a.cameraToCenterDistance : "map" === this.paint.get("circle-pitch-scale") && "viewport" === this.paint.get("circle-pitch-alignment") && (_ *= a.cameraToCenterDistance / x[3]),
                                    Ha(h, y, _))
                                        return !0
                                }
                            return !1
                        }
                        ,
                        t
                    }(wn));
                    function po(e, t) {
                        var i = co([], [e.x, e.y, 0, 1], t);
                        return new n(i[0] / i[3],i[1] / i[3])
                    }
                    var fo = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t
                    }(Ga);
                    function mo(e, t, i, r) {
                        var n = t.width
                          , a = t.height;
                        if (r) {
                            if (r instanceof Uint8ClampedArray)
                                r = new Uint8Array(r.buffer);
                            else if (r.length !== n * a * i)
                                throw new RangeError("mismatched image size")
                        } else
                            r = new Uint8Array(n * a * i);
                        return e.width = n,
                        e.height = a,
                        e.data = r,
                        e
                    }
                    function vo(e, t, i) {
                        var r = t.width
                          , n = t.height;
                        if (r !== e.width || n !== e.height) {
                            var a = mo({}, {
                                width: r,
                                height: n
                            }, i);
                            go(e, a, {
                                x: 0,
                                y: 0
                            }, {
                                x: 0,
                                y: 0
                            }, {
                                width: Math.min(e.width, r),
                                height: Math.min(e.height, n)
                            }, i),
                            e.width = r,
                            e.height = n,
                            e.data = a.data
                        }
                    }
                    function go(e, t, i, r, n, a) {
                        if (0 === n.width || 0 === n.height)
                            return t;
                        if (n.width > e.width || n.height > e.height || i.x > e.width - n.width || i.y > e.height - n.height)
                            throw new RangeError("out of range source coordinates for image copy");
                        if (n.width > t.width || n.height > t.height || r.x > t.width - n.width || r.y > t.height - n.height)
                            throw new RangeError("out of range destination coordinates for image copy");
                        for (var o = e.data, s = t.data, l = 0; l < n.height; l++)
                            for (var u = ((i.y + l) * e.width + i.x) * a, c = ((r.y + l) * t.width + r.x) * a, h = 0; h < n.width * a; h++)
                                s[c + h] = o[u + h];
                        return t
                    }
                    Br("HeatmapBucket", fo, {
                        omit: ["layers"]
                    });
                    var yo = function(e, t) {
                        mo(this, e, 1, t)
                    };
                    yo.prototype.resize = function(e) {
                        vo(this, e, 1)
                    }
                    ,
                    yo.prototype.clone = function() {
                        return new yo({
                            width: this.width,
                            height: this.height
                        },new Uint8Array(this.data))
                    }
                    ,
                    yo.copy = function(e, t, i, r, n) {
                        go(e, t, i, r, n, 1)
                    }
                    ;
                    var _o = function(e, t) {
                        mo(this, e, 4, t)
                    };
                    _o.prototype.resize = function(e) {
                        vo(this, e, 4)
                    }
                    ,
                    _o.prototype.replace = function(e, t) {
                        t ? this.data.set(e) : this.data = e instanceof Uint8ClampedArray ? new Uint8Array(e.buffer) : e
                    }
                    ,
                    _o.prototype.clone = function() {
                        return new _o({
                            width: this.width,
                            height: this.height
                        },new Uint8Array(this.data))
                    }
                    ,
                    _o.copy = function(e, t, i, r, n) {
                        go(e, t, i, r, n, 4)
                    }
                    ,
                    Br("AlphaImage", yo),
                    Br("RGBAImage", _o);
                    var xo = {
                        paint: new bn({
                            "heatmap-radius": new gn(Ce.paint_heatmap["heatmap-radius"]),
                            "heatmap-weight": new gn(Ce.paint_heatmap["heatmap-weight"]),
                            "heatmap-intensity": new vn(Ce.paint_heatmap["heatmap-intensity"]),
                            "heatmap-color": new xn(Ce.paint_heatmap["heatmap-color"]),
                            "heatmap-opacity": new vn(Ce.paint_heatmap["heatmap-opacity"])
                        })
                    };
                    function bo(e) {
                        var t = {}
                          , i = e.resolution || 256
                          , r = e.clips ? e.clips.length : 1
                          , n = e.image || new _o({
                            width: i,
                            height: r
                        })
                          , a = function(i, r, a) {
                            t[e.evaluationKey] = a;
                            var o = e.expression.evaluate(t);
                            n.data[i + r + 0] = Math.floor(255 * o.r / o.a),
                            n.data[i + r + 1] = Math.floor(255 * o.g / o.a),
                            n.data[i + r + 2] = Math.floor(255 * o.b / o.a),
                            n.data[i + r + 3] = Math.floor(255 * o.a)
                        };
                        if (e.clips)
                            for (var o = 0, s = 0; o < r; ++o,
                            s += 4 * i)
                                for (var l = 0, u = 0; l < i; l++,
                                u += 4) {
                                    var c = l / (i - 1)
                                      , h = e.clips[o];
                                    a(s, u, h.start * (1 - c) + h.end * c)
                                }
                        else
                            for (var p = 0, f = 0; p < i; p++,
                            f += 4)
                                a(0, f, p / (i - 1));
                        return n
                    }
                    var wo = function(e) {
                        function t(t) {
                            e.call(this, t, xo),
                            this._updateColorRamp()
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.createBucket = function(e) {
                            return new fo(e)
                        }
                        ,
                        t.prototype._handleSpecialPaintPropertyUpdate = function(e) {
                            "heatmap-color" === e && this._updateColorRamp()
                        }
                        ,
                        t.prototype._updateColorRamp = function() {
                            this.colorRamp = bo({
                                expression: this._transitionablePaint._values["heatmap-color"].value.expression,
                                evaluationKey: "heatmapDensity",
                                image: this.colorRamp
                            }),
                            this.colorRampTexture = null
                        }
                        ,
                        t.prototype.resize = function() {
                            this.heatmapFbo && (this.heatmapFbo.destroy(),
                            this.heatmapFbo = null)
                        }
                        ,
                        t.prototype.queryRadius = function() {
                            return 0
                        }
                        ,
                        t.prototype.queryIntersectsFeature = function() {
                            return !1
                        }
                        ,
                        t.prototype.hasOffscreenPass = function() {
                            return 0 !== this.paint.get("heatmap-opacity") && "none" !== this.visibility
                        }
                        ,
                        t
                    }(wn)
                      , So = {
                        paint: new bn({
                            "hillshade-illumination-direction": new vn(Ce.paint_hillshade["hillshade-illumination-direction"]),
                            "hillshade-illumination-anchor": new vn(Ce.paint_hillshade["hillshade-illumination-anchor"]),
                            "hillshade-exaggeration": new vn(Ce.paint_hillshade["hillshade-exaggeration"]),
                            "hillshade-shadow-color": new vn(Ce.paint_hillshade["hillshade-shadow-color"]),
                            "hillshade-highlight-color": new vn(Ce.paint_hillshade["hillshade-highlight-color"]),
                            "hillshade-accent-color": new vn(Ce.paint_hillshade["hillshade-accent-color"])
                        })
                    }
                      , Mo = function(e) {
                        function t(t) {
                            e.call(this, t, So)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.hasOffscreenPass = function() {
                            return 0 !== this.paint.get("hillshade-exaggeration") && "none" !== this.visibility
                        }
                        ,
                        t
                    }(wn)
                      , To = En([{
                        name: "a_pos",
                        components: 2,
                        type: "Int16"
                    }], 4).members
                      , Eo = Po
                      , Ao = Po;
                    function Po(e, t, i) {
                        i = i || 2;
                        var r, n, a, o, s, l, u, c = t && t.length, h = c ? t[0] * i : e.length, p = Co(e, 0, h, i, !0), f = [];
                        if (!p || p.next === p.prev)
                            return f;
                        if (c && (p = function(e, t, i, r) {
                            var n, a, o, s = [];
                            for (n = 0,
                            a = t.length; n < a; n++)
                                (o = Co(e, t[n] * r, n < a - 1 ? t[n + 1] * r : e.length, r, !1)) === o.next && (o.steiner = !0),
                                s.push(Uo(o));
                            for (s.sort(Oo),
                            n = 0; n < s.length; n++)
                                Bo(s[n], i),
                                i = Lo(i, i.next);
                            return i
                        }(e, t, p, i)),
                        e.length > 80 * i) {
                            r = a = e[0],
                            n = o = e[1];
                            for (var d = i; d < h; d += i)
                                (s = e[d]) < r && (r = s),
                                (l = e[d + 1]) < n && (n = l),
                                s > a && (a = s),
                                l > o && (o = l);
                            u = 0 !== (u = Math.max(a - r, o - n)) ? 1 / u : 0
                        }
                        return Io(p, f, i, r, n, u),
                        f
                    }
                    function Co(e, t, i, r, n) {
                        var a, o;
                        if (n === $o(e, t, i, r) > 0)
                            for (a = t; a < i; a += r)
                                o = Ko(a, e[a], e[a + 1], o);
                        else
                            for (a = i - r; a >= t; a -= r)
                                o = Ko(a, e[a], e[a + 1], o);
                        return o && Ho(o, o.next) && (Jo(o),
                        o = o.next),
                        o
                    }
                    function Lo(e, t) {
                        if (!e)
                            return e;
                        t || (t = e);
                        var i, r = e;
                        do {
                            if (i = !1,
                            r.steiner || !Ho(r, r.next) && 0 !== jo(r.prev, r, r.next))
                                r = r.next;
                            else {
                                if (Jo(r),
                                (r = t = r.prev) === r.next)
                                    break;
                                i = !0
                            }
                        } while (i || r !== t);
                        return t
                    }
                    function Io(e, t, i, r, n, a, o) {
                        if (e) {
                            !o && a && function(e, t, i, r) {
                                var n = e;
                                do {
                                    null === n.z && (n.z = No(n.x, n.y, t, i, r)),
                                    n.prevZ = n.prev,
                                    n.nextZ = n.next,
                                    n = n.next
                                } while (n !== e);
                                n.prevZ.nextZ = null,
                                n.prevZ = null,
                                function(e) {
                                    var t, i, r, n, a, o, s, l, u = 1;
                                    do {
                                        for (i = e,
                                        e = null,
                                        a = null,
                                        o = 0; i; ) {
                                            for (o++,
                                            r = i,
                                            s = 0,
                                            t = 0; t < u && (s++,
                                            r = r.nextZ); t++)
                                                ;
                                            for (l = u; s > 0 || l > 0 && r; )
                                                0 !== s && (0 === l || !r || i.z <= r.z) ? (n = i,
                                                i = i.nextZ,
                                                s--) : (n = r,
                                                r = r.nextZ,
                                                l--),
                                                a ? a.nextZ = n : e = n,
                                                n.prevZ = a,
                                                a = n;
                                            i = r
                                        }
                                        a.nextZ = null,
                                        u *= 2
                                    } while (o > 1)
                                }(n)
                            }(e, r, n, a);
                            for (var s, l, u = e; e.prev !== e.next; )
                                if (s = e.prev,
                                l = e.next,
                                a ? zo(e, r, n, a) : ko(e))
                                    t.push(s.i / i),
                                    t.push(e.i / i),
                                    t.push(l.i / i),
                                    Jo(e),
                                    e = l.next,
                                    u = l.next;
                                else if ((e = l) === u) {
                                    o ? 1 === o ? Io(e = Do(Lo(e), t, i), t, i, r, n, a, 2) : 2 === o && Ro(e, t, i, r, n, a) : Io(Lo(e), t, i, r, n, a, 1);
                                    break
                                }
                        }
                    }
                    function ko(e) {
                        var t = e.prev
                          , i = e
                          , r = e.next;
                        if (jo(t, i, r) >= 0)
                            return !1;
                        for (var n = e.next.next; n !== e.prev; ) {
                            if (Vo(t.x, t.y, i.x, i.y, r.x, r.y, n.x, n.y) && jo(n.prev, n, n.next) >= 0)
                                return !1;
                            n = n.next
                        }
                        return !0
                    }
                    function zo(e, t, i, r) {
                        var n = e.prev
                          , a = e
                          , o = e.next;
                        if (jo(n, a, o) >= 0)
                            return !1;
                        for (var s = n.x > a.x ? n.x > o.x ? n.x : o.x : a.x > o.x ? a.x : o.x, l = n.y > a.y ? n.y > o.y ? n.y : o.y : a.y > o.y ? a.y : o.y, u = No(n.x < a.x ? n.x < o.x ? n.x : o.x : a.x < o.x ? a.x : o.x, n.y < a.y ? n.y < o.y ? n.y : o.y : a.y < o.y ? a.y : o.y, t, i, r), c = No(s, l, t, i, r), h = e.prevZ, p = e.nextZ; h && h.z >= u && p && p.z <= c; ) {
                            if (h !== e.prev && h !== e.next && Vo(n.x, n.y, a.x, a.y, o.x, o.y, h.x, h.y) && jo(h.prev, h, h.next) >= 0)
                                return !1;
                            if (h = h.prevZ,
                            p !== e.prev && p !== e.next && Vo(n.x, n.y, a.x, a.y, o.x, o.y, p.x, p.y) && jo(p.prev, p, p.next) >= 0)
                                return !1;
                            p = p.nextZ
                        }
                        for (; h && h.z >= u; ) {
                            if (h !== e.prev && h !== e.next && Vo(n.x, n.y, a.x, a.y, o.x, o.y, h.x, h.y) && jo(h.prev, h, h.next) >= 0)
                                return !1;
                            h = h.prevZ
                        }
                        for (; p && p.z <= c; ) {
                            if (p !== e.prev && p !== e.next && Vo(n.x, n.y, a.x, a.y, o.x, o.y, p.x, p.y) && jo(p.prev, p, p.next) >= 0)
                                return !1;
                            p = p.nextZ
                        }
                        return !0
                    }
                    function Do(e, t, i) {
                        var r = e;
                        do {
                            var n = r.prev
                              , a = r.next.next;
                            !Ho(n, a) && qo(n, r, r.next, a) && Xo(n, a) && Xo(a, n) && (t.push(n.i / i),
                            t.push(r.i / i),
                            t.push(a.i / i),
                            Jo(r),
                            Jo(r.next),
                            r = e = a),
                            r = r.next
                        } while (r !== e);
                        return Lo(r)
                    }
                    function Ro(e, t, i, r, n, a) {
                        var o = e;
                        do {
                            for (var s = o.next.next; s !== o.prev; ) {
                                if (o.i !== s.i && Go(o, s)) {
                                    var l = Yo(o, s);
                                    return o = Lo(o, o.next),
                                    l = Lo(l, l.next),
                                    Io(o, t, i, r, n, a),
                                    void Io(l, t, i, r, n, a)
                                }
                                s = s.next
                            }
                            o = o.next
                        } while (o !== e)
                    }
                    function Oo(e, t) {
                        return e.x - t.x
                    }
                    function Bo(e, t) {
                        if (t = function(e, t) {
                            var i, r = t, n = e.x, a = e.y, o = -1 / 0;
                            do {
                                if (a <= r.y && a >= r.next.y && r.next.y !== r.y) {
                                    var s = r.x + (a - r.y) * (r.next.x - r.x) / (r.next.y - r.y);
                                    if (s <= n && s > o) {
                                        if (o = s,
                                        s === n) {
                                            if (a === r.y)
                                                return r;
                                            if (a === r.next.y)
                                                return r.next
                                        }
                                        i = r.x < r.next.x ? r : r.next
                                    }
                                }
                                r = r.next
                            } while (r !== t);
                            if (!i)
                                return null;
                            if (n === o)
                                return i;
                            var l, u = i, c = i.x, h = i.y, p = 1 / 0;
                            r = i;
                            do {
                                n >= r.x && r.x >= c && n !== r.x && Vo(a < h ? n : o, a, c, h, a < h ? o : n, a, r.x, r.y) && (l = Math.abs(a - r.y) / (n - r.x),
                                Xo(r, e) && (l < p || l === p && (r.x > i.x || r.x === i.x && Fo(i, r))) && (i = r,
                                p = l)),
                                r = r.next
                            } while (r !== u);
                            return i
                        }(e, t)) {
                            var i = Yo(t, e);
                            Lo(t, t.next),
                            Lo(i, i.next)
                        }
                    }
                    function Fo(e, t) {
                        return jo(e.prev, e, t.prev) < 0 && jo(t.next, e, e.next) < 0
                    }
                    function No(e, t, i, r, n) {
                        return (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - i) * n) | e << 8)) | e << 4)) | e << 2)) | e << 1)) | (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - r) * n) | t << 8)) | t << 4)) | t << 2)) | t << 1)) << 1
                    }
                    function Uo(e) {
                        var t = e
                          , i = e;
                        do {
                            (t.x < i.x || t.x === i.x && t.y < i.y) && (i = t),
                            t = t.next
                        } while (t !== e);
                        return i
                    }
                    function Vo(e, t, i, r, n, a, o, s) {
                        return (n - o) * (t - s) - (e - o) * (a - s) >= 0 && (e - o) * (r - s) - (i - o) * (t - s) >= 0 && (i - o) * (a - s) - (n - o) * (r - s) >= 0
                    }
                    function Go(e, t) {
                        return e.next.i !== t.i && e.prev.i !== t.i && !function(e, t) {
                            var i = e;
                            do {
                                if (i.i !== e.i && i.next.i !== e.i && i.i !== t.i && i.next.i !== t.i && qo(i, i.next, e, t))
                                    return !0;
                                i = i.next
                            } while (i !== e);
                            return !1
                        }(e, t) && (Xo(e, t) && Xo(t, e) && function(e, t) {
                            var i = e
                              , r = !1
                              , n = (e.x + t.x) / 2
                              , a = (e.y + t.y) / 2;
                            do {
                                i.y > a != i.next.y > a && i.next.y !== i.y && n < (i.next.x - i.x) * (a - i.y) / (i.next.y - i.y) + i.x && (r = !r),
                                i = i.next
                            } while (i !== e);
                            return r
                        }(e, t) && (jo(e.prev, e, t.prev) || jo(e, t.prev, t)) || Ho(e, t) && jo(e.prev, e, e.next) > 0 && jo(t.prev, t, t.next) > 0)
                    }
                    function jo(e, t, i) {
                        return (t.y - e.y) * (i.x - t.x) - (t.x - e.x) * (i.y - t.y)
                    }
                    function Ho(e, t) {
                        return e.x === t.x && e.y === t.y
                    }
                    function qo(e, t, i, r) {
                        var n = Zo(jo(e, t, i))
                          , a = Zo(jo(e, t, r))
                          , o = Zo(jo(i, r, e))
                          , s = Zo(jo(i, r, t));
                        return n !== a && o !== s || !(0 !== n || !Wo(e, i, t)) || !(0 !== a || !Wo(e, r, t)) || !(0 !== o || !Wo(i, e, r)) || !(0 !== s || !Wo(i, t, r))
                    }
                    function Wo(e, t, i) {
                        return t.x <= Math.max(e.x, i.x) && t.x >= Math.min(e.x, i.x) && t.y <= Math.max(e.y, i.y) && t.y >= Math.min(e.y, i.y)
                    }
                    function Zo(e) {
                        return e > 0 ? 1 : e < 0 ? -1 : 0
                    }
                    function Xo(e, t) {
                        return jo(e.prev, e, e.next) < 0 ? jo(e, t, e.next) >= 0 && jo(e, e.prev, t) >= 0 : jo(e, t, e.prev) < 0 || jo(e, e.next, t) < 0
                    }
                    function Yo(e, t) {
                        var i = new Qo(e.i,e.x,e.y)
                          , r = new Qo(t.i,t.x,t.y)
                          , n = e.next
                          , a = t.prev;
                        return e.next = t,
                        t.prev = e,
                        i.next = n,
                        n.prev = i,
                        r.next = i,
                        i.prev = r,
                        a.next = r,
                        r.prev = a,
                        r
                    }
                    function Ko(e, t, i, r) {
                        var n = new Qo(e,t,i);
                        return r ? (n.next = r.next,
                        n.prev = r,
                        r.next.prev = n,
                        r.next = n) : (n.prev = n,
                        n.next = n),
                        n
                    }
                    function Jo(e) {
                        e.next.prev = e.prev,
                        e.prev.next = e.next,
                        e.prevZ && (e.prevZ.nextZ = e.nextZ),
                        e.nextZ && (e.nextZ.prevZ = e.prevZ)
                    }
                    function Qo(e, t, i) {
                        this.i = e,
                        this.x = t,
                        this.y = i,
                        this.prev = null,
                        this.next = null,
                        this.z = null,
                        this.prevZ = null,
                        this.nextZ = null,
                        this.steiner = !1
                    }
                    function $o(e, t, i, r) {
                        for (var n = 0, a = t, o = i - r; a < i; a += r)
                            n += (e[o] - e[a]) * (e[a + 1] + e[o + 1]),
                            o = a;
                        return n
                    }
                    function es(e, t, i, r, n) {
                        !function e(t, i, r, n, a) {
                            for (; n > r; ) {
                                if (n - r > 600) {
                                    var o = n - r + 1
                                      , s = i - r + 1
                                      , l = Math.log(o)
                                      , u = .5 * Math.exp(2 * l / 3)
                                      , c = .5 * Math.sqrt(l * u * (o - u) / o) * (s - o / 2 < 0 ? -1 : 1);
                                    e(t, i, Math.max(r, Math.floor(i - s * u / o + c)), Math.min(n, Math.floor(i + (o - s) * u / o + c)), a)
                                }
                                var h = t[i]
                                  , p = r
                                  , f = n;
                                for (ts(t, r, i),
                                a(t[n], h) > 0 && ts(t, r, n); p < f; ) {
                                    for (ts(t, p, f),
                                    p++,
                                    f--; a(t[p], h) < 0; )
                                        p++;
                                    for (; a(t[f], h) > 0; )
                                        f--
                                }
                                0 === a(t[r], h) ? ts(t, r, f) : ts(t, ++f, n),
                                f <= i && (r = f + 1),
                                i <= f && (n = f - 1)
                            }
                        }(e, t, i || 0, r || e.length - 1, n || is)
                    }
                    function ts(e, t, i) {
                        var r = e[t];
                        e[t] = e[i],
                        e[i] = r
                    }
                    function is(e, t) {
                        return e < t ? -1 : e > t ? 1 : 0
                    }
                    function rs(e, t) {
                        var i = e.length;
                        if (i <= 1)
                            return [e];
                        for (var r, n, a = [], o = 0; o < i; o++) {
                            var s = T(e[o]);
                            0 !== s && (e[o].area = Math.abs(s),
                            void 0 === n && (n = s < 0),
                            n === s < 0 ? (r && a.push(r),
                            r = [e[o]]) : r.push(e[o]))
                        }
                        if (r && a.push(r),
                        t > 1)
                            for (var l = 0; l < a.length; l++)
                                a[l].length <= t || (es(a[l], t, 1, a[l].length - 1, ns),
                                a[l] = a[l].slice(0, t));
                        return a
                    }
                    function ns(e, t) {
                        return t.area - e.area
                    }
                    function as(e, t, i) {
                        for (var r = i.patternDependencies, n = !1, a = 0, o = t; a < o.length; a += 1) {
                            var s = o[a].paint.get(e + "-pattern");
                            s.isConstant() || (n = !0);
                            var l = s.constantOr(null);
                            l && (n = !0,
                            r[l.to] = !0,
                            r[l.from] = !0)
                        }
                        return n
                    }
                    function os(e, t, i, r, n) {
                        for (var a = n.patternDependencies, o = 0, s = t; o < s.length; o += 1) {
                            var l = s[o]
                              , u = l.paint.get(e + "-pattern").value;
                            if ("constant" !== u.kind) {
                                var c = u.evaluate({
                                    zoom: r - 1
                                }, i, {}, n.availableImages)
                                  , h = u.evaluate({
                                    zoom: r
                                }, i, {}, n.availableImages)
                                  , p = u.evaluate({
                                    zoom: r + 1
                                }, i, {}, n.availableImages);
                                h = h && h.name ? h.name : h,
                                p = p && p.name ? p.name : p,
                                a[c = c && c.name ? c.name : c] = !0,
                                a[h] = !0,
                                a[p] = !0,
                                i.patterns[l.id] = {
                                    min: c,
                                    mid: h,
                                    max: p
                                }
                            }
                        }
                        return i
                    }
                    Po.deviation = function(e, t, i, r) {
                        var n = t && t.length
                          , a = Math.abs($o(e, 0, n ? t[0] * i : e.length, i));
                        if (n)
                            for (var o = 0, s = t.length; o < s; o++)
                                a -= Math.abs($o(e, t[o] * i, o < s - 1 ? t[o + 1] * i : e.length, i));
                        var l = 0;
                        for (o = 0; o < r.length; o += 3) {
                            var u = r[o] * i
                              , c = r[o + 1] * i
                              , h = r[o + 2] * i;
                            l += Math.abs((e[u] - e[h]) * (e[c + 1] - e[u + 1]) - (e[u] - e[c]) * (e[h + 1] - e[u + 1]))
                        }
                        return 0 === a && 0 === l ? 0 : Math.abs((l - a) / a)
                    }
                    ,
                    Po.flatten = function(e) {
                        for (var t = e[0][0].length, i = {
                            vertices: [],
                            holes: [],
                            dimensions: t
                        }, r = 0, n = 0; n < e.length; n++) {
                            for (var a = 0; a < e[n].length; a++)
                                for (var o = 0; o < t; o++)
                                    i.vertices.push(e[n][a][o]);
                            n > 0 && i.holes.push(r += e[n - 1].length)
                        }
                        return i
                    }
                    ,
                    Eo.default = Ao;
                    var ss = function(e) {
                        this.zoom = e.zoom,
                        this.overscaling = e.overscaling,
                        this.layers = e.layers,
                        this.layerIds = this.layers.map((function(e) {
                            return e.id
                        }
                        )),
                        this.index = e.index,
                        this.hasPattern = !1,
                        this.patternFeatures = [],
                        this.layoutVertexArray = new Pn,
                        this.indexArray = new Vn,
                        this.indexArray2 = new Zn,
                        this.programConfigurations = new Da(e.layers,e.zoom),
                        this.segments = new sa,
                        this.segments2 = new sa,
                        this.stateDependentLayerIds = this.layers.filter((function(e) {
                            return e.isStateDependent()
                        }
                        )).map((function(e) {
                            return e.id
                        }
                        ))
                    };
                    ss.prototype.populate = function(e, t, i) {
                        this.hasPattern = as("fill", this.layers, t);
                        for (var r = this.layers[0].layout.get("fill-sort-key"), n = [], a = 0, o = e; a < o.length; a += 1) {
                            var s = o[a]
                              , l = s.feature
                              , u = s.id
                              , c = s.index
                              , h = s.sourceLayerIndex
                              , p = this.layers[0]._featureFilter.needGeometry
                              , f = Ua(l, p);
                            if (this.layers[0]._featureFilter.filter(new sn(this.zoom), f, i)) {
                                var d = r ? r.evaluate(f, {}, i, t.availableImages) : void 0
                                  , m = {
                                    id: u,
                                    properties: l.properties,
                                    type: l.type,
                                    sourceLayerIndex: h,
                                    index: c,
                                    geometry: p ? f.geometry : Na(l),
                                    patterns: {},
                                    sortKey: d
                                };
                                n.push(m)
                            }
                        }
                        r && n.sort((function(e, t) {
                            return e.sortKey - t.sortKey
                        }
                        ));
                        for (var v = 0, g = n; v < g.length; v += 1) {
                            var y = g[v]
                              , _ = y.geometry
                              , x = y.index
                              , b = y.sourceLayerIndex;
                            if (this.hasPattern) {
                                var w = os("fill", this.layers, y, this.zoom, t);
                                this.patternFeatures.push(w)
                            } else
                                this.addFeature(y, _, x, i, {});
                            t.featureIndex.insert(e[x].feature, _, x, b, this.index)
                        }
                    }
                    ,
                    ss.prototype.update = function(e, t, i) {
                        this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(e, t, this.stateDependentLayers, i)
                    }
                    ,
                    ss.prototype.addFeatures = function(e, t, i) {
                        for (var r = 0, n = this.patternFeatures; r < n.length; r += 1) {
                            var a = n[r];
                            this.addFeature(a, a.geometry, a.index, t, i)
                        }
                    }
                    ,
                    ss.prototype.isEmpty = function() {
                        return 0 === this.layoutVertexArray.length
                    }
                    ,
                    ss.prototype.uploadPending = function() {
                        return !this.uploaded || this.programConfigurations.needsUpload
                    }
                    ,
                    ss.prototype.upload = function(e) {
                        this.uploaded || (this.layoutVertexBuffer = e.createVertexBuffer(this.layoutVertexArray, To),
                        this.indexBuffer = e.createIndexBuffer(this.indexArray),
                        this.indexBuffer2 = e.createIndexBuffer(this.indexArray2)),
                        this.programConfigurations.upload(e),
                        this.uploaded = !0
                    }
                    ,
                    ss.prototype.destroy = function() {
                        this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(),
                        this.indexBuffer.destroy(),
                        this.indexBuffer2.destroy(),
                        this.programConfigurations.destroy(),
                        this.segments.destroy(),
                        this.segments2.destroy())
                    }
                    ,
                    ss.prototype.addFeature = function(e, t, i, r, n) {
                        for (var a = 0, o = rs(t, 500); a < o.length; a += 1) {
                            for (var s = o[a], l = 0, u = 0, c = s; u < c.length; u += 1)
                                l += c[u].length;
                            for (var h = this.segments.prepareSegment(l, this.layoutVertexArray, this.indexArray), p = h.vertexLength, f = [], d = [], m = 0, v = s; m < v.length; m += 1) {
                                var g = v[m];
                                if (0 !== g.length) {
                                    g !== s[0] && d.push(f.length / 2);
                                    var y = this.segments2.prepareSegment(g.length, this.layoutVertexArray, this.indexArray2)
                                      , _ = y.vertexLength;
                                    this.layoutVertexArray.emplaceBack(g[0].x, g[0].y),
                                    this.indexArray2.emplaceBack(_ + g.length - 1, _),
                                    f.push(g[0].x),
                                    f.push(g[0].y);
                                    for (var x = 1; x < g.length; x++)
                                        this.layoutVertexArray.emplaceBack(g[x].x, g[x].y),
                                        this.indexArray2.emplaceBack(_ + x - 1, _ + x),
                                        f.push(g[x].x),
                                        f.push(g[x].y);
                                    y.vertexLength += g.length,
                                    y.primitiveLength += g.length
                                }
                            }
                            for (var b = Eo(f, d), w = 0; w < b.length; w += 3)
                                this.indexArray.emplaceBack(p + b[w], p + b[w + 1], p + b[w + 2]);
                            h.vertexLength += l,
                            h.primitiveLength += b.length / 3
                        }
                        this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, e, i, n, r)
                    }
                    ,
                    Br("FillBucket", ss, {
                        omit: ["layers", "patternFeatures"]
                    });
                    var ls = new bn({
                        "fill-sort-key": new gn(Ce.layout_fill["fill-sort-key"])
                    })
                      , us = {
                        paint: new bn({
                            "fill-antialias": new vn(Ce.paint_fill["fill-antialias"]),
                            "fill-opacity": new gn(Ce.paint_fill["fill-opacity"]),
                            "fill-color": new gn(Ce.paint_fill["fill-color"]),
                            "fill-outline-color": new gn(Ce.paint_fill["fill-outline-color"]),
                            "fill-translate": new vn(Ce.paint_fill["fill-translate"]),
                            "fill-translate-anchor": new vn(Ce.paint_fill["fill-translate-anchor"]),
                            "fill-pattern": new yn(Ce.paint_fill["fill-pattern"])
                        }),
                        layout: ls
                    }
                      , cs = function(e) {
                        function t(t) {
                            e.call(this, t, us)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.recalculate = function(t, i) {
                            e.prototype.recalculate.call(this, t, i);
                            var r = this.paint._values["fill-outline-color"];
                            "constant" === r.value.kind && void 0 === r.value.value && (this.paint._values["fill-outline-color"] = this.paint._values["fill-color"])
                        }
                        ,
                        t.prototype.createBucket = function(e) {
                            return new ss(e)
                        }
                        ,
                        t.prototype.queryRadius = function() {
                            return to(this.paint.get("fill-translate"))
                        }
                        ,
                        t.prototype.queryIntersectsFeature = function(e, t, i, r, n, a, o) {
                            return qa(io(e, this.paint.get("fill-translate"), this.paint.get("fill-translate-anchor"), a.angle, o), r)
                        }
                        ,
                        t.prototype.isTileClipped = function() {
                            return !0
                        }
                        ,
                        t
                    }(wn)
                      , hs = En([{
                        name: "a_pos",
                        components: 2,
                        type: "Int16"
                    }, {
                        name: "a_normal_ed",
                        components: 4,
                        type: "Int16"
                    }], 4).members
                      , ps = fs;
                    function fs(e, t, i, r, n) {
                        this.properties = {},
                        this.extent = i,
                        this.type = 0,
                        this._pbf = e,
                        this._geometry = -1,
                        this._keys = r,
                        this._values = n,
                        e.readFields(ds, this, t)
                    }
                    function ds(e, t, i) {
                        1 == e ? t.id = i.readVarint() : 2 == e ? function(e, t) {
                            for (var i = e.readVarint() + e.pos; e.pos < i; ) {
                                var r = t._keys[e.readVarint()]
                                  , n = t._values[e.readVarint()];
                                t.properties[r] = n
                            }
                        }(i, t) : 3 == e ? t.type = i.readVarint() : 4 == e && (t._geometry = i.pos)
                    }
                    function ms(e) {
                        for (var t, i, r = 0, n = 0, a = e.length, o = a - 1; n < a; o = n++)
                            r += ((i = e[o]).x - (t = e[n]).x) * (t.y + i.y);
                        return r
                    }
                    fs.types = ["Unknown", "Point", "LineString", "Polygon"],
                    fs.prototype.loadGeometry = function() {
                        var e = this._pbf;
                        e.pos = this._geometry;
                        for (var t, i = e.readVarint() + e.pos, r = 1, a = 0, o = 0, s = 0, l = []; e.pos < i; ) {
                            if (a <= 0) {
                                var u = e.readVarint();
                                r = 7 & u,
                                a = u >> 3
                            }
                            if (a--,
                            1 === r || 2 === r)
                                o += e.readSVarint(),
                                s += e.readSVarint(),
                                1 === r && (t && l.push(t),
                                t = []),
                                t.push(new n(o,s));
                            else {
                                if (7 !== r)
                                    throw new Error("unknown command " + r);
                                t && t.push(t[0].clone())
                            }
                        }
                        return t && l.push(t),
                        l
                    }
                    ,
                    fs.prototype.bbox = function() {
                        var e = this._pbf;
                        e.pos = this._geometry;
                        for (var t = e.readVarint() + e.pos, i = 1, r = 0, n = 0, a = 0, o = 1 / 0, s = -1 / 0, l = 1 / 0, u = -1 / 0; e.pos < t; ) {
                            if (r <= 0) {
                                var c = e.readVarint();
                                i = 7 & c,
                                r = c >> 3
                            }
                            if (r--,
                            1 === i || 2 === i)
                                (n += e.readSVarint()) < o && (o = n),
                                n > s && (s = n),
                                (a += e.readSVarint()) < l && (l = a),
                                a > u && (u = a);
                            else if (7 !== i)
                                throw new Error("unknown command " + i)
                        }
                        return [o, l, s, u]
                    }
                    ,
                    fs.prototype.toGeoJSON = function(e, t, i) {
                        var r, n, a = this.extent * Math.pow(2, i), o = this.extent * e, s = this.extent * t, l = this.loadGeometry(), u = fs.types[this.type];
                        function c(e) {
                            for (var t = 0; t < e.length; t++) {
                                var i = e[t];
                                e[t] = [360 * (i.x + o) / a - 180, 360 / Math.PI * Math.atan(Math.exp((180 - 360 * (i.y + s) / a) * Math.PI / 180)) - 90]
                            }
                        }
                        switch (this.type) {
                        case 1:
                            var h = [];
                            for (r = 0; r < l.length; r++)
                                h[r] = l[r][0];
                            c(l = h);
                            break;
                        case 2:
                            for (r = 0; r < l.length; r++)
                                c(l[r]);
                            break;
                        case 3:
                            for (l = function(e) {
                                var t = e.length;
                                if (t <= 1)
                                    return [e];
                                for (var i, r, n = [], a = 0; a < t; a++) {
                                    var o = ms(e[a]);
                                    0 !== o && (void 0 === r && (r = o < 0),
                                    r === o < 0 ? (i && n.push(i),
                                    i = [e[a]]) : i.push(e[a]))
                                }
                                return i && n.push(i),
                                n
                            }(l),
                            r = 0; r < l.length; r++)
                                for (n = 0; n < l[r].length; n++)
                                    c(l[r][n])
                        }
                        1 === l.length ? l = l[0] : u = "Multi" + u;
                        var p = {
                            type: "Feature",
                            geometry: {
                                type: u,
                                coordinates: l
                            },
                            properties: this.properties
                        };
                        return "id"in this && (p.id = this.id),
                        p
                    }
                    ;
                    var vs = gs;
                    function gs(e, t) {
                        this.version = 1,
                        this.name = null,
                        this.extent = 4096,
                        this.length = 0,
                        this._pbf = e,
                        this._keys = [],
                        this._values = [],
                        this._features = [],
                        e.readFields(ys, this, t),
                        this.length = this._features.length
                    }
                    function ys(e, t, i) {
                        15 === e ? t.version = i.readVarint() : 1 === e ? t.name = i.readString() : 5 === e ? t.extent = i.readVarint() : 2 === e ? t._features.push(i.pos) : 3 === e ? t._keys.push(i.readString()) : 4 === e && t._values.push(function(e) {
                            for (var t = null, i = e.readVarint() + e.pos; e.pos < i; ) {
                                var r = e.readVarint() >> 3;
                                t = 1 === r ? e.readString() : 2 === r ? e.readFloat() : 3 === r ? e.readDouble() : 4 === r ? e.readVarint64() : 5 === r ? e.readVarint() : 6 === r ? e.readSVarint() : 7 === r ? e.readBoolean() : null
                            }
                            return t
                        }(i))
                    }
                    function _s(e, t, i) {
                        if (3 === e) {
                            var r = new vs(i,i.readVarint() + i.pos);
                            r.length && (t[r.name] = r)
                        }
                    }
                    gs.prototype.feature = function(e) {
                        if (e < 0 || e >= this._features.length)
                            throw new Error("feature index out of bounds");
                        this._pbf.pos = this._features[e];
                        var t = this._pbf.readVarint() + this._pbf.pos;
                        return new ps(this._pbf,t,this.extent,this._keys,this._values)
                    }
                    ;
                    var xs = {
                        VectorTile: function(e, t) {
                            this.layers = e.readFields(_s, {}, t)
                        },
                        VectorTileFeature: ps,
                        VectorTileLayer: vs
                    }
                      , bs = xs.VectorTileFeature.types
                      , ws = Math.pow(2, 13);
                    function Ss(e, t, i, r, n, a, o, s) {
                        e.emplaceBack(t, i, 2 * Math.floor(r * ws) + o, n * ws * 2, a * ws * 2, Math.round(s))
                    }
                    var Ms = function(e) {
                        this.zoom = e.zoom,
                        this.overscaling = e.overscaling,
                        this.layers = e.layers,
                        this.layerIds = this.layers.map((function(e) {
                            return e.id
                        }
                        )),
                        this.index = e.index,
                        this.hasPattern = !1,
                        this.layoutVertexArray = new Ln,
                        this.indexArray = new Vn,
                        this.programConfigurations = new Da(e.layers,e.zoom),
                        this.segments = new sa,
                        this.stateDependentLayerIds = this.layers.filter((function(e) {
                            return e.isStateDependent()
                        }
                        )).map((function(e) {
                            return e.id
                        }
                        ))
                    };
                    function Ts(e, t) {
                        return e.x === t.x && (e.x < 0 || e.x > 8192) || e.y === t.y && (e.y < 0 || e.y > 8192)
                    }
                    Ms.prototype.populate = function(e, t, i) {
                        this.features = [],
                        this.hasPattern = as("fill-extrusion", this.layers, t);
                        for (var r = 0, n = e; r < n.length; r += 1) {
                            var a = n[r]
                              , o = a.feature
                              , s = a.id
                              , l = a.index
                              , u = a.sourceLayerIndex
                              , c = this.layers[0]._featureFilter.needGeometry
                              , h = Ua(o, c);
                            if (this.layers[0]._featureFilter.filter(new sn(this.zoom), h, i)) {
                                var p = {
                                    id: s,
                                    sourceLayerIndex: u,
                                    index: l,
                                    geometry: c ? h.geometry : Na(o),
                                    properties: o.properties,
                                    type: o.type,
                                    patterns: {}
                                };
                                this.hasPattern ? this.features.push(os("fill-extrusion", this.layers, p, this.zoom, t)) : this.addFeature(p, p.geometry, l, i, {}),
                                t.featureIndex.insert(o, p.geometry, l, u, this.index, !0)
                            }
                        }
                    }
                    ,
                    Ms.prototype.addFeatures = function(e, t, i) {
                        for (var r = 0, n = this.features; r < n.length; r += 1) {
                            var a = n[r];
                            this.addFeature(a, a.geometry, a.index, t, i)
                        }
                    }
                    ,
                    Ms.prototype.update = function(e, t, i) {
                        this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(e, t, this.stateDependentLayers, i)
                    }
                    ,
                    Ms.prototype.isEmpty = function() {
                        return 0 === this.layoutVertexArray.length
                    }
                    ,
                    Ms.prototype.uploadPending = function() {
                        return !this.uploaded || this.programConfigurations.needsUpload
                    }
                    ,
                    Ms.prototype.upload = function(e) {
                        this.uploaded || (this.layoutVertexBuffer = e.createVertexBuffer(this.layoutVertexArray, hs),
                        this.indexBuffer = e.createIndexBuffer(this.indexArray)),
                        this.programConfigurations.upload(e),
                        this.uploaded = !0
                    }
                    ,
                    Ms.prototype.destroy = function() {
                        this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(),
                        this.indexBuffer.destroy(),
                        this.programConfigurations.destroy(),
                        this.segments.destroy())
                    }
                    ,
                    Ms.prototype.addFeature = function(e, t, i, r, n) {
                        for (var a = 0, o = rs(t, 500); a < o.length; a += 1) {
                            for (var s = o[a], l = 0, u = 0, c = s; u < c.length; u += 1)
                                l += c[u].length;
                            for (var h = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray), p = 0, f = s; p < f.length; p += 1) {
                                var d = f[p];
                                if (0 !== d.length && !((k = d).every((function(e) {
                                    return e.x < 0
                                }
                                )) || k.every((function(e) {
                                    return e.x > 8192
                                }
                                )) || k.every((function(e) {
                                    return e.y < 0
                                }
                                )) || k.every((function(e) {
                                    return e.y > 8192
                                }
                                ))))
                                    for (var m = 0, v = 0; v < d.length; v++) {
                                        var g = d[v];
                                        if (v >= 1) {
                                            var y = d[v - 1];
                                            if (!Ts(g, y)) {
                                                h.vertexLength + 4 > sa.MAX_VERTEX_ARRAY_LENGTH && (h = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray));
                                                var _ = g.sub(y)._perp()._unit()
                                                  , x = y.dist(g);
                                                m + x > 32768 && (m = 0),
                                                Ss(this.layoutVertexArray, g.x, g.y, _.x, _.y, 0, 0, m),
                                                Ss(this.layoutVertexArray, g.x, g.y, _.x, _.y, 0, 1, m),
                                                Ss(this.layoutVertexArray, y.x, y.y, _.x, _.y, 0, 0, m += x),
                                                Ss(this.layoutVertexArray, y.x, y.y, _.x, _.y, 0, 1, m);
                                                var b = h.vertexLength;
                                                this.indexArray.emplaceBack(b, b + 2, b + 1),
                                                this.indexArray.emplaceBack(b + 1, b + 2, b + 3),
                                                h.vertexLength += 4,
                                                h.primitiveLength += 2
                                            }
                                        }
                                    }
                            }
                            if (h.vertexLength + l > sa.MAX_VERTEX_ARRAY_LENGTH && (h = this.segments.prepareSegment(l, this.layoutVertexArray, this.indexArray)),
                            "Polygon" === bs[e.type]) {
                                for (var w = [], S = [], M = h.vertexLength, T = 0, E = s; T < E.length; T += 1) {
                                    var A = E[T];
                                    if (0 !== A.length) {
                                        A !== s[0] && S.push(w.length / 2);
                                        for (var P = 0; P < A.length; P++) {
                                            var C = A[P];
                                            Ss(this.layoutVertexArray, C.x, C.y, 0, 0, 1, 1, 0),
                                            w.push(C.x),
                                            w.push(C.y)
                                        }
                                    }
                                }
                                for (var L = Eo(w, S), I = 0; I < L.length; I += 3)
                                    this.indexArray.emplaceBack(M + L[I], M + L[I + 2], M + L[I + 1]);
                                h.primitiveLength += L.length / 3,
                                h.vertexLength += l
                            }
                        }
                        var k;
                        this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, e, i, n, r)
                    }
                    ,
                    Br("FillExtrusionBucket", Ms, {
                        omit: ["layers", "features"]
                    });
                    var Es = {
                        paint: new bn({
                            "fill-extrusion-opacity": new vn(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),
                            "fill-extrusion-color": new gn(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),
                            "fill-extrusion-translate": new vn(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),
                            "fill-extrusion-translate-anchor": new vn(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),
                            "fill-extrusion-pattern": new yn(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),
                            "fill-extrusion-height": new gn(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),
                            "fill-extrusion-base": new gn(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),
                            "fill-extrusion-vertical-gradient": new vn(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])
                        })
                    }
                      , As = function(e) {
                        function t(t) {
                            e.call(this, t, Es)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.createBucket = function(e) {
                            return new Ms(e)
                        }
                        ,
                        t.prototype.queryRadius = function() {
                            return to(this.paint.get("fill-extrusion-translate"))
                        }
                        ,
                        t.prototype.is3D = function() {
                            return !0
                        }
                        ,
                        t.prototype.queryIntersectsFeature = function(e, t, i, r, a, o, s, l) {
                            var u = io(e, this.paint.get("fill-extrusion-translate"), this.paint.get("fill-extrusion-translate-anchor"), o.angle, s)
                              , c = this.paint.get("fill-extrusion-height").evaluate(t, i)
                              , h = this.paint.get("fill-extrusion-base").evaluate(t, i)
                              , p = function(e, t, i, r) {
                                for (var a = [], o = 0, s = e; o < s.length; o += 1) {
                                    var l = s[o]
                                      , u = [l.x, l.y, 0, 1];
                                    co(u, u, t),
                                    a.push(new n(u[0] / u[3],u[1] / u[3]))
                                }
                                return a
                            }(u, l)
                              , f = function(e, t, i, r) {
                                for (var a = [], o = [], s = r[8] * t, l = r[9] * t, u = r[10] * t, c = r[11] * t, h = r[8] * i, p = r[9] * i, f = r[10] * i, d = r[11] * i, m = 0, v = e; m < v.length; m += 1) {
                                    for (var g = [], y = [], _ = 0, x = v[m]; _ < x.length; _ += 1) {
                                        var b = x[_]
                                          , w = b.x
                                          , S = b.y
                                          , M = r[0] * w + r[4] * S + r[12]
                                          , T = r[1] * w + r[5] * S + r[13]
                                          , E = r[2] * w + r[6] * S + r[14]
                                          , A = r[3] * w + r[7] * S + r[15]
                                          , P = E + u
                                          , C = A + c
                                          , L = M + h
                                          , I = T + p
                                          , k = E + f
                                          , z = A + d
                                          , D = new n((M + s) / C,(T + l) / C);
                                        D.z = P / C,
                                        g.push(D);
                                        var R = new n(L / z,I / z);
                                        R.z = k / z,
                                        y.push(R)
                                    }
                                    a.push(g),
                                    o.push(y)
                                }
                                return [a, o]
                            }(r, h, c, l);
                            return function(e, t, i) {
                                var r = 1 / 0;
                                qa(i, t) && (r = Cs(i, t[0]));
                                for (var n = 0; n < t.length; n++)
                                    for (var a = t[n], o = e[n], s = 0; s < a.length - 1; s++) {
                                        var l = a[s]
                                          , u = [l, a[s + 1], o[s + 1], o[s], l];
                                        ja(i, u) && (r = Math.min(r, Cs(i, u)))
                                    }
                                return r !== 1 / 0 && r
                            }(f[0], f[1], p)
                        }
                        ,
                        t
                    }(wn);
                    function Ps(e, t) {
                        return e.x * t.x + e.y * t.y
                    }
                    function Cs(e, t) {
                        if (1 === e.length) {
                            for (var i, r = 0, n = t[r++]; !i || n.equals(i); )
                                if (!(i = t[r++]))
                                    return 1 / 0;
                            for (; r < t.length; r++) {
                                var a = t[r]
                                  , o = e[0]
                                  , s = i.sub(n)
                                  , l = a.sub(n)
                                  , u = o.sub(n)
                                  , c = Ps(s, s)
                                  , h = Ps(s, l)
                                  , p = Ps(l, l)
                                  , f = Ps(u, s)
                                  , d = Ps(u, l)
                                  , m = c * p - h * h
                                  , v = (p * f - h * d) / m
                                  , g = (c * d - h * f) / m
                                  , y = n.z * (1 - v - g) + i.z * v + a.z * g;
                                if (isFinite(y))
                                    return y
                            }
                            return 1 / 0
                        }
                        for (var _ = 1 / 0, x = 0, b = t; x < b.length; x += 1)
                            _ = Math.min(_, b[x].z);
                        return _
                    }
                    var Ls = En([{
                        name: "a_pos_normal",
                        components: 2,
                        type: "Int16"
                    }, {
                        name: "a_data",
                        components: 4,
                        type: "Uint8"
                    }], 4).members
                      , Is = En([{
                        name: "a_uv_x",
                        components: 1,
                        type: "Float32"
                    }, {
                        name: "a_split_index",
                        components: 1,
                        type: "Float32"
                    }]).members
                      , ks = xs.VectorTileFeature.types
                      , zs = Math.cos(Math.PI / 180 * 37.5)
                      , Ds = Math.pow(2, 14) / .5
                      , Rs = function(e) {
                        var t = this;
                        this.zoom = e.zoom,
                        this.overscaling = e.overscaling,
                        this.layers = e.layers,
                        this.layerIds = this.layers.map((function(e) {
                            return e.id
                        }
                        )),
                        this.index = e.index,
                        this.hasPattern = !1,
                        this.patternFeatures = [],
                        this.lineClipsArray = [],
                        this.gradients = {},
                        this.layers.forEach((function(e) {
                            t.gradients[e.id] = {}
                        }
                        )),
                        this.layoutVertexArray = new In,
                        this.layoutVertexArray2 = new kn,
                        this.indexArray = new Vn,
                        this.programConfigurations = new Da(e.layers,e.zoom),
                        this.segments = new sa,
                        this.maxLineLength = 0,
                        this.stateDependentLayerIds = this.layers.filter((function(e) {
                            return e.isStateDependent()
                        }
                        )).map((function(e) {
                            return e.id
                        }
                        ))
                    };
                    Rs.prototype.populate = function(e, t, i) {
                        this.hasPattern = as("line", this.layers, t);
                        for (var r = this.layers[0].layout.get("line-sort-key"), n = [], a = 0, o = e; a < o.length; a += 1) {
                            var s = o[a]
                              , l = s.feature
                              , u = s.id
                              , c = s.index
                              , h = s.sourceLayerIndex
                              , p = this.layers[0]._featureFilter.needGeometry
                              , f = Ua(l, p);
                            if (this.layers[0]._featureFilter.filter(new sn(this.zoom), f, i)) {
                                var d = r ? r.evaluate(f, {}, i) : void 0
                                  , m = {
                                    id: u,
                                    properties: l.properties,
                                    type: l.type,
                                    sourceLayerIndex: h,
                                    index: c,
                                    geometry: p ? f.geometry : Na(l),
                                    patterns: {},
                                    sortKey: d
                                };
                                n.push(m)
                            }
                        }
                        r && n.sort((function(e, t) {
                            return e.sortKey - t.sortKey
                        }
                        ));
                        for (var v = 0, g = n; v < g.length; v += 1) {
                            var y = g[v]
                              , _ = y.geometry
                              , x = y.index
                              , b = y.sourceLayerIndex;
                            if (this.hasPattern) {
                                var w = os("line", this.layers, y, this.zoom, t);
                                this.patternFeatures.push(w)
                            } else
                                this.addFeature(y, _, x, i, {});
                            t.featureIndex.insert(e[x].feature, _, x, b, this.index)
                        }
                    }
                    ,
                    Rs.prototype.update = function(e, t, i) {
                        this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(e, t, this.stateDependentLayers, i)
                    }
                    ,
                    Rs.prototype.addFeatures = function(e, t, i) {
                        for (var r = 0, n = this.patternFeatures; r < n.length; r += 1) {
                            var a = n[r];
                            this.addFeature(a, a.geometry, a.index, t, i)
                        }
                    }
                    ,
                    Rs.prototype.isEmpty = function() {
                        return 0 === this.layoutVertexArray.length
                    }
                    ,
                    Rs.prototype.uploadPending = function() {
                        return !this.uploaded || this.programConfigurations.needsUpload
                    }
                    ,
                    Rs.prototype.upload = function(e) {
                        this.uploaded || (0 !== this.layoutVertexArray2.length && (this.layoutVertexBuffer2 = e.createVertexBuffer(this.layoutVertexArray2, Is)),
                        this.layoutVertexBuffer = e.createVertexBuffer(this.layoutVertexArray, Ls),
                        this.indexBuffer = e.createIndexBuffer(this.indexArray)),
                        this.programConfigurations.upload(e),
                        this.uploaded = !0
                    }
                    ,
                    Rs.prototype.destroy = function() {
                        this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(),
                        this.indexBuffer.destroy(),
                        this.programConfigurations.destroy(),
                        this.segments.destroy())
                    }
                    ,
                    Rs.prototype.lineFeatureClips = function(e) {
                        if (e.properties && e.properties.hasOwnProperty("mapbox_clip_start") && e.properties.hasOwnProperty("mapbox_clip_end"))
                            return {
                                start: +e.properties.mapbox_clip_start,
                                end: +e.properties.mapbox_clip_end
                            }
                    }
                    ,
                    Rs.prototype.addFeature = function(e, t, i, r, n) {
                        var a = this.layers[0].layout
                          , o = a.get("line-join").evaluate(e, {})
                          , s = a.get("line-cap")
                          , l = a.get("line-miter-limit")
                          , u = a.get("line-round-limit");
                        this.lineClips = this.lineFeatureClips(e);
                        for (var c = 0, h = t; c < h.length; c += 1)
                            this.addLine(h[c], e, o, s, l, u);
                        this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, e, i, n, r)
                    }
                    ,
                    Rs.prototype.addLine = function(e, t, i, r, n, a) {
                        if (this.distance = 0,
                        this.scaledDistance = 0,
                        this.totalDistance = 0,
                        this.lineClips) {
                            this.lineClipsArray.push(this.lineClips);
                            for (var o = 0; o < e.length - 1; o++)
                                this.totalDistance += e[o].dist(e[o + 1]);
                            this.updateScaledDistance(),
                            this.maxLineLength = Math.max(this.maxLineLength, this.totalDistance)
                        }
                        for (var s = "Polygon" === ks[t.type], l = e.length; l >= 2 && e[l - 1].equals(e[l - 2]); )
                            l--;
                        for (var u = 0; u < l - 1 && e[u].equals(e[u + 1]); )
                            u++;
                        if (!(l < (s ? 3 : 2))) {
                            "bevel" === i && (n = 1.05);
                            var c, h = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0, p = this.segments.prepareSegment(10 * l, this.layoutVertexArray, this.indexArray), f = void 0, d = void 0, m = void 0, v = void 0;
                            this.e1 = this.e2 = -1,
                            s && (v = e[u].sub(c = e[l - 2])._unit()._perp());
                            for (var g = u; g < l; g++)
                                if (!(d = g === l - 1 ? s ? e[u + 1] : void 0 : e[g + 1]) || !e[g].equals(d)) {
                                    v && (m = v),
                                    c && (f = c),
                                    c = e[g],
                                    v = d ? d.sub(c)._unit()._perp() : m;
                                    var y = (m = m || v).add(v);
                                    0 === y.x && 0 === y.y || y._unit();
                                    var _ = m.x * v.x + m.y * v.y
                                      , x = y.x * v.x + y.y * v.y
                                      , b = 0 !== x ? 1 / x : 1 / 0
                                      , w = 2 * Math.sqrt(2 - 2 * x)
                                      , S = x < zs && f && d
                                      , M = m.x * v.y - m.y * v.x > 0;
                                    if (S && g > u) {
                                        var T = c.dist(f);
                                        if (T > 2 * h) {
                                            var E = c.sub(c.sub(f)._mult(h / T)._round());
                                            this.updateDistance(f, E),
                                            this.addCurrentVertex(E, m, 0, 0, p),
                                            f = E
                                        }
                                    }
                                    var A = f && d
                                      , P = A ? i : s ? "butt" : r;
                                    if (A && "round" === P && (b < a ? P = "miter" : b <= 2 && (P = "fakeround")),
                                    "miter" === P && b > n && (P = "bevel"),
                                    "bevel" === P && (b > 2 && (P = "flipbevel"),
                                    b < n && (P = "miter")),
                                    f && this.updateDistance(f, c),
                                    "miter" === P)
                                        y._mult(b),
                                        this.addCurrentVertex(c, y, 0, 0, p);
                                    else if ("flipbevel" === P) {
                                        if (b > 100)
                                            y = v.mult(-1);
                                        else {
                                            var C = b * m.add(v).mag() / m.sub(v).mag();
                                            y._perp()._mult(C * (M ? -1 : 1))
                                        }
                                        this.addCurrentVertex(c, y, 0, 0, p),
                                        this.addCurrentVertex(c, y.mult(-1), 0, 0, p)
                                    } else if ("bevel" === P || "fakeround" === P) {
                                        var L = -Math.sqrt(b * b - 1)
                                          , I = M ? L : 0
                                          , k = M ? 0 : L;
                                        if (f && this.addCurrentVertex(c, m, I, k, p),
                                        "fakeround" === P)
                                            for (var z = Math.round(180 * w / Math.PI / 20), D = 1; D < z; D++) {
                                                var R = D / z;
                                                if (.5 !== R) {
                                                    var O = R - .5;
                                                    R += R * O * (R - 1) * ((1.0904 + _ * (_ * (3.55645 - 1.43519 * _) - 3.2452)) * O * O + (.848013 + _ * (.215638 * _ - 1.06021)))
                                                }
                                                var B = v.sub(m)._mult(R)._add(m)._unit()._mult(M ? -1 : 1);
                                                this.addHalfVertex(c, B.x, B.y, !1, M, 0, p)
                                            }
                                        d && this.addCurrentVertex(c, v, -I, -k, p)
                                    } else if ("butt" === P)
                                        this.addCurrentVertex(c, y, 0, 0, p);
                                    else if ("square" === P) {
                                        var F = f ? 1 : -1;
                                        this.addCurrentVertex(c, y, F, F, p)
                                    } else
                                        "round" === P && (f && (this.addCurrentVertex(c, m, 0, 0, p),
                                        this.addCurrentVertex(c, m, 1, 1, p, !0)),
                                        d && (this.addCurrentVertex(c, v, -1, -1, p, !0),
                                        this.addCurrentVertex(c, v, 0, 0, p)));
                                    if (S && g < l - 1) {
                                        var N = c.dist(d);
                                        if (N > 2 * h) {
                                            var U = c.add(d.sub(c)._mult(h / N)._round());
                                            this.updateDistance(c, U),
                                            this.addCurrentVertex(U, v, 0, 0, p),
                                            c = U
                                        }
                                    }
                                }
                        }
                    }
                    ,
                    Rs.prototype.addCurrentVertex = function(e, t, i, r, n, a) {
                        void 0 === a && (a = !1);
                        var o = t.y * r - t.x
                          , s = -t.y - t.x * r;
                        this.addHalfVertex(e, t.x + t.y * i, t.y - t.x * i, a, !1, i, n),
                        this.addHalfVertex(e, o, s, a, !0, -r, n),
                        this.distance > Ds / 2 && 0 === this.totalDistance && (this.distance = 0,
                        this.addCurrentVertex(e, t, i, r, n, a))
                    }
                    ,
                    Rs.prototype.addHalfVertex = function(e, t, i, r, n, a, o) {
                        var s = .5 * (this.lineClips ? this.scaledDistance * (Ds - 1) : this.scaledDistance);
                        this.layoutVertexArray.emplaceBack((e.x << 1) + (r ? 1 : 0), (e.y << 1) + (n ? 1 : 0), Math.round(63 * t) + 128, Math.round(63 * i) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1) | (63 & s) << 2, s >> 6),
                        this.lineClips && this.layoutVertexArray2.emplaceBack((this.scaledDistance - this.lineClips.start) / (this.lineClips.end - this.lineClips.start), this.lineClipsArray.length);
                        var l = o.vertexLength++;
                        this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, l),
                        o.primitiveLength++),
                        n ? this.e2 = l : this.e1 = l
                    }
                    ,
                    Rs.prototype.updateScaledDistance = function() {
                        this.scaledDistance = this.lineClips ? this.lineClips.start + (this.lineClips.end - this.lineClips.start) * this.distance / this.totalDistance : this.distance
                    }
                    ,
                    Rs.prototype.updateDistance = function(e, t) {
                        this.distance += e.dist(t),
                        this.updateScaledDistance()
                    }
                    ,
                    Br("LineBucket", Rs, {
                        omit: ["layers", "patternFeatures"]
                    });
                    var Os = new bn({
                        "line-cap": new vn(Ce.layout_line["line-cap"]),
                        "line-join": new gn(Ce.layout_line["line-join"]),
                        "line-miter-limit": new vn(Ce.layout_line["line-miter-limit"]),
                        "line-round-limit": new vn(Ce.layout_line["line-round-limit"]),
                        "line-sort-key": new gn(Ce.layout_line["line-sort-key"])
                    })
                      , Bs = {
                        paint: new bn({
                            "line-opacity": new gn(Ce.paint_line["line-opacity"]),
                            "line-color": new gn(Ce.paint_line["line-color"]),
                            "line-translate": new vn(Ce.paint_line["line-translate"]),
                            "line-translate-anchor": new vn(Ce.paint_line["line-translate-anchor"]),
                            "line-width": new gn(Ce.paint_line["line-width"]),
                            "line-gap-width": new gn(Ce.paint_line["line-gap-width"]),
                            "line-offset": new gn(Ce.paint_line["line-offset"]),
                            "line-blur": new gn(Ce.paint_line["line-blur"]),
                            "line-dasharray": new _n(Ce.paint_line["line-dasharray"]),
                            "line-pattern": new yn(Ce.paint_line["line-pattern"]),
                            "line-gradient": new xn(Ce.paint_line["line-gradient"])
                        }),
                        layout: Os
                    }
                      , Fs = new (function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.possiblyEvaluate = function(t, i) {
                            return i = new sn(Math.floor(i.zoom),{
                                now: i.now,
                                fadeDuration: i.fadeDuration,
                                zoomHistory: i.zoomHistory,
                                transition: i.transition
                            }),
                            e.prototype.possiblyEvaluate.call(this, t, i)
                        }
                        ,
                        t.prototype.evaluate = function(t, i, r, n) {
                            return i = p({}, i, {
                                zoom: Math.floor(i.zoom)
                            }),
                            e.prototype.evaluate.call(this, t, i, r, n)
                        }
                        ,
                        t
                    }(gn))(Bs.paint.properties["line-width"].specification);
                    Fs.useIntegerZoom = !0;
                    var Ns = function(e) {
                        function t(t) {
                            e.call(this, t, Bs),
                            this.gradientVersion = 0
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._handleSpecialPaintPropertyUpdate = function(e) {
                            "line-gradient" === e && (this.stepInterpolant = this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof jt,
                            this.gradientVersion = (this.gradientVersion + 1) % s)
                        }
                        ,
                        t.prototype.gradientExpression = function() {
                            return this._transitionablePaint._values["line-gradient"].value.expression
                        }
                        ,
                        t.prototype.recalculate = function(t, i) {
                            e.prototype.recalculate.call(this, t, i),
                            this.paint._values["line-floorwidth"] = Fs.possiblyEvaluate(this._transitioningPaint._values["line-width"].value, t)
                        }
                        ,
                        t.prototype.createBucket = function(e) {
                            return new Rs(e)
                        }
                        ,
                        t.prototype.queryRadius = function(e) {
                            var t = e
                              , i = Us(eo("line-width", this, t), eo("line-gap-width", this, t))
                              , r = eo("line-offset", this, t);
                            return i / 2 + Math.abs(r) + to(this.paint.get("line-translate"))
                        }
                        ,
                        t.prototype.queryIntersectsFeature = function(e, t, i, r, a, o, s) {
                            var l = io(e, this.paint.get("line-translate"), this.paint.get("line-translate-anchor"), o.angle, s)
                              , u = s / 2 * Us(this.paint.get("line-width").evaluate(t, i), this.paint.get("line-gap-width").evaluate(t, i))
                              , c = this.paint.get("line-offset").evaluate(t, i);
                            return c && (r = function(e, t) {
                                for (var i = [], r = new n(0,0), a = 0; a < e.length; a++) {
                                    for (var o = e[a], s = [], l = 0; l < o.length; l++) {
                                        var u = o[l]
                                          , c = o[l + 1]
                                          , h = 0 === l ? r : u.sub(o[l - 1])._unit()._perp()
                                          , p = l === o.length - 1 ? r : c.sub(u)._unit()._perp()
                                          , f = h._add(p)._unit();
                                        f._mult(1 / (f.x * p.x + f.y * p.y)),
                                        s.push(f._mult(t)._add(u))
                                    }
                                    i.push(s)
                                }
                                return i
                            }(r, c * s)),
                            function(e, t, i) {
                                for (var r = 0; r < t.length; r++) {
                                    var n = t[r];
                                    if (e.length >= 3)
                                        for (var a = 0; a < n.length; a++)
                                            if (Qa(e, n[a]))
                                                return !0;
                                    if (Wa(e, n, i))
                                        return !0
                                }
                                return !1
                            }(l, r, u)
                        }
                        ,
                        t.prototype.isTileClipped = function() {
                            return !0
                        }
                        ,
                        t
                    }(wn);
                    function Us(e, t) {
                        return t > 0 ? t + 2 * e : e
                    }
                    var Vs = En([{
                        name: "a_pos_offset",
                        components: 4,
                        type: "Int16"
                    }, {
                        name: "a_data",
                        components: 4,
                        type: "Uint16"
                    }, {
                        name: "a_pixeloffset",
                        components: 4,
                        type: "Int16"
                    }], 4)
                      , Gs = En([{
                        name: "a_projected_pos",
                        components: 3,
                        type: "Float32"
                    }], 4)
                      , js = (En([{
                        name: "a_fade_opacity",
                        components: 1,
                        type: "Uint32"
                    }], 4),
                    En([{
                        name: "a_placed",
                        components: 2,
                        type: "Uint8"
                    }, {
                        name: "a_shift",
                        components: 2,
                        type: "Float32"
                    }]))
                      , Hs = (En([{
                        type: "Int16",
                        name: "anchorPointX"
                    }, {
                        type: "Int16",
                        name: "anchorPointY"
                    }, {
                        type: "Int16",
                        name: "x1"
                    }, {
                        type: "Int16",
                        name: "y1"
                    }, {
                        type: "Int16",
                        name: "x2"
                    }, {
                        type: "Int16",
                        name: "y2"
                    }, {
                        type: "Uint32",
                        name: "featureIndex"
                    }, {
                        type: "Uint16",
                        name: "sourceLayerIndex"
                    }, {
                        type: "Uint16",
                        name: "bucketIndex"
                    }]),
                    En([{
                        name: "a_pos",
                        components: 2,
                        type: "Int16"
                    }, {
                        name: "a_anchor_pos",
                        components: 2,
                        type: "Int16"
                    }, {
                        name: "a_extrude",
                        components: 2,
                        type: "Int16"
                    }], 4))
                      , qs = En([{
                        name: "a_pos",
                        components: 2,
                        type: "Float32"
                    }, {
                        name: "a_radius",
                        components: 1,
                        type: "Float32"
                    }, {
                        name: "a_flags",
                        components: 2,
                        type: "Int16"
                    }], 4);
                    function Ws(e, t, i) {
                        return e.sections.forEach((function(e) {
                            e.text = function(e, t, i) {
                                var r = t.layout.get("text-transform").evaluate(i, {});
                                return "uppercase" === r ? e = e.toLocaleUpperCase() : "lowercase" === r && (e = e.toLocaleLowerCase()),
                                on.applyArabicShaping && (e = on.applyArabicShaping(e)),
                                e
                            }(e.text, t, i)
                        }
                        )),
                        e
                    }
                    En([{
                        name: "triangle",
                        components: 3,
                        type: "Uint16"
                    }]),
                    En([{
                        type: "Int16",
                        name: "anchorX"
                    }, {
                        type: "Int16",
                        name: "anchorY"
                    }, {
                        type: "Uint16",
                        name: "glyphStartIndex"
                    }, {
                        type: "Uint16",
                        name: "numGlyphs"
                    }, {
                        type: "Uint32",
                        name: "vertexStartIndex"
                    }, {
                        type: "Uint32",
                        name: "lineStartIndex"
                    }, {
                        type: "Uint32",
                        name: "lineLength"
                    }, {
                        type: "Uint16",
                        name: "segment"
                    }, {
                        type: "Uint16",
                        name: "lowerSize"
                    }, {
                        type: "Uint16",
                        name: "upperSize"
                    }, {
                        type: "Float32",
                        name: "lineOffsetX"
                    }, {
                        type: "Float32",
                        name: "lineOffsetY"
                    }, {
                        type: "Uint8",
                        name: "writingMode"
                    }, {
                        type: "Uint8",
                        name: "placedOrientation"
                    }, {
                        type: "Uint8",
                        name: "hidden"
                    }, {
                        type: "Uint32",
                        name: "crossTileID"
                    }, {
                        type: "Int16",
                        name: "associatedIconIndex"
                    }]),
                    En([{
                        type: "Int16",
                        name: "anchorX"
                    }, {
                        type: "Int16",
                        name: "anchorY"
                    }, {
                        type: "Int16",
                        name: "rightJustifiedTextSymbolIndex"
                    }, {
                        type: "Int16",
                        name: "centerJustifiedTextSymbolIndex"
                    }, {
                        type: "Int16",
                        name: "leftJustifiedTextSymbolIndex"
                    }, {
                        type: "Int16",
                        name: "verticalPlacedTextSymbolIndex"
                    }, {
                        type: "Int16",
                        name: "placedIconSymbolIndex"
                    }, {
                        type: "Int16",
                        name: "verticalPlacedIconSymbolIndex"
                    }, {
                        type: "Uint16",
                        name: "key"
                    }, {
                        type: "Uint16",
                        name: "textBoxStartIndex"
                    }, {
                        type: "Uint16",
                        name: "textBoxEndIndex"
                    }, {
                        type: "Uint16",
                        name: "verticalTextBoxStartIndex"
                    }, {
                        type: "Uint16",
                        name: "verticalTextBoxEndIndex"
                    }, {
                        type: "Uint16",
                        name: "iconBoxStartIndex"
                    }, {
                        type: "Uint16",
                        name: "iconBoxEndIndex"
                    }, {
                        type: "Uint16",
                        name: "verticalIconBoxStartIndex"
                    }, {
                        type: "Uint16",
                        name: "verticalIconBoxEndIndex"
                    }, {
                        type: "Uint16",
                        name: "featureIndex"
                    }, {
                        type: "Uint16",
                        name: "numHorizontalGlyphVertices"
                    }, {
                        type: "Uint16",
                        name: "numVerticalGlyphVertices"
                    }, {
                        type: "Uint16",
                        name: "numIconVertices"
                    }, {
                        type: "Uint16",
                        name: "numVerticalIconVertices"
                    }, {
                        type: "Uint16",
                        name: "useRuntimeCollisionCircles"
                    }, {
                        type: "Uint32",
                        name: "crossTileID"
                    }, {
                        type: "Float32",
                        name: "textBoxScale"
                    }, {
                        type: "Float32",
                        components: 2,
                        name: "textOffset"
                    }, {
                        type: "Float32",
                        name: "collisionCircleDiameter"
                    }]),
                    En([{
                        type: "Float32",
                        name: "offsetX"
                    }]),
                    En([{
                        type: "Int16",
                        name: "x"
                    }, {
                        type: "Int16",
                        name: "y"
                    }, {
                        type: "Int16",
                        name: "tileUnitDistanceFromAnchor"
                    }]);
                    var Zs = {
                        "!": "",
                        "#": "",
                        $: "",
                        "%": "",
                        "&": "",
                        "(": "",
                        ")": "",
                        "*": "",
                        "+": "",
                        ",": "",
                        "-": "",
                        ".": "",
                        "/": "",
                        ":": "",
                        ";": "",
                        "<": "",
                        "=": "",
                        ">": "",
                        "?": "",
                        "@": "",
                        "[": "",
                        "\\": "",
                        "]": "",
                        "^": "",
                        _: "",
                        "`": "",
                        "{": "",
                        "|": "",
                        "}": "",
                        "~": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": "",
                        "": ""
                    }
                      , Xs = function(e, t, i, r, n) {
                        var a, o, s = 8 * n - r - 1, l = (1 << s) - 1, u = l >> 1, c = -7, h = i ? n - 1 : 0, p = i ? -1 : 1, f = e[t + h];
                        for (h += p,
                        a = f & (1 << -c) - 1,
                        f >>= -c,
                        c += s; c > 0; a = 256 * a + e[t + h],
                        h += p,
                        c -= 8)
                            ;
                        for (o = a & (1 << -c) - 1,
                        a >>= -c,
                        c += r; c > 0; o = 256 * o + e[t + h],
                        h += p,
                        c -= 8)
                            ;
                        if (0 === a)
                            a = 1 - u;
                        else {
                            if (a === l)
                                return o ? NaN : 1 / 0 * (f ? -1 : 1);
                            o += Math.pow(2, r),
                            a -= u
                        }
                        return (f ? -1 : 1) * o * Math.pow(2, a - r)
                    }
                      , Ys = function(e, t, i, r, n, a) {
                        var o, s, l, u = 8 * a - n - 1, c = (1 << u) - 1, h = c >> 1, p = 23 === n ? Math.pow(2, -24) - Math.pow(2, -77) : 0, f = r ? 0 : a - 1, d = r ? 1 : -1, m = t < 0 || 0 === t && 1 / t < 0 ? 1 : 0;
                        for (t = Math.abs(t),
                        isNaN(t) || t === 1 / 0 ? (s = isNaN(t) ? 1 : 0,
                        o = c) : (o = Math.floor(Math.log(t) / Math.LN2),
                        t * (l = Math.pow(2, -o)) < 1 && (o--,
                        l *= 2),
                        (t += o + h >= 1 ? p / l : p * Math.pow(2, 1 - h)) * l >= 2 && (o++,
                        l /= 2),
                        o + h >= c ? (s = 0,
                        o = c) : o + h >= 1 ? (s = (t * l - 1) * Math.pow(2, n),
                        o += h) : (s = t * Math.pow(2, h - 1) * Math.pow(2, n),
                        o = 0)); n >= 8; e[i + f] = 255 & s,
                        f += d,
                        s /= 256,
                        n -= 8)
                            ;
                        for (o = o << n | s,
                        u += n; u > 0; e[i + f] = 255 & o,
                        f += d,
                        o /= 256,
                        u -= 8)
                            ;
                        e[i + f - d] |= 128 * m
                    }
                      , Ks = Js;
                    function Js(e) {
                        this.buf = ArrayBuffer.isView && ArrayBuffer.isView(e) ? e : new Uint8Array(e || 0),
                        this.pos = 0,
                        this.type = 0,
                        this.length = this.buf.length
                    }
                    Js.Varint = 0,
                    Js.Fixed64 = 1,
                    Js.Bytes = 2,
                    Js.Fixed32 = 5;
                    var Qs = "undefined" == typeof TextDecoder ? null : new TextDecoder("utf8");
                    function $s(e) {
                        return e.type === Js.Bytes ? e.readVarint() + e.pos : e.pos + 1
                    }
                    function el(e, t, i) {
                        return i ? 4294967296 * t + (e >>> 0) : 4294967296 * (t >>> 0) + (e >>> 0)
                    }
                    function tl(e, t, i) {
                        var r = t <= 16383 ? 1 : t <= 2097151 ? 2 : t <= 268435455 ? 3 : Math.floor(Math.log(t) / (7 * Math.LN2));
                        i.realloc(r);
                        for (var n = i.pos - 1; n >= e; n--)
                            i.buf[n + r] = i.buf[n]
                    }
                    function il(e, t) {
                        for (var i = 0; i < e.length; i++)
                            t.writeVarint(e[i])
                    }
                    function rl(e, t) {
                        for (var i = 0; i < e.length; i++)
                            t.writeSVarint(e[i])
                    }
                    function nl(e, t) {
                        for (var i = 0; i < e.length; i++)
                            t.writeFloat(e[i])
                    }
                    function al(e, t) {
                        for (var i = 0; i < e.length; i++)
                            t.writeDouble(e[i])
                    }
                    function ol(e, t) {
                        for (var i = 0; i < e.length; i++)
                            t.writeBoolean(e[i])
                    }
                    function sl(e, t) {
                        for (var i = 0; i < e.length; i++)
                            t.writeFixed32(e[i])
                    }
                    function ll(e, t) {
                        for (var i = 0; i < e.length; i++)
                            t.writeSFixed32(e[i])
                    }
                    function ul(e, t) {
                        for (var i = 0; i < e.length; i++)
                            t.writeFixed64(e[i])
                    }
                    function cl(e, t) {
                        for (var i = 0; i < e.length; i++)
                            t.writeSFixed64(e[i])
                    }
                    function hl(e, t) {
                        return (e[t] | e[t + 1] << 8 | e[t + 2] << 16) + 16777216 * e[t + 3]
                    }
                    function pl(e, t, i) {
                        e[i] = t,
                        e[i + 1] = t >>> 8,
                        e[i + 2] = t >>> 16,
                        e[i + 3] = t >>> 24
                    }
                    function fl(e, t) {
                        return (e[t] | e[t + 1] << 8 | e[t + 2] << 16) + (e[t + 3] << 24)
                    }
                    function dl(e, t, i) {
                        1 === e && i.readMessage(ml, t)
                    }
                    function ml(e, t, i) {
                        if (3 === e) {
                            var r = i.readMessage(vl, {})
                              , n = r.width
                              , a = r.height
                              , o = r.left
                              , s = r.top
                              , l = r.advance;
                            t.push({
                                id: r.id,
                                bitmap: new yo({
                                    width: n + 6,
                                    height: a + 6
                                },r.bitmap),
                                metrics: {
                                    width: n,
                                    height: a,
                                    left: o,
                                    top: s,
                                    advance: l
                                }
                            })
                        }
                    }
                    function vl(e, t, i) {
                        1 === e ? t.id = i.readVarint() : 2 === e ? t.bitmap = i.readBytes() : 3 === e ? t.width = i.readVarint() : 4 === e ? t.height = i.readVarint() : 5 === e ? t.left = i.readSVarint() : 6 === e ? t.top = i.readSVarint() : 7 === e && (t.advance = i.readVarint())
                    }
                    function gl(e) {
                        for (var t = 0, i = 0, r = 0, n = e; r < n.length; r += 1) {
                            var a = n[r];
                            t += a.w * a.h,
                            i = Math.max(i, a.w)
                        }
                        e.sort((function(e, t) {
                            return t.h - e.h
                        }
                        ));
                        for (var o = [{
                            x: 0,
                            y: 0,
                            w: Math.max(Math.ceil(Math.sqrt(t / .95)), i),
                            h: 1 / 0
                        }], s = 0, l = 0, u = 0, c = e; u < c.length; u += 1)
                            for (var h = c[u], p = o.length - 1; p >= 0; p--) {
                                var f = o[p];
                                if (!(h.w > f.w || h.h > f.h)) {
                                    if (h.x = f.x,
                                    h.y = f.y,
                                    l = Math.max(l, h.y + h.h),
                                    s = Math.max(s, h.x + h.w),
                                    h.w === f.w && h.h === f.h) {
                                        var d = o.pop();
                                        p < o.length && (o[p] = d)
                                    } else
                                        h.h === f.h ? (f.x += h.w,
                                        f.w -= h.w) : h.w === f.w ? (f.y += h.h,
                                        f.h -= h.h) : (o.push({
                                            x: f.x + h.w,
                                            y: f.y,
                                            w: f.w - h.w,
                                            h: h.h
                                        }),
                                        f.y += h.h,
                                        f.h -= h.h);
                                    break
                                }
                            }
                        return {
                            w: s,
                            h: l,
                            fill: t / (s * l) || 0
                        }
                    }
                    Js.prototype = {
                        destroy: function() {
                            this.buf = null
                        },
                        readFields: function(e, t, i) {
                            for (i = i || this.length; this.pos < i; ) {
                                var r = this.readVarint()
                                  , n = r >> 3
                                  , a = this.pos;
                                this.type = 7 & r,
                                e(n, t, this),
                                this.pos === a && this.skip(r)
                            }
                            return t
                        },
                        readMessage: function(e, t) {
                            return this.readFields(e, t, this.readVarint() + this.pos)
                        },
                        readFixed32: function() {
                            var e = hl(this.buf, this.pos);
                            return this.pos += 4,
                            e
                        },
                        readSFixed32: function() {
                            var e = fl(this.buf, this.pos);
                            return this.pos += 4,
                            e
                        },
                        readFixed64: function() {
                            var e = hl(this.buf, this.pos) + 4294967296 * hl(this.buf, this.pos + 4);
                            return this.pos += 8,
                            e
                        },
                        readSFixed64: function() {
                            var e = hl(this.buf, this.pos) + 4294967296 * fl(this.buf, this.pos + 4);
                            return this.pos += 8,
                            e
                        },
                        readFloat: function() {
                            var e = Xs(this.buf, this.pos, !0, 23, 4);
                            return this.pos += 4,
                            e
                        },
                        readDouble: function() {
                            var e = Xs(this.buf, this.pos, !0, 52, 8);
                            return this.pos += 8,
                            e
                        },
                        readVarint: function(e) {
                            var t, i, r = this.buf;
                            return t = 127 & (i = r[this.pos++]),
                            i < 128 ? t : (t |= (127 & (i = r[this.pos++])) << 7,
                            i < 128 ? t : (t |= (127 & (i = r[this.pos++])) << 14,
                            i < 128 ? t : (t |= (127 & (i = r[this.pos++])) << 21,
                            i < 128 ? t : function(e, t, i) {
                                var r, n, a = i.buf;
                                if (r = (112 & (n = a[i.pos++])) >> 4,
                                n < 128)
                                    return el(e, r, t);
                                if (r |= (127 & (n = a[i.pos++])) << 3,
                                n < 128)
                                    return el(e, r, t);
                                if (r |= (127 & (n = a[i.pos++])) << 10,
                                n < 128)
                                    return el(e, r, t);
                                if (r |= (127 & (n = a[i.pos++])) << 17,
                                n < 128)
                                    return el(e, r, t);
                                if (r |= (127 & (n = a[i.pos++])) << 24,
                                n < 128)
                                    return el(e, r, t);
                                if (r |= (1 & (n = a[i.pos++])) << 31,
                                n < 128)
                                    return el(e, r, t);
                                throw new Error("Expected varint not more than 10 bytes")
                            }(t |= (15 & (i = r[this.pos])) << 28, e, this))))
                        },
                        readVarint64: function() {
                            return this.readVarint(!0)
                        },
                        readSVarint: function() {
                            var e = this.readVarint();
                            return e % 2 == 1 ? (e + 1) / -2 : e / 2
                        },
                        readBoolean: function() {
                            return Boolean(this.readVarint())
                        },
                        readString: function() {
                            var e = this.readVarint() + this.pos
                              , t = this.pos;
                            return this.pos = e,
                            e - t >= 12 && Qs ? function(e, t, i) {
                                return Qs.decode(e.subarray(t, i))
                            }(this.buf, t, e) : function(e, t, i) {
                                for (var r = "", n = t; n < i; ) {
                                    var a, o, s, l = e[n], u = null, c = l > 239 ? 4 : l > 223 ? 3 : l > 191 ? 2 : 1;
                                    if (n + c > i)
                                        break;
                                    1 === c ? l < 128 && (u = l) : 2 === c ? 128 == (192 & (a = e[n + 1])) && (u = (31 & l) << 6 | 63 & a) <= 127 && (u = null) : 3 === c ? (o = e[n + 2],
                                    128 == (192 & (a = e[n + 1])) && 128 == (192 & o) && ((u = (15 & l) << 12 | (63 & a) << 6 | 63 & o) <= 2047 || u >= 55296 && u <= 57343) && (u = null)) : 4 === c && (o = e[n + 2],
                                    s = e[n + 3],
                                    128 == (192 & (a = e[n + 1])) && 128 == (192 & o) && 128 == (192 & s) && ((u = (15 & l) << 18 | (63 & a) << 12 | (63 & o) << 6 | 63 & s) <= 65535 || u >= 1114112) && (u = null)),
                                    null === u ? (u = 65533,
                                    c = 1) : u > 65535 && (u -= 65536,
                                    r += String.fromCharCode(u >>> 10 & 1023 | 55296),
                                    u = 56320 | 1023 & u),
                                    r += String.fromCharCode(u),
                                    n += c
                                }
                                return r
                            }(this.buf, t, e)
                        },
                        readBytes: function() {
                            var e = this.readVarint() + this.pos
                              , t = this.buf.subarray(this.pos, e);
                            return this.pos = e,
                            t
                        },
                        readPackedVarint: function(e, t) {
                            if (this.type !== Js.Bytes)
                                return e.push(this.readVarint(t));
                            var i = $s(this);
                            for (e = e || []; this.pos < i; )
                                e.push(this.readVarint(t));
                            return e
                        },
                        readPackedSVarint: function(e) {
                            if (this.type !== Js.Bytes)
                                return e.push(this.readSVarint());
                            var t = $s(this);
                            for (e = e || []; this.pos < t; )
                                e.push(this.readSVarint());
                            return e
                        },
                        readPackedBoolean: function(e) {
                            if (this.type !== Js.Bytes)
                                return e.push(this.readBoolean());
                            var t = $s(this);
                            for (e = e || []; this.pos < t; )
                                e.push(this.readBoolean());
                            return e
                        },
                        readPackedFloat: function(e) {
                            if (this.type !== Js.Bytes)
                                return e.push(this.readFloat());
                            var t = $s(this);
                            for (e = e || []; this.pos < t; )
                                e.push(this.readFloat());
                            return e
                        },
                        readPackedDouble: function(e) {
                            if (this.type !== Js.Bytes)
                                return e.push(this.readDouble());
                            var t = $s(this);
                            for (e = e || []; this.pos < t; )
                                e.push(this.readDouble());
                            return e
                        },
                        readPackedFixed32: function(e) {
                            if (this.type !== Js.Bytes)
                                return e.push(this.readFixed32());
                            var t = $s(this);
                            for (e = e || []; this.pos < t; )
                                e.push(this.readFixed32());
                            return e
                        },
                        readPackedSFixed32: function(e) {
                            if (this.type !== Js.Bytes)
                                return e.push(this.readSFixed32());
                            var t = $s(this);
                            for (e = e || []; this.pos < t; )
                                e.push(this.readSFixed32());
                            return e
                        },
                        readPackedFixed64: function(e) {
                            if (this.type !== Js.Bytes)
                                return e.push(this.readFixed64());
                            var t = $s(this);
                            for (e = e || []; this.pos < t; )
                                e.push(this.readFixed64());
                            return e
                        },
                        readPackedSFixed64: function(e) {
                            if (this.type !== Js.Bytes)
                                return e.push(this.readSFixed64());
                            var t = $s(this);
                            for (e = e || []; this.pos < t; )
                                e.push(this.readSFixed64());
                            return e
                        },
                        skip: function(e) {
                            var t = 7 & e;
                            if (t === Js.Varint)
                                for (; this.buf[this.pos++] > 127; )
                                    ;
                            else if (t === Js.Bytes)
                                this.pos = this.readVarint() + this.pos;
                            else if (t === Js.Fixed32)
                                this.pos += 4;
                            else {
                                if (t !== Js.Fixed64)
                                    throw new Error("Unimplemented type: " + t);
                                this.pos += 8
                            }
                        },
                        writeTag: function(e, t) {
                            this.writeVarint(e << 3 | t)
                        },
                        realloc: function(e) {
                            for (var t = this.length || 16; t < this.pos + e; )
                                t *= 2;
                            if (t !== this.length) {
                                var i = new Uint8Array(t);
                                i.set(this.buf),
                                this.buf = i,
                                this.length = t
                            }
                        },
                        finish: function() {
                            return this.length = this.pos,
                            this.pos = 0,
                            this.buf.subarray(0, this.length)
                        },
                        writeFixed32: function(e) {
                            this.realloc(4),
                            pl(this.buf, e, this.pos),
                            this.pos += 4
                        },
                        writeSFixed32: function(e) {
                            this.realloc(4),
                            pl(this.buf, e, this.pos),
                            this.pos += 4
                        },
                        writeFixed64: function(e) {
                            this.realloc(8),
                            pl(this.buf, -1 & e, this.pos),
                            pl(this.buf, Math.floor(e * (1 / 4294967296)), this.pos + 4),
                            this.pos += 8
                        },
                        writeSFixed64: function(e) {
                            this.realloc(8),
                            pl(this.buf, -1 & e, this.pos),
                            pl(this.buf, Math.floor(e * (1 / 4294967296)), this.pos + 4),
                            this.pos += 8
                        },
                        writeVarint: function(e) {
                            (e = +e || 0) > 268435455 || e < 0 ? function(e, t) {
                                var i, r;
                                if (e >= 0 ? (i = e % 4294967296 | 0,
                                r = e / 4294967296 | 0) : (r = ~(-e / 4294967296),
                                4294967295 ^ (i = ~(-e % 4294967296)) ? i = i + 1 | 0 : (i = 0,
                                r = r + 1 | 0)),
                                e >= 0x10000000000000000 || e < -0x10000000000000000)
                                    throw new Error("Given varint doesn't fit into 10 bytes");
                                t.realloc(10),
                                function(e, t, i) {
                                    i.buf[i.pos++] = 127 & e | 128,
                                    e >>>= 7,
                                    i.buf[i.pos++] = 127 & e | 128,
                                    e >>>= 7,
                                    i.buf[i.pos++] = 127 & e | 128,
                                    e >>>= 7,
                                    i.buf[i.pos++] = 127 & e | 128,
                                    i.buf[i.pos] = 127 & (e >>>= 7)
                                }(i, 0, t),
                                function(e, t) {
                                    var i = (7 & e) << 4;
                                    t.buf[t.pos++] |= i | ((e >>>= 3) ? 128 : 0),
                                    e && (t.buf[t.pos++] = 127 & e | ((e >>>= 7) ? 128 : 0),
                                    e && (t.buf[t.pos++] = 127 & e | ((e >>>= 7) ? 128 : 0),
                                    e && (t.buf[t.pos++] = 127 & e | ((e >>>= 7) ? 128 : 0),
                                    e && (t.buf[t.pos++] = 127 & e | ((e >>>= 7) ? 128 : 0),
                                    e && (t.buf[t.pos++] = 127 & e)))))
                                }(r, t)
                            }(e, this) : (this.realloc(4),
                            this.buf[this.pos++] = 127 & e | (e > 127 ? 128 : 0),
                            e <= 127 || (this.buf[this.pos++] = 127 & (e >>>= 7) | (e > 127 ? 128 : 0),
                            e <= 127 || (this.buf[this.pos++] = 127 & (e >>>= 7) | (e > 127 ? 128 : 0),
                            e <= 127 || (this.buf[this.pos++] = e >>> 7 & 127))))
                        },
                        writeSVarint: function(e) {
                            this.writeVarint(e < 0 ? 2 * -e - 1 : 2 * e)
                        },
                        writeBoolean: function(e) {
                            this.writeVarint(Boolean(e))
                        },
                        writeString: function(e) {
                            e = String(e),
                            this.realloc(4 * e.length),
                            this.pos++;
                            var t = this.pos;
                            this.pos = function(e, t, i) {
                                for (var r, n, a = 0; a < t.length; a++) {
                                    if ((r = t.charCodeAt(a)) > 55295 && r < 57344) {
                                        if (!n) {
                                            r > 56319 || a + 1 === t.length ? (e[i++] = 239,
                                            e[i++] = 191,
                                            e[i++] = 189) : n = r;
                                            continue
                                        }
                                        if (r < 56320) {
                                            e[i++] = 239,
                                            e[i++] = 191,
                                            e[i++] = 189,
                                            n = r;
                                            continue
                                        }
                                        r = n - 55296 << 10 | r - 56320 | 65536,
                                        n = null
                                    } else
                                        n && (e[i++] = 239,
                                        e[i++] = 191,
                                        e[i++] = 189,
                                        n = null);
                                    r < 128 ? e[i++] = r : (r < 2048 ? e[i++] = r >> 6 | 192 : (r < 65536 ? e[i++] = r >> 12 | 224 : (e[i++] = r >> 18 | 240,
                                    e[i++] = r >> 12 & 63 | 128),
                                    e[i++] = r >> 6 & 63 | 128),
                                    e[i++] = 63 & r | 128)
                                }
                                return i
                            }(this.buf, e, this.pos);
                            var i = this.pos - t;
                            i >= 128 && tl(t, i, this),
                            this.pos = t - 1,
                            this.writeVarint(i),
                            this.pos += i
                        },
                        writeFloat: function(e) {
                            this.realloc(4),
                            Ys(this.buf, e, this.pos, !0, 23, 4),
                            this.pos += 4
                        },
                        writeDouble: function(e) {
                            this.realloc(8),
                            Ys(this.buf, e, this.pos, !0, 52, 8),
                            this.pos += 8
                        },
                        writeBytes: function(e) {
                            var t = e.length;
                            this.writeVarint(t),
                            this.realloc(t);
                            for (var i = 0; i < t; i++)
                                this.buf[this.pos++] = e[i]
                        },
                        writeRawMessage: function(e, t) {
                            this.pos++;
                            var i = this.pos;
                            e(t, this);
                            var r = this.pos - i;
                            r >= 128 && tl(i, r, this),
                            this.pos = i - 1,
                            this.writeVarint(r),
                            this.pos += r
                        },
                        writeMessage: function(e, t, i) {
                            this.writeTag(e, Js.Bytes),
                            this.writeRawMessage(t, i)
                        },
                        writePackedVarint: function(e, t) {
                            t.length && this.writeMessage(e, il, t)
                        },
                        writePackedSVarint: function(e, t) {
                            t.length && this.writeMessage(e, rl, t)
                        },
                        writePackedBoolean: function(e, t) {
                            t.length && this.writeMessage(e, ol, t)
                        },
                        writePackedFloat: function(e, t) {
                            t.length && this.writeMessage(e, nl, t)
                        },
                        writePackedDouble: function(e, t) {
                            t.length && this.writeMessage(e, al, t)
                        },
                        writePackedFixed32: function(e, t) {
                            t.length && this.writeMessage(e, sl, t)
                        },
                        writePackedSFixed32: function(e, t) {
                            t.length && this.writeMessage(e, ll, t)
                        },
                        writePackedFixed64: function(e, t) {
                            t.length && this.writeMessage(e, ul, t)
                        },
                        writePackedSFixed64: function(e, t) {
                            t.length && this.writeMessage(e, cl, t)
                        },
                        writeBytesField: function(e, t) {
                            this.writeTag(e, Js.Bytes),
                            this.writeBytes(t)
                        },
                        writeFixed32Field: function(e, t) {
                            this.writeTag(e, Js.Fixed32),
                            this.writeFixed32(t)
                        },
                        writeSFixed32Field: function(e, t) {
                            this.writeTag(e, Js.Fixed32),
                            this.writeSFixed32(t)
                        },
                        writeFixed64Field: function(e, t) {
                            this.writeTag(e, Js.Fixed64),
                            this.writeFixed64(t)
                        },
                        writeSFixed64Field: function(e, t) {
                            this.writeTag(e, Js.Fixed64),
                            this.writeSFixed64(t)
                        },
                        writeVarintField: function(e, t) {
                            this.writeTag(e, Js.Varint),
                            this.writeVarint(t)
                        },
                        writeSVarintField: function(e, t) {
                            this.writeTag(e, Js.Varint),
                            this.writeSVarint(t)
                        },
                        writeStringField: function(e, t) {
                            this.writeTag(e, Js.Bytes),
                            this.writeString(t)
                        },
                        writeFloatField: function(e, t) {
                            this.writeTag(e, Js.Fixed32),
                            this.writeFloat(t)
                        },
                        writeDoubleField: function(e, t) {
                            this.writeTag(e, Js.Fixed64),
                            this.writeDouble(t)
                        },
                        writeBooleanField: function(e, t) {
                            this.writeVarintField(e, Boolean(t))
                        }
                    };
                    var yl = function(e, t) {
                        var i = t.pixelRatio
                          , r = t.version
                          , n = t.stretchX
                          , a = t.stretchY
                          , o = t.content;
                        this.paddedRect = e,
                        this.pixelRatio = i,
                        this.stretchX = n,
                        this.stretchY = a,
                        this.content = o,
                        this.version = r
                    }
                      , _l = {
                        tl: {
                            configurable: !0
                        },
                        br: {
                            configurable: !0
                        },
                        tlbr: {
                            configurable: !0
                        },
                        displaySize: {
                            configurable: !0
                        }
                    };
                    _l.tl.get = function() {
                        return [this.paddedRect.x + 1, this.paddedRect.y + 1]
                    }
                    ,
                    _l.br.get = function() {
                        return [this.paddedRect.x + this.paddedRect.w - 1, this.paddedRect.y + this.paddedRect.h - 1]
                    }
                    ,
                    _l.tlbr.get = function() {
                        return this.tl.concat(this.br)
                    }
                    ,
                    _l.displaySize.get = function() {
                        return [(this.paddedRect.w - 2) / this.pixelRatio, (this.paddedRect.h - 2) / this.pixelRatio]
                    }
                    ,
                    Object.defineProperties(yl.prototype, _l);
                    var xl = function(e, t) {
                        var i = {}
                          , r = {};
                        this.haveRenderCallbacks = [];
                        var n = [];
                        this.addImages(e, i, n),
                        this.addImages(t, r, n);
                        var a = gl(n)
                          , o = new _o({
                            width: a.w || 1,
                            height: a.h || 1
                        });
                        for (var s in e) {
                            var l = e[s]
                              , u = i[s].paddedRect;
                            _o.copy(l.data, o, {
                                x: 0,
                                y: 0
                            }, {
                                x: u.x + 1,
                                y: u.y + 1
                            }, l.data)
                        }
                        for (var c in t) {
                            var h = t[c]
                              , p = r[c].paddedRect
                              , f = p.x + 1
                              , d = p.y + 1
                              , m = h.data.width
                              , v = h.data.height;
                            _o.copy(h.data, o, {
                                x: 0,
                                y: 0
                            }, {
                                x: f,
                                y: d
                            }, h.data),
                            _o.copy(h.data, o, {
                                x: 0,
                                y: v - 1
                            }, {
                                x: f,
                                y: d - 1
                            }, {
                                width: m,
                                height: 1
                            }),
                            _o.copy(h.data, o, {
                                x: 0,
                                y: 0
                            }, {
                                x: f,
                                y: d + v
                            }, {
                                width: m,
                                height: 1
                            }),
                            _o.copy(h.data, o, {
                                x: m - 1,
                                y: 0
                            }, {
                                x: f - 1,
                                y: d
                            }, {
                                width: 1,
                                height: v
                            }),
                            _o.copy(h.data, o, {
                                x: 0,
                                y: 0
                            }, {
                                x: f + m,
                                y: d
                            }, {
                                width: 1,
                                height: v
                            })
                        }
                        this.image = o,
                        this.iconPositions = i,
                        this.patternPositions = r
                    };
                    xl.prototype.addImages = function(e, t, i) {
                        for (var r in e) {
                            var n = e[r]
                              , a = {
                                x: 0,
                                y: 0,
                                w: n.data.width + 2,
                                h: n.data.height + 2
                            };
                            i.push(a),
                            t[r] = new yl(a,n),
                            n.hasRenderCallback && this.haveRenderCallbacks.push(r)
                        }
                    }
                    ,
                    xl.prototype.patchUpdatedImages = function(e, t) {
                        for (var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),
                        e.updatedImages)
                            this.patchUpdatedImage(this.iconPositions[i], e.getImage(i), t),
                            this.patchUpdatedImage(this.patternPositions[i], e.getImage(i), t)
                    }
                    ,
                    xl.prototype.patchUpdatedImage = function(e, t, i) {
                        if (e && t && e.version !== t.version) {
                            e.version = t.version;
                            var r = e.tl;
                            i.update(t.data, void 0, {
                                x: r[0],
                                y: r[1]
                            })
                        }
                    }
                    ,
                    Br("ImagePosition", yl),
                    Br("ImageAtlas", xl);
                    var bl = {
                        horizontal: 1,
                        vertical: 2,
                        horizontalOnly: 3
                    }
                      , wl = function() {
                        this.scale = 1,
                        this.fontStack = "",
                        this.imageName = null
                    };
                    wl.forText = function(e, t) {
                        var i = new wl;
                        return i.scale = e || 1,
                        i.fontStack = t,
                        i
                    }
                    ,
                    wl.forImage = function(e) {
                        var t = new wl;
                        return t.imageName = e,
                        t
                    }
                    ;
                    var Sl = function() {
                        this.text = "",
                        this.sectionIndex = [],
                        this.sections = [],
                        this.imageSectionID = null
                    };
                    function Ml(e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m) {
                        var v, g = Sl.fromFeature(e, n);
                        h === bl.vertical && g.verticalizePunctuation();
                        var y = on.processBidirectionalText
                          , _ = on.processStyledBidirectionalText;
                        if (y && 1 === g.sections.length) {
                            v = [];
                            for (var x = 0, b = y(g.toString(), Il(g, u, a, t, r, f, d)); x < b.length; x += 1) {
                                var w = b[x]
                                  , S = new Sl;
                                S.text = w,
                                S.sections = g.sections;
                                for (var M = 0; M < w.length; M++)
                                    S.sectionIndex.push(0);
                                v.push(S)
                            }
                        } else if (_) {
                            v = [];
                            for (var T = 0, E = _(g.text, g.sectionIndex, Il(g, u, a, t, r, f, d)); T < E.length; T += 1) {
                                var A = E[T]
                                  , P = new Sl;
                                P.text = A[0],
                                P.sectionIndex = A[1],
                                P.sections = g.sections,
                                v.push(P)
                            }
                        } else
                            v = function(e, t) {
                                for (var i = [], r = e.text, n = 0, a = 0, o = t; a < o.length; a += 1) {
                                    var s = o[a];
                                    i.push(e.substring(n, s)),
                                    n = s
                                }
                                return n < r.length && i.push(e.substring(n, r.length)),
                                i
                            }(g, Il(g, u, a, t, r, f, d));
                        var C = []
                          , L = {
                            positionedLines: C,
                            text: g.toString(),
                            top: c[1],
                            bottom: c[1],
                            left: c[0],
                            right: c[0],
                            writingMode: h,
                            iconsInText: !1,
                            verticalizable: !1
                        };
                        return function(e, t, i, r, n, a, o, s, l, u, c, h) {
                            for (var p = 0, f = -17, d = 0, m = 0, v = "right" === s ? 1 : "left" === s ? 0 : .5, g = 0, y = 0, _ = n; y < _.length; y += 1) {
                                var x = _[y];
                                x.trim();
                                var b = x.getMaxScale()
                                  , w = 24 * (b - 1)
                                  , S = {
                                    positionedGlyphs: [],
                                    lineOffset: 0
                                };
                                e.positionedLines[g] = S;
                                var M = S.positionedGlyphs
                                  , T = 0;
                                if (x.length()) {
                                    for (var E = 0; E < x.length(); E++) {
                                        var A = x.getSection(E)
                                          , P = x.getSectionIndex(E)
                                          , C = x.getCharCode(E)
                                          , L = 0
                                          , I = null
                                          , k = null
                                          , z = null
                                          , D = 24
                                          , R = !(l === bl.horizontal || !c && !Wr(C) || c && (Tl[C] || (H = C,
                                        Hr.Arabic(H) || Hr["Arabic Supplement"](H) || Hr["Arabic Extended-A"](H) || Hr["Arabic Presentation Forms-A"](H) || Hr["Arabic Presentation Forms-B"](H))));
                                        if (A.imageName) {
                                            var O = r[A.imageName];
                                            if (!O)
                                                continue;
                                            z = A.imageName,
                                            e.iconsInText = e.iconsInText || !0,
                                            k = O.paddedRect;
                                            var B = O.displaySize;
                                            A.scale = 24 * A.scale / h,
                                            L = w + (24 - B[1] * A.scale),
                                            D = (I = {
                                                width: B[0],
                                                height: B[1],
                                                left: 1,
                                                top: -3,
                                                advance: R ? B[1] : B[0]
                                            }).advance;
                                            var F = R ? B[0] * A.scale - 24 * b : B[1] * A.scale - 24 * b;
                                            F > 0 && F > T && (T = F)
                                        } else {
                                            var N = i[A.fontStack]
                                              , U = N && N[C];
                                            if (U && U.rect)
                                                k = U.rect,
                                                I = U.metrics;
                                            else {
                                                var V = t[A.fontStack]
                                                  , G = V && V[C];
                                                if (!G)
                                                    continue;
                                                I = G.metrics
                                            }
                                            L = 24 * (b - A.scale)
                                        }
                                        R ? (e.verticalizable = !0,
                                        M.push({
                                            glyph: C,
                                            imageName: z,
                                            x: p,
                                            y: f + L,
                                            vertical: R,
                                            scale: A.scale,
                                            fontStack: A.fontStack,
                                            sectionIndex: P,
                                            metrics: I,
                                            rect: k
                                        }),
                                        p += D * A.scale + u) : (M.push({
                                            glyph: C,
                                            imageName: z,
                                            x: p,
                                            y: f + L,
                                            vertical: R,
                                            scale: A.scale,
                                            fontStack: A.fontStack,
                                            sectionIndex: P,
                                            metrics: I,
                                            rect: k
                                        }),
                                        p += I.advance * A.scale + u)
                                    }
                                    0 !== M.length && (d = Math.max(p - u, d),
                                    zl(M, 0, M.length - 1, v, T)),
                                    p = 0;
                                    var j = a * b + T;
                                    S.lineOffset = Math.max(T, w),
                                    f += j,
                                    m = Math.max(j, m),
                                    ++g
                                } else
                                    f += a,
                                    ++g
                            }
                            var H, q = f - -17, W = kl(o), Z = W.horizontalAlign, X = W.verticalAlign;
                            (function(e, t, i, r, n, a, o, s, l) {
                                var u, c = (t - i) * n;
                                u = a !== o ? -s * r - -17 : (-r * l + .5) * o;
                                for (var h = 0, p = e; h < p.length; h += 1)
                                    for (var f = 0, d = p[h].positionedGlyphs; f < d.length; f += 1) {
                                        var m = d[f];
                                        m.x += c,
                                        m.y += u
                                    }
                            }
                            )(e.positionedLines, v, Z, X, d, m, a, q, n.length),
                            e.top += -X * q,
                            e.bottom = e.top + q,
                            e.left += -Z * d,
                            e.right = e.left + d
                        }(L, t, i, r, v, o, s, l, h, u, p, m),
                        !function(e) {
                            for (var t = 0, i = e; t < i.length; t += 1)
                                if (0 !== i[t].positionedGlyphs.length)
                                    return !1;
                            return !0
                        }(C) && L
                    }
                    Sl.fromFeature = function(e, t) {
                        for (var i = new Sl, r = 0; r < e.sections.length; r++) {
                            var n = e.sections[r];
                            n.image ? i.addImageSection(n) : i.addTextSection(n, t)
                        }
                        return i
                    }
                    ,
                    Sl.prototype.length = function() {
                        return this.text.length
                    }
                    ,
                    Sl.prototype.getSection = function(e) {
                        return this.sections[this.sectionIndex[e]]
                    }
                    ,
                    Sl.prototype.getSectionIndex = function(e) {
                        return this.sectionIndex[e]
                    }
                    ,
                    Sl.prototype.getCharCode = function(e) {
                        return this.text.charCodeAt(e)
                    }
                    ,
                    Sl.prototype.verticalizePunctuation = function() {
                        this.text = function(e) {
                            for (var t = "", i = 0; i < e.length; i++) {
                                var r = e.charCodeAt(i + 1) || null
                                  , n = e.charCodeAt(i - 1) || null;
                                t += r && Zr(r) && !Zs[e[i + 1]] || n && Zr(n) && !Zs[e[i - 1]] || !Zs[e[i]] ? e[i] : Zs[e[i]]
                            }
                            return t
                        }(this.text)
                    }
                    ,
                    Sl.prototype.trim = function() {
                        for (var e = 0, t = 0; t < this.text.length && Tl[this.text.charCodeAt(t)]; t++)
                            e++;
                        for (var i = this.text.length, r = this.text.length - 1; r >= 0 && r >= e && Tl[this.text.charCodeAt(r)]; r--)
                            i--;
                        this.text = this.text.substring(e, i),
                        this.sectionIndex = this.sectionIndex.slice(e, i)
                    }
                    ,
                    Sl.prototype.substring = function(e, t) {
                        var i = new Sl;
                        return i.text = this.text.substring(e, t),
                        i.sectionIndex = this.sectionIndex.slice(e, t),
                        i.sections = this.sections,
                        i
                    }
                    ,
                    Sl.prototype.toString = function() {
                        return this.text
                    }
                    ,
                    Sl.prototype.getMaxScale = function() {
                        var e = this;
                        return this.sectionIndex.reduce((function(t, i) {
                            return Math.max(t, e.sections[i].scale)
                        }
                        ), 0)
                    }
                    ,
                    Sl.prototype.addTextSection = function(e, t) {
                        this.text += e.text,
                        this.sections.push(wl.forText(e.scale, e.fontStack || t));
                        for (var i = this.sections.length - 1, r = 0; r < e.text.length; ++r)
                            this.sectionIndex.push(i)
                    }
                    ,
                    Sl.prototype.addImageSection = function(e) {
                        var t = e.image ? e.image.name : "";
                        if (0 !== t.length) {
                            var i = this.getNextImageSectionCharCode();
                            i ? (this.text += String.fromCharCode(i),
                            this.sections.push(wl.forImage(t)),
                            this.sectionIndex.push(this.sections.length - 1)) : S("Reached maximum number of images 6401")
                        } else
                            S("Can't add FormattedSection with an empty image.")
                    }
                    ,
                    Sl.prototype.getNextImageSectionCharCode = function() {
                        return this.imageSectionID ? this.imageSectionID >= 63743 ? null : ++this.imageSectionID : (this.imageSectionID = 57344,
                        this.imageSectionID)
                    }
                    ;
                    var Tl = {
                        9: !0,
                        10: !0,
                        11: !0,
                        12: !0,
                        13: !0,
                        32: !0
                    }
                      , El = {};
                    function Al(e, t, i, r, n, a) {
                        if (t.imageName) {
                            var o = r[t.imageName];
                            return o ? o.displaySize[0] * t.scale * 24 / a + n : 0
                        }
                        var s = i[t.fontStack]
                          , l = s && s[e];
                        return l ? l.metrics.advance * t.scale + n : 0
                    }
                    function Pl(e, t, i, r) {
                        var n = Math.pow(e - t, 2);
                        return r ? e < t ? n / 2 : 2 * n : n + Math.abs(i) * i
                    }
                    function Cl(e, t, i) {
                        var r = 0;
                        return 10 === e && (r -= 1e4),
                        i && (r += 150),
                        40 !== e && 65288 !== e || (r += 50),
                        41 !== t && 65289 !== t || (r += 50),
                        r
                    }
                    function Ll(e, t, i, r, n, a) {
                        for (var o = null, s = Pl(t, i, n, a), l = 0, u = r; l < u.length; l += 1) {
                            var c = u[l]
                              , h = Pl(t - c.x, i, n, a) + c.badness;
                            h <= s && (o = c,
                            s = h)
                        }
                        return {
                            index: e,
                            x: t,
                            priorBreak: o,
                            badness: s
                        }
                    }
                    function Il(e, t, i, r, n, a, o) {
                        if ("point" !== a)
                            return [];
                        if (!e)
                            return [];
                        for (var s, l = [], u = function(e, t, i, r, n, a) {
                            for (var o = 0, s = 0; s < e.length(); s++) {
                                var l = e.getSection(s);
                                o += Al(e.getCharCode(s), l, r, n, t, a)
                            }
                            return o / Math.max(1, Math.ceil(o / i))
                        }(e, t, i, r, n, o), c = e.text.indexOf("") >= 0, h = 0, p = 0; p < e.length(); p++) {
                            var f = e.getSection(p)
                              , d = e.getCharCode(p);
                            if (Tl[d] || (h += Al(d, f, r, n, t, o)),
                            p < e.length() - 1) {
                                var m = !((s = d) < 11904 || !(Hr["Bopomofo Extended"](s) || Hr.Bopomofo(s) || Hr["CJK Compatibility Forms"](s) || Hr["CJK Compatibility Ideographs"](s) || Hr["CJK Compatibility"](s) || Hr["CJK Radicals Supplement"](s) || Hr["CJK Strokes"](s) || Hr["CJK Symbols and Punctuation"](s) || Hr["CJK Unified Ideographs Extension A"](s) || Hr["CJK Unified Ideographs"](s) || Hr["Enclosed CJK Letters and Months"](s) || Hr["Halfwidth and Fullwidth Forms"](s) || Hr.Hiragana(s) || Hr["Ideographic Description Characters"](s) || Hr["Kangxi Radicals"](s) || Hr["Katakana Phonetic Extensions"](s) || Hr.Katakana(s) || Hr["Vertical Forms"](s) || Hr["Yi Radicals"](s) || Hr["Yi Syllables"](s)));
                                (El[d] || m || f.imageName) && l.push(Ll(p + 1, h, u, l, Cl(d, e.getCharCode(p + 1), m && c), !1))
                            }
                        }
                        return function e(t) {
                            return t ? e(t.priorBreak).concat(t.index) : []
                        }(Ll(e.length(), h, u, l, 0, !0))
                    }
                    function kl(e) {
                        var t = .5
                          , i = .5;
                        switch (e) {
                        case "right":
                        case "top-right":
                        case "bottom-right":
                            t = 1;
                            break;
                        case "left":
                        case "top-left":
                        case "bottom-left":
                            t = 0
                        }
                        switch (e) {
                        case "bottom":
                        case "bottom-right":
                        case "bottom-left":
                            i = 1;
                            break;
                        case "top":
                        case "top-right":
                        case "top-left":
                            i = 0
                        }
                        return {
                            horizontalAlign: t,
                            verticalAlign: i
                        }
                    }
                    function zl(e, t, i, r, n) {
                        if (r || n)
                            for (var a = e[i], o = (e[i].x + a.metrics.advance * a.scale) * r, s = t; s <= i; s++)
                                e[s].x -= o,
                                e[s].y += n
                    }
                    function Dl(e, t, i, r, n, a) {
                        var o, s = e.image;
                        if (s.content) {
                            var l = s.content
                              , u = s.pixelRatio || 1;
                            o = [l[0] / u, l[1] / u, s.displaySize[0] - l[2] / u, s.displaySize[1] - l[3] / u]
                        }
                        var c, h, p, f, d = t.left * a, m = t.right * a;
                        "width" === i || "both" === i ? (f = n[0] + d - r[3],
                        h = n[0] + m + r[1]) : h = (f = n[0] + (d + m - s.displaySize[0]) / 2) + s.displaySize[0];
                        var v = t.top * a
                          , g = t.bottom * a;
                        return "height" === i || "both" === i ? (c = n[1] + v - r[0],
                        p = n[1] + g + r[2]) : p = (c = n[1] + (v + g - s.displaySize[1]) / 2) + s.displaySize[1],
                        {
                            image: s,
                            top: c,
                            right: h,
                            bottom: p,
                            left: f,
                            collisionPadding: o
                        }
                    }
                    El[10] = !0,
                    El[32] = !0,
                    El[38] = !0,
                    El[40] = !0,
                    El[41] = !0,
                    El[43] = !0,
                    El[45] = !0,
                    El[47] = !0,
                    El[173] = !0,
                    El[183] = !0,
                    El[8203] = !0,
                    El[8208] = !0,
                    El[8211] = !0,
                    El[8231] = !0;
                    var Rl = function(e) {
                        function t(t, i, r, n) {
                            e.call(this, t, i),
                            this.angle = r,
                            void 0 !== n && (this.segment = n)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.clone = function() {
                            return new t(this.x,this.y,this.angle,this.segment)
                        }
                        ,
                        t
                    }(n);
                    function Ol(e, t) {
                        var i = t.expression;
                        if ("constant" === i.kind)
                            return {
                                kind: "constant",
                                layoutSize: i.evaluate(new sn(e + 1))
                            };
                        if ("source" === i.kind)
                            return {
                                kind: "source"
                            };
                        for (var r = i.zoomStops, n = i.interpolationType, a = 0; a < r.length && r[a] <= e; )
                            a++;
                        for (var o = a = Math.max(0, a - 1); o < r.length && r[o] < e + 1; )
                            o++;
                        o = Math.min(r.length - 1, o);
                        var s = r[a]
                          , l = r[o];
                        return "composite" === i.kind ? {
                            kind: "composite",
                            minZoom: s,
                            maxZoom: l,
                            interpolationType: n
                        } : {
                            kind: "camera",
                            minZoom: s,
                            maxZoom: l,
                            minSize: i.evaluate(new sn(s)),
                            maxSize: i.evaluate(new sn(l)),
                            interpolationType: n
                        }
                    }
                    function Bl(e, t, i) {
                        var r = t.uSize
                          , n = i.lowerSize;
                        return "source" === e.kind ? n / 128 : "composite" === e.kind ? Ht(n / 128, i.upperSize / 128, t.uSizeT) : r
                    }
                    function Fl(e, t) {
                        var i = 0
                          , r = 0;
                        if ("constant" === e.kind)
                            r = e.layoutSize;
                        else if ("source" !== e.kind) {
                            var n = e.interpolationType
                              , a = n ? c(ai.interpolationFactor(n, t, e.minZoom, e.maxZoom), 0, 1) : 0;
                            "camera" === e.kind ? r = Ht(e.minSize, e.maxSize, a) : i = a
                        }
                        return {
                            uSizeT: i,
                            uSize: r
                        }
                    }
                    Br("Anchor", Rl);
                    var Nl = Object.freeze({
                        __proto__: null,
                        getSizeData: Ol,
                        evaluateSizeForFeature: Bl,
                        evaluateSizeForZoom: Fl,
                        SIZE_PACK_FACTOR: 128
                    });
                    function Ul(e, t, i, r, n) {
                        if (void 0 === t.segment)
                            return !0;
                        for (var a = t, o = t.segment + 1, s = 0; s > -i / 2; ) {
                            if (--o < 0)
                                return !1;
                            s -= e[o].dist(a),
                            a = e[o]
                        }
                        s += e[o].dist(e[o + 1]),
                        o++;
                        for (var l = [], u = 0; s < i / 2; ) {
                            var c = e[o]
                              , h = e[o + 1];
                            if (!h)
                                return !1;
                            var p = e[o - 1].angleTo(c) - c.angleTo(h);
                            for (p = Math.abs((p + 3 * Math.PI) % (2 * Math.PI) - Math.PI),
                            l.push({
                                distance: s,
                                angleDelta: p
                            }),
                            u += p; s - l[0].distance > r; )
                                u -= l.shift().angleDelta;
                            if (u > n)
                                return !1;
                            o++,
                            s += c.dist(h)
                        }
                        return !0
                    }
                    function Vl(e) {
                        for (var t = 0, i = 0; i < e.length - 1; i++)
                            t += e[i].dist(e[i + 1]);
                        return t
                    }
                    function Gl(e, t, i) {
                        return e ? .6 * t * i : 0
                    }
                    function jl(e, t) {
                        return Math.max(e ? e.right - e.left : 0, t ? t.right - t.left : 0)
                    }
                    function Hl(e, t, i, r, n, a) {
                        for (var o = Gl(i, n, a), s = jl(i, r) * a, l = 0, u = Vl(e) / 2, c = 0; c < e.length - 1; c++) {
                            var h = e[c]
                              , p = e[c + 1]
                              , f = h.dist(p);
                            if (l + f > u) {
                                var d = (u - l) / f
                                  , m = Ht(h.x, p.x, d)
                                  , v = Ht(h.y, p.y, d)
                                  , g = new Rl(m,v,p.angleTo(h),c);
                                return g._round(),
                                !o || Ul(e, g, s, o, t) ? g : void 0
                            }
                            l += f
                        }
                    }
                    function ql(e, t, i, r, n, a, o, s, l) {
                        var u = Gl(r, a, o)
                          , c = jl(r, n)
                          , h = c * o
                          , p = 0 === e[0].x || e[0].x === l || 0 === e[0].y || e[0].y === l;
                        return t - h < t / 4 && (t = h + t / 4),
                        function e(t, i, r, n, a, o, s, l, u) {
                            for (var c = o / 2, h = Vl(t), p = 0, f = i - r, d = [], m = 0; m < t.length - 1; m++) {
                                for (var v = t[m], g = t[m + 1], y = v.dist(g), _ = g.angleTo(v); f + r < p + y; ) {
                                    var x = ((f += r) - p) / y
                                      , b = Ht(v.x, g.x, x)
                                      , w = Ht(v.y, g.y, x);
                                    if (b >= 0 && b < u && w >= 0 && w < u && f - c >= 0 && f + c <= h) {
                                        var S = new Rl(b,w,_,m);
                                        S._round(),
                                        n && !Ul(t, S, o, n, a) || d.push(S)
                                    }
                                }
                                p += y
                            }
                            return l || d.length || s || (d = e(t, p / 2, r, n, a, o, s, !0, u)),
                            d
                        }(e, p ? t / 2 * s % t : (c / 2 + 2 * a) * o * s % t, t, u, i, h, p, !1, l)
                    }
                    function Wl(e, t, i, r, a) {
                        for (var o = [], s = 0; s < e.length; s++)
                            for (var l = e[s], u = void 0, c = 0; c < l.length - 1; c++) {
                                var h = l[c]
                                  , p = l[c + 1];
                                h.x < t && p.x < t || (h.x < t ? h = new n(t,h.y + (t - h.x) / (p.x - h.x) * (p.y - h.y))._round() : p.x < t && (p = new n(t,h.y + (t - h.x) / (p.x - h.x) * (p.y - h.y))._round()),
                                h.y < i && p.y < i || (h.y < i ? h = new n(h.x + (i - h.y) / (p.y - h.y) * (p.x - h.x),i)._round() : p.y < i && (p = new n(h.x + (i - h.y) / (p.y - h.y) * (p.x - h.x),i)._round()),
                                h.x >= r && p.x >= r || (h.x >= r ? h = new n(r,h.y + (r - h.x) / (p.x - h.x) * (p.y - h.y))._round() : p.x >= r && (p = new n(r,h.y + (r - h.x) / (p.x - h.x) * (p.y - h.y))._round()),
                                h.y >= a && p.y >= a || (h.y >= a ? h = new n(h.x + (a - h.y) / (p.y - h.y) * (p.x - h.x),a)._round() : p.y >= a && (p = new n(h.x + (a - h.y) / (p.y - h.y) * (p.x - h.x),a)._round()),
                                u && h.equals(u[u.length - 1]) || o.push(u = [h]),
                                u.push(p)))))
                            }
                        return o
                    }
                    function Zl(e, t, i, r) {
                        var a = []
                          , o = e.image
                          , s = o.pixelRatio
                          , l = o.paddedRect.w - 2
                          , u = o.paddedRect.h - 2
                          , c = e.right - e.left
                          , h = e.bottom - e.top
                          , p = o.stretchX || [[0, l]]
                          , f = o.stretchY || [[0, u]]
                          , d = function(e, t) {
                            return e + t[1] - t[0]
                        }
                          , m = p.reduce(d, 0)
                          , v = f.reduce(d, 0)
                          , g = l - m
                          , y = u - v
                          , _ = 0
                          , x = m
                          , b = 0
                          , w = v
                          , S = 0
                          , M = g
                          , T = 0
                          , E = y;
                        if (o.content && r) {
                            var A = o.content;
                            _ = Xl(p, 0, A[0]),
                            b = Xl(f, 0, A[1]),
                            x = Xl(p, A[0], A[2]),
                            w = Xl(f, A[1], A[3]),
                            S = A[0] - _,
                            T = A[1] - b,
                            M = A[2] - A[0] - x,
                            E = A[3] - A[1] - w
                        }
                        var P = function(r, a, l, u) {
                            var p = Kl(r.stretch - _, x, c, e.left)
                              , f = Jl(r.fixed - S, M, r.stretch, m)
                              , d = Kl(a.stretch - b, w, h, e.top)
                              , g = Jl(a.fixed - T, E, a.stretch, v)
                              , y = Kl(l.stretch - _, x, c, e.left)
                              , A = Jl(l.fixed - S, M, l.stretch, m)
                              , P = Kl(u.stretch - b, w, h, e.top)
                              , C = Jl(u.fixed - T, E, u.stretch, v)
                              , L = new n(p,d)
                              , I = new n(y,d)
                              , k = new n(y,P)
                              , z = new n(p,P)
                              , D = new n(f / s,g / s)
                              , R = new n(A / s,C / s)
                              , O = t * Math.PI / 180;
                            if (O) {
                                var B = Math.sin(O)
                                  , F = Math.cos(O)
                                  , N = [F, -B, B, F];
                                L._matMult(N),
                                I._matMult(N),
                                z._matMult(N),
                                k._matMult(N)
                            }
                            var U = r.stretch + r.fixed
                              , V = a.stretch + a.fixed;
                            return {
                                tl: L,
                                tr: I,
                                bl: z,
                                br: k,
                                tex: {
                                    x: o.paddedRect.x + 1 + U,
                                    y: o.paddedRect.y + 1 + V,
                                    w: l.stretch + l.fixed - U,
                                    h: u.stretch + u.fixed - V
                                },
                                writingMode: void 0,
                                glyphOffset: [0, 0],
                                sectionIndex: 0,
                                pixelOffsetTL: D,
                                pixelOffsetBR: R,
                                minFontScaleX: M / s / c,
                                minFontScaleY: E / s / h,
                                isSDF: i
                            }
                        };
                        if (r && (o.stretchX || o.stretchY))
                            for (var C = Yl(p, g, m), L = Yl(f, y, v), I = 0; I < C.length - 1; I++)
                                for (var k = C[I], z = C[I + 1], D = 0; D < L.length - 1; D++)
                                    a.push(P(k, L[D], z, L[D + 1]));
                        else
                            a.push(P({
                                fixed: 0,
                                stretch: -1
                            }, {
                                fixed: 0,
                                stretch: -1
                            }, {
                                fixed: 0,
                                stretch: l + 1
                            }, {
                                fixed: 0,
                                stretch: u + 1
                            }));
                        return a
                    }
                    function Xl(e, t, i) {
                        for (var r = 0, n = 0, a = e; n < a.length; n += 1) {
                            var o = a[n];
                            r += Math.max(t, Math.min(i, o[1])) - Math.max(t, Math.min(i, o[0]))
                        }
                        return r
                    }
                    function Yl(e, t, i) {
                        for (var r = [{
                            fixed: -1,
                            stretch: 0
                        }], n = 0, a = e; n < a.length; n += 1) {
                            var o = a[n]
                              , s = o[0]
                              , l = o[1]
                              , u = r[r.length - 1];
                            r.push({
                                fixed: s - u.stretch,
                                stretch: u.stretch
                            }),
                            r.push({
                                fixed: s - u.stretch,
                                stretch: u.stretch + (l - s)
                            })
                        }
                        return r.push({
                            fixed: t + 1,
                            stretch: i
                        }),
                        r
                    }
                    function Kl(e, t, i, r) {
                        return e / t * i + r
                    }
                    function Jl(e, t, i, r) {
                        return e - t * i / r
                    }
                    var Ql = function(e, t, i, r, a, o, s, l, u, c) {
                        if (this.boxStartIndex = e.length,
                        u) {
                            var h = o.top
                              , p = o.bottom
                              , f = o.collisionPadding;
                            f && (h -= f[1],
                            p += f[3]);
                            var d = p - h;
                            d > 0 && (d = Math.max(10, d),
                            this.circleDiameter = d)
                        } else {
                            var m = o.top * s - l
                              , v = o.bottom * s + l
                              , g = o.left * s - l
                              , y = o.right * s + l
                              , _ = o.collisionPadding;
                            if (_ && (g -= _[0] * s,
                            m -= _[1] * s,
                            y += _[2] * s,
                            v += _[3] * s),
                            c) {
                                var x = new n(g,m)
                                  , b = new n(y,m)
                                  , w = new n(g,v)
                                  , S = new n(y,v)
                                  , M = c * Math.PI / 180;
                                x._rotate(M),
                                b._rotate(M),
                                w._rotate(M),
                                S._rotate(M),
                                g = Math.min(x.x, b.x, w.x, S.x),
                                y = Math.max(x.x, b.x, w.x, S.x),
                                m = Math.min(x.y, b.y, w.y, S.y),
                                v = Math.max(x.y, b.y, w.y, S.y)
                            }
                            e.emplaceBack(t.x, t.y, g, m, y, v, i, r, a)
                        }
                        this.boxEndIndex = e.length
                    }
                      , $l = function(e, t) {
                        if (void 0 === e && (e = []),
                        void 0 === t && (t = eu),
                        this.data = e,
                        this.length = this.data.length,
                        this.compare = t,
                        this.length > 0)
                            for (var i = (this.length >> 1) - 1; i >= 0; i--)
                                this._down(i)
                    };
                    function eu(e, t) {
                        return e < t ? -1 : e > t ? 1 : 0
                    }
                    function tu(e, t, i) {
                        void 0 === t && (t = 1),
                        void 0 === i && (i = !1);
                        for (var r = 1 / 0, a = 1 / 0, o = -1 / 0, s = -1 / 0, l = e[0], u = 0; u < l.length; u++) {
                            var c = l[u];
                            (!u || c.x < r) && (r = c.x),
                            (!u || c.y < a) && (a = c.y),
                            (!u || c.x > o) && (o = c.x),
                            (!u || c.y > s) && (s = c.y)
                        }
                        var h = Math.min(o - r, s - a)
                          , p = h / 2
                          , f = new $l([],iu);
                        if (0 === h)
                            return new n(r,a);
                        for (var d = r; d < o; d += h)
                            for (var m = a; m < s; m += h)
                                f.push(new ru(d + p,m + p,p,e));
                        for (var v = function(e) {
                            for (var t = 0, i = 0, r = 0, n = e[0], a = 0, o = n.length, s = o - 1; a < o; s = a++) {
                                var l = n[a]
                                  , u = n[s]
                                  , c = l.x * u.y - u.x * l.y;
                                i += (l.x + u.x) * c,
                                r += (l.y + u.y) * c,
                                t += 3 * c
                            }
                            return new ru(i / t,r / t,0,e)
                        }(e), g = f.length; f.length; ) {
                            var y = f.pop();
                            (y.d > v.d || !v.d) && (v = y,
                            i && console.log("found best %d after %d probes", Math.round(1e4 * y.d) / 1e4, g)),
                            y.max - v.d <= t || (f.push(new ru(y.p.x - (p = y.h / 2),y.p.y - p,p,e)),
                            f.push(new ru(y.p.x + p,y.p.y - p,p,e)),
                            f.push(new ru(y.p.x - p,y.p.y + p,p,e)),
                            f.push(new ru(y.p.x + p,y.p.y + p,p,e)),
                            g += 4)
                        }
                        return i && (console.log("num probes: " + g),
                        console.log("best distance: " + v.d)),
                        v.p
                    }
                    function iu(e, t) {
                        return t.max - e.max
                    }
                    function ru(e, t, i, r) {
                        this.p = new n(e,t),
                        this.h = i,
                        this.d = function(e, t) {
                            for (var i = !1, r = 1 / 0, n = 0; n < t.length; n++)
                                for (var a = t[n], o = 0, s = a.length, l = s - 1; o < s; l = o++) {
                                    var u = a[o]
                                      , c = a[l];
                                    u.y > e.y != c.y > e.y && e.x < (c.x - u.x) * (e.y - u.y) / (c.y - u.y) + u.x && (i = !i),
                                    r = Math.min(r, Ka(e, u, c))
                                }
                            return (i ? 1 : -1) * Math.sqrt(r)
                        }(this.p, r),
                        this.max = this.d + this.h * Math.SQRT2
                    }
                    $l.prototype.push = function(e) {
                        this.data.push(e),
                        this.length++,
                        this._up(this.length - 1)
                    }
                    ,
                    $l.prototype.pop = function() {
                        if (0 !== this.length) {
                            var e = this.data[0]
                              , t = this.data.pop();
                            return this.length--,
                            this.length > 0 && (this.data[0] = t,
                            this._down(0)),
                            e
                        }
                    }
                    ,
                    $l.prototype.peek = function() {
                        return this.data[0]
                    }
                    ,
                    $l.prototype._up = function(e) {
                        for (var t = this.data, i = this.compare, r = t[e]; e > 0; ) {
                            var n = e - 1 >> 1
                              , a = t[n];
                            if (i(r, a) >= 0)
                                break;
                            t[e] = a,
                            e = n
                        }
                        t[e] = r
                    }
                    ,
                    $l.prototype._down = function(e) {
                        for (var t = this.data, i = this.compare, r = this.length >> 1, n = t[e]; e < r; ) {
                            var a = 1 + (e << 1)
                              , o = t[a]
                              , s = a + 1;
                            if (s < this.length && i(t[s], o) < 0 && (a = s,
                            o = t[s]),
                            i(o, n) >= 0)
                                break;
                            t[e] = o,
                            e = a
                        }
                        t[e] = n
                    }
                    ;
                    var nu = Number.POSITIVE_INFINITY;
                    function au(e, t) {
                        return t[1] !== nu ? function(e, t, i) {
                            var r = 0
                              , n = 0;
                            switch (t = Math.abs(t),
                            i = Math.abs(i),
                            e) {
                            case "top-right":
                            case "top-left":
                            case "top":
                                n = i - 7;
                                break;
                            case "bottom-right":
                            case "bottom-left":
                            case "bottom":
                                n = 7 - i
                            }
                            switch (e) {
                            case "top-right":
                            case "bottom-right":
                            case "right":
                                r = -t;
                                break;
                            case "top-left":
                            case "bottom-left":
                            case "left":
                                r = t
                            }
                            return [r, n]
                        }(e, t[0], t[1]) : function(e, t) {
                            var i = 0
                              , r = 0;
                            t < 0 && (t = 0);
                            var n = t / Math.sqrt(2);
                            switch (e) {
                            case "top-right":
                            case "top-left":
                                r = n - 7;
                                break;
                            case "bottom-right":
                            case "bottom-left":
                                r = 7 - n;
                                break;
                            case "bottom":
                                r = 7 - t;
                                break;
                            case "top":
                                r = t - 7
                            }
                            switch (e) {
                            case "top-right":
                            case "bottom-right":
                                i = -n;
                                break;
                            case "top-left":
                            case "bottom-left":
                                i = n;
                                break;
                            case "left":
                                i = t;
                                break;
                            case "right":
                                i = -t
                            }
                            return [i, r]
                        }(e, t[0])
                    }
                    function ou(e) {
                        switch (e) {
                        case "right":
                        case "top-right":
                        case "bottom-right":
                            return "right";
                        case "left":
                        case "top-left":
                        case "bottom-left":
                            return "left"
                        }
                        return "center"
                    }
                    function su(e, t, i, r, a, o, s, l, u, c, h, p, f, d, m) {
                        var v = function(e, t, i, r, a, o, s, l) {
                            for (var u = r.layout.get("text-rotate").evaluate(o, {}) * Math.PI / 180, c = [], h = 0, p = t.positionedLines; h < p.length; h += 1)
                                for (var f = p[h], d = 0, m = f.positionedGlyphs; d < m.length; d += 1) {
                                    var v = m[d];
                                    if (v.rect) {
                                        var g = v.rect || {}
                                          , y = 4
                                          , _ = !0
                                          , x = 1
                                          , b = 0
                                          , w = (a || l) && v.vertical
                                          , S = v.metrics.advance * v.scale / 2;
                                        if (l && t.verticalizable && (b = f.lineOffset / 2 - (v.imageName ? -(24 - v.metrics.width * v.scale) / 2 : 24 * (v.scale - 1))),
                                        v.imageName) {
                                            var M = s[v.imageName];
                                            _ = M.sdf,
                                            y = 1 / (x = M.pixelRatio)
                                        }
                                        var T = a ? [v.x + S, v.y] : [0, 0]
                                          , E = a ? [0, 0] : [v.x + S + i[0], v.y + i[1] - b]
                                          , A = [0, 0];
                                        w && (A = E,
                                        E = [0, 0]);
                                        var P = (v.metrics.left - y) * v.scale - S + E[0]
                                          , C = (-v.metrics.top - y) * v.scale + E[1]
                                          , L = P + g.w * v.scale / x
                                          , I = C + g.h * v.scale / x
                                          , k = new n(P,C)
                                          , z = new n(L,C)
                                          , D = new n(P,I)
                                          , R = new n(L,I);
                                        if (w) {
                                            var O = new n(-S,S - -17)
                                              , B = -Math.PI / 2
                                              , F = 12 - S
                                              , N = new n(22 - F,-(v.imageName ? F : 0))
                                              , U = new (Function.prototype.bind.apply(n, [null].concat(A)));
                                            k._rotateAround(B, O)._add(N)._add(U),
                                            z._rotateAround(B, O)._add(N)._add(U),
                                            D._rotateAround(B, O)._add(N)._add(U),
                                            R._rotateAround(B, O)._add(N)._add(U)
                                        }
                                        if (u) {
                                            var V = Math.sin(u)
                                              , G = Math.cos(u)
                                              , j = [G, -V, V, G];
                                            k._matMult(j),
                                            z._matMult(j),
                                            D._matMult(j),
                                            R._matMult(j)
                                        }
                                        var H = new n(0,0)
                                          , q = new n(0,0);
                                        c.push({
                                            tl: k,
                                            tr: z,
                                            bl: D,
                                            br: R,
                                            tex: g,
                                            writingMode: t.writingMode,
                                            glyphOffset: T,
                                            sectionIndex: v.sectionIndex,
                                            isSDF: _,
                                            pixelOffsetTL: H,
                                            pixelOffsetBR: q,
                                            minFontScaleX: 0,
                                            minFontScaleY: 0
                                        })
                                    }
                                }
                            return c
                        }(0, i, l, a, o, s, r, e.allowVerticalPlacement)
                          , g = e.textSizeData
                          , y = null;
                        "source" === g.kind ? (y = [128 * a.layout.get("text-size").evaluate(s, {})])[0] > 32640 && S(e.layerIds[0] + ': Value for "text-size" is >= 255. Reduce your "text-size".') : "composite" === g.kind && ((y = [128 * d.compositeTextSizes[0].evaluate(s, {}, m), 128 * d.compositeTextSizes[1].evaluate(s, {}, m)])[0] > 32640 || y[1] > 32640) && S(e.layerIds[0] + ': Value for "text-size" is >= 255. Reduce your "text-size".'),
                        e.addSymbols(e.text, v, y, l, o, s, c, t, u.lineStartIndex, u.lineLength, f, m);
                        for (var _ = 0, x = h; _ < x.length; _ += 1)
                            p[x[_]] = e.text.placedSymbolArray.length - 1;
                        return 4 * v.length
                    }
                    function lu(e) {
                        for (var t in e)
                            return e[t];
                        return null
                    }
                    function uu(e, t, i, r) {
                        var n = e.compareText;
                        if (t in n) {
                            for (var a = n[t], o = a.length - 1; o >= 0; o--)
                                if (r.dist(a[o]) < i)
                                    return !0
                        } else
                            n[t] = [];
                        return n[t].push(r),
                        !1
                    }
                    var cu = xs.VectorTileFeature.types
                      , hu = [{
                        name: "a_fade_opacity",
                        components: 1,
                        type: "Uint8",
                        offset: 0
                    }];
                    function pu(e, t, i, r, n, a, o, s, l, u, c, h, p) {
                        var f = s ? Math.min(32640, Math.round(s[0])) : 0
                          , d = s ? Math.min(32640, Math.round(s[1])) : 0;
                        e.emplaceBack(t, i, Math.round(32 * r), Math.round(32 * n), a, o, (f << 1) + (l ? 1 : 0), d, 16 * u, 16 * c, 256 * h, 256 * p)
                    }
                    function fu(e, t, i) {
                        e.emplaceBack(t.x, t.y, i),
                        e.emplaceBack(t.x, t.y, i),
                        e.emplaceBack(t.x, t.y, i),
                        e.emplaceBack(t.x, t.y, i)
                    }
                    function du(e) {
                        for (var t = 0, i = e.sections; t < i.length; t += 1)
                            if (Kr(i[t].text))
                                return !0;
                        return !1
                    }
                    var mu = function(e) {
                        this.layoutVertexArray = new Dn,
                        this.indexArray = new Vn,
                        this.programConfigurations = e,
                        this.segments = new sa,
                        this.dynamicLayoutVertexArray = new Rn,
                        this.opacityVertexArray = new On,
                        this.placedSymbolArray = new $n
                    };
                    mu.prototype.isEmpty = function() {
                        return 0 === this.layoutVertexArray.length && 0 === this.indexArray.length && 0 === this.dynamicLayoutVertexArray.length && 0 === this.opacityVertexArray.length
                    }
                    ,
                    mu.prototype.upload = function(e, t, i, r) {
                        this.isEmpty() || (i && (this.layoutVertexBuffer = e.createVertexBuffer(this.layoutVertexArray, Vs.members),
                        this.indexBuffer = e.createIndexBuffer(this.indexArray, t),
                        this.dynamicLayoutVertexBuffer = e.createVertexBuffer(this.dynamicLayoutVertexArray, Gs.members, !0),
                        this.opacityVertexBuffer = e.createVertexBuffer(this.opacityVertexArray, hu, !0),
                        this.opacityVertexBuffer.itemSize = 1),
                        (i || r) && this.programConfigurations.upload(e))
                    }
                    ,
                    mu.prototype.destroy = function() {
                        this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(),
                        this.indexBuffer.destroy(),
                        this.programConfigurations.destroy(),
                        this.segments.destroy(),
                        this.dynamicLayoutVertexBuffer.destroy(),
                        this.opacityVertexBuffer.destroy())
                    }
                    ,
                    Br("SymbolBuffers", mu);
                    var vu = function(e, t, i) {
                        this.layoutVertexArray = new e,
                        this.layoutAttributes = t,
                        this.indexArray = new i,
                        this.segments = new sa,
                        this.collisionVertexArray = new Un
                    };
                    vu.prototype.upload = function(e) {
                        this.layoutVertexBuffer = e.createVertexBuffer(this.layoutVertexArray, this.layoutAttributes),
                        this.indexBuffer = e.createIndexBuffer(this.indexArray),
                        this.collisionVertexBuffer = e.createVertexBuffer(this.collisionVertexArray, js.members, !0)
                    }
                    ,
                    vu.prototype.destroy = function() {
                        this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(),
                        this.indexBuffer.destroy(),
                        this.segments.destroy(),
                        this.collisionVertexBuffer.destroy())
                    }
                    ,
                    Br("CollisionBuffers", vu);
                    var gu = function(e) {
                        this.collisionBoxArray = e.collisionBoxArray,
                        this.zoom = e.zoom,
                        this.overscaling = e.overscaling,
                        this.layers = e.layers,
                        this.layerIds = this.layers.map((function(e) {
                            return e.id
                        }
                        )),
                        this.index = e.index,
                        this.pixelRatio = e.pixelRatio,
                        this.sourceLayerIndex = e.sourceLayerIndex,
                        this.hasPattern = !1,
                        this.hasRTLText = !1,
                        this.sortKeyRanges = [],
                        this.collisionCircleArray = [],
                        this.placementInvProjMatrix = oo([]),
                        this.placementViewportMatrix = oo([]);
                        var t = this.layers[0]._unevaluatedLayout._values;
                        this.textSizeData = Ol(this.zoom, t["text-size"]),
                        this.iconSizeData = Ol(this.zoom, t["icon-size"]);
                        var i = this.layers[0].layout
                          , r = i.get("symbol-sort-key")
                          , n = i.get("symbol-z-order");
                        this.canOverlap = i.get("text-allow-overlap") || i.get("icon-allow-overlap") || i.get("text-ignore-placement") || i.get("icon-ignore-placement"),
                        this.sortFeaturesByKey = "viewport-y" !== n && void 0 !== r.constantOr(1),
                        this.sortFeaturesByY = ("viewport-y" === n || "auto" === n && !this.sortFeaturesByKey) && this.canOverlap,
                        "point" === i.get("symbol-placement") && (this.writingModes = i.get("text-writing-mode").map((function(e) {
                            return bl[e]
                        }
                        ))),
                        this.stateDependentLayerIds = this.layers.filter((function(e) {
                            return e.isStateDependent()
                        }
                        )).map((function(e) {
                            return e.id
                        }
                        )),
                        this.sourceID = e.sourceID
                    };
                    gu.prototype.createArrays = function() {
                        this.text = new mu(new Da(this.layers,this.zoom,(function(e) {
                            return /^text/.test(e)
                        }
                        ))),
                        this.icon = new mu(new Da(this.layers,this.zoom,(function(e) {
                            return /^icon/.test(e)
                        }
                        ))),
                        this.glyphOffsetArray = new ia,
                        this.lineVertexArray = new ra,
                        this.symbolInstances = new ta
                    }
                    ,
                    gu.prototype.calculateGlyphDependencies = function(e, t, i, r, n) {
                        for (var a = 0; a < e.length; a++)
                            if (t[e.charCodeAt(a)] = !0,
                            (i || r) && n) {
                                var o = Zs[e.charAt(a)];
                                o && (t[o.charCodeAt(0)] = !0)
                            }
                    }
                    ,
                    gu.prototype.populate = function(e, t, i) {
                        var r = this.layers[0]
                          , n = r.layout
                          , a = n.get("text-font")
                          , o = n.get("text-field")
                          , s = n.get("icon-image")
                          , l = ("constant" !== o.value.kind || o.value.value instanceof rt && !o.value.value.isEmpty() || o.value.value.toString().length > 0) && ("constant" !== a.value.kind || a.value.value.length > 0)
                          , u = "constant" !== s.value.kind || !!s.value.value || Object.keys(s.parameters).length > 0
                          , c = n.get("symbol-sort-key");
                        if (this.features = [],
                        l || u) {
                            for (var h = t.iconDependencies, p = t.glyphDependencies, f = t.availableImages, d = new sn(this.zoom), m = 0, v = e; m < v.length; m += 1) {
                                var g = v[m]
                                  , y = g.feature
                                  , _ = g.id
                                  , x = g.index
                                  , b = g.sourceLayerIndex
                                  , w = r._featureFilter.needGeometry
                                  , S = Ua(y, w);
                                if (r._featureFilter.filter(d, S, i)) {
                                    w || (S.geometry = Na(y));
                                    var M = void 0;
                                    if (l) {
                                        var T = r.getValueAndResolveTokens("text-field", S, i, f)
                                          , E = rt.factory(T);
                                        du(E) && (this.hasRTLText = !0),
                                        (!this.hasRTLText || "unavailable" === nn() || this.hasRTLText && on.isParsed()) && (M = Ws(E, r, S))
                                    }
                                    var A = void 0;
                                    if (u) {
                                        var P = r.getValueAndResolveTokens("icon-image", S, i, f);
                                        A = P instanceof nt ? P : nt.fromString(P)
                                    }
                                    if (M || A) {
                                        var C = this.sortFeaturesByKey ? c.evaluate(S, {}, i) : void 0;
                                        if (this.features.push({
                                            id: _,
                                            text: M,
                                            icon: A,
                                            index: x,
                                            sourceLayerIndex: b,
                                            geometry: S.geometry,
                                            properties: y.properties,
                                            type: cu[y.type],
                                            sortKey: C
                                        }),
                                        A && (h[A.name] = !0),
                                        M) {
                                            var L = a.evaluate(S, {}, i).join(",")
                                              , I = "map" === n.get("text-rotation-alignment") && "point" !== n.get("symbol-placement");
                                            this.allowVerticalPlacement = this.writingModes && this.writingModes.indexOf(bl.vertical) >= 0;
                                            for (var k = 0, z = M.sections; k < z.length; k += 1) {
                                                var D = z[k];
                                                if (D.image)
                                                    h[D.image.name] = !0;
                                                else {
                                                    var R = qr(M.toString())
                                                      , O = D.fontStack || L
                                                      , B = p[O] = p[O] || {};
                                                    this.calculateGlyphDependencies(D.text, B, I, this.allowVerticalPlacement, R)
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            "line" === n.get("symbol-placement") && (this.features = function(e) {
                                var t = {}
                                  , i = {}
                                  , r = []
                                  , n = 0;
                                function a(t) {
                                    r.push(e[t]),
                                    n++
                                }
                                function o(e, t, n) {
                                    var a = i[e];
                                    return delete i[e],
                                    i[t] = a,
                                    r[a].geometry[0].pop(),
                                    r[a].geometry[0] = r[a].geometry[0].concat(n[0]),
                                    a
                                }
                                function s(e, i, n) {
                                    var a = t[i];
                                    return delete t[i],
                                    t[e] = a,
                                    r[a].geometry[0].shift(),
                                    r[a].geometry[0] = n[0].concat(r[a].geometry[0]),
                                    a
                                }
                                function l(e, t, i) {
                                    var r = i ? t[0][t[0].length - 1] : t[0][0];
                                    return e + ":" + r.x + ":" + r.y
                                }
                                for (var u = 0; u < e.length; u++) {
                                    var c = e[u]
                                      , h = c.geometry
                                      , p = c.text ? c.text.toString() : null;
                                    if (p) {
                                        var f = l(p, h)
                                          , d = l(p, h, !0);
                                        if (f in i && d in t && i[f] !== t[d]) {
                                            var m = s(f, d, h)
                                              , v = o(f, d, r[m].geometry);
                                            delete t[f],
                                            delete i[d],
                                            i[l(p, r[v].geometry, !0)] = v,
                                            r[m].geometry = null
                                        } else
                                            f in i ? o(f, d, h) : d in t ? s(f, d, h) : (a(u),
                                            t[f] = n - 1,
                                            i[d] = n - 1)
                                    } else
                                        a(u)
                                }
                                return r.filter((function(e) {
                                    return e.geometry
                                }
                                ))
                            }(this.features)),
                            this.sortFeaturesByKey && this.features.sort((function(e, t) {
                                return e.sortKey - t.sortKey
                            }
                            ))
                        }
                    }
                    ,
                    gu.prototype.update = function(e, t, i) {
                        this.stateDependentLayers.length && (this.text.programConfigurations.updatePaintArrays(e, t, this.layers, i),
                        this.icon.programConfigurations.updatePaintArrays(e, t, this.layers, i))
                    }
                    ,
                    gu.prototype.isEmpty = function() {
                        return 0 === this.symbolInstances.length && !this.hasRTLText
                    }
                    ,
                    gu.prototype.uploadPending = function() {
                        return !this.uploaded || this.text.programConfigurations.needsUpload || this.icon.programConfigurations.needsUpload
                    }
                    ,
                    gu.prototype.upload = function(e) {
                        !this.uploaded && this.hasDebugData() && (this.textCollisionBox.upload(e),
                        this.iconCollisionBox.upload(e)),
                        this.text.upload(e, this.sortFeaturesByY, !this.uploaded, this.text.programConfigurations.needsUpload),
                        this.icon.upload(e, this.sortFeaturesByY, !this.uploaded, this.icon.programConfigurations.needsUpload),
                        this.uploaded = !0
                    }
                    ,
                    gu.prototype.destroyDebugData = function() {
                        this.textCollisionBox.destroy(),
                        this.iconCollisionBox.destroy()
                    }
                    ,
                    gu.prototype.destroy = function() {
                        this.text.destroy(),
                        this.icon.destroy(),
                        this.hasDebugData() && this.destroyDebugData()
                    }
                    ,
                    gu.prototype.addToLineVertexArray = function(e, t) {
                        var i = this.lineVertexArray.length;
                        if (void 0 !== e.segment) {
                            for (var r = e.dist(t[e.segment + 1]), n = e.dist(t[e.segment]), a = {}, o = e.segment + 1; o < t.length; o++)
                                a[o] = {
                                    x: t[o].x,
                                    y: t[o].y,
                                    tileUnitDistanceFromAnchor: r
                                },
                                o < t.length - 1 && (r += t[o + 1].dist(t[o]));
                            for (var s = e.segment || 0; s >= 0; s--)
                                a[s] = {
                                    x: t[s].x,
                                    y: t[s].y,
                                    tileUnitDistanceFromAnchor: n
                                },
                                s > 0 && (n += t[s - 1].dist(t[s]));
                            for (var l = 0; l < t.length; l++) {
                                var u = a[l];
                                this.lineVertexArray.emplaceBack(u.x, u.y, u.tileUnitDistanceFromAnchor)
                            }
                        }
                        return {
                            lineStartIndex: i,
                            lineLength: this.lineVertexArray.length - i
                        }
                    }
                    ,
                    gu.prototype.addSymbols = function(e, t, i, r, n, a, o, s, l, u, c, h) {
                        for (var p = e.indexArray, f = e.layoutVertexArray, d = e.segments.prepareSegment(4 * t.length, f, p, this.canOverlap ? a.sortKey : void 0), m = this.glyphOffsetArray.length, v = d.vertexLength, g = this.allowVerticalPlacement && o === bl.vertical ? Math.PI / 2 : 0, y = a.text && a.text.sections, _ = 0; _ < t.length; _++) {
                            var x = t[_]
                              , b = x.tl
                              , w = x.tr
                              , S = x.bl
                              , M = x.br
                              , T = x.tex
                              , E = x.pixelOffsetTL
                              , A = x.pixelOffsetBR
                              , P = x.minFontScaleX
                              , C = x.minFontScaleY
                              , L = x.glyphOffset
                              , I = x.isSDF
                              , k = x.sectionIndex
                              , z = d.vertexLength
                              , D = L[1];
                            pu(f, s.x, s.y, b.x, D + b.y, T.x, T.y, i, I, E.x, E.y, P, C),
                            pu(f, s.x, s.y, w.x, D + w.y, T.x + T.w, T.y, i, I, A.x, E.y, P, C),
                            pu(f, s.x, s.y, S.x, D + S.y, T.x, T.y + T.h, i, I, E.x, A.y, P, C),
                            pu(f, s.x, s.y, M.x, D + M.y, T.x + T.w, T.y + T.h, i, I, A.x, A.y, P, C),
                            fu(e.dynamicLayoutVertexArray, s, g),
                            p.emplaceBack(z, z + 1, z + 2),
                            p.emplaceBack(z + 1, z + 2, z + 3),
                            d.vertexLength += 4,
                            d.primitiveLength += 2,
                            this.glyphOffsetArray.emplaceBack(L[0]),
                            _ !== t.length - 1 && k === t[_ + 1].sectionIndex || e.programConfigurations.populatePaintArrays(f.length, a, a.index, {}, h, y && y[k])
                        }
                        e.placedSymbolArray.emplaceBack(s.x, s.y, m, this.glyphOffsetArray.length - m, v, l, u, s.segment, i ? i[0] : 0, i ? i[1] : 0, r[0], r[1], o, 0, !1, 0, c)
                    }
                    ,
                    gu.prototype._addCollisionDebugVertex = function(e, t, i, r, n, a) {
                        return t.emplaceBack(0, 0),
                        e.emplaceBack(i.x, i.y, r, n, Math.round(a.x), Math.round(a.y))
                    }
                    ,
                    gu.prototype.addCollisionDebugVertices = function(e, t, i, r, a, o, s) {
                        var l = a.segments.prepareSegment(4, a.layoutVertexArray, a.indexArray)
                          , u = l.vertexLength
                          , c = a.layoutVertexArray
                          , h = a.collisionVertexArray
                          , p = s.anchorX
                          , f = s.anchorY;
                        this._addCollisionDebugVertex(c, h, o, p, f, new n(e,t)),
                        this._addCollisionDebugVertex(c, h, o, p, f, new n(i,t)),
                        this._addCollisionDebugVertex(c, h, o, p, f, new n(i,r)),
                        this._addCollisionDebugVertex(c, h, o, p, f, new n(e,r)),
                        l.vertexLength += 4;
                        var d = a.indexArray;
                        d.emplaceBack(u, u + 1),
                        d.emplaceBack(u + 1, u + 2),
                        d.emplaceBack(u + 2, u + 3),
                        d.emplaceBack(u + 3, u),
                        l.primitiveLength += 4
                    }
                    ,
                    gu.prototype.addDebugCollisionBoxes = function(e, t, i, r) {
                        for (var n = e; n < t; n++) {
                            var a = this.collisionBoxArray.get(n);
                            this.addCollisionDebugVertices(a.x1, a.y1, a.x2, a.y2, r ? this.textCollisionBox : this.iconCollisionBox, a.anchorPoint, i)
                        }
                    }
                    ,
                    gu.prototype.generateCollisionDebugBuffers = function() {
                        this.hasDebugData() && this.destroyDebugData(),
                        this.textCollisionBox = new vu(Fn,Hs.members,Zn),
                        this.iconCollisionBox = new vu(Fn,Hs.members,Zn);
                        for (var e = 0; e < this.symbolInstances.length; e++) {
                            var t = this.symbolInstances.get(e);
                            this.addDebugCollisionBoxes(t.textBoxStartIndex, t.textBoxEndIndex, t, !0),
                            this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex, t.verticalTextBoxEndIndex, t, !0),
                            this.addDebugCollisionBoxes(t.iconBoxStartIndex, t.iconBoxEndIndex, t, !1),
                            this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex, t.verticalIconBoxEndIndex, t, !1)
                        }
                    }
                    ,
                    gu.prototype._deserializeCollisionBoxesForSymbol = function(e, t, i, r, n, a, o, s, l) {
                        for (var u = {}, c = t; c < i; c++) {
                            var h = e.get(c);
                            u.textBox = {
                                x1: h.x1,
                                y1: h.y1,
                                x2: h.x2,
                                y2: h.y2,
                                anchorPointX: h.anchorPointX,
                                anchorPointY: h.anchorPointY
                            },
                            u.textFeatureIndex = h.featureIndex;
                            break
                        }
                        for (var p = r; p < n; p++) {
                            var f = e.get(p);
                            u.verticalTextBox = {
                                x1: f.x1,
                                y1: f.y1,
                                x2: f.x2,
                                y2: f.y2,
                                anchorPointX: f.anchorPointX,
                                anchorPointY: f.anchorPointY
                            },
                            u.verticalTextFeatureIndex = f.featureIndex;
                            break
                        }
                        for (var d = a; d < o; d++) {
                            var m = e.get(d);
                            u.iconBox = {
                                x1: m.x1,
                                y1: m.y1,
                                x2: m.x2,
                                y2: m.y2,
                                anchorPointX: m.anchorPointX,
                                anchorPointY: m.anchorPointY
                            },
                            u.iconFeatureIndex = m.featureIndex;
                            break
                        }
                        for (var v = s; v < l; v++) {
                            var g = e.get(v);
                            u.verticalIconBox = {
                                x1: g.x1,
                                y1: g.y1,
                                x2: g.x2,
                                y2: g.y2,
                                anchorPointX: g.anchorPointX,
                                anchorPointY: g.anchorPointY
                            },
                            u.verticalIconFeatureIndex = g.featureIndex;
                            break
                        }
                        return u
                    }
                    ,
                    gu.prototype.deserializeCollisionBoxes = function(e) {
                        this.collisionArrays = [];
                        for (var t = 0; t < this.symbolInstances.length; t++) {
                            var i = this.symbolInstances.get(t);
                            this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e, i.textBoxStartIndex, i.textBoxEndIndex, i.verticalTextBoxStartIndex, i.verticalTextBoxEndIndex, i.iconBoxStartIndex, i.iconBoxEndIndex, i.verticalIconBoxStartIndex, i.verticalIconBoxEndIndex))
                        }
                    }
                    ,
                    gu.prototype.hasTextData = function() {
                        return this.text.segments.get().length > 0
                    }
                    ,
                    gu.prototype.hasIconData = function() {
                        return this.icon.segments.get().length > 0
                    }
                    ,
                    gu.prototype.hasDebugData = function() {
                        return this.textCollisionBox && this.iconCollisionBox
                    }
                    ,
                    gu.prototype.hasTextCollisionBoxData = function() {
                        return this.hasDebugData() && this.textCollisionBox.segments.get().length > 0
                    }
                    ,
                    gu.prototype.hasIconCollisionBoxData = function() {
                        return this.hasDebugData() && this.iconCollisionBox.segments.get().length > 0
                    }
                    ,
                    gu.prototype.addIndicesForPlacedSymbol = function(e, t) {
                        for (var i = e.placedSymbolArray.get(t), r = i.vertexStartIndex + 4 * i.numGlyphs, n = i.vertexStartIndex; n < r; n += 4)
                            e.indexArray.emplaceBack(n, n + 1, n + 2),
                            e.indexArray.emplaceBack(n + 1, n + 2, n + 3)
                    }
                    ,
                    gu.prototype.getSortedSymbolIndexes = function(e) {
                        if (this.sortedAngle === e && void 0 !== this.symbolInstanceIndexes)
                            return this.symbolInstanceIndexes;
                        for (var t = Math.sin(e), i = Math.cos(e), r = [], n = [], a = [], o = 0; o < this.symbolInstances.length; ++o) {
                            a.push(o);
                            var s = this.symbolInstances.get(o);
                            r.push(0 | Math.round(t * s.anchorX + i * s.anchorY)),
                            n.push(s.featureIndex)
                        }
                        return a.sort((function(e, t) {
                            return r[e] - r[t] || n[t] - n[e]
                        }
                        )),
                        a
                    }
                    ,
                    gu.prototype.addToSortKeyRanges = function(e, t) {
                        var i = this.sortKeyRanges[this.sortKeyRanges.length - 1];
                        i && i.sortKey === t ? i.symbolInstanceEnd = e + 1 : this.sortKeyRanges.push({
                            sortKey: t,
                            symbolInstanceStart: e,
                            symbolInstanceEnd: e + 1
                        })
                    }
                    ,
                    gu.prototype.sortFeatures = function(e) {
                        var t = this;
                        if (this.sortFeaturesByY && this.sortedAngle !== e && !(this.text.segments.get().length > 1 || this.icon.segments.get().length > 1)) {
                            this.symbolInstanceIndexes = this.getSortedSymbolIndexes(e),
                            this.sortedAngle = e,
                            this.text.indexArray.clear(),
                            this.icon.indexArray.clear(),
                            this.featureSortOrder = [];
                            for (var i = 0, r = this.symbolInstanceIndexes; i < r.length; i += 1) {
                                var n = this.symbolInstances.get(r[i]);
                                this.featureSortOrder.push(n.featureIndex),
                                [n.rightJustifiedTextSymbolIndex, n.centerJustifiedTextSymbolIndex, n.leftJustifiedTextSymbolIndex].forEach((function(e, i, r) {
                                    e >= 0 && r.indexOf(e) === i && t.addIndicesForPlacedSymbol(t.text, e)
                                }
                                )),
                                n.verticalPlacedTextSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.text, n.verticalPlacedTextSymbolIndex),
                                n.placedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, n.placedIconSymbolIndex),
                                n.verticalPlacedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, n.verticalPlacedIconSymbolIndex)
                            }
                            this.text.indexBuffer && this.text.indexBuffer.updateData(this.text.indexArray),
                            this.icon.indexBuffer && this.icon.indexBuffer.updateData(this.icon.indexArray)
                        }
                    }
                    ,
                    Br("SymbolBucket", gu, {
                        omit: ["layers", "collisionBoxArray", "features", "compareText"]
                    }),
                    gu.MAX_GLYPHS = 65535,
                    gu.addDynamicAttributes = fu;
                    var yu = new bn({
                        "symbol-placement": new vn(Ce.layout_symbol["symbol-placement"]),
                        "symbol-spacing": new vn(Ce.layout_symbol["symbol-spacing"]),
                        "symbol-avoid-edges": new vn(Ce.layout_symbol["symbol-avoid-edges"]),
                        "symbol-sort-key": new gn(Ce.layout_symbol["symbol-sort-key"]),
                        "symbol-z-order": new vn(Ce.layout_symbol["symbol-z-order"]),
                        "icon-allow-overlap": new vn(Ce.layout_symbol["icon-allow-overlap"]),
                        "icon-ignore-placement": new vn(Ce.layout_symbol["icon-ignore-placement"]),
                        "icon-optional": new vn(Ce.layout_symbol["icon-optional"]),
                        "icon-rotation-alignment": new vn(Ce.layout_symbol["icon-rotation-alignment"]),
                        "icon-size": new gn(Ce.layout_symbol["icon-size"]),
                        "icon-text-fit": new vn(Ce.layout_symbol["icon-text-fit"]),
                        "icon-text-fit-padding": new vn(Ce.layout_symbol["icon-text-fit-padding"]),
                        "icon-image": new gn(Ce.layout_symbol["icon-image"]),
                        "icon-rotate": new gn(Ce.layout_symbol["icon-rotate"]),
                        "icon-padding": new vn(Ce.layout_symbol["icon-padding"]),
                        "icon-keep-upright": new vn(Ce.layout_symbol["icon-keep-upright"]),
                        "icon-offset": new gn(Ce.layout_symbol["icon-offset"]),
                        "icon-anchor": new gn(Ce.layout_symbol["icon-anchor"]),
                        "icon-pitch-alignment": new vn(Ce.layout_symbol["icon-pitch-alignment"]),
                        "text-pitch-alignment": new vn(Ce.layout_symbol["text-pitch-alignment"]),
                        "text-rotation-alignment": new vn(Ce.layout_symbol["text-rotation-alignment"]),
                        "text-field": new gn(Ce.layout_symbol["text-field"]),
                        "text-font": new gn(Ce.layout_symbol["text-font"]),
                        "text-size": new gn(Ce.layout_symbol["text-size"]),
                        "text-max-width": new gn(Ce.layout_symbol["text-max-width"]),
                        "text-line-height": new vn(Ce.layout_symbol["text-line-height"]),
                        "text-letter-spacing": new gn(Ce.layout_symbol["text-letter-spacing"]),
                        "text-justify": new gn(Ce.layout_symbol["text-justify"]),
                        "text-radial-offset": new gn(Ce.layout_symbol["text-radial-offset"]),
                        "text-variable-anchor": new vn(Ce.layout_symbol["text-variable-anchor"]),
                        "text-anchor": new gn(Ce.layout_symbol["text-anchor"]),
                        "text-max-angle": new vn(Ce.layout_symbol["text-max-angle"]),
                        "text-writing-mode": new vn(Ce.layout_symbol["text-writing-mode"]),
                        "text-rotate": new gn(Ce.layout_symbol["text-rotate"]),
                        "text-padding": new vn(Ce.layout_symbol["text-padding"]),
                        "text-keep-upright": new vn(Ce.layout_symbol["text-keep-upright"]),
                        "text-transform": new gn(Ce.layout_symbol["text-transform"]),
                        "text-offset": new gn(Ce.layout_symbol["text-offset"]),
                        "text-allow-overlap": new vn(Ce.layout_symbol["text-allow-overlap"]),
                        "text-ignore-placement": new vn(Ce.layout_symbol["text-ignore-placement"]),
                        "text-optional": new vn(Ce.layout_symbol["text-optional"])
                    })
                      , _u = {
                        paint: new bn({
                            "icon-opacity": new gn(Ce.paint_symbol["icon-opacity"]),
                            "icon-color": new gn(Ce.paint_symbol["icon-color"]),
                            "icon-halo-color": new gn(Ce.paint_symbol["icon-halo-color"]),
                            "icon-halo-width": new gn(Ce.paint_symbol["icon-halo-width"]),
                            "icon-halo-blur": new gn(Ce.paint_symbol["icon-halo-blur"]),
                            "icon-translate": new vn(Ce.paint_symbol["icon-translate"]),
                            "icon-translate-anchor": new vn(Ce.paint_symbol["icon-translate-anchor"]),
                            "text-opacity": new gn(Ce.paint_symbol["text-opacity"]),
                            "text-color": new gn(Ce.paint_symbol["text-color"],{
                                runtimeType: Ve,
                                getOverride: function(e) {
                                    return e.textColor
                                },
                                hasOverride: function(e) {
                                    return !!e.textColor
                                }
                            }),
                            "text-halo-color": new gn(Ce.paint_symbol["text-halo-color"]),
                            "text-halo-width": new gn(Ce.paint_symbol["text-halo-width"]),
                            "text-halo-blur": new gn(Ce.paint_symbol["text-halo-blur"]),
                            "text-translate": new vn(Ce.paint_symbol["text-translate"]),
                            "text-translate-anchor": new vn(Ce.paint_symbol["text-translate-anchor"])
                        }),
                        layout: yu
                    }
                      , xu = function(e) {
                        this.type = e.property.overrides ? e.property.overrides.runtimeType : Be,
                        this.defaultValue = e
                    };
                    xu.prototype.evaluate = function(e) {
                        if (e.formattedSection) {
                            var t = this.defaultValue.property.overrides;
                            if (t && t.hasOverride(e.formattedSection))
                                return t.getOverride(e.formattedSection)
                        }
                        return e.feature && e.featureState ? this.defaultValue.evaluate(e.feature, e.featureState) : this.defaultValue.property.specification.default
                    }
                    ,
                    xu.prototype.eachChild = function(e) {
                        this.defaultValue.isConstant() || e(this.defaultValue.value._styleExpression.expression)
                    }
                    ,
                    xu.prototype.outputDefined = function() {
                        return !1
                    }
                    ,
                    xu.prototype.serialize = function() {
                        return null
                    }
                    ,
                    Br("FormatSectionOverride", xu, {
                        omit: ["defaultValue"]
                    });
                    var bu = function(e) {
                        function t(t) {
                            e.call(this, t, _u)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.recalculate = function(t, i) {
                            if (e.prototype.recalculate.call(this, t, i),
                            "auto" === this.layout.get("icon-rotation-alignment") && (this.layout._values["icon-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"),
                            "auto" === this.layout.get("text-rotation-alignment") && (this.layout._values["text-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"),
                            "auto" === this.layout.get("text-pitch-alignment") && (this.layout._values["text-pitch-alignment"] = this.layout.get("text-rotation-alignment")),
                            "auto" === this.layout.get("icon-pitch-alignment") && (this.layout._values["icon-pitch-alignment"] = this.layout.get("icon-rotation-alignment")),
                            "point" === this.layout.get("symbol-placement")) {
                                var r = this.layout.get("text-writing-mode");
                                if (r) {
                                    for (var n = [], a = 0, o = r; a < o.length; a += 1) {
                                        var s = o[a];
                                        n.indexOf(s) < 0 && n.push(s)
                                    }
                                    this.layout._values["text-writing-mode"] = n
                                } else
                                    this.layout._values["text-writing-mode"] = ["horizontal"]
                            }
                            this._setPaintOverrides()
                        }
                        ,
                        t.prototype.getValueAndResolveTokens = function(e, t, i, r) {
                            var n = this.layout.get(e).evaluate(t, {}, i, r)
                              , a = this._unevaluatedLayout._values[e];
                            return a.isDataDriven() || qi(a.value) || !n ? n : function(e, t) {
                                return t.replace(/{([^{}]+)}/g, (function(t, i) {
                                    return i in e ? String(e[i]) : ""
                                }
                                ))
                            }(t.properties, n)
                        }
                        ,
                        t.prototype.createBucket = function(e) {
                            return new gu(e)
                        }
                        ,
                        t.prototype.queryRadius = function() {
                            return 0
                        }
                        ,
                        t.prototype.queryIntersectsFeature = function() {
                            return !1
                        }
                        ,
                        t.prototype._setPaintOverrides = function() {
                            for (var e = 0, i = _u.paint.overridableProperties; e < i.length; e += 1) {
                                var r = i[e];
                                if (t.hasPaintOverride(this.layout, r)) {
                                    var n, a = this.paint.get(r), o = new xu(a), s = new Hi(o,a.property.specification);
                                    n = "constant" === a.value.kind || "source" === a.value.kind ? new Zi("source",s) : new Xi("composite",s,a.value.zoomStops,a.value._interpolationType),
                                    this.paint._values[r] = new dn(a.property,n,a.parameters)
                                }
                            }
                        }
                        ,
                        t.prototype._handleOverridablePaintPropertyUpdate = function(e, i, r) {
                            return !(!this.layout || i.isDataDriven() || r.isDataDriven()) && t.hasPaintOverride(this.layout, e)
                        }
                        ,
                        t.hasPaintOverride = function(e, t) {
                            var i = e.get("text-field")
                              , r = _u.paint.properties[t]
                              , n = !1
                              , a = function(e) {
                                for (var t = 0, i = e; t < i.length; t += 1)
                                    if (r.overrides && r.overrides.hasOverride(i[t]))
                                        return void (n = !0)
                            };
                            if ("constant" === i.value.kind && i.value.value instanceof rt)
                                a(i.value.value.sections);
                            else if ("source" === i.value.kind) {
                                var o = function(e) {
                                    n || (e instanceof ut && st(e.value) === qe ? a(e.value.sections) : e instanceof ft ? a(e.sections) : e.eachChild(o))
                                }
                                  , s = i.value;
                                s._styleExpression && o(s._styleExpression.expression)
                            }
                            return n
                        }
                        ,
                        t
                    }(wn)
                      , wu = {
                        paint: new bn({
                            "background-color": new vn(Ce.paint_background["background-color"]),
                            "background-pattern": new _n(Ce.paint_background["background-pattern"]),
                            "background-opacity": new vn(Ce.paint_background["background-opacity"])
                        })
                    }
                      , Su = function(e) {
                        function t(t) {
                            e.call(this, t, wu)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t
                    }(wn)
                      , Mu = {
                        paint: new bn({
                            "raster-opacity": new vn(Ce.paint_raster["raster-opacity"]),
                            "raster-hue-rotate": new vn(Ce.paint_raster["raster-hue-rotate"]),
                            "raster-brightness-min": new vn(Ce.paint_raster["raster-brightness-min"]),
                            "raster-brightness-max": new vn(Ce.paint_raster["raster-brightness-max"]),
                            "raster-saturation": new vn(Ce.paint_raster["raster-saturation"]),
                            "raster-contrast": new vn(Ce.paint_raster["raster-contrast"]),
                            "raster-resampling": new vn(Ce.paint_raster["raster-resampling"]),
                            "raster-fade-duration": new vn(Ce.paint_raster["raster-fade-duration"])
                        })
                    }
                      , Tu = function(e) {
                        function t(t) {
                            e.call(this, t, Mu)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t
                    }(wn)
                      , Eu = function(e) {
                        function t(t) {
                            e.call(this, t, {}),
                            this.implementation = t
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.is3D = function() {
                            return "3d" === this.implementation.renderingMode
                        }
                        ,
                        t.prototype.hasOffscreenPass = function() {
                            return void 0 !== this.implementation.prerender
                        }
                        ,
                        t.prototype.recalculate = function() {}
                        ,
                        t.prototype.updateTransitions = function() {}
                        ,
                        t.prototype.hasTransition = function() {}
                        ,
                        t.prototype.serialize = function() {}
                        ,
                        t.prototype.onAdd = function(e) {
                            this.implementation.onAdd && this.implementation.onAdd(e, e.painter.context.gl)
                        }
                        ,
                        t.prototype.onRemove = function(e) {
                            this.implementation.onRemove && this.implementation.onRemove(e, e.painter.context.gl)
                        }
                        ,
                        t
                    }(wn)
                      , Au = {
                        circle: ho,
                        heatmap: wo,
                        hillshade: Mo,
                        fill: cs,
                        "fill-extrusion": As,
                        line: Ns,
                        symbol: bu,
                        background: Su,
                        raster: Tu
                    }
                      , Pu = o.HTMLImageElement
                      , Cu = o.HTMLCanvasElement
                      , Lu = o.HTMLVideoElement
                      , Iu = o.ImageData
                      , ku = o.ImageBitmap
                      , zu = function(e, t, i, r) {
                        this.context = e,
                        this.format = i,
                        this.texture = e.gl.createTexture(),
                        this.update(t, r)
                    };
                    zu.prototype.update = function(e, t, i) {
                        var r = e.width
                          , n = e.height
                          , a = !(this.size && this.size[0] === r && this.size[1] === n || i)
                          , o = this.context
                          , s = o.gl;
                        if (this.useMipmap = Boolean(t && t.useMipmap),
                        s.bindTexture(s.TEXTURE_2D, this.texture),
                        o.pixelStoreUnpackFlipY.set(!1),
                        o.pixelStoreUnpack.set(1),
                        o.pixelStoreUnpackPremultiplyAlpha.set(this.format === s.RGBA && (!t || !1 !== t.premultiply)),
                        a)
                            this.size = [r, n],
                            e instanceof Pu || e instanceof Cu || e instanceof Lu || e instanceof Iu || ku && e instanceof ku ? s.texImage2D(s.TEXTURE_2D, 0, this.format, this.format, s.UNSIGNED_BYTE, e) : s.texImage2D(s.TEXTURE_2D, 0, this.format, r, n, 0, this.format, s.UNSIGNED_BYTE, e.data);
                        else {
                            var l = i || {
                                x: 0,
                                y: 0
                            }
                              , u = l.x
                              , c = l.y;
                            e instanceof Pu || e instanceof Cu || e instanceof Lu || e instanceof Iu || ku && e instanceof ku ? s.texSubImage2D(s.TEXTURE_2D, 0, u, c, s.RGBA, s.UNSIGNED_BYTE, e) : s.texSubImage2D(s.TEXTURE_2D, 0, u, c, r, n, s.RGBA, s.UNSIGNED_BYTE, e.data)
                        }
                        this.useMipmap && this.isSizePowerOfTwo() && s.generateMipmap(s.TEXTURE_2D)
                    }
                    ,
                    zu.prototype.bind = function(e, t, i) {
                        var r = this.context.gl;
                        r.bindTexture(r.TEXTURE_2D, this.texture),
                        i !== r.LINEAR_MIPMAP_NEAREST || this.isSizePowerOfTwo() || (i = r.LINEAR),
                        e !== this.filter && (r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, e),
                        r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, i || e),
                        this.filter = e),
                        t !== this.wrap && (r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, t),
                        r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, t),
                        this.wrap = t)
                    }
                    ,
                    zu.prototype.isSizePowerOfTwo = function() {
                        return this.size[0] === this.size[1] && Math.log(this.size[0]) / Math.LN2 % 1 == 0
                    }
                    ,
                    zu.prototype.destroy = function() {
                        this.context.gl.deleteTexture(this.texture),
                        this.texture = null
                    }
                    ;
                    var Du = function(e) {
                        var t = this;
                        this._callback = e,
                        this._triggered = !1,
                        "undefined" != typeof MessageChannel && (this._channel = new MessageChannel,
                        this._channel.port2.onmessage = function() {
                            t._triggered = !1,
                            t._callback()
                        }
                        )
                    };
                    Du.prototype.trigger = function() {
                        var e = this;
                        this._triggered || (this._triggered = !0,
                        this._channel ? this._channel.port1.postMessage(!0) : setTimeout((function() {
                            e._triggered = !1,
                            e._callback()
                        }
                        ), 0))
                    }
                    ,
                    Du.prototype.remove = function() {
                        delete this._channel,
                        this._callback = function() {}
                    }
                    ;
                    var Ru = function(e, t, i) {
                        this.target = e,
                        this.parent = t,
                        this.mapId = i,
                        this.callbacks = {},
                        this.tasks = {},
                        this.taskQueue = [],
                        this.cancelCallbacks = {},
                        g(["receive", "process"], this),
                        this.invoker = new Du(this.process),
                        this.target.addEventListener("message", this.receive, !1),
                        this.globalScope = E() ? e : o
                    };
                    function Ou(e, t, i) {
                        var r = 2 * Math.PI * 6378137 / 256 / Math.pow(2, i);
                        return [e * r - 2 * Math.PI * 6378137 / 2, t * r - 2 * Math.PI * 6378137 / 2]
                    }
                    Ru.prototype.send = function(e, t, i, r, n) {
                        var a = this;
                        void 0 === n && (n = !1);
                        var o = Math.round(1e18 * Math.random()).toString(36).substring(0, 10);
                        i && (this.callbacks[o] = i);
                        var s = C(this.globalScope) ? void 0 : [];
                        return this.target.postMessage({
                            id: o,
                            type: e,
                            hasCallback: !!i,
                            targetMapId: r,
                            mustQueue: n,
                            sourceMapId: this.mapId,
                            data: Vr(t, s)
                        }, s),
                        {
                            cancel: function() {
                                i && delete a.callbacks[o],
                                a.target.postMessage({
                                    id: o,
                                    type: "<cancel>",
                                    targetMapId: r,
                                    sourceMapId: a.mapId
                                })
                            }
                        }
                    }
                    ,
                    Ru.prototype.receive = function(e) {
                        var t = e.data
                          , i = t.id;
                        if (i && (!t.targetMapId || this.mapId === t.targetMapId))
                            if ("<cancel>" === t.type) {
                                delete this.tasks[i];
                                var r = this.cancelCallbacks[i];
                                delete this.cancelCallbacks[i],
                                r && r()
                            } else
                                E() || t.mustQueue ? (this.tasks[i] = t,
                                this.taskQueue.push(i),
                                this.invoker.trigger()) : this.processTask(i, t)
                    }
                    ,
                    Ru.prototype.process = function() {
                        if (this.taskQueue.length) {
                            var e = this.taskQueue.shift()
                              , t = this.tasks[e];
                            delete this.tasks[e],
                            this.taskQueue.length && this.invoker.trigger(),
                            t && this.processTask(e, t)
                        }
                    }
                    ,
                    Ru.prototype.processTask = function(e, t) {
                        var i = this;
                        if ("<response>" === t.type) {
                            var r = this.callbacks[e];
                            delete this.callbacks[e],
                            r && (t.error ? r(Gr(t.error)) : r(null, Gr(t.data)))
                        } else {
                            var n = !1
                              , a = C(this.globalScope) ? void 0 : []
                              , o = t.hasCallback ? function(t, r) {
                                n = !0,
                                delete i.cancelCallbacks[e],
                                i.target.postMessage({
                                    id: e,
                                    type: "<response>",
                                    sourceMapId: i.mapId,
                                    error: t ? Vr(t) : null,
                                    data: Vr(r, a)
                                }, a)
                            }
                            : function(e) {
                                n = !0
                            }
                              , s = null
                              , l = Gr(t.data);
                            if (this.parent[t.type])
                                s = this.parent[t.type](t.sourceMapId, l, o);
                            else if (this.parent.getWorkerSource) {
                                var u = t.type.split(".");
                                s = this.parent.getWorkerSource(t.sourceMapId, u[0], l.source)[u[1]](l, o)
                            } else
                                o(new Error("Could not find function " + t.type));
                            !n && s && s.cancel && (this.cancelCallbacks[e] = s.cancel)
                        }
                    }
                    ,
                    Ru.prototype.remove = function() {
                        this.invoker.remove(),
                        this.target.removeEventListener("message", this.receive, !1)
                    }
                    ;
                    var Bu = function(e, t) {
                        e && (t ? this.setSouthWest(e).setNorthEast(t) : 4 === e.length ? this.setSouthWest([e[0], e[1]]).setNorthEast([e[2], e[3]]) : this.setSouthWest(e[0]).setNorthEast(e[1]))
                    };
                    Bu.prototype.setNorthEast = function(e) {
                        return this._ne = e instanceof Fu ? new Fu(e.lng,e.lat) : Fu.convert(e),
                        this
                    }
                    ,
                    Bu.prototype.setSouthWest = function(e) {
                        return this._sw = e instanceof Fu ? new Fu(e.lng,e.lat) : Fu.convert(e),
                        this
                    }
                    ,
                    Bu.prototype.extend = function(e) {
                        var t, i, r = this._sw, n = this._ne;
                        if (e instanceof Fu)
                            t = e,
                            i = e;
                        else {
                            if (!(e instanceof Bu))
                                return Array.isArray(e) ? 4 === e.length || e.every(Array.isArray) ? this.extend(Bu.convert(e)) : this.extend(Fu.convert(e)) : this;
                            if (i = e._ne,
                            !(t = e._sw) || !i)
                                return this
                        }
                        return r || n ? (r.lng = Math.min(t.lng, r.lng),
                        r.lat = Math.min(t.lat, r.lat),
                        n.lng = Math.max(i.lng, n.lng),
                        n.lat = Math.max(i.lat, n.lat)) : (this._sw = new Fu(t.lng,t.lat),
                        this._ne = new Fu(i.lng,i.lat)),
                        this
                    }
                    ,
                    Bu.prototype.getCenter = function() {
                        return new Fu((this._sw.lng + this._ne.lng) / 2,(this._sw.lat + this._ne.lat) / 2)
                    }
                    ,
                    Bu.prototype.getSouthWest = function() {
                        return this._sw
                    }
                    ,
                    Bu.prototype.getNorthEast = function() {
                        return this._ne
                    }
                    ,
                    Bu.prototype.getNorthWest = function() {
                        return new Fu(this.getWest(),this.getNorth())
                    }
                    ,
                    Bu.prototype.getSouthEast = function() {
                        return new Fu(this.getEast(),this.getSouth())
                    }
                    ,
                    Bu.prototype.getWest = function() {
                        return this._sw.lng
                    }
                    ,
                    Bu.prototype.getSouth = function() {
                        return this._sw.lat
                    }
                    ,
                    Bu.prototype.getEast = function() {
                        return this._ne.lng
                    }
                    ,
                    Bu.prototype.getNorth = function() {
                        return this._ne.lat
                    }
                    ,
                    Bu.prototype.toArray = function() {
                        return [this._sw.toArray(), this._ne.toArray()]
                    }
                    ,
                    Bu.prototype.toString = function() {
                        return "LngLatBounds(" + this._sw.toString() + ", " + this._ne.toString() + ")"
                    }
                    ,
                    Bu.prototype.isEmpty = function() {
                        return !(this._sw && this._ne)
                    }
                    ,
                    Bu.prototype.contains = function(e) {
                        var t = Fu.convert(e)
                          , i = t.lng
                          , r = t.lat
                          , n = this._sw.lng <= i && i <= this._ne.lng;
                        return this._sw.lng > this._ne.lng && (n = this._sw.lng >= i && i >= this._ne.lng),
                        this._sw.lat <= r && r <= this._ne.lat && n
                    }
                    ,
                    Bu.convert = function(e) {
                        return !e || e instanceof Bu ? e : new Bu(e)
                    }
                    ;
                    var Fu = function(e, t) {
                        if (isNaN(e) || isNaN(t))
                            throw new Error("Invalid LngLat object: (" + e + ", " + t + ")");
                        if (this.lng = +e,
                        this.lat = +t,
                        this.lat > 90 || this.lat < -90)
                            throw new Error("Invalid LngLat latitude value: must be between -90 and 90")
                    };
                    Fu.prototype.wrap = function() {
                        return new Fu(h(this.lng, -180, 180),this.lat)
                    }
                    ,
                    Fu.prototype.toArray = function() {
                        return [this.lng, this.lat]
                    }
                    ,
                    Fu.prototype.toString = function() {
                        return "LngLat(" + this.lng + ", " + this.lat + ")"
                    }
                    ,
                    Fu.prototype.distanceTo = function(e) {
                        var t = Math.PI / 180
                          , i = this.lat * t
                          , r = e.lat * t
                          , n = Math.sin(i) * Math.sin(r) + Math.cos(i) * Math.cos(r) * Math.cos((e.lng - this.lng) * t);
                        return 6371008.8 * Math.acos(Math.min(n, 1))
                    }
                    ,
                    Fu.prototype.toBounds = function(e) {
                        void 0 === e && (e = 0);
                        var t = 360 * e / 40075017
                          , i = t / Math.cos(Math.PI / 180 * this.lat);
                        return new Bu(new Fu(this.lng - i,this.lat - t),new Fu(this.lng + i,this.lat + t))
                    }
                    ,
                    Fu.convert = function(e) {
                        if (e instanceof Fu)
                            return e;
                        if (Array.isArray(e) && (2 === e.length || 3 === e.length))
                            return new Fu(Number(e[0]),Number(e[1]));
                        if (!Array.isArray(e) && "object" == typeof e && null !== e)
                            return new Fu(Number("lng"in e ? e.lng : e.lon),Number(e.lat));
                        throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")
                    }
                    ;
                    var Nu = 2 * Math.PI * 6371008.8;
                    function Uu(e) {
                        return Nu * Math.cos(e * Math.PI / 180)
                    }
                    function Vu(e) {
                        return (180 + e) / 360
                    }
                    function Gu(e) {
                        return (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + e * Math.PI / 360))) / 360
                    }
                    function ju(e, t) {
                        return e / Uu(t)
                    }
                    function Hu(e) {
                        return 360 / Math.PI * Math.atan(Math.exp((180 - 360 * e) * Math.PI / 180)) - 90
                    }
                    var qu = function(e, t, i) {
                        void 0 === i && (i = 0),
                        this.x = +e,
                        this.y = +t,
                        this.z = +i
                    };
                    qu.fromLngLat = function(e, t) {
                        void 0 === t && (t = 0);
                        var i = Fu.convert(e);
                        return new qu(Vu(i.lng),Gu(i.lat),ju(t, i.lat))
                    }
                    ,
                    qu.prototype.toLngLat = function() {
                        return new Fu(360 * this.x - 180,Hu(this.y))
                    }
                    ,
                    qu.prototype.toAltitude = function() {
                        return this.z * Uu(Hu(this.y))
                    }
                    ,
                    qu.prototype.meterInMercatorCoordinateUnits = function() {
                        return 1 / Nu * (e = Hu(this.y),
                        1 / Math.cos(e * Math.PI / 180));
                        var e
                    }
                    ;
                    var Wu = function(e, t, i) {
                        this.z = e,
                        this.x = t,
                        this.y = i,
                        this.key = Yu(0, e, e, t, i)
                    };
                    Wu.prototype.equals = function(e) {
                        return this.z === e.z && this.x === e.x && this.y === e.y
                    }
                    ,
                    Wu.prototype.url = function(e, t) {
                        var i, r, n, a, o, s = (r = this.y,
                        n = this.z,
                        a = Ou(256 * (i = this.x), 256 * (r = Math.pow(2, n) - r - 1), n),
                        o = Ou(256 * (i + 1), 256 * (r + 1), n),
                        a[0] + "," + a[1] + "," + o[0] + "," + o[1]), l = function(e, t, i) {
                            for (var r, n = "", a = e; a > 0; a--)
                                n += (t & (r = 1 << a - 1) ? 1 : 0) + (i & r ? 2 : 0);
                            return n
                        }(this.z, this.x, this.y);
                        return e[(this.x + this.y) % e.length].replace("{prefix}", (this.x % 16).toString(16) + (this.y % 16).toString(16)).replace("{z}", String(this.z)).replace("{x}", String(this.x)).replace("{y}", String("tms" === t ? Math.pow(2, this.z) - this.y - 1 : this.y)).replace("{quadkey}", l).replace("{bbox-epsg-3857}", s)
                    }
                    ,
                    Wu.prototype.getTilePoint = function(e) {
                        var t = Math.pow(2, this.z);
                        return new n(8192 * (e.x * t - this.x),8192 * (e.y * t - this.y))
                    }
                    ,
                    Wu.prototype.toString = function() {
                        return this.z + "/" + this.x + "/" + this.y
                    }
                    ;
                    var Zu = function(e, t) {
                        this.wrap = e,
                        this.canonical = t,
                        this.key = Yu(e, t.z, t.z, t.x, t.y)
                    }
                      , Xu = function(e, t, i, r, n) {
                        this.overscaledZ = e,
                        this.wrap = t,
                        this.canonical = new Wu(i,+r,+n),
                        this.key = Yu(t, e, i, r, n)
                    };
                    function Yu(e, t, i, r, n) {
                        (e *= 2) < 0 && (e = -1 * e - 1);
                        var a = 1 << i;
                        return (a * a * e + a * n + r).toString(36) + i.toString(36) + t.toString(36)
                    }
                    Xu.prototype.equals = function(e) {
                        return this.overscaledZ === e.overscaledZ && this.wrap === e.wrap && this.canonical.equals(e.canonical)
                    }
                    ,
                    Xu.prototype.scaledTo = function(e) {
                        var t = this.canonical.z - e;
                        return e > this.canonical.z ? new Xu(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y) : new Xu(e,this.wrap,e,this.canonical.x >> t,this.canonical.y >> t)
                    }
                    ,
                    Xu.prototype.calculateScaledKey = function(e, t) {
                        var i = this.canonical.z - e;
                        return e > this.canonical.z ? Yu(this.wrap * +t, e, this.canonical.z, this.canonical.x, this.canonical.y) : Yu(this.wrap * +t, e, e, this.canonical.x >> i, this.canonical.y >> i)
                    }
                    ,
                    Xu.prototype.isChildOf = function(e) {
                        if (e.wrap !== this.wrap)
                            return !1;
                        var t = this.canonical.z - e.canonical.z;
                        return 0 === e.overscaledZ || e.overscaledZ < this.overscaledZ && e.canonical.x === this.canonical.x >> t && e.canonical.y === this.canonical.y >> t
                    }
                    ,
                    Xu.prototype.children = function(e) {
                        if (this.overscaledZ >= e)
                            return [new Xu(this.overscaledZ + 1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];
                        var t = this.canonical.z + 1
                          , i = 2 * this.canonical.x
                          , r = 2 * this.canonical.y;
                        return [new Xu(t,this.wrap,t,i,r), new Xu(t,this.wrap,t,i + 1,r), new Xu(t,this.wrap,t,i,r + 1), new Xu(t,this.wrap,t,i + 1,r + 1)]
                    }
                    ,
                    Xu.prototype.isLessThan = function(e) {
                        return this.wrap < e.wrap || !(this.wrap > e.wrap) && (this.overscaledZ < e.overscaledZ || !(this.overscaledZ > e.overscaledZ) && (this.canonical.x < e.canonical.x || !(this.canonical.x > e.canonical.x) && this.canonical.y < e.canonical.y))
                    }
                    ,
                    Xu.prototype.wrapped = function() {
                        return new Xu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)
                    }
                    ,
                    Xu.prototype.unwrapTo = function(e) {
                        return new Xu(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)
                    }
                    ,
                    Xu.prototype.overscaleFactor = function() {
                        return Math.pow(2, this.overscaledZ - this.canonical.z)
                    }
                    ,
                    Xu.prototype.toUnwrapped = function() {
                        return new Zu(this.wrap,this.canonical)
                    }
                    ,
                    Xu.prototype.toString = function() {
                        return this.overscaledZ + "/" + this.canonical.x + "/" + this.canonical.y
                    }
                    ,
                    Xu.prototype.getTilePoint = function(e) {
                        return this.canonical.getTilePoint(new qu(e.x - this.wrap,e.y))
                    }
                    ,
                    Br("CanonicalTileID", Wu),
                    Br("OverscaledTileID", Xu, {
                        omit: ["posMatrix"]
                    });
                    var Ku = function(e, t, i) {
                        if (this.uid = e,
                        t.height !== t.width)
                            throw new RangeError("DEM tiles must be square");
                        if (i && "mapbox" !== i && "terrarium" !== i)
                            return S('"' + i + '" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');
                        this.stride = t.height;
                        var r = this.dim = t.height - 2;
                        this.data = new Uint32Array(t.data.buffer),
                        this.encoding = i || "mapbox";
                        for (var n = 0; n < r; n++)
                            this.data[this._idx(-1, n)] = this.data[this._idx(0, n)],
                            this.data[this._idx(r, n)] = this.data[this._idx(r - 1, n)],
                            this.data[this._idx(n, -1)] = this.data[this._idx(n, 0)],
                            this.data[this._idx(n, r)] = this.data[this._idx(n, r - 1)];
                        this.data[this._idx(-1, -1)] = this.data[this._idx(0, 0)],
                        this.data[this._idx(r, -1)] = this.data[this._idx(r - 1, 0)],
                        this.data[this._idx(-1, r)] = this.data[this._idx(0, r - 1)],
                        this.data[this._idx(r, r)] = this.data[this._idx(r - 1, r - 1)]
                    };
                    Ku.prototype.get = function(e, t) {
                        var i = new Uint8Array(this.data.buffer)
                          , r = 4 * this._idx(e, t);
                        return ("terrarium" === this.encoding ? this._unpackTerrarium : this._unpackMapbox)(i[r], i[r + 1], i[r + 2])
                    }
                    ,
                    Ku.prototype.getUnpackVector = function() {
                        return "terrarium" === this.encoding ? [256, 1, 1 / 256, 32768] : [6553.6, 25.6, .1, 1e4]
                    }
                    ,
                    Ku.prototype._idx = function(e, t) {
                        if (e < -1 || e >= this.dim + 1 || t < -1 || t >= this.dim + 1)
                            throw new RangeError("out of range source coordinates for DEM data");
                        return (t + 1) * this.stride + (e + 1)
                    }
                    ,
                    Ku.prototype._unpackMapbox = function(e, t, i) {
                        return (256 * e * 256 + 256 * t + i) / 10 - 1e4
                    }
                    ,
                    Ku.prototype._unpackTerrarium = function(e, t, i) {
                        return 256 * e + t + i / 256 - 32768
                    }
                    ,
                    Ku.prototype.getPixels = function() {
                        return new _o({
                            width: this.stride,
                            height: this.stride
                        },new Uint8Array(this.data.buffer))
                    }
                    ,
                    Ku.prototype.backfillBorder = function(e, t, i) {
                        if (this.dim !== e.dim)
                            throw new Error("dem dimension mismatch");
                        var r = t * this.dim
                          , n = t * this.dim + this.dim
                          , a = i * this.dim
                          , o = i * this.dim + this.dim;
                        switch (t) {
                        case -1:
                            r = n - 1;
                            break;
                        case 1:
                            n = r + 1
                        }
                        switch (i) {
                        case -1:
                            a = o - 1;
                            break;
                        case 1:
                            o = a + 1
                        }
                        for (var s = -t * this.dim, l = -i * this.dim, u = a; u < o; u++)
                            for (var c = r; c < n; c++)
                                this.data[this._idx(c, u)] = e.data[this._idx(c + s, u + l)]
                    }
                    ,
                    Br("DEMData", Ku);
                    var Ju = function(e) {
                        this._stringToNumber = {},
                        this._numberToString = [];
                        for (var t = 0; t < e.length; t++) {
                            var i = e[t];
                            this._stringToNumber[i] = t,
                            this._numberToString[t] = i
                        }
                    };
                    Ju.prototype.encode = function(e) {
                        return this._stringToNumber[e]
                    }
                    ,
                    Ju.prototype.decode = function(e) {
                        return this._numberToString[e]
                    }
                    ;
                    var Qu = function(e, t, i, r, n) {
                        this.type = "Feature",
                        this._vectorTileFeature = e,
                        e._z = t,
                        e._x = i,
                        e._y = r,
                        this.properties = e.properties,
                        this.id = n
                    }
                      , $u = {
                        geometry: {
                            configurable: !0
                        }
                    };
                    $u.geometry.get = function() {
                        return void 0 === this._geometry && (this._geometry = this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x, this._vectorTileFeature._y, this._vectorTileFeature._z).geometry),
                        this._geometry
                    }
                    ,
                    $u.geometry.set = function(e) {
                        this._geometry = e
                    }
                    ,
                    Qu.prototype.toJSON = function() {
                        var e = {
                            geometry: this.geometry
                        };
                        for (var t in this)
                            "_geometry" !== t && "_vectorTileFeature" !== t && (e[t] = this[t]);
                        return e
                    }
                    ,
                    Object.defineProperties(Qu.prototype, $u);
                    var ec = function() {
                        this.state = {},
                        this.stateChanges = {},
                        this.deletedStates = {}
                    };
                    ec.prototype.updateState = function(e, t, i) {
                        var r = String(t);
                        if (this.stateChanges[e] = this.stateChanges[e] || {},
                        this.stateChanges[e][r] = this.stateChanges[e][r] || {},
                        p(this.stateChanges[e][r], i),
                        null === this.deletedStates[e])
                            for (var n in this.deletedStates[e] = {},
                            this.state[e])
                                n !== r && (this.deletedStates[e][n] = null);
                        else if (this.deletedStates[e] && null === this.deletedStates[e][r])
                            for (var a in this.deletedStates[e][r] = {},
                            this.state[e][r])
                                i[a] || (this.deletedStates[e][r][a] = null);
                        else
                            for (var o in i)
                                this.deletedStates[e] && this.deletedStates[e][r] && null === this.deletedStates[e][r][o] && delete this.deletedStates[e][r][o]
                    }
                    ,
                    ec.prototype.removeFeatureState = function(e, t, i) {
                        if (null !== this.deletedStates[e]) {
                            var r = String(t);
                            if (this.deletedStates[e] = this.deletedStates[e] || {},
                            i && void 0 !== t)
                                null !== this.deletedStates[e][r] && (this.deletedStates[e][r] = this.deletedStates[e][r] || {},
                                this.deletedStates[e][r][i] = null);
                            else if (void 0 !== t)
                                if (this.stateChanges[e] && this.stateChanges[e][r])
                                    for (i in this.deletedStates[e][r] = {},
                                    this.stateChanges[e][r])
                                        this.deletedStates[e][r][i] = null;
                                else
                                    this.deletedStates[e][r] = null;
                            else
                                this.deletedStates[e] = null
                        }
                    }
                    ,
                    ec.prototype.getState = function(e, t) {
                        var i = String(t)
                          , r = p({}, (this.state[e] || {})[i], (this.stateChanges[e] || {})[i]);
                        if (null === this.deletedStates[e])
                            return {};
                        if (this.deletedStates[e]) {
                            var n = this.deletedStates[e][t];
                            if (null === n)
                                return {};
                            for (var a in n)
                                delete r[a]
                        }
                        return r
                    }
                    ,
                    ec.prototype.initializeTileState = function(e, t) {
                        e.setFeatureState(this.state, t)
                    }
                    ,
                    ec.prototype.coalesceChanges = function(e, t) {
                        var i = {};
                        for (var r in this.stateChanges) {
                            this.state[r] = this.state[r] || {};
                            var n = {};
                            for (var a in this.stateChanges[r])
                                this.state[r][a] || (this.state[r][a] = {}),
                                p(this.state[r][a], this.stateChanges[r][a]),
                                n[a] = this.state[r][a];
                            i[r] = n
                        }
                        for (var o in this.deletedStates) {
                            this.state[o] = this.state[o] || {};
                            var s = {};
                            if (null === this.deletedStates[o])
                                for (var l in this.state[o])
                                    s[l] = {},
                                    this.state[o][l] = {};
                            else
                                for (var u in this.deletedStates[o]) {
                                    if (null === this.deletedStates[o][u])
                                        this.state[o][u] = {};
                                    else
                                        for (var c = 0, h = Object.keys(this.deletedStates[o][u]); c < h.length; c += 1)
                                            delete this.state[o][u][h[c]];
                                    s[u] = this.state[o][u]
                                }
                            i[o] = i[o] || {},
                            p(i[o], s)
                        }
                        if (this.stateChanges = {},
                        this.deletedStates = {},
                        0 !== Object.keys(i).length)
                            for (var f in e)
                                e[f].setFeatureState(i, t)
                    }
                    ;
                    var tc = function(e, t) {
                        this.tileID = e,
                        this.x = e.canonical.x,
                        this.y = e.canonical.y,
                        this.z = e.canonical.z,
                        this.grid = new kr(8192,16,0),
                        this.grid3D = new kr(8192,16,0),
                        this.featureIndexArray = new aa,
                        this.promoteId = t
                    };
                    function ic(e, t, i, r, n) {
                        return _(e, (function(e, a) {
                            var o = t instanceof mn ? t.get(a) : null;
                            return o && o.evaluate ? o.evaluate(i, r, n) : o
                        }
                        ))
                    }
                    function rc(e) {
                        for (var t = 1 / 0, i = 1 / 0, r = -1 / 0, n = -1 / 0, a = 0, o = e; a < o.length; a += 1) {
                            var s = o[a];
                            t = Math.min(t, s.x),
                            i = Math.min(i, s.y),
                            r = Math.max(r, s.x),
                            n = Math.max(n, s.y)
                        }
                        return {
                            minX: t,
                            minY: i,
                            maxX: r,
                            maxY: n
                        }
                    }
                    function nc(e, t) {
                        return t - e
                    }
                    tc.prototype.insert = function(e, t, i, r, n, a) {
                        var o = this.featureIndexArray.length;
                        this.featureIndexArray.emplaceBack(i, r, n);
                        for (var s = a ? this.grid3D : this.grid, l = 0; l < t.length; l++) {
                            for (var u = t[l], c = [1 / 0, 1 / 0, -1 / 0, -1 / 0], h = 0; h < u.length; h++) {
                                var p = u[h];
                                c[0] = Math.min(c[0], p.x),
                                c[1] = Math.min(c[1], p.y),
                                c[2] = Math.max(c[2], p.x),
                                c[3] = Math.max(c[3], p.y)
                            }
                            c[0] < 8192 && c[1] < 8192 && c[2] >= 0 && c[3] >= 0 && s.insert(o, c[0], c[1], c[2], c[3])
                        }
                    }
                    ,
                    tc.prototype.loadVTLayers = function() {
                        return this.vtLayers || (this.vtLayers = new xs.VectorTile(new Ks(this.rawTileData)).layers,
                        this.sourceLayerCoder = new Ju(this.vtLayers ? Object.keys(this.vtLayers).sort() : ["_geojsonTileLayer"])),
                        this.vtLayers
                    }
                    ,
                    tc.prototype.query = function(e, t, i, r) {
                        var a = this;
                        this.loadVTLayers();
                        for (var o = e.params || {}, s = 8192 / e.tileSize / e.scale, l = ar(o.filter), u = e.queryGeometry, c = e.queryPadding * s, h = rc(u), p = this.grid.query(h.minX - c, h.minY - c, h.maxX + c, h.maxY + c), f = rc(e.cameraQueryGeometry), d = 0, m = this.grid3D.query(f.minX - c, f.minY - c, f.maxX + c, f.maxY + c, (function(t, i, r, a) {
                            return function(e, t, i, r, a) {
                                for (var o = 0, s = e; o < s.length; o += 1) {
                                    var l = s[o];
                                    if (t <= l.x && i <= l.y && r >= l.x && a >= l.y)
                                        return !0
                                }
                                var u = [new n(t,i), new n(t,a), new n(r,a), new n(r,i)];
                                if (e.length > 2)
                                    for (var c = 0, h = u; c < h.length; c += 1)
                                        if (Qa(e, h[c]))
                                            return !0;
                                for (var p = 0; p < e.length - 1; p++)
                                    if ($a(e[p], e[p + 1], u))
                                        return !0;
                                return !1
                            }(e.cameraQueryGeometry, t - c, i - c, r + c, a + c)
                        }
                        )); d < m.length; d += 1)
                            p.push(m[d]);
                        p.sort(nc);
                        for (var v, g = {}, y = function(n) {
                            var c = p[n];
                            if (c !== v) {
                                v = c;
                                var h = a.featureIndexArray.get(c)
                                  , f = null;
                                a.loadMatchingFeature(g, h.bucketIndex, h.sourceLayerIndex, h.featureIndex, l, o.layers, o.availableImages, t, i, r, (function(t, i, r) {
                                    return f || (f = Na(t)),
                                    i.queryIntersectsFeature(u, t, r, f, a.z, e.transform, s, e.pixelPosMatrix)
                                }
                                ))
                            }
                        }, _ = 0; _ < p.length; _++)
                            y(_);
                        return g
                    }
                    ,
                    tc.prototype.loadMatchingFeature = function(e, t, i, r, n, a, o, s, l, u, c) {
                        var h = this.bucketLayerIDs[t];
                        if (!a || function(e, t) {
                            for (var i = 0; i < e.length; i++)
                                if (t.indexOf(e[i]) >= 0)
                                    return !0;
                            return !1
                        }(a, h)) {
                            var f = this.sourceLayerCoder.decode(i)
                              , d = this.vtLayers[f].feature(r);
                            if (n.needGeometry) {
                                var m = Ua(d, !0);
                                if (!n.filter(new sn(this.tileID.overscaledZ), m, this.tileID.canonical))
                                    return
                            } else if (!n.filter(new sn(this.tileID.overscaledZ), d))
                                return;
                            for (var v = this.getId(d, f), g = 0; g < h.length; g++) {
                                var y = h[g];
                                if (!(a && a.indexOf(y) < 0)) {
                                    var _ = s[y];
                                    if (_) {
                                        var x = {};
                                        void 0 !== v && u && (x = u.getState(_.sourceLayer || "_geojsonTileLayer", v));
                                        var b = p({}, l[y]);
                                        b.paint = ic(b.paint, _.paint, d, x, o),
                                        b.layout = ic(b.layout, _.layout, d, x, o);
                                        var w = !c || c(d, _, x);
                                        if (w) {
                                            var S = new Qu(d,this.z,this.x,this.y,v);
                                            S.layer = b;
                                            var M = e[y];
                                            void 0 === M && (M = e[y] = []),
                                            M.push({
                                                featureIndex: r,
                                                feature: S,
                                                intersectionZ: w
                                            })
                                        }
                                    }
                                }
                            }
                        }
                    }
                    ,
                    tc.prototype.lookupSymbolFeatures = function(e, t, i, r, n, a, o, s) {
                        var l = {};
                        this.loadVTLayers();
                        for (var u = ar(n), c = 0, h = e; c < h.length; c += 1)
                            this.loadMatchingFeature(l, i, r, h[c], u, a, o, s, t);
                        return l
                    }
                    ,
                    tc.prototype.hasLayer = function(e) {
                        for (var t = 0, i = this.bucketLayerIDs; t < i.length; t += 1)
                            for (var r = 0, n = i[t]; r < n.length; r += 1)
                                if (e === n[r])
                                    return !0;
                        return !1
                    }
                    ,
                    tc.prototype.getId = function(e, t) {
                        var i = e.id;
                        return this.promoteId && "boolean" == typeof (i = e.properties["string" == typeof this.promoteId ? this.promoteId : this.promoteId[t]]) && (i = Number(i)),
                        i
                    }
                    ,
                    Br("FeatureIndex", tc, {
                        omit: ["rawTileData", "sourceLayerCoder"]
                    });
                    var ac = function(e, t) {
                        this.tileID = e,
                        this.uid = d(),
                        this.uses = 0,
                        this.tileSize = t,
                        this.buckets = {},
                        this.expirationTime = null,
                        this.queryPadding = 0,
                        this.hasSymbolBuckets = !1,
                        this.hasRTLText = !1,
                        this.dependencies = {},
                        this.expiredRequestCount = 0,
                        this.state = "loading"
                    };
                    ac.prototype.registerFadeDuration = function(e) {
                        var t = e + this.timeAdded;
                        t < F.now() || this.fadeEndTime && t < this.fadeEndTime || (this.fadeEndTime = t)
                    }
                    ,
                    ac.prototype.wasRequested = function() {
                        return "errored" === this.state || "loaded" === this.state || "reloading" === this.state
                    }
                    ,
                    ac.prototype.loadVectorData = function(e, t, i) {
                        if (this.hasData() && this.unloadVectorData(),
                        this.state = "loaded",
                        e) {
                            for (var r in e.featureIndex && (this.latestFeatureIndex = e.featureIndex,
                            e.rawTileData ? (this.latestRawTileData = e.rawTileData,
                            this.latestFeatureIndex.rawTileData = e.rawTileData) : this.latestRawTileData && (this.latestFeatureIndex.rawTileData = this.latestRawTileData)),
                            this.collisionBoxArray = e.collisionBoxArray,
                            this.buckets = function(e, t) {
                                var i = {};
                                if (!t)
                                    return i;
                                for (var r = function() {
                                    var e = a[n]
                                      , r = e.layerIds.map((function(e) {
                                        return t.getLayer(e)
                                    }
                                    )).filter(Boolean);
                                    if (0 !== r.length) {
                                        e.layers = r,
                                        e.stateDependentLayerIds && (e.stateDependentLayers = e.stateDependentLayerIds.map((function(e) {
                                            return r.filter((function(t) {
                                                return t.id === e
                                            }
                                            ))[0]
                                        }
                                        )));
                                        for (var o = 0, s = r; o < s.length; o += 1)
                                            i[s[o].id] = e
                                    }
                                }, n = 0, a = e; n < a.length; n += 1)
                                    r();
                                return i
                            }(e.buckets, t.style),
                            this.hasSymbolBuckets = !1,
                            this.buckets) {
                                var n = this.buckets[r];
                                if (n instanceof gu) {
                                    if (this.hasSymbolBuckets = !0,
                                    !i)
                                        break;
                                    n.justReloaded = !0
                                }
                            }
                            if (this.hasRTLText = !1,
                            this.hasSymbolBuckets)
                                for (var a in this.buckets) {
                                    var o = this.buckets[a];
                                    if (o instanceof gu && o.hasRTLText) {
                                        this.hasRTLText = !0,
                                        on.isLoading() || on.isLoaded() || "deferred" !== nn() || an();
                                        break
                                    }
                                }
                            for (var s in this.queryPadding = 0,
                            this.buckets) {
                                var l = this.buckets[s];
                                this.queryPadding = Math.max(this.queryPadding, t.style.getLayer(s).queryRadius(l))
                            }
                            e.imageAtlas && (this.imageAtlas = e.imageAtlas),
                            e.glyphAtlasImage && (this.glyphAtlasImage = e.glyphAtlasImage)
                        } else
                            this.collisionBoxArray = new Jn
                    }
                    ,
                    ac.prototype.unloadVectorData = function() {
                        for (var e in this.buckets)
                            this.buckets[e].destroy();
                        this.buckets = {},
                        this.imageAtlasTexture && this.imageAtlasTexture.destroy(),
                        this.imageAtlas && (this.imageAtlas = null),
                        this.glyphAtlasTexture && this.glyphAtlasTexture.destroy(),
                        this.latestFeatureIndex = null,
                        this.state = "unloaded"
                    }
                    ,
                    ac.prototype.getBucket = function(e) {
                        return this.buckets[e.id]
                    }
                    ,
                    ac.prototype.upload = function(e) {
                        for (var t in this.buckets) {
                            var i = this.buckets[t];
                            i.uploadPending() && i.upload(e)
                        }
                        var r = e.gl;
                        this.imageAtlas && !this.imageAtlas.uploaded && (this.imageAtlasTexture = new zu(e,this.imageAtlas.image,r.RGBA),
                        this.imageAtlas.uploaded = !0),
                        this.glyphAtlasImage && (this.glyphAtlasTexture = new zu(e,this.glyphAtlasImage,r.ALPHA),
                        this.glyphAtlasImage = null)
                    }
                    ,
                    ac.prototype.prepare = function(e) {
                        this.imageAtlas && this.imageAtlas.patchUpdatedImages(e, this.imageAtlasTexture)
                    }
                    ,
                    ac.prototype.queryRenderedFeatures = function(e, t, i, r, n, a, o, s, l, u) {
                        return this.latestFeatureIndex && this.latestFeatureIndex.rawTileData ? this.latestFeatureIndex.query({
                            queryGeometry: r,
                            cameraQueryGeometry: n,
                            scale: a,
                            tileSize: this.tileSize,
                            pixelPosMatrix: u,
                            transform: s,
                            params: o,
                            queryPadding: this.queryPadding * l
                        }, e, t, i) : {}
                    }
                    ,
                    ac.prototype.querySourceFeatures = function(e, t) {
                        var i = this.latestFeatureIndex;
                        if (i && i.rawTileData) {
                            var r = i.loadVTLayers()
                              , n = t ? t.sourceLayer : ""
                              , a = r._geojsonTileLayer || r[n];
                            if (a)
                                for (var o = ar(t && t.filter), s = this.tileID.canonical, l = s.z, u = s.x, c = s.y, h = {
                                    z: l,
                                    x: u,
                                    y: c
                                }, p = 0; p < a.length; p++) {
                                    var f = a.feature(p);
                                    if (o.needGeometry) {
                                        var d = Ua(f, !0);
                                        if (!o.filter(new sn(this.tileID.overscaledZ), d, this.tileID.canonical))
                                            continue
                                    } else if (!o.filter(new sn(this.tileID.overscaledZ), f))
                                        continue;
                                    var m = i.getId(f, n)
                                      , v = new Qu(f,l,u,c,m);
                                    v.tile = h,
                                    e.push(v)
                                }
                        }
                    }
                    ,
                    ac.prototype.hasData = function() {
                        return "loaded" === this.state || "reloading" === this.state || "expired" === this.state
                    }
                    ,
                    ac.prototype.patternsLoaded = function() {
                        return this.imageAtlas && !!Object.keys(this.imageAtlas.patternPositions).length
                    }
                    ,
                    ac.prototype.setExpiryData = function(e) {
                        var t = this.expirationTime;
                        if (e.cacheControl) {
                            var i = A(e.cacheControl);
                            i["max-age"] && (this.expirationTime = Date.now() + 1e3 * i["max-age"])
                        } else
                            e.expires && (this.expirationTime = new Date(e.expires).getTime());
                        if (this.expirationTime) {
                            var r = Date.now()
                              , n = !1;
                            if (this.expirationTime > r)
                                n = !1;
                            else if (t)
                                if (this.expirationTime < t)
                                    n = !0;
                                else {
                                    var a = this.expirationTime - t;
                                    a ? this.expirationTime = r + Math.max(a, 3e4) : n = !0
                                }
                            else
                                n = !0;
                            n ? (this.expiredRequestCount++,
                            this.state = "expired") : this.expiredRequestCount = 0
                        }
                    }
                    ,
                    ac.prototype.getExpiryTimeout = function() {
                        if (this.expirationTime)
                            return this.expiredRequestCount ? 1e3 * (1 << Math.min(this.expiredRequestCount - 1, 31)) : Math.min(this.expirationTime - (new Date).getTime(), Math.pow(2, 31) - 1)
                    }
                    ,
                    ac.prototype.setFeatureState = function(e, t) {
                        if (this.latestFeatureIndex && this.latestFeatureIndex.rawTileData && 0 !== Object.keys(e).length) {
                            var i = this.latestFeatureIndex.loadVTLayers();
                            for (var r in this.buckets)
                                if (t.style.hasLayer(r)) {
                                    var n = this.buckets[r]
                                      , a = n.layers[0].sourceLayer || "_geojsonTileLayer"
                                      , o = i[a]
                                      , s = e[a];
                                    if (o && s && 0 !== Object.keys(s).length) {
                                        n.update(s, o, this.imageAtlas && this.imageAtlas.patternPositions || {});
                                        var l = t && t.style && t.style.getLayer(r);
                                        l && (this.queryPadding = Math.max(this.queryPadding, l.queryRadius(n)))
                                    }
                                }
                        }
                    }
                    ,
                    ac.prototype.holdingForFade = function() {
                        return void 0 !== this.symbolFadeHoldUntil
                    }
                    ,
                    ac.prototype.symbolFadeFinished = function() {
                        return !this.symbolFadeHoldUntil || this.symbolFadeHoldUntil < F.now()
                    }
                    ,
                    ac.prototype.clearFadeHold = function() {
                        this.symbolFadeHoldUntil = void 0
                    }
                    ,
                    ac.prototype.setHoldDuration = function(e) {
                        this.symbolFadeHoldUntil = F.now() + e
                    }
                    ,
                    ac.prototype.setDependencies = function(e, t) {
                        for (var i = {}, r = 0, n = t; r < n.length; r += 1)
                            i[n[r]] = !0;
                        this.dependencies[e] = i
                    }
                    ,
                    ac.prototype.hasDependency = function(e, t) {
                        for (var i = 0, r = e; i < r.length; i += 1) {
                            var n = this.dependencies[r[i]];
                            if (n)
                                for (var a = 0, o = t; a < o.length; a += 1)
                                    if (n[o[a]])
                                        return !0
                        }
                        return !1
                    }
                    ;
                    var oc = o.performance
                      , sc = function(e) {
                        this._marks = {
                            start: [e.url, "start"].join("#"),
                            end: [e.url, "end"].join("#"),
                            measure: e.url.toString()
                        },
                        oc.mark(this._marks.start)
                    };
                    sc.prototype.finish = function() {
                        oc.mark(this._marks.end);
                        var e = oc.getEntriesByName(this._marks.measure);
                        return 0 === e.length && (oc.measure(this._marks.measure, this._marks.start, this._marks.end),
                        e = oc.getEntriesByName(this._marks.measure),
                        oc.clearMarks(this._marks.start),
                        oc.clearMarks(this._marks.end),
                        oc.clearMeasures(this._marks.measure)),
                        e
                    }
                    ,
                    e.Actor = Ru,
                    e.AlphaImage = yo,
                    e.CanonicalTileID = Wu,
                    e.CollisionBoxArray = Jn,
                    e.Color = et,
                    e.DEMData = Ku,
                    e.DataConstantProperty = vn,
                    e.DictionaryCoder = Ju,
                    e.EXTENT = 8192,
                    e.ErrorEvent = Ae,
                    e.EvaluationParameters = sn,
                    e.Event = Ee,
                    e.Evented = Pe,
                    e.FeatureIndex = tc,
                    e.FillBucket = ss,
                    e.FillExtrusionBucket = Ms,
                    e.ImageAtlas = xl,
                    e.ImagePosition = yl,
                    e.LineBucket = Rs,
                    e.LngLat = Fu,
                    e.LngLatBounds = Bu,
                    e.MercatorCoordinate = qu,
                    e.ONE_EM = 24,
                    e.OverscaledTileID = Xu,
                    e.Point = n,
                    e.Point$1 = n,
                    e.Properties = bn,
                    e.Protobuf = Ks,
                    e.RGBAImage = _o,
                    e.RequestManager = q,
                    e.RequestPerformance = sc,
                    e.ResourceType = de,
                    e.SegmentVector = sa,
                    e.SourceFeatureState = ec,
                    e.StructArrayLayout1ui2 = Xn,
                    e.StructArrayLayout2f1f2i16 = Nn,
                    e.StructArrayLayout2i4 = Pn,
                    e.StructArrayLayout3ui6 = Vn,
                    e.StructArrayLayout4i8 = Cn,
                    e.SymbolBucket = gu,
                    e.Texture = zu,
                    e.Tile = ac,
                    e.Transitionable = cn,
                    e.Uniform1f = xa,
                    e.Uniform1i = _a,
                    e.Uniform2f = ba,
                    e.Uniform3f = wa,
                    e.Uniform4f = Sa,
                    e.UniformColor = Ma,
                    e.UniformMatrix4f = Ea,
                    e.UnwrappedTileID = Zu,
                    e.ValidationError = Le,
                    e.WritingMode = bl,
                    e.ZoomHistory = jr,
                    e.add = function(e, t, i) {
                        return e[0] = t[0] + i[0],
                        e[1] = t[1] + i[1],
                        e[2] = t[2] + i[2],
                        e
                    }
                    ,
                    e.addDynamicAttributes = fu,
                    e.asyncAll = function(e, t, i) {
                        if (!e.length)
                            return i(null, []);
                        var r = e.length
                          , n = new Array(e.length)
                          , a = null;
                        e.forEach((function(e, o) {
                            t(e, (function(e, t) {
                                e && (a = e),
                                n[o] = t,
                                0 == --r && i(a, n)
                            }
                            ))
                        }
                        ))
                    }
                    ,
                    e.bezier = l,
                    e.bindAll = g,
                    e.browser = F,
                    e.cacheEntryPossiblyAdded = function(e) {
                        ++pe > le && (e.getActor().send("enforceCacheSizeLimit", se),
                        pe = 0)
                    }
                    ,
                    e.clamp = c,
                    e.clearTileCache = function(e) {
                        var t = o.caches.delete("mapbox-tiles");
                        e && t.catch(e).then((function() {
                            return e()
                        }
                        ))
                    }
                    ,
                    e.clipLine = Wl,
                    e.clone = function(e) {
                        var t = new ao(16);
                        return t[0] = e[0],
                        t[1] = e[1],
                        t[2] = e[2],
                        t[3] = e[3],
                        t[4] = e[4],
                        t[5] = e[5],
                        t[6] = e[6],
                        t[7] = e[7],
                        t[8] = e[8],
                        t[9] = e[9],
                        t[10] = e[10],
                        t[11] = e[11],
                        t[12] = e[12],
                        t[13] = e[13],
                        t[14] = e[14],
                        t[15] = e[15],
                        t
                    }
                    ,
                    e.clone$1 = b,
                    e.clone$2 = function(e) {
                        var t = new ao(3);
                        return t[0] = e[0],
                        t[1] = e[1],
                        t[2] = e[2],
                        t
                    }
                    ,
                    e.collisionCircleLayout = qs,
                    e.config = N,
                    e.create = function() {
                        var e = new ao(16);
                        return ao != Float32Array && (e[1] = 0,
                        e[2] = 0,
                        e[3] = 0,
                        e[4] = 0,
                        e[6] = 0,
                        e[7] = 0,
                        e[8] = 0,
                        e[9] = 0,
                        e[11] = 0,
                        e[12] = 0,
                        e[13] = 0,
                        e[14] = 0),
                        e[0] = 1,
                        e[5] = 1,
                        e[10] = 1,
                        e[15] = 1,
                        e
                    }
                    ,
                    e.create$1 = function() {
                        var e = new ao(9);
                        return ao != Float32Array && (e[1] = 0,
                        e[2] = 0,
                        e[3] = 0,
                        e[5] = 0,
                        e[6] = 0,
                        e[7] = 0),
                        e[0] = 1,
                        e[4] = 1,
                        e[8] = 1,
                        e
                    }
                    ,
                    e.create$2 = function() {
                        var e = new ao(4);
                        return ao != Float32Array && (e[1] = 0,
                        e[2] = 0),
                        e[0] = 1,
                        e[3] = 1,
                        e
                    }
                    ,
                    e.createCommonjsModule = t,
                    e.createExpression = Wi,
                    e.createLayout = En,
                    e.createStyleLayer = function(e) {
                        return "custom" === e.type ? new Eu(e) : new Au[e.type](e)
                    }
                    ,
                    e.cross = function(e, t, i) {
                        var r = t[0]
                          , n = t[1]
                          , a = t[2]
                          , o = i[0]
                          , s = i[1]
                          , l = i[2];
                        return e[0] = n * l - a * s,
                        e[1] = a * o - r * l,
                        e[2] = r * s - n * o,
                        e
                    }
                    ,
                    e.deepEqual = function e(t, i) {
                        if (Array.isArray(t)) {
                            if (!Array.isArray(i) || t.length !== i.length)
                                return !1;
                            for (var r = 0; r < t.length; r++)
                                if (!e(t[r], i[r]))
                                    return !1;
                            return !0
                        }
                        if ("object" == typeof t && null !== t && null !== i) {
                            if ("object" != typeof i)
                                return !1;
                            if (Object.keys(t).length !== Object.keys(i).length)
                                return !1;
                            for (var n in t)
                                if (!e(t[n], i[n]))
                                    return !1;
                            return !0
                        }
                        return t === i
                    }
                    ,
                    e.dot = function(e, t) {
                        return e[0] * t[0] + e[1] * t[1] + e[2] * t[2]
                    }
                    ,
                    e.dot$1 = function(e, t) {
                        return e[0] * t[0] + e[1] * t[1] + e[2] * t[2] + e[3] * t[3]
                    }
                    ,
                    e.ease = u,
                    e.emitValidationErrors = Ir,
                    e.endsWith = y,
                    e.enforceCacheSizeLimit = function(e) {
                        ue(),
                        ee && ee.then((function(t) {
                            t.keys().then((function(i) {
                                for (var r = 0; r < i.length - e; r++)
                                    t.delete(i[r])
                            }
                            ))
                        }
                        ))
                    }
                    ,
                    e.evaluateSizeForFeature = Bl,
                    e.evaluateSizeForZoom = Fl,
                    e.evaluateVariableOffset = au,
                    e.evented = rn,
                    e.extend = p,
                    e.featureFilter = ar,
                    e.filterObject = x,
                    e.fromRotation = function(e, t) {
                        var i = Math.sin(t)
                          , r = Math.cos(t);
                        return e[0] = r,
                        e[1] = i,
                        e[2] = 0,
                        e[3] = -i,
                        e[4] = r,
                        e[5] = 0,
                        e[6] = 0,
                        e[7] = 0,
                        e[8] = 1,
                        e
                    }
                    ,
                    e.getAnchorAlignment = kl,
                    e.getAnchorJustification = ou,
                    e.getArrayBuffer = xe,
                    e.getImage = Se,
                    e.getJSON = function(e, t) {
                        return _e(p(e, {
                            type: "json"
                        }), t)
                    }
                    ,
                    e.getRTLTextPluginStatus = nn,
                    e.getReferrer = ye,
                    e.getVideo = function(e, t) {
                        var i, r, n = o.document.createElement("video");
                        n.muted = !0,
                        n.onloadstart = function() {
                            t(null, n)
                        }
                        ;
                        for (var a = 0; a < e.length; a++) {
                            var s = o.document.createElement("source");
                            i = e[a],
                            r = void 0,
                            (r = o.document.createElement("a")).href = i,
                            (r.protocol !== o.document.location.protocol || r.host !== o.document.location.host) && (n.crossOrigin = "Anonymous"),
                            s.src = e[a],
                            n.appendChild(s)
                        }
                        return {
                            cancel: function() {}
                        }
                    }
                    ,
                    e.identity = oo,
                    e.invert = function(e, t) {
                        var i = t[0]
                          , r = t[1]
                          , n = t[2]
                          , a = t[3]
                          , o = t[4]
                          , s = t[5]
                          , l = t[6]
                          , u = t[7]
                          , c = t[8]
                          , h = t[9]
                          , p = t[10]
                          , f = t[11]
                          , d = t[12]
                          , m = t[13]
                          , v = t[14]
                          , g = t[15]
                          , y = i * s - r * o
                          , _ = i * l - n * o
                          , x = i * u - a * o
                          , b = r * l - n * s
                          , w = r * u - a * s
                          , S = n * u - a * l
                          , M = c * m - h * d
                          , T = c * v - p * d
                          , E = c * g - f * d
                          , A = h * v - p * m
                          , P = h * g - f * m
                          , C = p * g - f * v
                          , L = y * C - _ * P + x * A + b * E - w * T + S * M;
                        return L ? (e[0] = (s * C - l * P + u * A) * (L = 1 / L),
                        e[1] = (n * P - r * C - a * A) * L,
                        e[2] = (m * S - v * w + g * b) * L,
                        e[3] = (p * w - h * S - f * b) * L,
                        e[4] = (l * E - o * C - u * T) * L,
                        e[5] = (i * C - n * E + a * T) * L,
                        e[6] = (v * x - d * S - g * _) * L,
                        e[7] = (c * S - p * x + f * _) * L,
                        e[8] = (o * P - s * E + u * M) * L,
                        e[9] = (r * E - i * P - a * M) * L,
                        e[10] = (d * w - m * x + g * y) * L,
                        e[11] = (h * x - c * w - f * y) * L,
                        e[12] = (s * T - o * A - l * M) * L,
                        e[13] = (i * A - r * T + n * M) * L,
                        e[14] = (m * _ - d * b - v * y) * L,
                        e[15] = (c * b - h * _ + p * y) * L,
                        e) : null
                    }
                    ,
                    e.isChar = Hr,
                    e.isMapboxURL = W,
                    e.keysDifference = function(e, t) {
                        var i = [];
                        for (var r in e)
                            r in t || i.push(r);
                        return i
                    }
                    ,
                    e.makeRequest = _e,
                    e.mapObject = _,
                    e.mercatorXfromLng = Vu,
                    e.mercatorYfromLat = Gu,
                    e.mercatorZfromAltitude = ju,
                    e.mul = uo,
                    e.multiply = so,
                    e.mvt = xs,
                    e.nextPowerOfTwo = function(e) {
                        return e <= 1 ? 1 : Math.pow(2, Math.ceil(Math.log(e) / Math.LN2))
                    }
                    ,
                    e.normalize = function(e, t) {
                        var i = t[0]
                          , r = t[1]
                          , n = t[2]
                          , a = i * i + r * r + n * n;
                        return a > 0 && (a = 1 / Math.sqrt(a)),
                        e[0] = t[0] * a,
                        e[1] = t[1] * a,
                        e[2] = t[2] * a,
                        e
                    }
                    ,
                    e.number = Ht,
                    e.offscreenCanvasSupported = fe,
                    e.ortho = function(e, t, i, r, n, a, o) {
                        var s = 1 / (t - i)
                          , l = 1 / (r - n)
                          , u = 1 / (a - o);
                        return e[0] = -2 * s,
                        e[1] = 0,
                        e[2] = 0,
                        e[3] = 0,
                        e[4] = 0,
                        e[5] = -2 * l,
                        e[6] = 0,
                        e[7] = 0,
                        e[8] = 0,
                        e[9] = 0,
                        e[10] = 2 * u,
                        e[11] = 0,
                        e[12] = (t + i) * s,
                        e[13] = (n + r) * l,
                        e[14] = (o + a) * u,
                        e[15] = 1,
                        e
                    }
                    ,
                    e.parseGlyphPBF = function(e) {
                        return new Ks(e).readFields(dl, [])
                    }
                    ,
                    e.pbf = Ks,
                    e.performSymbolLayout = function(e, t, i, r, n, a, o) {
                        e.createArrays(),
                        e.tilePixelRatio = 8192 / (512 * e.overscaling),
                        e.compareText = {},
                        e.iconsNeedLinear = !1;
                        var s = e.layers[0].layout
                          , l = e.layers[0]._unevaluatedLayout._values
                          , u = {};
                        if ("composite" === e.textSizeData.kind) {
                            var c = e.textSizeData
                              , h = c.maxZoom;
                            u.compositeTextSizes = [l["text-size"].possiblyEvaluate(new sn(c.minZoom), o), l["text-size"].possiblyEvaluate(new sn(h), o)]
                        }
                        if ("composite" === e.iconSizeData.kind) {
                            var p = e.iconSizeData
                              , f = p.maxZoom;
                            u.compositeIconSizes = [l["icon-size"].possiblyEvaluate(new sn(p.minZoom), o), l["icon-size"].possiblyEvaluate(new sn(f), o)]
                        }
                        u.layoutTextSize = l["text-size"].possiblyEvaluate(new sn(e.zoom + 1), o),
                        u.layoutIconSize = l["icon-size"].possiblyEvaluate(new sn(e.zoom + 1), o),
                        u.textMaxSize = l["text-size"].possiblyEvaluate(new sn(18));
                        for (var d = 24 * s.get("text-line-height"), m = "map" === s.get("text-rotation-alignment") && "point" !== s.get("symbol-placement"), v = s.get("text-keep-upright"), g = s.get("text-size"), y = function() {
                            var a = x[_]
                              , l = s.get("text-font").evaluate(a, {}, o).join(",")
                              , c = g.evaluate(a, {}, o)
                              , h = u.layoutTextSize.evaluate(a, {}, o)
                              , p = u.layoutIconSize.evaluate(a, {}, o)
                              , f = {
                                horizontal: {},
                                vertical: void 0
                            }
                              , y = a.text
                              , b = [0, 0];
                            if (y) {
                                var w = y.toString()
                                  , M = 24 * s.get("text-letter-spacing").evaluate(a, {}, o)
                                  , T = function(e) {
                                    for (var t = 0, i = e; t < i.length; t += 1)
                                        if (r = i[t].charCodeAt(0),
                                        Hr.Arabic(r) || Hr["Arabic Supplement"](r) || Hr["Arabic Extended-A"](r) || Hr["Arabic Presentation Forms-A"](r) || Hr["Arabic Presentation Forms-B"](r))
                                            return !1;
                                    var r;
                                    return !0
                                }(w) ? M : 0
                                  , E = s.get("text-anchor").evaluate(a, {}, o)
                                  , A = s.get("text-variable-anchor");
                                if (!A) {
                                    var P = s.get("text-radial-offset").evaluate(a, {}, o);
                                    b = P ? au(E, [24 * P, nu]) : s.get("text-offset").evaluate(a, {}, o).map((function(e) {
                                        return 24 * e
                                    }
                                    ))
                                }
                                var C = m ? "center" : s.get("text-justify").evaluate(a, {}, o)
                                  , L = s.get("symbol-placement")
                                  , I = "point" === L ? 24 * s.get("text-max-width").evaluate(a, {}, o) : 0
                                  , k = function() {
                                    e.allowVerticalPlacement && qr(w) && (f.vertical = Ml(y, t, i, n, l, I, d, E, "left", T, b, bl.vertical, !0, L, h, c))
                                };
                                if (!m && A) {
                                    for (var z = "auto" === C ? A.map((function(e) {
                                        return ou(e)
                                    }
                                    )) : [C], D = !1, R = 0; R < z.length; R++) {
                                        var O = z[R];
                                        if (!f.horizontal[O])
                                            if (D)
                                                f.horizontal[O] = f.horizontal[0];
                                            else {
                                                var B = Ml(y, t, i, n, l, I, d, "center", O, T, b, bl.horizontal, !1, L, h, c);
                                                B && (f.horizontal[O] = B,
                                                D = 1 === B.positionedLines.length)
                                            }
                                    }
                                    k()
                                } else {
                                    "auto" === C && (C = ou(E));
                                    var F = Ml(y, t, i, n, l, I, d, E, C, T, b, bl.horizontal, !1, L, h, c);
                                    F && (f.horizontal[C] = F),
                                    k(),
                                    qr(w) && m && v && (f.vertical = Ml(y, t, i, n, l, I, d, E, C, T, b, bl.vertical, !1, L, h, c))
                                }
                            }
                            var N = void 0
                              , U = !1;
                            if (a.icon && a.icon.name) {
                                var V = r[a.icon.name];
                                V && (N = function(e, t, i) {
                                    var r = kl(i)
                                      , n = t[0] - e.displaySize[0] * r.horizontalAlign
                                      , a = t[1] - e.displaySize[1] * r.verticalAlign;
                                    return {
                                        image: e,
                                        top: a,
                                        bottom: a + e.displaySize[1],
                                        left: n,
                                        right: n + e.displaySize[0]
                                    }
                                }(n[a.icon.name], s.get("icon-offset").evaluate(a, {}, o), s.get("icon-anchor").evaluate(a, {}, o)),
                                U = V.sdf,
                                void 0 === e.sdfIcons ? e.sdfIcons = V.sdf : e.sdfIcons !== V.sdf && S("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),
                                (V.pixelRatio !== e.pixelRatio || 0 !== s.get("icon-rotate").constantOr(1)) && (e.iconsNeedLinear = !0))
                            }
                            var G = lu(f.horizontal) || f.vertical;
                            e.iconsInText = !!G && G.iconsInText,
                            (G || N) && function(e, t, i, r, n, a, o, s, l, u, c) {
                                var h = a.textMaxSize.evaluate(t, {});
                                void 0 === h && (h = o);
                                var p, f = e.layers[0].layout, d = f.get("icon-offset").evaluate(t, {}, c), m = lu(i.horizontal), v = o / 24, g = e.tilePixelRatio * v, y = e.tilePixelRatio * h / 24, _ = e.tilePixelRatio * s, x = e.tilePixelRatio * f.get("symbol-spacing"), b = f.get("text-padding") * e.tilePixelRatio, w = f.get("icon-padding") * e.tilePixelRatio, M = f.get("text-max-angle") / 180 * Math.PI, T = "map" === f.get("text-rotation-alignment") && "point" !== f.get("symbol-placement"), E = "map" === f.get("icon-rotation-alignment") && "point" !== f.get("symbol-placement"), A = f.get("symbol-placement"), P = x / 2, C = f.get("icon-text-fit");
                                r && "none" !== C && (e.allowVerticalPlacement && i.vertical && (p = Dl(r, i.vertical, C, f.get("icon-text-fit-padding"), d, v)),
                                m && (r = Dl(r, m, C, f.get("icon-text-fit-padding"), d, v)));
                                var L = function(s, h) {
                                    h.x < 0 || h.x >= 8192 || h.y < 0 || h.y >= 8192 || function(e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m, v, g, y, _, x, b, w, M, T) {
                                        var E, A, P, C, L, I = e.addToLineVertexArray(t, i), k = 0, z = 0, D = 0, R = 0, O = -1, B = -1, F = {}, N = pa(""), U = 0, V = 0;
                                        if (void 0 === s._unevaluatedLayout.getValue("text-radial-offset") ? (U = (E = s.layout.get("text-offset").evaluate(x, {}, M).map((function(e) {
                                            return 24 * e
                                        }
                                        )))[0],
                                        V = E[1]) : (U = 24 * s.layout.get("text-radial-offset").evaluate(x, {}, M),
                                        V = nu),
                                        e.allowVerticalPlacement && r.vertical) {
                                            var G = s.layout.get("text-rotate").evaluate(x, {}, M) + 90;
                                            C = new Ql(l,t,u,c,h,r.vertical,p,f,d,G),
                                            o && (L = new Ql(l,t,u,c,h,o,v,g,d,G))
                                        }
                                        if (n) {
                                            var j = s.layout.get("icon-rotate").evaluate(x, {})
                                              , H = "none" !== s.layout.get("icon-text-fit")
                                              , q = Zl(n, j, w, H)
                                              , W = o ? Zl(o, j, w, H) : void 0;
                                            P = new Ql(l,t,u,c,h,n,v,g,!1,j),
                                            k = 4 * q.length;
                                            var Z = e.iconSizeData
                                              , X = null;
                                            "source" === Z.kind ? (X = [128 * s.layout.get("icon-size").evaluate(x, {})])[0] > 32640 && S(e.layerIds[0] + ': Value for "icon-size" is >= 255. Reduce your "icon-size".') : "composite" === Z.kind && ((X = [128 * b.compositeIconSizes[0].evaluate(x, {}, M), 128 * b.compositeIconSizes[1].evaluate(x, {}, M)])[0] > 32640 || X[1] > 32640) && S(e.layerIds[0] + ': Value for "icon-size" is >= 255. Reduce your "icon-size".'),
                                            e.addSymbols(e.icon, q, X, _, y, x, !1, t, I.lineStartIndex, I.lineLength, -1, M),
                                            O = e.icon.placedSymbolArray.length - 1,
                                            W && (z = 4 * W.length,
                                            e.addSymbols(e.icon, W, X, _, y, x, bl.vertical, t, I.lineStartIndex, I.lineLength, -1, M),
                                            B = e.icon.placedSymbolArray.length - 1)
                                        }
                                        for (var Y in r.horizontal) {
                                            var K = r.horizontal[Y];
                                            if (!A) {
                                                N = pa(K.text);
                                                var J = s.layout.get("text-rotate").evaluate(x, {}, M);
                                                A = new Ql(l,t,u,c,h,K,p,f,d,J)
                                            }
                                            var Q = 1 === K.positionedLines.length;
                                            if (D += su(e, t, K, a, s, d, x, m, I, r.vertical ? bl.horizontal : bl.horizontalOnly, Q ? Object.keys(r.horizontal) : [Y], F, O, b, M),
                                            Q)
                                                break
                                        }
                                        r.vertical && (R += su(e, t, r.vertical, a, s, d, x, m, I, bl.vertical, ["vertical"], F, B, b, M));
                                        var $ = A ? A.boxStartIndex : e.collisionBoxArray.length
                                          , ee = A ? A.boxEndIndex : e.collisionBoxArray.length
                                          , te = C ? C.boxStartIndex : e.collisionBoxArray.length
                                          , ie = C ? C.boxEndIndex : e.collisionBoxArray.length
                                          , re = P ? P.boxStartIndex : e.collisionBoxArray.length
                                          , ne = P ? P.boxEndIndex : e.collisionBoxArray.length
                                          , ae = L ? L.boxStartIndex : e.collisionBoxArray.length
                                          , oe = L ? L.boxEndIndex : e.collisionBoxArray.length
                                          , se = -1
                                          , le = function(e, t) {
                                            return e && e.circleDiameter ? Math.max(e.circleDiameter, t) : t
                                        };
                                        se = le(A, se),
                                        se = le(C, se),
                                        se = le(P, se);
                                        var ue = (se = le(L, se)) > -1 ? 1 : 0;
                                        ue && (se *= T / 24),
                                        e.glyphOffsetArray.length >= gu.MAX_GLYPHS && S("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),
                                        void 0 !== x.sortKey && e.addToSortKeyRanges(e.symbolInstances.length, x.sortKey),
                                        e.symbolInstances.emplaceBack(t.x, t.y, F.right >= 0 ? F.right : -1, F.center >= 0 ? F.center : -1, F.left >= 0 ? F.left : -1, F.vertical || -1, O, B, N, $, ee, te, ie, re, ne, ae, oe, u, D, R, k, z, ue, 0, p, U, V, se)
                                    }(e, h, s, i, r, n, p, e.layers[0], e.collisionBoxArray, t.index, t.sourceLayerIndex, e.index, g, b, T, l, _, w, E, d, t, a, u, c, o)
                                };
                                if ("line" === A)
                                    for (var I = 0, k = Wl(t.geometry, 0, 0, 8192, 8192); I < k.length; I += 1)
                                        for (var z = k[I], D = 0, R = ql(z, x, M, i.vertical || m, r, 24, y, e.overscaling, 8192); D < R.length; D += 1) {
                                            var O = R[D];
                                            m && uu(e, m.text, P, O) || L(z, O)
                                        }
                                else if ("line-center" === A)
                                    for (var B = 0, F = t.geometry; B < F.length; B += 1) {
                                        var N = F[B];
                                        if (N.length > 1) {
                                            var U = Hl(N, M, i.vertical || m, r, 24, y);
                                            U && L(N, U)
                                        }
                                    }
                                else if ("Polygon" === t.type)
                                    for (var V = 0, G = rs(t.geometry, 0); V < G.length; V += 1) {
                                        var j = G[V]
                                          , H = tu(j, 16);
                                        L(j[0], new Rl(H.x,H.y,0))
                                    }
                                else if ("LineString" === t.type)
                                    for (var q = 0, W = t.geometry; q < W.length; q += 1) {
                                        var Z = W[q];
                                        L(Z, new Rl(Z[0].x,Z[0].y,0))
                                    }
                                else if ("Point" === t.type)
                                    for (var X = 0, Y = t.geometry; X < Y.length; X += 1)
                                        for (var K = 0, J = Y[X]; K < J.length; K += 1) {
                                            var Q = J[K];
                                            L([Q], new Rl(Q.x,Q.y,0))
                                        }
                            }(e, a, f, N, r, u, h, p, b, U, o)
                        }, _ = 0, x = e.features; _ < x.length; _ += 1)
                            y();
                        a && e.generateCollisionDebugBuffers()
                    }
                    ,
                    e.perspective = function(e, t, i, r, n) {
                        var a, o = 1 / Math.tan(t / 2);
                        return e[0] = o / i,
                        e[1] = 0,
                        e[2] = 0,
                        e[3] = 0,
                        e[4] = 0,
                        e[5] = o,
                        e[6] = 0,
                        e[7] = 0,
                        e[8] = 0,
                        e[9] = 0,
                        e[11] = -1,
                        e[12] = 0,
                        e[13] = 0,
                        e[15] = 0,
                        null != n && n !== 1 / 0 ? (e[10] = (n + r) * (a = 1 / (r - n)),
                        e[14] = 2 * n * r * a) : (e[10] = -1,
                        e[14] = -2 * r),
                        e
                    }
                    ,
                    e.pick = function(e, t) {
                        for (var i = {}, r = 0; r < t.length; r++) {
                            var n = t[r];
                            n in e && (i[n] = e[n])
                        }
                        return i
                    }
                    ,
                    e.plugin = on,
                    e.polygonIntersectsPolygon = ja,
                    e.postMapLoadEvent = oe,
                    e.postTurnstileEvent = ne,
                    e.potpack = gl,
                    e.refProperties = ["type", "source", "source-layer", "minzoom", "maxzoom", "filter", "layout"],
                    e.register = Br,
                    e.registerForPluginStateChange = function(e) {
                        return e({
                            pluginStatus: Qr,
                            pluginURL: $r
                        }),
                        rn.on("pluginStateChange", e),
                        e
                    }
                    ,
                    e.renderColorRamp = bo,
                    e.rotate = function(e, t, i) {
                        var r = t[0]
                          , n = t[1]
                          , a = t[2]
                          , o = t[3]
                          , s = Math.sin(i)
                          , l = Math.cos(i);
                        return e[0] = r * l + a * s,
                        e[1] = n * l + o * s,
                        e[2] = r * -s + a * l,
                        e[3] = n * -s + o * l,
                        e
                    }
                    ,
                    e.rotateX = function(e, t, i) {
                        var r = Math.sin(i)
                          , n = Math.cos(i)
                          , a = t[4]
                          , o = t[5]
                          , s = t[6]
                          , l = t[7]
                          , u = t[8]
                          , c = t[9]
                          , h = t[10]
                          , p = t[11];
                        return t !== e && (e[0] = t[0],
                        e[1] = t[1],
                        e[2] = t[2],
                        e[3] = t[3],
                        e[12] = t[12],
                        e[13] = t[13],
                        e[14] = t[14],
                        e[15] = t[15]),
                        e[4] = a * n + u * r,
                        e[5] = o * n + c * r,
                        e[6] = s * n + h * r,
                        e[7] = l * n + p * r,
                        e[8] = u * n - a * r,
                        e[9] = c * n - o * r,
                        e[10] = h * n - s * r,
                        e[11] = p * n - l * r,
                        e
                    }
                    ,
                    e.rotateZ = function(e, t, i) {
                        var r = Math.sin(i)
                          , n = Math.cos(i)
                          , a = t[0]
                          , o = t[1]
                          , s = t[2]
                          , l = t[3]
                          , u = t[4]
                          , c = t[5]
                          , h = t[6]
                          , p = t[7];
                        return t !== e && (e[8] = t[8],
                        e[9] = t[9],
                        e[10] = t[10],
                        e[11] = t[11],
                        e[12] = t[12],
                        e[13] = t[13],
                        e[14] = t[14],
                        e[15] = t[15]),
                        e[0] = a * n + u * r,
                        e[1] = o * n + c * r,
                        e[2] = s * n + h * r,
                        e[3] = l * n + p * r,
                        e[4] = u * n - a * r,
                        e[5] = c * n - o * r,
                        e[6] = h * n - s * r,
                        e[7] = p * n - l * r,
                        e
                    }
                    ,
                    e.scale = function(e, t, i) {
                        var r = i[0]
                          , n = i[1]
                          , a = i[2];
                        return e[0] = t[0] * r,
                        e[1] = t[1] * r,
                        e[2] = t[2] * r,
                        e[3] = t[3] * r,
                        e[4] = t[4] * n,
                        e[5] = t[5] * n,
                        e[6] = t[6] * n,
                        e[7] = t[7] * n,
                        e[8] = t[8] * a,
                        e[9] = t[9] * a,
                        e[10] = t[10] * a,
                        e[11] = t[11] * a,
                        e[12] = t[12],
                        e[13] = t[13],
                        e[14] = t[14],
                        e[15] = t[15],
                        e
                    }
                    ,
                    e.scale$1 = function(e, t, i) {
                        return e[0] = t[0] * i,
                        e[1] = t[1] * i,
                        e[2] = t[2] * i,
                        e[3] = t[3] * i,
                        e
                    }
                    ,
                    e.scale$2 = function(e, t, i) {
                        return e[0] = t[0] * i,
                        e[1] = t[1] * i,
                        e[2] = t[2] * i,
                        e
                    }
                    ,
                    e.setCacheLimits = function(e, t) {
                        se = e,
                        le = t
                    }
                    ,
                    e.setRTLTextPlugin = function(e, t, i) {
                        if (void 0 === i && (i = !1),
                        "deferred" === Qr || "loading" === Qr || "loaded" === Qr)
                            throw new Error("setRTLTextPlugin cannot be called multiple times.");
                        $r = F.resolveURL(e),
                        Qr = "deferred",
                        Jr = t,
                        tn(),
                        i || an()
                    }
                    ,
                    e.sphericalToCartesian = function(e) {
                        var t = e[0]
                          , i = e[1]
                          , r = e[2];
                        return i += 90,
                        i *= Math.PI / 180,
                        r *= Math.PI / 180,
                        {
                            x: t * Math.cos(i) * Math.sin(r),
                            y: t * Math.sin(i) * Math.sin(r),
                            z: t * Math.cos(r)
                        }
                    }
                    ,
                    e.sqrLen = function(e) {
                        var t = e[0]
                          , i = e[1];
                        return t * t + i * i
                    }
                    ,
                    e.styleSpec = Ce,
                    e.sub = function(e, t, i) {
                        return e[0] = t[0] - i[0],
                        e[1] = t[1] - i[1],
                        e[2] = t[2] - i[2],
                        e
                    }
                    ,
                    e.symbolSize = Nl,
                    e.transformMat3 = function(e, t, i) {
                        var r = t[0]
                          , n = t[1]
                          , a = t[2];
                        return e[0] = r * i[0] + n * i[3] + a * i[6],
                        e[1] = r * i[1] + n * i[4] + a * i[7],
                        e[2] = r * i[2] + n * i[5] + a * i[8],
                        e
                    }
                    ,
                    e.transformMat4 = co,
                    e.translate = function(e, t, i) {
                        var r, n, a, o, s, l, u, c, h, p, f, d, m = i[0], v = i[1], g = i[2];
                        return t === e ? (e[12] = t[0] * m + t[4] * v + t[8] * g + t[12],
                        e[13] = t[1] * m + t[5] * v + t[9] * g + t[13],
                        e[14] = t[2] * m + t[6] * v + t[10] * g + t[14],
                        e[15] = t[3] * m + t[7] * v + t[11] * g + t[15]) : (n = t[1],
                        a = t[2],
                        o = t[3],
                        s = t[4],
                        l = t[5],
                        u = t[6],
                        c = t[7],
                        h = t[8],
                        p = t[9],
                        f = t[10],
                        d = t[11],
                        e[0] = r = t[0],
                        e[1] = n,
                        e[2] = a,
                        e[3] = o,
                        e[4] = s,
                        e[5] = l,
                        e[6] = u,
                        e[7] = c,
                        e[8] = h,
                        e[9] = p,
                        e[10] = f,
                        e[11] = d,
                        e[12] = r * m + s * v + h * g + t[12],
                        e[13] = n * m + l * v + p * g + t[13],
                        e[14] = a * m + u * v + f * g + t[14],
                        e[15] = o * m + c * v + d * g + t[15]),
                        e
                    }
                    ,
                    e.triggerPluginCompletionEvent = en,
                    e.uniqueId = d,
                    e.validateCustomStyleLayer = function(e) {
                        var t = []
                          , i = e.id;
                        return void 0 === i && t.push({
                            message: "layers." + i + ': missing required property "id"'
                        }),
                        void 0 === e.render && t.push({
                            message: "layers." + i + ': missing required method "render"'
                        }),
                        e.renderingMode && "2d" !== e.renderingMode && "3d" !== e.renderingMode && t.push({
                            message: "layers." + i + ': property "renderingMode" must be either "2d" or "3d"'
                        }),
                        t
                    }
                    ,
                    e.validateLight = Pr,
                    e.validateStyle = Ar,
                    e.values = function(e) {
                        var t = [];
                        for (var i in e)
                            t.push(e[i]);
                        return t
                    }
                    ,
                    e.vectorTile = xs,
                    e.version = "1.14.0",
                    e.warnOnce = S,
                    e.webpSupported = U,
                    e.window = o,
                    e.wrap = h
                }
                )),
                r(0, (function(e) {
                    function t(e) {
                        var i = typeof e;
                        if ("number" === i || "boolean" === i || "string" === i || null == e)
                            return JSON.stringify(e);
                        if (Array.isArray(e)) {
                            for (var r = "[", n = 0, a = e; n < a.length; n += 1)
                                r += t(a[n]) + ",";
                            return r + "]"
                        }
                        for (var o = Object.keys(e).sort(), s = "{", l = 0; l < o.length; l++)
                            s += JSON.stringify(o[l]) + ":" + t(e[o[l]]) + ",";
                        return s + "}"
                    }
                    function i(i) {
                        for (var r = "", n = 0, a = e.refProperties; n < a.length; n += 1)
                            r += "/" + t(i[a[n]]);
                        return r
                    }
                    var r = function(e) {
                        this.keyCache = {},
                        e && this.replace(e)
                    };
                    r.prototype.replace = function(e) {
                        this._layerConfigs = {},
                        this._layers = {},
                        this.update(e, [])
                    }
                    ,
                    r.prototype.update = function(t, r) {
                        for (var n = this, a = 0, o = t; a < o.length; a += 1) {
                            var s = o[a];
                            this._layerConfigs[s.id] = s;
                            var l = this._layers[s.id] = e.createStyleLayer(s);
                            l._featureFilter = e.featureFilter(l.filter),
                            this.keyCache[s.id] && delete this.keyCache[s.id]
                        }
                        for (var u = 0, c = r; u < c.length; u += 1) {
                            var h = c[u];
                            delete this.keyCache[h],
                            delete this._layerConfigs[h],
                            delete this._layers[h]
                        }
                        this.familiesBySource = {};
                        for (var p = 0, f = function(e, t) {
                            for (var r = {}, n = 0; n < e.length; n++) {
                                var a = t && t[e[n].id] || i(e[n]);
                                t && (t[e[n].id] = a);
                                var o = r[a];
                                o || (o = r[a] = []),
                                o.push(e[n])
                            }
                            var s = [];
                            for (var l in r)
                                s.push(r[l]);
                            return s
                        }(e.values(this._layerConfigs), this.keyCache); p < f.length; p += 1) {
                            var d = f[p].map((function(e) {
                                return n._layers[e.id]
                            }
                            ))
                              , m = d[0];
                            if ("none" !== m.visibility) {
                                var v = m.source || ""
                                  , g = this.familiesBySource[v];
                                g || (g = this.familiesBySource[v] = {});
                                var y = m.sourceLayer || "_geojsonTileLayer"
                                  , _ = g[y];
                                _ || (_ = g[y] = []),
                                _.push(d)
                            }
                        }
                    }
                    ;
                    var n = function(t) {
                        var i = {}
                          , r = [];
                        for (var n in t) {
                            var a = t[n]
                              , o = i[n] = {};
                            for (var s in a) {
                                var l = a[+s];
                                if (l && 0 !== l.bitmap.width && 0 !== l.bitmap.height) {
                                    var u = {
                                        x: 0,
                                        y: 0,
                                        w: l.bitmap.width + 2,
                                        h: l.bitmap.height + 2
                                    };
                                    r.push(u),
                                    o[s] = {
                                        rect: u,
                                        metrics: l.metrics
                                    }
                                }
                            }
                        }
                        var c = e.potpack(r)
                          , h = new e.AlphaImage({
                            width: c.w || 1,
                            height: c.h || 1
                        });
                        for (var p in t) {
                            var f = t[p];
                            for (var d in f) {
                                var m = f[+d];
                                if (m && 0 !== m.bitmap.width && 0 !== m.bitmap.height) {
                                    var v = i[p][d].rect;
                                    e.AlphaImage.copy(m.bitmap, h, {
                                        x: 0,
                                        y: 0
                                    }, {
                                        x: v.x + 1,
                                        y: v.y + 1
                                    }, m.bitmap)
                                }
                            }
                        }
                        this.image = h,
                        this.positions = i
                    };
                    e.register("GlyphAtlas", n);
                    var a = function(t) {
                        this.tileID = new e.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),
                        this.uid = t.uid,
                        this.zoom = t.zoom,
                        this.pixelRatio = t.pixelRatio,
                        this.tileSize = t.tileSize,
                        this.source = t.source,
                        this.overscaling = this.tileID.overscaleFactor(),
                        this.showCollisionBoxes = t.showCollisionBoxes,
                        this.collectResourceTiming = !!t.collectResourceTiming,
                        this.returnDependencies = !!t.returnDependencies,
                        this.promoteId = t.promoteId
                    };
                    function o(t, i, r) {
                        for (var n = new e.EvaluationParameters(i), a = 0, o = t; a < o.length; a += 1)
                            o[a].recalculate(n, r)
                    }
                    function s(t, i) {
                        var r = e.getArrayBuffer(t.request, (function(t, r, n, a) {
                            t ? i(t) : r && i(null, {
                                vectorTile: new e.vectorTile.VectorTile(new e.pbf(r)),
                                rawData: r,
                                cacheControl: n,
                                expires: a
                            })
                        }
                        ));
                        return function() {
                            r.cancel(),
                            i()
                        }
                    }
                    a.prototype.parse = function(t, i, r, a, s) {
                        var l = this;
                        this.status = "parsing",
                        this.data = t,
                        this.collisionBoxArray = new e.CollisionBoxArray;
                        var u = new e.DictionaryCoder(Object.keys(t.layers).sort())
                          , c = new e.FeatureIndex(this.tileID,this.promoteId);
                        c.bucketLayerIDs = [];
                        var h, p, f, d, m = {}, v = {
                            featureIndex: c,
                            iconDependencies: {},
                            patternDependencies: {},
                            glyphDependencies: {},
                            availableImages: r
                        }, g = i.familiesBySource[this.source];
                        for (var y in g) {
                            var _ = t.layers[y];
                            if (_) {
                                1 === _.version && e.warnOnce('Vector tile source "' + this.source + '" layer "' + y + '" does not use vector tile spec v2 and therefore may have some rendering errors.');
                                for (var x = u.encode(y), b = [], w = 0; w < _.length; w++) {
                                    var S = _.feature(w)
                                      , M = c.getId(S, y);
                                    b.push({
                                        feature: S,
                                        id: M,
                                        index: w,
                                        sourceLayerIndex: x
                                    })
                                }
                                for (var T = 0, E = g[y]; T < E.length; T += 1) {
                                    var A = E[T]
                                      , P = A[0];
                                    P.minzoom && this.zoom < Math.floor(P.minzoom) || P.maxzoom && this.zoom >= P.maxzoom || "none" !== P.visibility && (o(A, this.zoom, r),
                                    (m[P.id] = P.createBucket({
                                        index: c.bucketLayerIDs.length,
                                        layers: A,
                                        zoom: this.zoom,
                                        pixelRatio: this.pixelRatio,
                                        overscaling: this.overscaling,
                                        collisionBoxArray: this.collisionBoxArray,
                                        sourceLayerIndex: x,
                                        sourceID: this.source
                                    })).populate(b, v, this.tileID.canonical),
                                    c.bucketLayerIDs.push(A.map((function(e) {
                                        return e.id
                                    }
                                    ))))
                                }
                            }
                        }
                        var C = e.mapObject(v.glyphDependencies, (function(e) {
                            return Object.keys(e).map(Number)
                        }
                        ));
                        Object.keys(C).length ? a.send("getGlyphs", {
                            uid: this.uid,
                            stacks: C
                        }, (function(e, t) {
                            h || (h = e,
                            p = t,
                            k.call(l))
                        }
                        )) : p = {};
                        var L = Object.keys(v.iconDependencies);
                        L.length ? a.send("getImages", {
                            icons: L,
                            source: this.source,
                            tileID: this.tileID,
                            type: "icons"
                        }, (function(e, t) {
                            h || (h = e,
                            f = t,
                            k.call(l))
                        }
                        )) : f = {};
                        var I = Object.keys(v.patternDependencies);
                        function k() {
                            if (h)
                                return s(h);
                            if (p && f && d) {
                                var t = new n(p)
                                  , i = new e.ImageAtlas(f,d);
                                for (var a in m) {
                                    var l = m[a];
                                    l instanceof e.SymbolBucket ? (o(l.layers, this.zoom, r),
                                    e.performSymbolLayout(l, p, t.positions, f, i.iconPositions, this.showCollisionBoxes, this.tileID.canonical)) : l.hasPattern && (l instanceof e.LineBucket || l instanceof e.FillBucket || l instanceof e.FillExtrusionBucket) && (o(l.layers, this.zoom, r),
                                    l.addFeatures(v, this.tileID.canonical, i.patternPositions))
                                }
                                this.status = "done",
                                s(null, {
                                    buckets: e.values(m).filter((function(e) {
                                        return !e.isEmpty()
                                    }
                                    )),
                                    featureIndex: c,
                                    collisionBoxArray: this.collisionBoxArray,
                                    glyphAtlasImage: t.image,
                                    imageAtlas: i,
                                    glyphMap: this.returnDependencies ? p : null,
                                    iconMap: this.returnDependencies ? f : null,
                                    glyphPositions: this.returnDependencies ? t.positions : null
                                })
                            }
                        }
                        I.length ? a.send("getImages", {
                            icons: I,
                            source: this.source,
                            tileID: this.tileID,
                            type: "patterns"
                        }, (function(e, t) {
                            h || (h = e,
                            d = t,
                            k.call(l))
                        }
                        )) : d = {},
                        k.call(this)
                    }
                    ;
                    var l = function(e, t, i, r) {
                        this.actor = e,
                        this.layerIndex = t,
                        this.availableImages = i,
                        this.loadVectorData = r || s,
                        this.loading = {},
                        this.loaded = {}
                    };
                    l.prototype.loadTile = function(t, i) {
                        var r = this
                          , n = t.uid;
                        this.loading || (this.loading = {});
                        var o = !!(t && t.request && t.request.collectResourceTiming) && new e.RequestPerformance(t.request)
                          , s = this.loading[n] = new a(t);
                        s.abort = this.loadVectorData(t, (function(t, a) {
                            if (delete r.loading[n],
                            t || !a)
                                return s.status = "done",
                                r.loaded[n] = s,
                                i(t);
                            var l = a.rawData
                              , u = {};
                            a.expires && (u.expires = a.expires),
                            a.cacheControl && (u.cacheControl = a.cacheControl);
                            var c = {};
                            if (o) {
                                var h = o.finish();
                                h && (c.resourceTiming = JSON.parse(JSON.stringify(h)))
                            }
                            s.vectorTile = a.vectorTile,
                            s.parse(a.vectorTile, r.layerIndex, r.availableImages, r.actor, (function(t, r) {
                                if (t || !r)
                                    return i(t);
                                i(null, e.extend({
                                    rawTileData: l.slice(0)
                                }, r, u, c))
                            }
                            )),
                            r.loaded = r.loaded || {},
                            r.loaded[n] = s
                        }
                        ))
                    }
                    ,
                    l.prototype.reloadTile = function(e, t) {
                        var i = this
                          , r = this.loaded
                          , n = e.uid
                          , a = this;
                        if (r && r[n]) {
                            var o = r[n];
                            o.showCollisionBoxes = e.showCollisionBoxes;
                            var s = function(e, r) {
                                var n = o.reloadCallback;
                                n && (delete o.reloadCallback,
                                o.parse(o.vectorTile, a.layerIndex, i.availableImages, a.actor, n)),
                                t(e, r)
                            };
                            "parsing" === o.status ? o.reloadCallback = s : "done" === o.status && (o.vectorTile ? o.parse(o.vectorTile, this.layerIndex, this.availableImages, this.actor, s) : s())
                        }
                    }
                    ,
                    l.prototype.abortTile = function(e, t) {
                        var i = this.loading
                          , r = e.uid;
                        i && i[r] && i[r].abort && (i[r].abort(),
                        delete i[r]),
                        t()
                    }
                    ,
                    l.prototype.removeTile = function(e, t) {
                        var i = this.loaded
                          , r = e.uid;
                        i && i[r] && delete i[r],
                        t()
                    }
                    ;
                    var u = e.window.ImageBitmap
                      , c = function() {
                        this.loaded = {}
                    };
                    function h(e, t) {
                        if (0 !== e.length) {
                            p(e[0], t);
                            for (var i = 1; i < e.length; i++)
                                p(e[i], !t)
                        }
                    }
                    function p(e, t) {
                        for (var i = 0, r = 0, n = e.length, a = n - 1; r < n; a = r++)
                            i += (e[r][0] - e[a][0]) * (e[a][1] + e[r][1]);
                        i >= 0 != !!t && e.reverse()
                    }
                    c.prototype.loadTile = function(t, i) {
                        var r = t.uid
                          , n = t.encoding
                          , a = t.rawImageData
                          , o = u && a instanceof u ? this.getImageData(a) : a
                          , s = new e.DEMData(r,o,n);
                        this.loaded = this.loaded || {},
                        this.loaded[r] = s,
                        i(null, s)
                    }
                    ,
                    c.prototype.getImageData = function(t) {
                        this.offscreenCanvas && this.offscreenCanvasContext || (this.offscreenCanvas = new OffscreenCanvas(t.width,t.height),
                        this.offscreenCanvasContext = this.offscreenCanvas.getContext("2d")),
                        this.offscreenCanvas.width = t.width,
                        this.offscreenCanvas.height = t.height,
                        this.offscreenCanvasContext.drawImage(t, 0, 0, t.width, t.height);
                        var i = this.offscreenCanvasContext.getImageData(-1, -1, t.width + 2, t.height + 2);
                        return this.offscreenCanvasContext.clearRect(0, 0, this.offscreenCanvas.width, this.offscreenCanvas.height),
                        new e.RGBAImage({
                            width: i.width,
                            height: i.height
                        },i.data)
                    }
                    ,
                    c.prototype.removeTile = function(e) {
                        var t = this.loaded
                          , i = e.uid;
                        t && t[i] && delete t[i]
                    }
                    ;
                    var f = e.vectorTile.VectorTileFeature.prototype.toGeoJSON
                      , d = function(t) {
                        this._feature = t,
                        this.extent = e.EXTENT,
                        this.type = t.type,
                        this.properties = t.tags,
                        "id"in t && !isNaN(t.id) && (this.id = parseInt(t.id, 10))
                    };
                    d.prototype.loadGeometry = function() {
                        if (1 === this._feature.type) {
                            for (var t = [], i = 0, r = this._feature.geometry; i < r.length; i += 1) {
                                var n = r[i];
                                t.push([new e.Point$1(n[0],n[1])])
                            }
                            return t
                        }
                        for (var a = [], o = 0, s = this._feature.geometry; o < s.length; o += 1) {
                            for (var l = [], u = 0, c = s[o]; u < c.length; u += 1) {
                                var h = c[u];
                                l.push(new e.Point$1(h[0],h[1]))
                            }
                            a.push(l)
                        }
                        return a
                    }
                    ,
                    d.prototype.toGeoJSON = function(e, t, i) {
                        return f.call(this, e, t, i)
                    }
                    ;
                    var m = function(t) {
                        this.layers = {
                            _geojsonTileLayer: this
                        },
                        this.name = "_geojsonTileLayer",
                        this.extent = e.EXTENT,
                        this.length = t.length,
                        this._features = t
                    };
                    m.prototype.feature = function(e) {
                        return new d(this._features[e])
                    }
                    ;
                    var v = e.vectorTile.VectorTileFeature
                      , g = y;
                    function y(e, t) {
                        this.options = t || {},
                        this.features = e,
                        this.length = e.length
                    }
                    function _(e, t) {
                        this.id = "number" == typeof e.id ? e.id : void 0,
                        this.type = e.type,
                        this.rawGeometry = 1 === e.type ? [e.geometry] : e.geometry,
                        this.properties = e.tags,
                        this.extent = t || 4096
                    }
                    y.prototype.feature = function(e) {
                        return new _(this.features[e],this.options.extent)
                    }
                    ,
                    _.prototype.loadGeometry = function() {
                        var t = this.rawGeometry;
                        this.geometry = [];
                        for (var i = 0; i < t.length; i++) {
                            for (var r = t[i], n = [], a = 0; a < r.length; a++)
                                n.push(new e.Point$1(r[a][0],r[a][1]));
                            this.geometry.push(n)
                        }
                        return this.geometry
                    }
                    ,
                    _.prototype.bbox = function() {
                        this.geometry || this.loadGeometry();
                        for (var e = this.geometry, t = 1 / 0, i = -1 / 0, r = 1 / 0, n = -1 / 0, a = 0; a < e.length; a++)
                            for (var o = e[a], s = 0; s < o.length; s++) {
                                var l = o[s];
                                t = Math.min(t, l.x),
                                i = Math.max(i, l.x),
                                r = Math.min(r, l.y),
                                n = Math.max(n, l.y)
                            }
                        return [t, r, i, n]
                    }
                    ,
                    _.prototype.toGeoJSON = v.prototype.toGeoJSON;
                    var x = w
                      , b = g;
                    function w(t) {
                        var i = new e.pbf;
                        return function(e, t) {
                            for (var i in e.layers)
                                t.writeMessage(3, S, e.layers[i])
                        }(t, i),
                        i.finish()
                    }
                    function S(e, t) {
                        var i;
                        t.writeVarintField(15, e.version || 1),
                        t.writeStringField(1, e.name || ""),
                        t.writeVarintField(5, e.extent || 4096);
                        var r = {
                            keys: [],
                            values: [],
                            keycache: {},
                            valuecache: {}
                        };
                        for (i = 0; i < e.length; i++)
                            r.feature = e.feature(i),
                            t.writeMessage(2, M, r);
                        var n = r.keys;
                        for (i = 0; i < n.length; i++)
                            t.writeStringField(3, n[i]);
                        var a = r.values;
                        for (i = 0; i < a.length; i++)
                            t.writeMessage(4, C, a[i])
                    }
                    function M(e, t) {
                        var i = e.feature;
                        void 0 !== i.id && t.writeVarintField(1, i.id),
                        t.writeMessage(2, T, e),
                        t.writeVarintField(3, i.type),
                        t.writeMessage(4, P, i)
                    }
                    function T(e, t) {
                        var i = e.feature
                          , r = e.keys
                          , n = e.values
                          , a = e.keycache
                          , o = e.valuecache;
                        for (var s in i.properties) {
                            var l = a[s];
                            void 0 === l && (r.push(s),
                            a[s] = l = r.length - 1),
                            t.writeVarint(l);
                            var u = i.properties[s]
                              , c = typeof u;
                            "string" !== c && "boolean" !== c && "number" !== c && (u = JSON.stringify(u));
                            var h = c + ":" + u
                              , p = o[h];
                            void 0 === p && (n.push(u),
                            o[h] = p = n.length - 1),
                            t.writeVarint(p)
                        }
                    }
                    function E(e, t) {
                        return (t << 3) + (7 & e)
                    }
                    function A(e) {
                        return e << 1 ^ e >> 31
                    }
                    function P(e, t) {
                        for (var i = e.loadGeometry(), r = e.type, n = 0, a = 0, o = i.length, s = 0; s < o; s++) {
                            var l = i[s]
                              , u = 1;
                            1 === r && (u = l.length),
                            t.writeVarint(E(1, u));
                            for (var c = 3 === r ? l.length - 1 : l.length, h = 0; h < c; h++) {
                                1 === h && 1 !== r && t.writeVarint(E(2, c - 1));
                                var p = l[h].x - n
                                  , f = l[h].y - a;
                                t.writeVarint(A(p)),
                                t.writeVarint(A(f)),
                                n += p,
                                a += f
                            }
                            3 === r && t.writeVarint(E(7, 1))
                        }
                    }
                    function C(e, t) {
                        var i = typeof e;
                        "string" === i ? t.writeStringField(1, e) : "boolean" === i ? t.writeBooleanField(7, e) : "number" === i && (e % 1 != 0 ? t.writeDoubleField(3, e) : e < 0 ? t.writeSVarintField(6, e) : t.writeVarintField(5, e))
                    }
                    function L(e, t, i, r) {
                        I(e, i, r),
                        I(t, 2 * i, 2 * r),
                        I(t, 2 * i + 1, 2 * r + 1)
                    }
                    function I(e, t, i) {
                        var r = e[t];
                        e[t] = e[i],
                        e[i] = r
                    }
                    function k(e, t, i, r) {
                        var n = e - i
                          , a = t - r;
                        return n * n + a * a
                    }
                    x.fromVectorTileJs = w,
                    x.fromGeojsonVt = function(e, t) {
                        t = t || {};
                        var i = {};
                        for (var r in e)
                            i[r] = new g(e[r].features,t),
                            i[r].name = r,
                            i[r].version = t.version,
                            i[r].extent = t.extent;
                        return w({
                            layers: i
                        })
                    }
                    ,
                    x.GeoJSONWrapper = b;
                    var z = function(e) {
                        return e[0]
                    }
                      , D = function(e) {
                        return e[1]
                    }
                      , R = function(e, t, i, r, n) {
                        void 0 === t && (t = z),
                        void 0 === i && (i = D),
                        void 0 === r && (r = 64),
                        void 0 === n && (n = Float64Array),
                        this.nodeSize = r,
                        this.points = e;
                        for (var a = e.length < 65536 ? Uint16Array : Uint32Array, o = this.ids = new a(e.length), s = this.coords = new n(2 * e.length), l = 0; l < e.length; l++)
                            o[l] = l,
                            s[2 * l] = t(e[l]),
                            s[2 * l + 1] = i(e[l]);
                        !function e(t, i, r, n, a, o) {
                            if (!(a - n <= r)) {
                                var s = n + a >> 1;
                                !function e(t, i, r, n, a, o) {
                                    for (; a > n; ) {
                                        if (a - n > 600) {
                                            var s = a - n + 1
                                              , l = r - n + 1
                                              , u = Math.log(s)
                                              , c = .5 * Math.exp(2 * u / 3)
                                              , h = .5 * Math.sqrt(u * c * (s - c) / s) * (l - s / 2 < 0 ? -1 : 1);
                                            e(t, i, r, Math.max(n, Math.floor(r - l * c / s + h)), Math.min(a, Math.floor(r + (s - l) * c / s + h)), o)
                                        }
                                        var p = i[2 * r + o]
                                          , f = n
                                          , d = a;
                                        for (L(t, i, n, r),
                                        i[2 * a + o] > p && L(t, i, n, a); f < d; ) {
                                            for (L(t, i, f, d),
                                            f++,
                                            d--; i[2 * f + o] < p; )
                                                f++;
                                            for (; i[2 * d + o] > p; )
                                                d--
                                        }
                                        i[2 * n + o] === p ? L(t, i, n, d) : L(t, i, ++d, a),
                                        d <= r && (n = d + 1),
                                        r <= d && (a = d - 1)
                                    }
                                }(t, i, s, n, a, o % 2),
                                e(t, i, r, n, s - 1, o + 1),
                                e(t, i, r, s + 1, a, o + 1)
                            }
                        }(o, s, r, 0, o.length - 1, 0)
                    };
                    R.prototype.range = function(e, t, i, r) {
                        return function(e, t, i, r, n, a, o) {
                            for (var s, l, u = [0, e.length - 1, 0], c = []; u.length; ) {
                                var h = u.pop()
                                  , p = u.pop()
                                  , f = u.pop();
                                if (p - f <= o)
                                    for (var d = f; d <= p; d++)
                                        l = t[2 * d + 1],
                                        (s = t[2 * d]) >= i && s <= n && l >= r && l <= a && c.push(e[d]);
                                else {
                                    var m = Math.floor((f + p) / 2);
                                    l = t[2 * m + 1],
                                    (s = t[2 * m]) >= i && s <= n && l >= r && l <= a && c.push(e[m]);
                                    var v = (h + 1) % 2;
                                    (0 === h ? i <= s : r <= l) && (u.push(f),
                                    u.push(m - 1),
                                    u.push(v)),
                                    (0 === h ? n >= s : a >= l) && (u.push(m + 1),
                                    u.push(p),
                                    u.push(v))
                                }
                            }
                            return c
                        }(this.ids, this.coords, e, t, i, r, this.nodeSize)
                    }
                    ,
                    R.prototype.within = function(e, t, i) {
                        return function(e, t, i, r, n, a) {
                            for (var o = [0, e.length - 1, 0], s = [], l = n * n; o.length; ) {
                                var u = o.pop()
                                  , c = o.pop()
                                  , h = o.pop();
                                if (c - h <= a)
                                    for (var p = h; p <= c; p++)
                                        k(t[2 * p], t[2 * p + 1], i, r) <= l && s.push(e[p]);
                                else {
                                    var f = Math.floor((h + c) / 2)
                                      , d = t[2 * f]
                                      , m = t[2 * f + 1];
                                    k(d, m, i, r) <= l && s.push(e[f]);
                                    var v = (u + 1) % 2;
                                    (0 === u ? i - n <= d : r - n <= m) && (o.push(h),
                                    o.push(f - 1),
                                    o.push(v)),
                                    (0 === u ? i + n >= d : r + n >= m) && (o.push(f + 1),
                                    o.push(c),
                                    o.push(v))
                                }
                            }
                            return s
                        }(this.ids, this.coords, e, t, i, this.nodeSize)
                    }
                    ;
                    var O = {
                        minZoom: 0,
                        maxZoom: 16,
                        minPoints: 2,
                        radius: 40,
                        extent: 512,
                        nodeSize: 64,
                        log: !1,
                        generateId: !1,
                        reduce: null,
                        map: function(e) {
                            return e
                        }
                    }
                      , B = function(e) {
                        this.options = H(Object.create(O), e),
                        this.trees = new Array(this.options.maxZoom + 1)
                    };
                    function F(e, t, i, r, n) {
                        return {
                            x: e,
                            y: t,
                            zoom: 1 / 0,
                            id: i,
                            parentId: -1,
                            numPoints: r,
                            properties: n
                        }
                    }
                    function N(e, t) {
                        var i = e.geometry.coordinates
                          , r = i[1];
                        return {
                            x: G(i[0]),
                            y: j(r),
                            zoom: 1 / 0,
                            index: t,
                            parentId: -1
                        }
                    }
                    function U(e) {
                        return {
                            type: "Feature",
                            id: e.id,
                            properties: V(e),
                            geometry: {
                                type: "Point",
                                coordinates: [(r = e.x,
                                360 * (r - .5)), (t = e.y,
                                i = (180 - 360 * t) * Math.PI / 180,
                                360 * Math.atan(Math.exp(i)) / Math.PI - 90)]
                            }
                        };
                        var t, i, r
                    }
                    function V(e) {
                        var t = e.numPoints
                          , i = t >= 1e4 ? Math.round(t / 1e3) + "k" : t >= 1e3 ? Math.round(t / 100) / 10 + "k" : t;
                        return H(H({}, e.properties), {
                            cluster: !0,
                            cluster_id: e.id,
                            point_count: t,
                            point_count_abbreviated: i
                        })
                    }
                    function G(e) {
                        return e / 360 + .5
                    }
                    function j(e) {
                        var t = Math.sin(e * Math.PI / 180)
                          , i = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;
                        return i < 0 ? 0 : i > 1 ? 1 : i
                    }
                    function H(e, t) {
                        for (var i in t)
                            e[i] = t[i];
                        return e
                    }
                    function q(e) {
                        return e.x
                    }
                    function W(e) {
                        return e.y
                    }
                    function Z(e, t, i, r, n, a) {
                        var o = n - i
                          , s = a - r;
                        if (0 !== o || 0 !== s) {
                            var l = ((e - i) * o + (t - r) * s) / (o * o + s * s);
                            l > 1 ? (i = n,
                            r = a) : l > 0 && (i += o * l,
                            r += s * l)
                        }
                        return (o = e - i) * o + (s = t - r) * s
                    }
                    function X(e, t, i, r) {
                        var n = {
                            id: void 0 === e ? null : e,
                            type: t,
                            geometry: i,
                            tags: r,
                            minX: 1 / 0,
                            minY: 1 / 0,
                            maxX: -1 / 0,
                            maxY: -1 / 0
                        };
                        return function(e) {
                            var t = e.geometry
                              , i = e.type;
                            if ("Point" === i || "MultiPoint" === i || "LineString" === i)
                                Y(e, t);
                            else if ("Polygon" === i || "MultiLineString" === i)
                                for (var r = 0; r < t.length; r++)
                                    Y(e, t[r]);
                            else if ("MultiPolygon" === i)
                                for (r = 0; r < t.length; r++)
                                    for (var n = 0; n < t[r].length; n++)
                                        Y(e, t[r][n])
                        }(n),
                        n
                    }
                    function Y(e, t) {
                        for (var i = 0; i < t.length; i += 3)
                            e.minX = Math.min(e.minX, t[i]),
                            e.minY = Math.min(e.minY, t[i + 1]),
                            e.maxX = Math.max(e.maxX, t[i]),
                            e.maxY = Math.max(e.maxY, t[i + 1])
                    }
                    function K(e, t, i, r) {
                        if (t.geometry) {
                            var n = t.geometry.coordinates
                              , a = t.geometry.type
                              , o = Math.pow(i.tolerance / ((1 << i.maxZoom) * i.extent), 2)
                              , s = []
                              , l = t.id;
                            if (i.promoteId ? l = t.properties[i.promoteId] : i.generateId && (l = r || 0),
                            "Point" === a)
                                J(n, s);
                            else if ("MultiPoint" === a)
                                for (var u = 0; u < n.length; u++)
                                    J(n[u], s);
                            else if ("LineString" === a)
                                Q(n, s, o, !1);
                            else if ("MultiLineString" === a) {
                                if (i.lineMetrics) {
                                    for (u = 0; u < n.length; u++)
                                        Q(n[u], s = [], o, !1),
                                        e.push(X(l, "LineString", s, t.properties));
                                    return
                                }
                                $(n, s, o, !1)
                            } else if ("Polygon" === a)
                                $(n, s, o, !0);
                            else {
                                if ("MultiPolygon" !== a) {
                                    if ("GeometryCollection" === a) {
                                        for (u = 0; u < t.geometry.geometries.length; u++)
                                            K(e, {
                                                id: l,
                                                geometry: t.geometry.geometries[u],
                                                properties: t.properties
                                            }, i, r);
                                        return
                                    }
                                    throw new Error("Input data is not a valid GeoJSON object.")
                                }
                                for (u = 0; u < n.length; u++) {
                                    var c = [];
                                    $(n[u], c, o, !0),
                                    s.push(c)
                                }
                            }
                            e.push(X(l, a, s, t.properties))
                        }
                    }
                    function J(e, t) {
                        t.push(ee(e[0])),
                        t.push(te(e[1])),
                        t.push(0)
                    }
                    function Q(e, t, i, r) {
                        for (var n, a, o = 0, s = 0; s < e.length; s++) {
                            var l = ee(e[s][0])
                              , u = te(e[s][1]);
                            t.push(l),
                            t.push(u),
                            t.push(0),
                            s > 0 && (o += r ? (n * u - l * a) / 2 : Math.sqrt(Math.pow(l - n, 2) + Math.pow(u - a, 2))),
                            n = l,
                            a = u
                        }
                        var c = t.length - 3;
                        t[2] = 1,
                        function e(t, i, r, n) {
                            for (var a, o = n, s = r - i >> 1, l = r - i, u = t[i], c = t[i + 1], h = t[r], p = t[r + 1], f = i + 3; f < r; f += 3) {
                                var d = Z(t[f], t[f + 1], u, c, h, p);
                                if (d > o)
                                    a = f,
                                    o = d;
                                else if (d === o) {
                                    var m = Math.abs(f - s);
                                    m < l && (a = f,
                                    l = m)
                                }
                            }
                            o > n && (a - i > 3 && e(t, i, a, n),
                            t[a + 2] = o,
                            r - a > 3 && e(t, a, r, n))
                        }(t, 0, c, i),
                        t[c + 2] = 1,
                        t.size = Math.abs(o),
                        t.start = 0,
                        t.end = t.size
                    }
                    function $(e, t, i, r) {
                        for (var n = 0; n < e.length; n++) {
                            var a = [];
                            Q(e[n], a, i, r),
                            t.push(a)
                        }
                    }
                    function ee(e) {
                        return e / 360 + .5
                    }
                    function te(e) {
                        var t = Math.sin(e * Math.PI / 180)
                          , i = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;
                        return i < 0 ? 0 : i > 1 ? 1 : i
                    }
                    function ie(e, t, i, r, n, a, o, s) {
                        if (r /= t,
                        a >= (i /= t) && o < r)
                            return e;
                        if (o < i || a >= r)
                            return null;
                        for (var l = [], u = 0; u < e.length; u++) {
                            var c = e[u]
                              , h = c.geometry
                              , p = c.type
                              , f = 0 === n ? c.minX : c.minY
                              , d = 0 === n ? c.maxX : c.maxY;
                            if (f >= i && d < r)
                                l.push(c);
                            else if (!(d < i || f >= r)) {
                                var m = [];
                                if ("Point" === p || "MultiPoint" === p)
                                    re(h, m, i, r, n);
                                else if ("LineString" === p)
                                    ne(h, m, i, r, n, !1, s.lineMetrics);
                                else if ("MultiLineString" === p)
                                    oe(h, m, i, r, n, !1);
                                else if ("Polygon" === p)
                                    oe(h, m, i, r, n, !0);
                                else if ("MultiPolygon" === p)
                                    for (var v = 0; v < h.length; v++) {
                                        var g = [];
                                        oe(h[v], g, i, r, n, !0),
                                        g.length && m.push(g)
                                    }
                                if (m.length) {
                                    if (s.lineMetrics && "LineString" === p) {
                                        for (v = 0; v < m.length; v++)
                                            l.push(X(c.id, p, m[v], c.tags));
                                        continue
                                    }
                                    "LineString" !== p && "MultiLineString" !== p || (1 === m.length ? (p = "LineString",
                                    m = m[0]) : p = "MultiLineString"),
                                    "Point" !== p && "MultiPoint" !== p || (p = 3 === m.length ? "Point" : "MultiPoint"),
                                    l.push(X(c.id, p, m, c.tags))
                                }
                            }
                        }
                        return l.length ? l : null
                    }
                    function re(e, t, i, r, n) {
                        for (var a = 0; a < e.length; a += 3) {
                            var o = e[a + n];
                            o >= i && o <= r && (t.push(e[a]),
                            t.push(e[a + 1]),
                            t.push(e[a + 2]))
                        }
                    }
                    function ne(e, t, i, r, n, a, o) {
                        for (var s, l, u = ae(e), c = 0 === n ? le : ue, h = e.start, p = 0; p < e.length - 3; p += 3) {
                            var f = e[p]
                              , d = e[p + 1]
                              , m = e[p + 2]
                              , v = e[p + 3]
                              , g = e[p + 4]
                              , y = 0 === n ? f : d
                              , _ = 0 === n ? v : g
                              , x = !1;
                            o && (s = Math.sqrt(Math.pow(f - v, 2) + Math.pow(d - g, 2))),
                            y < i ? _ > i && (l = c(u, f, d, v, g, i),
                            o && (u.start = h + s * l)) : y > r ? _ < r && (l = c(u, f, d, v, g, r),
                            o && (u.start = h + s * l)) : se(u, f, d, m),
                            _ < i && y >= i && (l = c(u, f, d, v, g, i),
                            x = !0),
                            _ > r && y <= r && (l = c(u, f, d, v, g, r),
                            x = !0),
                            !a && x && (o && (u.end = h + s * l),
                            t.push(u),
                            u = ae(e)),
                            o && (h += s)
                        }
                        var b = e.length - 3;
                        f = e[b],
                        d = e[b + 1],
                        m = e[b + 2],
                        (y = 0 === n ? f : d) >= i && y <= r && se(u, f, d, m),
                        b = u.length - 3,
                        a && b >= 3 && (u[b] !== u[0] || u[b + 1] !== u[1]) && se(u, u[0], u[1], u[2]),
                        u.length && t.push(u)
                    }
                    function ae(e) {
                        var t = [];
                        return t.size = e.size,
                        t.start = e.start,
                        t.end = e.end,
                        t
                    }
                    function oe(e, t, i, r, n, a) {
                        for (var o = 0; o < e.length; o++)
                            ne(e[o], t, i, r, n, a, !1)
                    }
                    function se(e, t, i, r) {
                        e.push(t),
                        e.push(i),
                        e.push(r)
                    }
                    function le(e, t, i, r, n, a) {
                        var o = (a - t) / (r - t);
                        return e.push(a),
                        e.push(i + (n - i) * o),
                        e.push(1),
                        o
                    }
                    function ue(e, t, i, r, n, a) {
                        var o = (a - i) / (n - i);
                        return e.push(t + (r - t) * o),
                        e.push(a),
                        e.push(1),
                        o
                    }
                    function ce(e, t) {
                        for (var i = [], r = 0; r < e.length; r++) {
                            var n, a = e[r], o = a.type;
                            if ("Point" === o || "MultiPoint" === o || "LineString" === o)
                                n = he(a.geometry, t);
                            else if ("MultiLineString" === o || "Polygon" === o) {
                                n = [];
                                for (var s = 0; s < a.geometry.length; s++)
                                    n.push(he(a.geometry[s], t))
                            } else if ("MultiPolygon" === o)
                                for (n = [],
                                s = 0; s < a.geometry.length; s++) {
                                    for (var l = [], u = 0; u < a.geometry[s].length; u++)
                                        l.push(he(a.geometry[s][u], t));
                                    n.push(l)
                                }
                            i.push(X(a.id, o, n, a.tags))
                        }
                        return i
                    }
                    function he(e, t) {
                        var i = [];
                        i.size = e.size,
                        void 0 !== e.start && (i.start = e.start,
                        i.end = e.end);
                        for (var r = 0; r < e.length; r += 3)
                            i.push(e[r] + t, e[r + 1], e[r + 2]);
                        return i
                    }
                    function pe(e, t) {
                        if (e.transformed)
                            return e;
                        var i, r, n, a = 1 << e.z, o = e.x, s = e.y;
                        for (i = 0; i < e.features.length; i++) {
                            var l = e.features[i]
                              , u = l.geometry
                              , c = l.type;
                            if (l.geometry = [],
                            1 === c)
                                for (r = 0; r < u.length; r += 2)
                                    l.geometry.push(fe(u[r], u[r + 1], t, a, o, s));
                            else
                                for (r = 0; r < u.length; r++) {
                                    var h = [];
                                    for (n = 0; n < u[r].length; n += 2)
                                        h.push(fe(u[r][n], u[r][n + 1], t, a, o, s));
                                    l.geometry.push(h)
                                }
                        }
                        return e.transformed = !0,
                        e
                    }
                    function fe(e, t, i, r, n, a) {
                        return [Math.round(i * (e * r - n)), Math.round(i * (t * r - a))]
                    }
                    function de(e, t, i, r, n) {
                        for (var a = t === n.maxZoom ? 0 : n.tolerance / ((1 << t) * n.extent), o = {
                            features: [],
                            numPoints: 0,
                            numSimplified: 0,
                            numFeatures: 0,
                            source: null,
                            x: i,
                            y: r,
                            z: t,
                            transformed: !1,
                            minX: 2,
                            minY: 1,
                            maxX: -1,
                            maxY: 0
                        }, s = 0; s < e.length; s++) {
                            o.numFeatures++,
                            me(o, e[s], a, n);
                            var l = e[s].minX
                              , u = e[s].minY
                              , c = e[s].maxX
                              , h = e[s].maxY;
                            l < o.minX && (o.minX = l),
                            u < o.minY && (o.minY = u),
                            c > o.maxX && (o.maxX = c),
                            h > o.maxY && (o.maxY = h)
                        }
                        return o
                    }
                    function me(e, t, i, r) {
                        var n = t.geometry
                          , a = t.type
                          , o = [];
                        if ("Point" === a || "MultiPoint" === a)
                            for (var s = 0; s < n.length; s += 3)
                                o.push(n[s]),
                                o.push(n[s + 1]),
                                e.numPoints++,
                                e.numSimplified++;
                        else if ("LineString" === a)
                            ve(o, n, e, i, !1, !1);
                        else if ("MultiLineString" === a || "Polygon" === a)
                            for (s = 0; s < n.length; s++)
                                ve(o, n[s], e, i, "Polygon" === a, 0 === s);
                        else if ("MultiPolygon" === a)
                            for (var l = 0; l < n.length; l++) {
                                var u = n[l];
                                for (s = 0; s < u.length; s++)
                                    ve(o, u[s], e, i, !0, 0 === s)
                            }
                        if (o.length) {
                            var c = t.tags || null;
                            if ("LineString" === a && r.lineMetrics) {
                                for (var h in c = {},
                                t.tags)
                                    c[h] = t.tags[h];
                                c.mapbox_clip_start = n.start / n.size,
                                c.mapbox_clip_end = n.end / n.size
                            }
                            var p = {
                                geometry: o,
                                type: "Polygon" === a || "MultiPolygon" === a ? 3 : "LineString" === a || "MultiLineString" === a ? 2 : 1,
                                tags: c
                            };
                            null !== t.id && (p.id = t.id),
                            e.features.push(p)
                        }
                    }
                    function ve(e, t, i, r, n, a) {
                        var o = r * r;
                        if (r > 0 && t.size < (n ? o : r))
                            i.numPoints += t.length / 3;
                        else {
                            for (var s = [], l = 0; l < t.length; l += 3)
                                (0 === r || t[l + 2] > o) && (i.numSimplified++,
                                s.push(t[l]),
                                s.push(t[l + 1])),
                                i.numPoints++;
                            n && function(e, t) {
                                for (var i = 0, r = 0, n = e.length, a = n - 2; r < n; a = r,
                                r += 2)
                                    i += (e[r] - e[a]) * (e[r + 1] + e[a + 1]);
                                if (i > 0 === t)
                                    for (r = 0,
                                    n = e.length; r < n / 2; r += 2) {
                                        var o = e[r]
                                          , s = e[r + 1];
                                        e[r] = e[n - 2 - r],
                                        e[r + 1] = e[n - 1 - r],
                                        e[n - 2 - r] = o,
                                        e[n - 1 - r] = s
                                    }
                            }(s, a),
                            e.push(s)
                        }
                    }
                    function ge(e, t) {
                        var i = (t = this.options = function(e, t) {
                            for (var i in t)
                                e[i] = t[i];
                            return e
                        }(Object.create(this.options), t)).debug;
                        if (i && console.time("preprocess data"),
                        t.maxZoom < 0 || t.maxZoom > 24)
                            throw new Error("maxZoom should be in the 0-24 range");
                        if (t.promoteId && t.generateId)
                            throw new Error("promoteId and generateId cannot be used together.");
                        var r = function(e, t) {
                            var i = [];
                            if ("FeatureCollection" === e.type)
                                for (var r = 0; r < e.features.length; r++)
                                    K(i, e.features[r], t, r);
                            else
                                K(i, "Feature" === e.type ? e : {
                                    geometry: e
                                }, t);
                            return i
                        }(e, t);
                        this.tiles = {},
                        this.tileCoords = [],
                        i && (console.timeEnd("preprocess data"),
                        console.log("index: maxZoom: %d, maxPoints: %d", t.indexMaxZoom, t.indexMaxPoints),
                        console.time("generate tiles"),
                        this.stats = {},
                        this.total = 0),
                        (r = function(e, t) {
                            var i = t.buffer / t.extent
                              , r = e
                              , n = ie(e, 1, -1 - i, i, 0, -1, 2, t)
                              , a = ie(e, 1, 1 - i, 2 + i, 0, -1, 2, t);
                            return (n || a) && (r = ie(e, 1, -i, 1 + i, 0, -1, 2, t) || [],
                            n && (r = ce(n, 1).concat(r)),
                            a && (r = r.concat(ce(a, -1)))),
                            r
                        }(r, t)).length && this.splitTile(r, 0, 0, 0),
                        i && (r.length && console.log("features: %d, points: %d", this.tiles[0].numFeatures, this.tiles[0].numPoints),
                        console.timeEnd("generate tiles"),
                        console.log("tiles generated:", this.total, JSON.stringify(this.stats)))
                    }
                    function ye(e, t, i) {
                        return 32 * ((1 << e) * i + t) + e
                    }
                    function _e(e, t) {
                        var i = e.tileID.canonical;
                        if (!this._geoJSONIndex)
                            return t(null, null);
                        var r = this._geoJSONIndex.getTile(i.z, i.x, i.y);
                        if (!r)
                            return t(null, null);
                        var n = new m(r.features)
                          , a = x(n);
                        0 === a.byteOffset && a.byteLength === a.buffer.byteLength || (a = new Uint8Array(a)),
                        t(null, {
                            vectorTile: n,
                            rawData: a.buffer
                        })
                    }
                    B.prototype.load = function(e) {
                        var t = this.options
                          , i = t.log
                          , r = t.minZoom
                          , n = t.maxZoom
                          , a = t.nodeSize;
                        i && console.time("total time");
                        var o = "prepare " + e.length + " points";
                        i && console.time(o),
                        this.points = e;
                        for (var s = [], l = 0; l < e.length; l++)
                            e[l].geometry && s.push(N(e[l], l));
                        this.trees[n + 1] = new R(s,q,W,a,Float32Array),
                        i && console.timeEnd(o);
                        for (var u = n; u >= r; u--) {
                            var c = +Date.now();
                            s = this._cluster(s, u),
                            this.trees[u] = new R(s,q,W,a,Float32Array),
                            i && console.log("z%d: %d clusters in %dms", u, s.length, +Date.now() - c)
                        }
                        return i && console.timeEnd("total time"),
                        this
                    }
                    ,
                    B.prototype.getClusters = function(e, t) {
                        var i = ((e[0] + 180) % 360 + 360) % 360 - 180
                          , r = Math.max(-90, Math.min(90, e[1]))
                          , n = 180 === e[2] ? 180 : ((e[2] + 180) % 360 + 360) % 360 - 180
                          , a = Math.max(-90, Math.min(90, e[3]));
                        if (e[2] - e[0] >= 360)
                            i = -180,
                            n = 180;
                        else if (i > n) {
                            var o = this.getClusters([i, r, 180, a], t)
                              , s = this.getClusters([-180, r, n, a], t);
                            return o.concat(s)
                        }
                        for (var l = this.trees[this._limitZoom(t)], u = [], c = 0, h = l.range(G(i), j(a), G(n), j(r)); c < h.length; c += 1) {
                            var p = l.points[h[c]];
                            u.push(p.numPoints ? U(p) : this.points[p.index])
                        }
                        return u
                    }
                    ,
                    B.prototype.getChildren = function(e) {
                        var t = this._getOriginId(e)
                          , i = this._getOriginZoom(e)
                          , r = "No cluster with the specified id."
                          , n = this.trees[i];
                        if (!n)
                            throw new Error(r);
                        var a = n.points[t];
                        if (!a)
                            throw new Error(r);
                        for (var o = this.options.radius / (this.options.extent * Math.pow(2, i - 1)), s = [], l = 0, u = n.within(a.x, a.y, o); l < u.length; l += 1) {
                            var c = n.points[u[l]];
                            c.parentId === e && s.push(c.numPoints ? U(c) : this.points[c.index])
                        }
                        if (0 === s.length)
                            throw new Error(r);
                        return s
                    }
                    ,
                    B.prototype.getLeaves = function(e, t, i) {
                        var r = [];
                        return this._appendLeaves(r, e, t = t || 10, i = i || 0, 0),
                        r
                    }
                    ,
                    B.prototype.getTile = function(e, t, i) {
                        var r = this.trees[this._limitZoom(e)]
                          , n = Math.pow(2, e)
                          , a = this.options
                          , o = a.radius / a.extent
                          , s = (i - o) / n
                          , l = (i + 1 + o) / n
                          , u = {
                            features: []
                        };
                        return this._addTileFeatures(r.range((t - o) / n, s, (t + 1 + o) / n, l), r.points, t, i, n, u),
                        0 === t && this._addTileFeatures(r.range(1 - o / n, s, 1, l), r.points, n, i, n, u),
                        t === n - 1 && this._addTileFeatures(r.range(0, s, o / n, l), r.points, -1, i, n, u),
                        u.features.length ? u : null
                    }
                    ,
                    B.prototype.getClusterExpansionZoom = function(e) {
                        for (var t = this._getOriginZoom(e) - 1; t <= this.options.maxZoom; ) {
                            var i = this.getChildren(e);
                            if (t++,
                            1 !== i.length)
                                break;
                            e = i[0].properties.cluster_id
                        }
                        return t
                    }
                    ,
                    B.prototype._appendLeaves = function(e, t, i, r, n) {
                        for (var a = 0, o = this.getChildren(t); a < o.length; a += 1) {
                            var s = o[a]
                              , l = s.properties;
                            if (l && l.cluster ? n + l.point_count <= r ? n += l.point_count : n = this._appendLeaves(e, l.cluster_id, i, r, n) : n < r ? n++ : e.push(s),
                            e.length === i)
                                break
                        }
                        return n
                    }
                    ,
                    B.prototype._addTileFeatures = function(e, t, i, r, n, a) {
                        for (var o = 0, s = e; o < s.length; o += 1) {
                            var l = t[s[o]]
                              , u = l.numPoints
                              , c = {
                                type: 1,
                                geometry: [[Math.round(this.options.extent * (l.x * n - i)), Math.round(this.options.extent * (l.y * n - r))]],
                                tags: u ? V(l) : this.points[l.index].properties
                            }
                              , h = void 0;
                            u ? h = l.id : this.options.generateId ? h = l.index : this.points[l.index].id && (h = this.points[l.index].id),
                            void 0 !== h && (c.id = h),
                            a.features.push(c)
                        }
                    }
                    ,
                    B.prototype._limitZoom = function(e) {
                        return Math.max(this.options.minZoom, Math.min(+e, this.options.maxZoom + 1))
                    }
                    ,
                    B.prototype._cluster = function(e, t) {
                        for (var i = [], r = this.options, n = r.reduce, a = r.minPoints, o = r.radius / (r.extent * Math.pow(2, t)), s = 0; s < e.length; s++) {
                            var l = e[s];
                            if (!(l.zoom <= t)) {
                                l.zoom = t;
                                for (var u = this.trees[t + 1], c = u.within(l.x, l.y, o), h = l.numPoints || 1, p = h, f = 0, d = c; f < d.length; f += 1) {
                                    var m = u.points[d[f]];
                                    m.zoom > t && (p += m.numPoints || 1)
                                }
                                if (p >= a) {
                                    for (var v = l.x * h, g = l.y * h, y = n && h > 1 ? this._map(l, !0) : null, _ = (s << 5) + (t + 1) + this.points.length, x = 0, b = c; x < b.length; x += 1) {
                                        var w = u.points[b[x]];
                                        if (!(w.zoom <= t)) {
                                            w.zoom = t;
                                            var S = w.numPoints || 1;
                                            v += w.x * S,
                                            g += w.y * S,
                                            w.parentId = _,
                                            n && (y || (y = this._map(l, !0)),
                                            n(y, this._map(w)))
                                        }
                                    }
                                    l.parentId = _,
                                    i.push(F(v / p, g / p, _, p, y))
                                } else if (i.push(l),
                                p > 1)
                                    for (var M = 0, T = c; M < T.length; M += 1) {
                                        var E = u.points[T[M]];
                                        E.zoom <= t || (E.zoom = t,
                                        i.push(E))
                                    }
                            }
                        }
                        return i
                    }
                    ,
                    B.prototype._getOriginId = function(e) {
                        return e - this.points.length >> 5
                    }
                    ,
                    B.prototype._getOriginZoom = function(e) {
                        return (e - this.points.length) % 32
                    }
                    ,
                    B.prototype._map = function(e, t) {
                        if (e.numPoints)
                            return t ? H({}, e.properties) : e.properties;
                        var i = this.points[e.index].properties
                          , r = this.options.map(i);
                        return t && r === i ? H({}, r) : r
                    }
                    ,
                    ge.prototype.options = {
                        maxZoom: 14,
                        indexMaxZoom: 5,
                        indexMaxPoints: 1e5,
                        tolerance: 3,
                        extent: 4096,
                        buffer: 64,
                        lineMetrics: !1,
                        promoteId: null,
                        generateId: !1,
                        debug: 0
                    },
                    ge.prototype.splitTile = function(e, t, i, r, n, a, o) {
                        for (var s = [e, t, i, r], l = this.options, u = l.debug; s.length; ) {
                            r = s.pop(),
                            i = s.pop(),
                            t = s.pop(),
                            e = s.pop();
                            var c = 1 << t
                              , h = ye(t, i, r)
                              , p = this.tiles[h];
                            if (!p && (u > 1 && console.time("creation"),
                            p = this.tiles[h] = de(e, t, i, r, l),
                            this.tileCoords.push({
                                z: t,
                                x: i,
                                y: r
                            }),
                            u)) {
                                u > 1 && (console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)", t, i, r, p.numFeatures, p.numPoints, p.numSimplified),
                                console.timeEnd("creation"));
                                var f = "z" + t;
                                this.stats[f] = (this.stats[f] || 0) + 1,
                                this.total++
                            }
                            if (p.source = e,
                            n) {
                                if (t === l.maxZoom || t === n)
                                    continue;
                                var d = 1 << n - t;
                                if (i !== Math.floor(a / d) || r !== Math.floor(o / d))
                                    continue
                            } else if (t === l.indexMaxZoom || p.numPoints <= l.indexMaxPoints)
                                continue;
                            if (p.source = null,
                            0 !== e.length) {
                                u > 1 && console.time("clipping");
                                var m, v, g, y, _, x, b = .5 * l.buffer / l.extent, w = .5 - b, S = .5 + b, M = 1 + b;
                                m = v = g = y = null,
                                _ = ie(e, c, i - b, i + S, 0, p.minX, p.maxX, l),
                                x = ie(e, c, i + w, i + M, 0, p.minX, p.maxX, l),
                                e = null,
                                _ && (m = ie(_, c, r - b, r + S, 1, p.minY, p.maxY, l),
                                v = ie(_, c, r + w, r + M, 1, p.minY, p.maxY, l),
                                _ = null),
                                x && (g = ie(x, c, r - b, r + S, 1, p.minY, p.maxY, l),
                                y = ie(x, c, r + w, r + M, 1, p.minY, p.maxY, l),
                                x = null),
                                u > 1 && console.timeEnd("clipping"),
                                s.push(m || [], t + 1, 2 * i, 2 * r),
                                s.push(v || [], t + 1, 2 * i, 2 * r + 1),
                                s.push(g || [], t + 1, 2 * i + 1, 2 * r),
                                s.push(y || [], t + 1, 2 * i + 1, 2 * r + 1)
                            }
                        }
                    }
                    ,
                    ge.prototype.getTile = function(e, t, i) {
                        var r = this.options
                          , n = r.extent
                          , a = r.debug;
                        if (e < 0 || e > 24)
                            return null;
                        var o = 1 << e
                          , s = ye(e, t = (t % o + o) % o, i);
                        if (this.tiles[s])
                            return pe(this.tiles[s], n);
                        a > 1 && console.log("drilling down to z%d-%d-%d", e, t, i);
                        for (var l, u = e, c = t, h = i; !l && u > 0; )
                            u--,
                            c = Math.floor(c / 2),
                            h = Math.floor(h / 2),
                            l = this.tiles[ye(u, c, h)];
                        return l && l.source ? (a > 1 && console.log("found parent tile z%d-%d-%d", u, c, h),
                        a > 1 && console.time("drilling down"),
                        this.splitTile(l.source, u, c, h, e, t, i),
                        a > 1 && console.timeEnd("drilling down"),
                        this.tiles[s] ? pe(this.tiles[s], n) : null) : null
                    }
                    ;
                    var xe = function(t) {
                        function i(e, i, r, n) {
                            t.call(this, e, i, r, _e),
                            n && (this.loadGeoJSON = n)
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.loadData = function(e, t) {
                            this._pendingCallback && this._pendingCallback(null, {
                                abandoned: !0
                            }),
                            this._pendingCallback = t,
                            this._pendingLoadDataParams = e,
                            this._state && "Idle" !== this._state ? this._state = "NeedsLoadData" : (this._state = "Coalescing",
                            this._loadData())
                        }
                        ,
                        i.prototype._loadData = function() {
                            var t = this;
                            if (this._pendingCallback && this._pendingLoadDataParams) {
                                var i = this._pendingCallback
                                  , r = this._pendingLoadDataParams;
                                delete this._pendingCallback,
                                delete this._pendingLoadDataParams;
                                var n = !!(r && r.request && r.request.collectResourceTiming) && new e.RequestPerformance(r.request);
                                this.loadGeoJSON(r, (function(a, o) {
                                    if (a || !o)
                                        return i(a);
                                    if ("object" != typeof o)
                                        return i(new Error("Input data given to '" + r.source + "' is not a valid GeoJSON object."));
                                    !function e(t, i) {
                                        var r, n = t && t.type;
                                        if ("FeatureCollection" === n)
                                            for (r = 0; r < t.features.length; r++)
                                                e(t.features[r], i);
                                        else if ("GeometryCollection" === n)
                                            for (r = 0; r < t.geometries.length; r++)
                                                e(t.geometries[r], i);
                                        else if ("Feature" === n)
                                            e(t.geometry, i);
                                        else if ("Polygon" === n)
                                            h(t.coordinates, i);
                                        else if ("MultiPolygon" === n)
                                            for (r = 0; r < t.coordinates.length; r++)
                                                h(t.coordinates[r], i);
                                        return t
                                    }(o, !0);
                                    try {
                                        if (r.filter) {
                                            var s = e.createExpression(r.filter, {
                                                type: "boolean",
                                                "property-type": "data-driven",
                                                overridable: !1,
                                                transition: !1
                                            });
                                            if ("error" === s.result)
                                                throw new Error(s.value.map((function(e) {
                                                    return e.key + ": " + e.message
                                                }
                                                )).join(", "));
                                            var l = o.features.filter((function(e) {
                                                return s.value.evaluate({
                                                    zoom: 0
                                                }, e)
                                            }
                                            ));
                                            o = {
                                                type: "FeatureCollection",
                                                features: l
                                            }
                                        }
                                        t._geoJSONIndex = r.cluster ? new B(function(t) {
                                            var i = t.superclusterOptions
                                              , r = t.clusterProperties;
                                            if (!r || !i)
                                                return i;
                                            for (var n = {}, a = {}, o = {
                                                accumulated: null,
                                                zoom: 0
                                            }, s = {
                                                properties: null
                                            }, l = Object.keys(r), u = 0, c = l; u < c.length; u += 1) {
                                                var h = c[u]
                                                  , p = r[h]
                                                  , f = p[0]
                                                  , d = e.createExpression(p[1])
                                                  , m = e.createExpression("string" == typeof f ? [f, ["accumulated"], ["get", h]] : f);
                                                n[h] = d.value,
                                                a[h] = m.value
                                            }
                                            return i.map = function(e) {
                                                s.properties = e;
                                                for (var t = {}, i = 0, r = l; i < r.length; i += 1) {
                                                    var a = r[i];
                                                    t[a] = n[a].evaluate(o, s)
                                                }
                                                return t
                                            }
                                            ,
                                            i.reduce = function(e, t) {
                                                s.properties = t;
                                                for (var i = 0, r = l; i < r.length; i += 1) {
                                                    var n = r[i];
                                                    o.accumulated = e[n],
                                                    e[n] = a[n].evaluate(o, s)
                                                }
                                            }
                                            ,
                                            i
                                        }(r)).load(o.features) : function(e, t) {
                                            return new ge(e,t)
                                        }(o, r.geojsonVtOptions)
                                    } catch (a) {
                                        return i(a)
                                    }
                                    t.loaded = {};
                                    var u = {};
                                    if (n) {
                                        var c = n.finish();
                                        c && (u.resourceTiming = {},
                                        u.resourceTiming[r.source] = JSON.parse(JSON.stringify(c)))
                                    }
                                    i(null, u)
                                }
                                ))
                            }
                        }
                        ,
                        i.prototype.coalesce = function() {
                            "Coalescing" === this._state ? this._state = "Idle" : "NeedsLoadData" === this._state && (this._state = "Coalescing",
                            this._loadData())
                        }
                        ,
                        i.prototype.reloadTile = function(e, i) {
                            var r = this.loaded;
                            return r && r[e.uid] ? t.prototype.reloadTile.call(this, e, i) : this.loadTile(e, i)
                        }
                        ,
                        i.prototype.loadGeoJSON = function(t, i) {
                            if (t.request)
                                e.getJSON(t.request, i);
                            else {
                                if ("string" != typeof t.data)
                                    return i(new Error("Input data given to '" + t.source + "' is not a valid GeoJSON object."));
                                try {
                                    return i(null, JSON.parse(t.data))
                                } catch (e) {
                                    return i(new Error("Input data given to '" + t.source + "' is not a valid GeoJSON object."))
                                }
                            }
                        }
                        ,
                        i.prototype.removeSource = function(e, t) {
                            this._pendingCallback && this._pendingCallback(null, {
                                abandoned: !0
                            }),
                            t()
                        }
                        ,
                        i.prototype.getClusterExpansionZoom = function(e, t) {
                            try {
                                t(null, this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))
                            } catch (e) {
                                t(e)
                            }
                        }
                        ,
                        i.prototype.getClusterChildren = function(e, t) {
                            try {
                                t(null, this._geoJSONIndex.getChildren(e.clusterId))
                            } catch (e) {
                                t(e)
                            }
                        }
                        ,
                        i.prototype.getClusterLeaves = function(e, t) {
                            try {
                                t(null, this._geoJSONIndex.getLeaves(e.clusterId, e.limit, e.offset))
                            } catch (e) {
                                t(e)
                            }
                        }
                        ,
                        i
                    }(l)
                      , be = function(t) {
                        var i = this;
                        this.self = t,
                        this.actor = new e.Actor(t,this),
                        this.layerIndexes = {},
                        this.availableImages = {},
                        this.workerSourceTypes = {
                            vector: l,
                            geojson: xe
                        },
                        this.workerSources = {},
                        this.demWorkerSources = {},
                        this.self.registerWorkerSource = function(e, t) {
                            if (i.workerSourceTypes[e])
                                throw new Error('Worker source with name "' + e + '" already registered.');
                            i.workerSourceTypes[e] = t
                        }
                        ,
                        this.self.registerRTLTextPlugin = function(t) {
                            if (e.plugin.isParsed())
                                throw new Error("RTL text plugin already registered.");
                            e.plugin.applyArabicShaping = t.applyArabicShaping,
                            e.plugin.processBidirectionalText = t.processBidirectionalText,
                            e.plugin.processStyledBidirectionalText = t.processStyledBidirectionalText
                        }
                    };
                    return be.prototype.setReferrer = function(e, t) {
                        this.referrer = t
                    }
                    ,
                    be.prototype.setImages = function(e, t, i) {
                        for (var r in this.availableImages[e] = t,
                        this.workerSources[e]) {
                            var n = this.workerSources[e][r];
                            for (var a in n)
                                n[a].availableImages = t
                        }
                        i()
                    }
                    ,
                    be.prototype.setLayers = function(e, t, i) {
                        this.getLayerIndex(e).replace(t),
                        i()
                    }
                    ,
                    be.prototype.updateLayers = function(e, t, i) {
                        this.getLayerIndex(e).update(t.layers, t.removedIds),
                        i()
                    }
                    ,
                    be.prototype.loadTile = function(e, t, i) {
                        this.getWorkerSource(e, t.type, t.source).loadTile(t, i)
                    }
                    ,
                    be.prototype.loadDEMTile = function(e, t, i) {
                        this.getDEMWorkerSource(e, t.source).loadTile(t, i)
                    }
                    ,
                    be.prototype.reloadTile = function(e, t, i) {
                        this.getWorkerSource(e, t.type, t.source).reloadTile(t, i)
                    }
                    ,
                    be.prototype.abortTile = function(e, t, i) {
                        this.getWorkerSource(e, t.type, t.source).abortTile(t, i)
                    }
                    ,
                    be.prototype.removeTile = function(e, t, i) {
                        this.getWorkerSource(e, t.type, t.source).removeTile(t, i)
                    }
                    ,
                    be.prototype.removeDEMTile = function(e, t) {
                        this.getDEMWorkerSource(e, t.source).removeTile(t)
                    }
                    ,
                    be.prototype.removeSource = function(e, t, i) {
                        if (this.workerSources[e] && this.workerSources[e][t.type] && this.workerSources[e][t.type][t.source]) {
                            var r = this.workerSources[e][t.type][t.source];
                            delete this.workerSources[e][t.type][t.source],
                            void 0 !== r.removeSource ? r.removeSource(t, i) : i()
                        }
                    }
                    ,
                    be.prototype.loadWorkerSource = function(e, t, i) {
                        try {
                            this.self.importScripts(t.url),
                            i()
                        } catch (e) {
                            i(e.toString())
                        }
                    }
                    ,
                    be.prototype.syncRTLPluginState = function(t, i, r) {
                        try {
                            e.plugin.setState(i);
                            var n = e.plugin.getPluginURL();
                            if (e.plugin.isLoaded() && !e.plugin.isParsed() && null != n) {
                                this.self.importScripts(n);
                                var a = e.plugin.isParsed();
                                r(a ? void 0 : new Error("RTL Text Plugin failed to import scripts from " + n), a)
                            }
                        } catch (e) {
                            r(e.toString())
                        }
                    }
                    ,
                    be.prototype.getAvailableImages = function(e) {
                        var t = this.availableImages[e];
                        return t || (t = []),
                        t
                    }
                    ,
                    be.prototype.getLayerIndex = function(e) {
                        var t = this.layerIndexes[e];
                        return t || (t = this.layerIndexes[e] = new r),
                        t
                    }
                    ,
                    be.prototype.getWorkerSource = function(e, t, i) {
                        var r = this;
                        return this.workerSources[e] || (this.workerSources[e] = {}),
                        this.workerSources[e][t] || (this.workerSources[e][t] = {}),
                        this.workerSources[e][t][i] || (this.workerSources[e][t][i] = new this.workerSourceTypes[t]({
                            send: function(t, i, n) {
                                r.actor.send(t, i, n, e)
                            }
                        },this.getLayerIndex(e),this.getAvailableImages(e))),
                        this.workerSources[e][t][i]
                    }
                    ,
                    be.prototype.getDEMWorkerSource = function(e, t) {
                        return this.demWorkerSources[e] || (this.demWorkerSources[e] = {}),
                        this.demWorkerSources[e][t] || (this.demWorkerSources[e][t] = new c),
                        this.demWorkerSources[e][t]
                    }
                    ,
                    be.prototype.enforceCacheSizeLimit = function(t, i) {
                        e.enforceCacheSizeLimit(i)
                    }
                    ,
                    "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope && (self.worker = new be(self)),
                    be
                }
                )),
                r(0, (function(e) {
                    var t = e.createCommonjsModule((function(e) {
                        function t(e) {
                            return !i(e)
                        }
                        function i(e) {
                            return "undefined" == typeof window || "undefined" == typeof document ? "not a browser" : Array.prototype && Array.prototype.every && Array.prototype.filter && Array.prototype.forEach && Array.prototype.indexOf && Array.prototype.lastIndexOf && Array.prototype.map && Array.prototype.some && Array.prototype.reduce && Array.prototype.reduceRight && Array.isArray ? Function.prototype && Function.prototype.bind ? Object.keys && Object.create && Object.getPrototypeOf && Object.getOwnPropertyNames && Object.isSealed && Object.isFrozen && Object.isExtensible && Object.getOwnPropertyDescriptor && Object.defineProperty && Object.defineProperties && Object.seal && Object.freeze && Object.preventExtensions ? "JSON"in window && "parse"in JSON && "stringify"in JSON ? function() {
                                if (!("Worker"in window && "Blob"in window && "URL"in window))
                                    return !1;
                                var e, t, i = new Blob([""],{
                                    type: "text/javascript"
                                }), r = URL.createObjectURL(i);
                                try {
                                    t = new Worker(r),
                                    e = !0
                                } catch (t) {
                                    e = !1
                                }
                                return t && t.terminate(),
                                URL.revokeObjectURL(r),
                                e
                            }() ? "Uint8ClampedArray"in window ? ArrayBuffer.isView ? function() {
                                var e = document.createElement("canvas");
                                e.width = e.height = 1;
                                var t = e.getContext("2d");
                                if (!t)
                                    return !1;
                                var i = t.getImageData(0, 0, 1, 1);
                                return i && i.width === e.width
                            }() ? (void 0 === r[i = e && e.failIfMajorPerformanceCaveat] && (r[i] = function(e) {
                                var i = function(e) {
                                    var i = document.createElement("canvas")
                                      , r = Object.create(t.webGLContextAttributes);
                                    return r.failIfMajorPerformanceCaveat = e,
                                    i.probablySupportsContext ? i.probablySupportsContext("webgl", r) || i.probablySupportsContext("experimental-webgl", r) : i.supportsContext ? i.supportsContext("webgl", r) || i.supportsContext("experimental-webgl", r) : i.getContext("webgl", r) || i.getContext("experimental-webgl", r)
                                }(e);
                                if (!i)
                                    return !1;
                                var r = i.createShader(i.VERTEX_SHADER);
                                return !(!r || i.isContextLost()) && (i.shaderSource(r, "void main() {}"),
                                i.compileShader(r),
                                !0 === i.getShaderParameter(r, i.COMPILE_STATUS))
                            }(i)),
                            r[i] ? void 0 : "insufficient WebGL support") : "insufficient Canvas/getImageData support" : "insufficient ArrayBuffer support" : "insufficient Uint8ClampedArray support" : "insufficient worker support" : "insufficient JSON support" : "insufficient Object support" : "insufficient Function support" : "insufficent Array support";
                            var i
                        }
                        e.exports ? e.exports = t : window && (window.mapboxgl = window.mapboxgl || {},
                        window.mapboxgl.supported = t,
                        window.mapboxgl.notSupportedReason = i);
                        var r = {};
                        t.webGLContextAttributes = {
                            antialias: !1,
                            alpha: !0,
                            stencil: !0,
                            depth: !0
                        }
                    }
                    ))
                      , i = {
                        create: function(t, i, r) {
                            var n = e.window.document.createElement(t);
                            return void 0 !== i && (n.className = i),
                            r && r.appendChild(n),
                            n
                        },
                        createNS: function(t, i) {
                            return e.window.document.createElementNS(t, i)
                        }
                    }
                      , r = e.window.document && e.window.document.documentElement.style;
                    function n(e) {
                        if (!r)
                            return e[0];
                        for (var t = 0; t < e.length; t++)
                            if (e[t]in r)
                                return e[t];
                        return e[0]
                    }
                    var a, o = n(["userSelect", "MozUserSelect", "WebkitUserSelect", "msUserSelect"]);
                    i.disableDrag = function() {
                        r && o && (a = r[o],
                        r[o] = "none")
                    }
                    ,
                    i.enableDrag = function() {
                        r && o && (r[o] = a)
                    }
                    ;
                    var s = n(["transform", "WebkitTransform"]);
                    i.setTransform = function(e, t) {
                        e.style[s] = t
                    }
                    ;
                    var l = !1;
                    try {
                        var u = Object.defineProperty({}, "passive", {
                            get: function() {
                                l = !0
                            }
                        });
                        e.window.addEventListener("test", u, u),
                        e.window.removeEventListener("test", u, u)
                    } catch (e) {
                        l = !1
                    }
                    i.addEventListener = function(e, t, i, r) {
                        void 0 === r && (r = {}),
                        e.addEventListener(t, i, "passive"in r && l ? r : r.capture)
                    }
                    ,
                    i.removeEventListener = function(e, t, i, r) {
                        void 0 === r && (r = {}),
                        e.removeEventListener(t, i, "passive"in r && l ? r : r.capture)
                    }
                    ;
                    var c = function(t) {
                        t.preventDefault(),
                        t.stopPropagation(),
                        e.window.removeEventListener("click", c, !0)
                    };
                    function h(e) {
                        var t = e.userImage;
                        return !!(t && t.render && t.render()) && (e.data.replace(new Uint8Array(t.data.buffer)),
                        !0)
                    }
                    i.suppressClick = function() {
                        e.window.addEventListener("click", c, !0),
                        e.window.setTimeout((function() {
                            e.window.removeEventListener("click", c, !0)
                        }
                        ), 0)
                    }
                    ,
                    i.mousePos = function(t, i) {
                        var r = t.getBoundingClientRect();
                        return new e.Point(i.clientX - r.left - t.clientLeft,i.clientY - r.top - t.clientTop)
                    }
                    ,
                    i.touchPos = function(t, i) {
                        for (var r = t.getBoundingClientRect(), n = [], a = 0; a < i.length; a++)
                            n.push(new e.Point(i[a].clientX - r.left - t.clientLeft,i[a].clientY - r.top - t.clientTop));
                        return n
                    }
                    ,
                    i.mouseButton = function(t) {
                        return void 0 !== e.window.InstallTrigger && 2 === t.button && t.ctrlKey && e.window.navigator.platform.toUpperCase().indexOf("MAC") >= 0 ? 0 : t.button
                    }
                    ,
                    i.remove = function(e) {
                        e.parentNode && e.parentNode.removeChild(e)
                    }
                    ;
                    var p = function(t) {
                        function i() {
                            t.call(this),
                            this.images = {},
                            this.updatedImages = {},
                            this.callbackDispatchedThisFrame = {},
                            this.loaded = !1,
                            this.requestors = [],
                            this.patterns = {},
                            this.atlasImage = new e.RGBAImage({
                                width: 1,
                                height: 1
                            }),
                            this.dirty = !0
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.isLoaded = function() {
                            return this.loaded
                        }
                        ,
                        i.prototype.setLoaded = function(e) {
                            if (this.loaded !== e && (this.loaded = e,
                            e)) {
                                for (var t = 0, i = this.requestors; t < i.length; t += 1) {
                                    var r = i[t];
                                    this._notify(r.ids, r.callback)
                                }
                                this.requestors = []
                            }
                        }
                        ,
                        i.prototype.getImage = function(e) {
                            return this.images[e]
                        }
                        ,
                        i.prototype.addImage = function(e, t) {
                            this._validate(e, t) && (this.images[e] = t)
                        }
                        ,
                        i.prototype._validate = function(t, i) {
                            var r = !0;
                            return this._validateStretch(i.stretchX, i.data && i.data.width) || (this.fire(new e.ErrorEvent(new Error('Image "' + t + '" has invalid "stretchX" value'))),
                            r = !1),
                            this._validateStretch(i.stretchY, i.data && i.data.height) || (this.fire(new e.ErrorEvent(new Error('Image "' + t + '" has invalid "stretchY" value'))),
                            r = !1),
                            this._validateContent(i.content, i) || (this.fire(new e.ErrorEvent(new Error('Image "' + t + '" has invalid "content" value'))),
                            r = !1),
                            r
                        }
                        ,
                        i.prototype._validateStretch = function(e, t) {
                            if (!e)
                                return !0;
                            for (var i = 0, r = 0, n = e; r < n.length; r += 1) {
                                var a = n[r];
                                if (a[0] < i || a[1] < a[0] || t < a[1])
                                    return !1;
                                i = a[1]
                            }
                            return !0
                        }
                        ,
                        i.prototype._validateContent = function(e, t) {
                            return !(e && (4 !== e.length || e[0] < 0 || t.data.width < e[0] || e[1] < 0 || t.data.height < e[1] || e[2] < 0 || t.data.width < e[2] || e[3] < 0 || t.data.height < e[3] || e[2] < e[0] || e[3] < e[1]))
                        }
                        ,
                        i.prototype.updateImage = function(e, t) {
                            t.version = this.images[e].version + 1,
                            this.images[e] = t,
                            this.updatedImages[e] = !0
                        }
                        ,
                        i.prototype.removeImage = function(e) {
                            var t = this.images[e];
                            delete this.images[e],
                            delete this.patterns[e],
                            t.userImage && t.userImage.onRemove && t.userImage.onRemove()
                        }
                        ,
                        i.prototype.listImages = function() {
                            return Object.keys(this.images)
                        }
                        ,
                        i.prototype.getImages = function(e, t) {
                            var i = !0;
                            if (!this.isLoaded())
                                for (var r = 0, n = e; r < n.length; r += 1)
                                    this.images[n[r]] || (i = !1);
                            this.isLoaded() || i ? this._notify(e, t) : this.requestors.push({
                                ids: e,
                                callback: t
                            })
                        }
                        ,
                        i.prototype._notify = function(t, i) {
                            for (var r = {}, n = 0, a = t; n < a.length; n += 1) {
                                var o = a[n];
                                this.images[o] || this.fire(new e.Event("styleimagemissing",{
                                    id: o
                                }));
                                var s = this.images[o];
                                s ? r[o] = {
                                    data: s.data.clone(),
                                    pixelRatio: s.pixelRatio,
                                    sdf: s.sdf,
                                    version: s.version,
                                    stretchX: s.stretchX,
                                    stretchY: s.stretchY,
                                    content: s.content,
                                    hasRenderCallback: Boolean(s.userImage && s.userImage.render)
                                } : e.warnOnce('Image "' + o + '" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')
                            }
                            i(null, r)
                        }
                        ,
                        i.prototype.getPixelSize = function() {
                            var e = this.atlasImage;
                            return {
                                width: e.width,
                                height: e.height
                            }
                        }
                        ,
                        i.prototype.getPattern = function(t) {
                            var i = this.patterns[t]
                              , r = this.getImage(t);
                            if (!r)
                                return null;
                            if (i && i.position.version === r.version)
                                return i.position;
                            if (i)
                                i.position.version = r.version;
                            else {
                                var n = {
                                    w: r.data.width + 2,
                                    h: r.data.height + 2,
                                    x: 0,
                                    y: 0
                                }
                                  , a = new e.ImagePosition(n,r);
                                this.patterns[t] = {
                                    bin: n,
                                    position: a
                                }
                            }
                            return this._updatePatternAtlas(),
                            this.patterns[t].position
                        }
                        ,
                        i.prototype.bind = function(t) {
                            var i = t.gl;
                            this.atlasTexture ? this.dirty && (this.atlasTexture.update(this.atlasImage),
                            this.dirty = !1) : this.atlasTexture = new e.Texture(t,this.atlasImage,i.RGBA),
                            this.atlasTexture.bind(i.LINEAR, i.CLAMP_TO_EDGE)
                        }
                        ,
                        i.prototype._updatePatternAtlas = function() {
                            var t = [];
                            for (var i in this.patterns)
                                t.push(this.patterns[i].bin);
                            var r = e.potpack(t)
                              , n = r.w
                              , a = r.h
                              , o = this.atlasImage;
                            for (var s in o.resize({
                                width: n || 1,
                                height: a || 1
                            }),
                            this.patterns) {
                                var l = this.patterns[s].bin
                                  , u = l.x + 1
                                  , c = l.y + 1
                                  , h = this.images[s].data
                                  , p = h.width
                                  , f = h.height;
                                e.RGBAImage.copy(h, o, {
                                    x: 0,
                                    y: 0
                                }, {
                                    x: u,
                                    y: c
                                }, {
                                    width: p,
                                    height: f
                                }),
                                e.RGBAImage.copy(h, o, {
                                    x: 0,
                                    y: f - 1
                                }, {
                                    x: u,
                                    y: c - 1
                                }, {
                                    width: p,
                                    height: 1
                                }),
                                e.RGBAImage.copy(h, o, {
                                    x: 0,
                                    y: 0
                                }, {
                                    x: u,
                                    y: c + f
                                }, {
                                    width: p,
                                    height: 1
                                }),
                                e.RGBAImage.copy(h, o, {
                                    x: p - 1,
                                    y: 0
                                }, {
                                    x: u - 1,
                                    y: c
                                }, {
                                    width: 1,
                                    height: f
                                }),
                                e.RGBAImage.copy(h, o, {
                                    x: 0,
                                    y: 0
                                }, {
                                    x: u + p,
                                    y: c
                                }, {
                                    width: 1,
                                    height: f
                                })
                            }
                            this.dirty = !0
                        }
                        ,
                        i.prototype.beginFrame = function() {
                            this.callbackDispatchedThisFrame = {}
                        }
                        ,
                        i.prototype.dispatchRenderCallbacks = function(e) {
                            for (var t = 0, i = e; t < i.length; t += 1) {
                                var r = i[t];
                                if (!this.callbackDispatchedThisFrame[r]) {
                                    this.callbackDispatchedThisFrame[r] = !0;
                                    var n = this.images[r];
                                    h(n) && this.updateImage(r, n)
                                }
                            }
                        }
                        ,
                        i
                    }(e.Evented)
                      , f = v
                      , d = v
                      , m = 1e20;
                    function v(e, t, i, r, n, a) {
                        this.fontSize = e || 24,
                        this.buffer = void 0 === t ? 3 : t,
                        this.cutoff = r || .25,
                        this.fontFamily = n || "sans-serif",
                        this.fontWeight = a || "normal",
                        this.radius = i || 8;
                        var o = this.size = this.fontSize + 2 * this.buffer;
                        this.canvas = document.createElement("canvas"),
                        this.canvas.width = this.canvas.height = o,
                        this.ctx = this.canvas.getContext("2d"),
                        this.ctx.font = this.fontWeight + " " + this.fontSize + "px " + this.fontFamily,
                        this.ctx.textBaseline = "middle",
                        this.ctx.fillStyle = "black",
                        this.gridOuter = new Float64Array(o * o),
                        this.gridInner = new Float64Array(o * o),
                        this.f = new Float64Array(o),
                        this.d = new Float64Array(o),
                        this.z = new Float64Array(o + 1),
                        this.v = new Int16Array(o),
                        this.middle = Math.round(o / 2 * (navigator.userAgent.indexOf("Gecko/") >= 0 ? 1.2 : 1))
                    }
                    function g(e, t, i, r, n, a, o) {
                        for (var s = 0; s < t; s++) {
                            for (var l = 0; l < i; l++)
                                r[l] = e[l * t + s];
                            for (y(r, n, a, o, i),
                            l = 0; l < i; l++)
                                e[l * t + s] = n[l]
                        }
                        for (l = 0; l < i; l++) {
                            for (s = 0; s < t; s++)
                                r[s] = e[l * t + s];
                            for (y(r, n, a, o, t),
                            s = 0; s < t; s++)
                                e[l * t + s] = Math.sqrt(n[s])
                        }
                    }
                    function y(e, t, i, r, n) {
                        i[0] = 0,
                        r[0] = -m,
                        r[1] = +m;
                        for (var a = 1, o = 0; a < n; a++) {
                            for (var s = (e[a] + a * a - (e[i[o]] + i[o] * i[o])) / (2 * a - 2 * i[o]); s <= r[o]; )
                                o--,
                                s = (e[a] + a * a - (e[i[o]] + i[o] * i[o])) / (2 * a - 2 * i[o]);
                            i[++o] = a,
                            r[o] = s,
                            r[o + 1] = +m
                        }
                        for (a = 0,
                        o = 0; a < n; a++) {
                            for (; r[o + 1] < a; )
                                o++;
                            t[a] = (a - i[o]) * (a - i[o]) + e[i[o]]
                        }
                    }
                    v.prototype.draw = function(e) {
                        this.ctx.clearRect(0, 0, this.size, this.size),
                        this.ctx.fillText(e, this.buffer, this.middle);
                        for (var t = this.ctx.getImageData(0, 0, this.size, this.size), i = new Uint8ClampedArray(this.size * this.size), r = 0; r < this.size * this.size; r++) {
                            var n = t.data[4 * r + 3] / 255;
                            this.gridOuter[r] = 1 === n ? 0 : 0 === n ? m : Math.pow(Math.max(0, .5 - n), 2),
                            this.gridInner[r] = 1 === n ? m : 0 === n ? 0 : Math.pow(Math.max(0, n - .5), 2)
                        }
                        for (g(this.gridOuter, this.size, this.size, this.f, this.d, this.v, this.z),
                        g(this.gridInner, this.size, this.size, this.f, this.d, this.v, this.z),
                        r = 0; r < this.size * this.size; r++)
                            i[r] = Math.max(0, Math.min(255, Math.round(255 - 255 * ((this.gridOuter[r] - this.gridInner[r]) / this.radius + this.cutoff))));
                        return i
                    }
                    ,
                    f.default = d;
                    var _ = function(e, t) {
                        this.requestManager = e,
                        this.localIdeographFontFamily = t,
                        this.entries = {}
                    };
                    _.prototype.setURL = function(e) {
                        this.url = e
                    }
                    ,
                    _.prototype.getGlyphs = function(t, i) {
                        var r = this
                          , n = [];
                        for (var a in t)
                            for (var o = 0, s = t[a]; o < s.length; o += 1)
                                n.push({
                                    stack: a,
                                    id: s[o]
                                });
                        e.asyncAll(n, (function(e, t) {
                            var i = e.stack
                              , n = e.id
                              , a = r.entries[i];
                            a || (a = r.entries[i] = {
                                glyphs: {},
                                requests: {},
                                ranges: {}
                            });
                            var o = a.glyphs[n];
                            if (void 0 === o) {
                                if (o = r._tinySDF(a, i, n))
                                    return a.glyphs[n] = o,
                                    void t(null, {
                                        stack: i,
                                        id: n,
                                        glyph: o
                                    });
                                var s = Math.floor(n / 256);
                                if (256 * s > 65535)
                                    t(new Error("glyphs > 65535 not supported"));
                                else if (a.ranges[s])
                                    t(null, {
                                        stack: i,
                                        id: n,
                                        glyph: o
                                    });
                                else {
                                    var l = a.requests[s];
                                    l || (l = a.requests[s] = [],
                                    _.loadGlyphRange(i, s, r.url, r.requestManager, (function(e, t) {
                                        if (t) {
                                            for (var i in t)
                                                r._doesCharSupportLocalGlyph(+i) || (a.glyphs[+i] = t[+i]);
                                            a.ranges[s] = !0
                                        }
                                        for (var n = 0, o = l; n < o.length; n += 1)
                                            (0,
                                            o[n])(e, t);
                                        delete a.requests[s]
                                    }
                                    ))),
                                    l.push((function(e, r) {
                                        e ? t(e) : r && t(null, {
                                            stack: i,
                                            id: n,
                                            glyph: r[n] || null
                                        })
                                    }
                                    ))
                                }
                            } else
                                t(null, {
                                    stack: i,
                                    id: n,
                                    glyph: o
                                })
                        }
                        ), (function(e, t) {
                            if (e)
                                i(e);
                            else if (t) {
                                for (var r = {}, n = 0, a = t; n < a.length; n += 1) {
                                    var o = a[n]
                                      , s = o.stack
                                      , l = o.id
                                      , u = o.glyph;
                                    (r[s] || (r[s] = {}))[l] = u && {
                                        id: u.id,
                                        bitmap: u.bitmap.clone(),
                                        metrics: u.metrics
                                    }
                                }
                                i(null, r)
                            }
                        }
                        ))
                    }
                    ,
                    _.prototype._doesCharSupportLocalGlyph = function(t) {
                        return !!this.localIdeographFontFamily && (e.isChar["CJK Unified Ideographs"](t) || e.isChar["Hangul Syllables"](t) || e.isChar.Hiragana(t) || e.isChar.Katakana(t))
                    }
                    ,
                    _.prototype._tinySDF = function(t, i, r) {
                        var n = this.localIdeographFontFamily;
                        if (n && this._doesCharSupportLocalGlyph(r)) {
                            var a = t.tinySDF;
                            if (!a) {
                                var o = "400";
                                /bold/i.test(i) ? o = "900" : /medium/i.test(i) ? o = "500" : /light/i.test(i) && (o = "200"),
                                a = t.tinySDF = new _.TinySDF(24,3,8,.25,n,o)
                            }
                            return {
                                id: r,
                                bitmap: new e.AlphaImage({
                                    width: 30,
                                    height: 30
                                },a.draw(String.fromCharCode(r))),
                                metrics: {
                                    width: 24,
                                    height: 24,
                                    left: 0,
                                    top: -8,
                                    advance: 24
                                }
                            }
                        }
                    }
                    ,
                    _.loadGlyphRange = function(t, i, r, n, a) {
                        var o = 256 * i
                          , s = o + 255
                          , l = n.transformRequest(n.normalizeGlyphsURL(r).replace("{fontstack}", t).replace("{range}", o + "-" + s), e.ResourceType.Glyphs);
                        e.getArrayBuffer(l, (function(t, i) {
                            if (t)
                                a(t);
                            else if (i) {
                                for (var r = {}, n = 0, o = e.parseGlyphPBF(i); n < o.length; n += 1) {
                                    var s = o[n];
                                    r[s.id] = s
                                }
                                a(null, r)
                            }
                        }
                        ))
                    }
                    ,
                    _.TinySDF = f;
                    var x = function() {
                        this.specification = e.styleSpec.light.position
                    };
                    x.prototype.possiblyEvaluate = function(t, i) {
                        return e.sphericalToCartesian(t.expression.evaluate(i))
                    }
                    ,
                    x.prototype.interpolate = function(t, i, r) {
                        return {
                            x: e.number(t.x, i.x, r),
                            y: e.number(t.y, i.y, r),
                            z: e.number(t.z, i.z, r)
                        }
                    }
                    ;
                    var b = new e.Properties({
                        anchor: new e.DataConstantProperty(e.styleSpec.light.anchor),
                        position: new x,
                        color: new e.DataConstantProperty(e.styleSpec.light.color),
                        intensity: new e.DataConstantProperty(e.styleSpec.light.intensity)
                    })
                      , w = function(t) {
                        function i(i) {
                            t.call(this),
                            this._transitionable = new e.Transitionable(b),
                            this.setLight(i),
                            this._transitioning = this._transitionable.untransitioned()
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.getLight = function() {
                            return this._transitionable.serialize()
                        }
                        ,
                        i.prototype.setLight = function(t, i) {
                            if (void 0 === i && (i = {}),
                            !this._validate(e.validateLight, t, i))
                                for (var r in t) {
                                    var n = t[r];
                                    e.endsWith(r, "-transition") ? this._transitionable.setTransition(r.slice(0, -"-transition".length), n) : this._transitionable.setValue(r, n)
                                }
                        }
                        ,
                        i.prototype.updateTransitions = function(e) {
                            this._transitioning = this._transitionable.transitioned(e, this._transitioning)
                        }
                        ,
                        i.prototype.hasTransition = function() {
                            return this._transitioning.hasTransition()
                        }
                        ,
                        i.prototype.recalculate = function(e) {
                            this.properties = this._transitioning.possiblyEvaluate(e)
                        }
                        ,
                        i.prototype._validate = function(t, i, r) {
                            return (!r || !1 !== r.validate) && e.emitValidationErrors(this, t.call(e.validateStyle, e.extend({
                                value: i,
                                style: {
                                    glyphs: !0,
                                    sprite: !0
                                },
                                styleSpec: e.styleSpec
                            })))
                        }
                        ,
                        i
                    }(e.Evented)
                      , S = function(e, t) {
                        this.width = e,
                        this.height = t,
                        this.nextRow = 0,
                        this.data = new Uint8Array(this.width * this.height),
                        this.dashEntry = {}
                    };
                    S.prototype.getDash = function(e, t) {
                        var i = e.join(",") + String(t);
                        return this.dashEntry[i] || (this.dashEntry[i] = this.addDash(e, t)),
                        this.dashEntry[i]
                    }
                    ,
                    S.prototype.getDashRanges = function(e, t, i) {
                        var r = []
                          , n = e.length % 2 == 1 ? -e[e.length - 1] * i : 0
                          , a = e[0] * i
                          , o = !0;
                        r.push({
                            left: n,
                            right: a,
                            isDash: o,
                            zeroLength: 0 === e[0]
                        });
                        for (var s = e[0], l = 1; l < e.length; l++) {
                            var u = e[l];
                            r.push({
                                left: n = s * i,
                                right: a = (s += u) * i,
                                isDash: o = !o,
                                zeroLength: 0 === u
                            })
                        }
                        return r
                    }
                    ,
                    S.prototype.addRoundDash = function(e, t, i) {
                        for (var r = t / 2, n = -i; n <= i; n++)
                            for (var a = this.width * (this.nextRow + i + n), o = 0, s = e[o], l = 0; l < this.width; l++) {
                                l / s.right > 1 && (s = e[++o]);
                                var u = Math.abs(l - s.left)
                                  , c = Math.abs(l - s.right)
                                  , h = Math.min(u, c)
                                  , p = void 0
                                  , f = n / i * (r + 1);
                                if (s.isDash) {
                                    var d = r - Math.abs(f);
                                    p = Math.sqrt(h * h + d * d)
                                } else
                                    p = r - Math.sqrt(h * h + f * f);
                                this.data[a + l] = Math.max(0, Math.min(255, p + 128))
                            }
                    }
                    ,
                    S.prototype.addRegularDash = function(e) {
                        for (var t = e.length - 1; t >= 0; --t) {
                            var i = e[t]
                              , r = e[t + 1];
                            i.zeroLength ? e.splice(t, 1) : r && r.isDash === i.isDash && (r.left = i.left,
                            e.splice(t, 1))
                        }
                        var n = e[0]
                          , a = e[e.length - 1];
                        n.isDash === a.isDash && (n.left = a.left - this.width,
                        a.right = n.right + this.width);
                        for (var o = this.width * this.nextRow, s = 0, l = e[s], u = 0; u < this.width; u++) {
                            u / l.right > 1 && (l = e[++s]);
                            var c = Math.abs(u - l.left)
                              , h = Math.abs(u - l.right)
                              , p = Math.min(c, h);
                            this.data[o + u] = Math.max(0, Math.min(255, (l.isDash ? p : -p) + 128))
                        }
                    }
                    ,
                    S.prototype.addDash = function(t, i) {
                        var r = i ? 7 : 0
                          , n = 2 * r + 1;
                        if (this.nextRow + n > this.height)
                            return e.warnOnce("LineAtlas out of space"),
                            null;
                        for (var a = 0, o = 0; o < t.length; o++)
                            a += t[o];
                        if (0 !== a) {
                            var s = this.width / a
                              , l = this.getDashRanges(t, this.width, s);
                            i ? this.addRoundDash(l, s, r) : this.addRegularDash(l)
                        }
                        var u = {
                            y: (this.nextRow + r + .5) / this.height,
                            height: 2 * r / this.height,
                            width: a
                        };
                        return this.nextRow += n,
                        this.dirty = !0,
                        u
                    }
                    ,
                    S.prototype.bind = function(e) {
                        var t = e.gl;
                        this.texture ? (t.bindTexture(t.TEXTURE_2D, this.texture),
                        this.dirty && (this.dirty = !1,
                        t.texSubImage2D(t.TEXTURE_2D, 0, 0, 0, this.width, this.height, t.ALPHA, t.UNSIGNED_BYTE, this.data))) : (this.texture = t.createTexture(),
                        t.bindTexture(t.TEXTURE_2D, this.texture),
                        t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.REPEAT),
                        t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.REPEAT),
                        t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, t.LINEAR),
                        t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, t.LINEAR),
                        t.texImage2D(t.TEXTURE_2D, 0, t.ALPHA, this.width, this.height, 0, t.ALPHA, t.UNSIGNED_BYTE, this.data))
                    }
                    ;
                    var M = function t(i, r) {
                        this.workerPool = i,
                        this.actors = [],
                        this.currentActor = 0,
                        this.id = e.uniqueId();
                        for (var n = this.workerPool.acquire(this.id), a = 0; a < n.length; a++) {
                            var o = new t.Actor(n[a],r,this.id);
                            o.name = "Worker " + a,
                            this.actors.push(o)
                        }
                    };
                    function T(t, i, r) {
                        var n = function(n, a) {
                            if (n)
                                return r(n);
                            if (a) {
                                var o = e.pick(e.extend(a, t), ["tiles", "minzoom", "maxzoom", "attribution", "mapbox_logo", "bounds", "scheme", "tileSize", "encoding"]);
                                a.vector_layers && (o.vectorLayers = a.vector_layers,
                                o.vectorLayerIds = o.vectorLayers.map((function(e) {
                                    return e.id
                                }
                                ))),
                                o.tiles = i.canonicalizeTileset(o, t.url),
                                r(null, o)
                            }
                        };
                        return t.url ? e.getJSON(i.transformRequest(i.normalizeSourceURL(t.url), e.ResourceType.Source), n) : e.browser.frame((function() {
                            return n(null, t)
                        }
                        ))
                    }
                    M.prototype.broadcast = function(t, i, r) {
                        e.asyncAll(this.actors, (function(e, r) {
                            e.send(t, i, r)
                        }
                        ), r = r || function() {}
                        )
                    }
                    ,
                    M.prototype.getActor = function() {
                        return this.currentActor = (this.currentActor + 1) % this.actors.length,
                        this.actors[this.currentActor]
                    }
                    ,
                    M.prototype.remove = function() {
                        this.actors.forEach((function(e) {
                            e.remove()
                        }
                        )),
                        this.actors = [],
                        this.workerPool.release(this.id)
                    }
                    ,
                    M.Actor = e.Actor;
                    var E = function(t, i, r) {
                        this.bounds = e.LngLatBounds.convert(this.validateBounds(t)),
                        this.minzoom = i || 0,
                        this.maxzoom = r || 24
                    };
                    E.prototype.validateBounds = function(e) {
                        return Array.isArray(e) && 4 === e.length ? [Math.max(-180, e[0]), Math.max(-90, e[1]), Math.min(180, e[2]), Math.min(90, e[3])] : [-180, -90, 180, 90]
                    }
                    ,
                    E.prototype.contains = function(t) {
                        var i = Math.pow(2, t.z)
                          , r = Math.floor(e.mercatorXfromLng(this.bounds.getWest()) * i)
                          , n = Math.floor(e.mercatorYfromLat(this.bounds.getNorth()) * i)
                          , a = Math.ceil(e.mercatorXfromLng(this.bounds.getEast()) * i)
                          , o = Math.ceil(e.mercatorYfromLat(this.bounds.getSouth()) * i);
                        return t.x >= r && t.x < a && t.y >= n && t.y < o
                    }
                    ;
                    var A = function(t) {
                        function i(i, r, n, a) {
                            if (t.call(this),
                            this.id = i,
                            this.dispatcher = n,
                            this.type = "vector",
                            this.minzoom = 0,
                            this.maxzoom = 22,
                            this.scheme = "xyz",
                            this.tileSize = 512,
                            this.reparseOverscaled = !0,
                            this.isTileClipped = !0,
                            this._loaded = !1,
                            e.extend(this, e.pick(r, ["url", "scheme", "tileSize", "promoteId"])),
                            this._options = e.extend({
                                type: "vector"
                            }, r),
                            this._collectResourceTiming = r.collectResourceTiming,
                            512 !== this.tileSize)
                                throw new Error("vector tile sources must have a tileSize of 512");
                            this.setEventedParent(a)
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.load = function() {
                            var t = this;
                            this._loaded = !1,
                            this.fire(new e.Event("dataloading",{
                                dataType: "source"
                            })),
                            this._tileJSONRequest = T(this._options, this.map._requestManager, (function(i, r) {
                                t._tileJSONRequest = null,
                                t._loaded = !0,
                                i ? t.fire(new e.ErrorEvent(i)) : r && (e.extend(t, r),
                                r.bounds && (t.tileBounds = new E(r.bounds,t.minzoom,t.maxzoom)),
                                e.postTurnstileEvent(r.tiles, t.map._requestManager._customAccessToken),
                                e.postMapLoadEvent(r.tiles, t.map._getMapId(), t.map._requestManager._skuToken, t.map._requestManager._customAccessToken),
                                t.fire(new e.Event("data",{
                                    dataType: "source",
                                    sourceDataType: "metadata"
                                })),
                                t.fire(new e.Event("data",{
                                    dataType: "source",
                                    sourceDataType: "content"
                                })))
                            }
                            ))
                        }
                        ,
                        i.prototype.loaded = function() {
                            return this._loaded
                        }
                        ,
                        i.prototype.hasTile = function(e) {
                            return !this.tileBounds || this.tileBounds.contains(e.canonical)
                        }
                        ,
                        i.prototype.onAdd = function(e) {
                            this.map = e,
                            this.load()
                        }
                        ,
                        i.prototype.setSourceProperty = function(e) {
                            this._tileJSONRequest && this._tileJSONRequest.cancel(),
                            e(),
                            this.map.style.sourceCaches[this.id].clearTiles(),
                            this.load()
                        }
                        ,
                        i.prototype.setTiles = function(e) {
                            var t = this;
                            return this.setSourceProperty((function() {
                                t._options.tiles = e
                            }
                            )),
                            this
                        }
                        ,
                        i.prototype.setUrl = function(e) {
                            var t = this;
                            return this.setSourceProperty((function() {
                                t.url = e,
                                t._options.url = e
                            }
                            )),
                            this
                        }
                        ,
                        i.prototype.onRemove = function() {
                            this._tileJSONRequest && (this._tileJSONRequest.cancel(),
                            this._tileJSONRequest = null)
                        }
                        ,
                        i.prototype.serialize = function() {
                            return e.extend({}, this._options)
                        }
                        ,
                        i.prototype.loadTile = function(t, i) {
                            var r = this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles, this.scheme))
                              , n = {
                                request: this.map._requestManager.transformRequest(r, e.ResourceType.Tile),
                                uid: t.uid,
                                tileID: t.tileID,
                                zoom: t.tileID.overscaledZ,
                                tileSize: this.tileSize * t.tileID.overscaleFactor(),
                                type: this.type,
                                source: this.id,
                                pixelRatio: e.browser.devicePixelRatio,
                                showCollisionBoxes: this.map.showCollisionBoxes,
                                promoteId: this.promoteId
                            };
                            function a(r, n) {
                                return delete t.request,
                                t.aborted ? i(null) : r && 404 !== r.status ? i(r) : (n && n.resourceTiming && (t.resourceTiming = n.resourceTiming),
                                this.map._refreshExpiredTiles && n && t.setExpiryData(n),
                                t.loadVectorData(n, this.map.painter),
                                e.cacheEntryPossiblyAdded(this.dispatcher),
                                i(null),
                                void (t.reloadCallback && (this.loadTile(t, t.reloadCallback),
                                t.reloadCallback = null)))
                            }
                            n.request.collectResourceTiming = this._collectResourceTiming,
                            t.actor && "expired" !== t.state ? "loading" === t.state ? t.reloadCallback = i : t.request = t.actor.send("reloadTile", n, a.bind(this)) : (t.actor = this.dispatcher.getActor(),
                            t.request = t.actor.send("loadTile", n, a.bind(this)))
                        }
                        ,
                        i.prototype.abortTile = function(e) {
                            e.request && (e.request.cancel(),
                            delete e.request),
                            e.actor && e.actor.send("abortTile", {
                                uid: e.uid,
                                type: this.type,
                                source: this.id
                            }, void 0)
                        }
                        ,
                        i.prototype.unloadTile = function(e) {
                            e.unloadVectorData(),
                            e.actor && e.actor.send("removeTile", {
                                uid: e.uid,
                                type: this.type,
                                source: this.id
                            }, void 0)
                        }
                        ,
                        i.prototype.hasTransition = function() {
                            return !1
                        }
                        ,
                        i
                    }(e.Evented)
                      , P = function(t) {
                        function i(i, r, n, a) {
                            t.call(this),
                            this.id = i,
                            this.dispatcher = n,
                            this.setEventedParent(a),
                            this.type = "raster",
                            this.minzoom = 0,
                            this.maxzoom = 22,
                            this.roundZoom = !0,
                            this.scheme = "xyz",
                            this.tileSize = 512,
                            this._loaded = !1,
                            this._options = e.extend({
                                type: "raster"
                            }, r),
                            e.extend(this, e.pick(r, ["url", "scheme", "tileSize"]))
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.load = function() {
                            var t = this;
                            this._loaded = !1,
                            this.fire(new e.Event("dataloading",{
                                dataType: "source"
                            })),
                            this._tileJSONRequest = T(this._options, this.map._requestManager, (function(i, r) {
                                t._tileJSONRequest = null,
                                t._loaded = !0,
                                i ? t.fire(new e.ErrorEvent(i)) : r && (e.extend(t, r),
                                r.bounds && (t.tileBounds = new E(r.bounds,t.minzoom,t.maxzoom)),
                                e.postTurnstileEvent(r.tiles),
                                e.postMapLoadEvent(r.tiles, t.map._getMapId(), t.map._requestManager._skuToken),
                                t.fire(new e.Event("data",{
                                    dataType: "source",
                                    sourceDataType: "metadata"
                                })),
                                t.fire(new e.Event("data",{
                                    dataType: "source",
                                    sourceDataType: "content"
                                })))
                            }
                            ))
                        }
                        ,
                        i.prototype.loaded = function() {
                            return this._loaded
                        }
                        ,
                        i.prototype.onAdd = function(e) {
                            this.map = e,
                            this.load()
                        }
                        ,
                        i.prototype.onRemove = function() {
                            this._tileJSONRequest && (this._tileJSONRequest.cancel(),
                            this._tileJSONRequest = null)
                        }
                        ,
                        i.prototype.serialize = function() {
                            return e.extend({}, this._options)
                        }
                        ,
                        i.prototype.hasTile = function(e) {
                            return !this.tileBounds || this.tileBounds.contains(e.canonical)
                        }
                        ,
                        i.prototype.loadTile = function(t, i) {
                            var r = this
                              , n = this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles, this.scheme), this.tileSize);
                            t.request = e.getImage(this.map._requestManager.transformRequest(n, e.ResourceType.Tile), (function(n, a) {
                                if (delete t.request,
                                t.aborted)
                                    t.state = "unloaded",
                                    i(null);
                                else if (n)
                                    t.state = "errored",
                                    i(n);
                                else if (a) {
                                    r.map._refreshExpiredTiles && t.setExpiryData(a),
                                    delete a.cacheControl,
                                    delete a.expires;
                                    var o = r.map.painter.context
                                      , s = o.gl;
                                    t.texture = r.map.painter.getTileTexture(a.width),
                                    t.texture ? t.texture.update(a, {
                                        useMipmap: !0
                                    }) : (t.texture = new e.Texture(o,a,s.RGBA,{
                                        useMipmap: !0
                                    }),
                                    t.texture.bind(s.LINEAR, s.CLAMP_TO_EDGE, s.LINEAR_MIPMAP_NEAREST),
                                    o.extTextureFilterAnisotropic && s.texParameterf(s.TEXTURE_2D, o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, o.extTextureFilterAnisotropicMax)),
                                    t.state = "loaded",
                                    e.cacheEntryPossiblyAdded(r.dispatcher),
                                    i(null)
                                }
                            }
                            ))
                        }
                        ,
                        i.prototype.abortTile = function(e, t) {
                            e.request && (e.request.cancel(),
                            delete e.request),
                            t()
                        }
                        ,
                        i.prototype.unloadTile = function(e, t) {
                            e.texture && this.map.painter.saveTileTexture(e.texture),
                            t()
                        }
                        ,
                        i.prototype.hasTransition = function() {
                            return !1
                        }
                        ,
                        i
                    }(e.Evented)
                      , C = function(t) {
                        function i(i, r, n, a) {
                            t.call(this, i, r, n, a),
                            this.type = "raster-dem",
                            this.maxzoom = 22,
                            this._options = e.extend({
                                type: "raster-dem"
                            }, r),
                            this.encoding = r.encoding || "mapbox"
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.serialize = function() {
                            return {
                                type: "raster-dem",
                                url: this.url,
                                tileSize: this.tileSize,
                                tiles: this.tiles,
                                bounds: this.bounds,
                                encoding: this.encoding
                            }
                        }
                        ,
                        i.prototype.loadTile = function(t, i) {
                            var r = this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles, this.scheme), this.tileSize);
                            function n(e, r) {
                                e && (t.state = "errored",
                                i(e)),
                                r && (t.dem = r,
                                t.needsHillshadePrepare = !0,
                                t.state = "loaded",
                                i(null))
                            }
                            t.request = e.getImage(this.map._requestManager.transformRequest(r, e.ResourceType.Tile), function(r, a) {
                                if (delete t.request,
                                t.aborted)
                                    t.state = "unloaded",
                                    i(null);
                                else if (r)
                                    t.state = "errored",
                                    i(r);
                                else if (a) {
                                    this.map._refreshExpiredTiles && t.setExpiryData(a),
                                    delete a.cacheControl,
                                    delete a.expires;
                                    var o = e.window.ImageBitmap && a instanceof e.window.ImageBitmap && e.offscreenCanvasSupported() ? a : e.browser.getImageData(a, 1)
                                      , s = {
                                        uid: t.uid,
                                        coord: t.tileID,
                                        source: this.id,
                                        rawImageData: o,
                                        encoding: this.encoding
                                    };
                                    t.actor && "expired" !== t.state || (t.actor = this.dispatcher.getActor(),
                                    t.actor.send("loadDEMTile", s, n.bind(this)))
                                }
                            }
                            .bind(this)),
                            t.neighboringTiles = this._getNeighboringTiles(t.tileID)
                        }
                        ,
                        i.prototype._getNeighboringTiles = function(t) {
                            var i = t.canonical
                              , r = Math.pow(2, i.z)
                              , n = (i.x - 1 + r) % r
                              , a = 0 === i.x ? t.wrap - 1 : t.wrap
                              , o = (i.x + 1 + r) % r
                              , s = i.x + 1 === r ? t.wrap + 1 : t.wrap
                              , l = {};
                            return l[new e.OverscaledTileID(t.overscaledZ,a,i.z,n,i.y).key] = {
                                backfilled: !1
                            },
                            l[new e.OverscaledTileID(t.overscaledZ,s,i.z,o,i.y).key] = {
                                backfilled: !1
                            },
                            i.y > 0 && (l[new e.OverscaledTileID(t.overscaledZ,a,i.z,n,i.y - 1).key] = {
                                backfilled: !1
                            },
                            l[new e.OverscaledTileID(t.overscaledZ,t.wrap,i.z,i.x,i.y - 1).key] = {
                                backfilled: !1
                            },
                            l[new e.OverscaledTileID(t.overscaledZ,s,i.z,o,i.y - 1).key] = {
                                backfilled: !1
                            }),
                            i.y + 1 < r && (l[new e.OverscaledTileID(t.overscaledZ,a,i.z,n,i.y + 1).key] = {
                                backfilled: !1
                            },
                            l[new e.OverscaledTileID(t.overscaledZ,t.wrap,i.z,i.x,i.y + 1).key] = {
                                backfilled: !1
                            },
                            l[new e.OverscaledTileID(t.overscaledZ,s,i.z,o,i.y + 1).key] = {
                                backfilled: !1
                            }),
                            l
                        }
                        ,
                        i.prototype.unloadTile = function(e) {
                            e.demTexture && this.map.painter.saveTileTexture(e.demTexture),
                            e.fbo && (e.fbo.destroy(),
                            delete e.fbo),
                            e.dem && delete e.dem,
                            delete e.neighboringTiles,
                            e.state = "unloaded",
                            e.actor && e.actor.send("removeDEMTile", {
                                uid: e.uid,
                                source: this.id
                            })
                        }
                        ,
                        i
                    }(P)
                      , L = function(t) {
                        function i(i, r, n, a) {
                            t.call(this),
                            this.id = i,
                            this.type = "geojson",
                            this.minzoom = 0,
                            this.maxzoom = 18,
                            this.tileSize = 512,
                            this.isTileClipped = !0,
                            this.reparseOverscaled = !0,
                            this._removed = !1,
                            this._loaded = !1,
                            this.actor = n.getActor(),
                            this.setEventedParent(a),
                            this._data = r.data,
                            this._options = e.extend({}, r),
                            this._collectResourceTiming = r.collectResourceTiming,
                            this._resourceTiming = [],
                            void 0 !== r.maxzoom && (this.maxzoom = r.maxzoom),
                            r.type && (this.type = r.type),
                            r.attribution && (this.attribution = r.attribution),
                            this.promoteId = r.promoteId;
                            var o = e.EXTENT / this.tileSize;
                            this.workerOptions = e.extend({
                                source: this.id,
                                cluster: r.cluster || !1,
                                geojsonVtOptions: {
                                    buffer: (void 0 !== r.buffer ? r.buffer : 128) * o,
                                    tolerance: (void 0 !== r.tolerance ? r.tolerance : .375) * o,
                                    extent: e.EXTENT,
                                    maxZoom: this.maxzoom,
                                    lineMetrics: r.lineMetrics || !1,
                                    generateId: r.generateId || !1
                                },
                                superclusterOptions: {
                                    maxZoom: void 0 !== r.clusterMaxZoom ? Math.min(r.clusterMaxZoom, this.maxzoom - 1) : this.maxzoom - 1,
                                    minPoints: Math.max(2, r.clusterMinPoints || 2),
                                    extent: e.EXTENT,
                                    radius: (r.clusterRadius || 50) * o,
                                    log: !1,
                                    generateId: r.generateId || !1
                                },
                                clusterProperties: r.clusterProperties,
                                filter: r.filter
                            }, r.workerOptions)
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.load = function() {
                            var t = this;
                            this.fire(new e.Event("dataloading",{
                                dataType: "source"
                            })),
                            this._updateWorkerData((function(i) {
                                if (i)
                                    t.fire(new e.ErrorEvent(i));
                                else {
                                    var r = {
                                        dataType: "source",
                                        sourceDataType: "metadata"
                                    };
                                    t._collectResourceTiming && t._resourceTiming && t._resourceTiming.length > 0 && (r.resourceTiming = t._resourceTiming,
                                    t._resourceTiming = []),
                                    t.fire(new e.Event("data",r))
                                }
                            }
                            ))
                        }
                        ,
                        i.prototype.onAdd = function(e) {
                            this.map = e,
                            this.load()
                        }
                        ,
                        i.prototype.setData = function(t) {
                            var i = this;
                            return this._data = t,
                            this.fire(new e.Event("dataloading",{
                                dataType: "source"
                            })),
                            this._updateWorkerData((function(t) {
                                if (t)
                                    i.fire(new e.ErrorEvent(t));
                                else {
                                    var r = {
                                        dataType: "source",
                                        sourceDataType: "content"
                                    };
                                    i._collectResourceTiming && i._resourceTiming && i._resourceTiming.length > 0 && (r.resourceTiming = i._resourceTiming,
                                    i._resourceTiming = []),
                                    i.fire(new e.Event("data",r))
                                }
                            }
                            )),
                            this
                        }
                        ,
                        i.prototype.getClusterExpansionZoom = function(e, t) {
                            return this.actor.send("geojson.getClusterExpansionZoom", {
                                clusterId: e,
                                source: this.id
                            }, t),
                            this
                        }
                        ,
                        i.prototype.getClusterChildren = function(e, t) {
                            return this.actor.send("geojson.getClusterChildren", {
                                clusterId: e,
                                source: this.id
                            }, t),
                            this
                        }
                        ,
                        i.prototype.getClusterLeaves = function(e, t, i, r) {
                            return this.actor.send("geojson.getClusterLeaves", {
                                source: this.id,
                                clusterId: e,
                                limit: t,
                                offset: i
                            }, r),
                            this
                        }
                        ,
                        i.prototype._updateWorkerData = function(t) {
                            var i = this;
                            this._loaded = !1;
                            var r = e.extend({}, this.workerOptions)
                              , n = this._data;
                            "string" == typeof n ? (r.request = this.map._requestManager.transformRequest(e.browser.resolveURL(n), e.ResourceType.Source),
                            r.request.collectResourceTiming = this._collectResourceTiming) : r.data = JSON.stringify(n),
                            this.actor.send(this.type + ".loadData", r, (function(e, n) {
                                i._removed || n && n.abandoned || (i._loaded = !0,
                                n && n.resourceTiming && n.resourceTiming[i.id] && (i._resourceTiming = n.resourceTiming[i.id].slice(0)),
                                i.actor.send(i.type + ".coalesce", {
                                    source: r.source
                                }, null),
                                t(e))
                            }
                            ))
                        }
                        ,
                        i.prototype.loaded = function() {
                            return this._loaded
                        }
                        ,
                        i.prototype.loadTile = function(t, i) {
                            var r = this
                              , n = t.actor ? "reloadTile" : "loadTile";
                            t.actor = this.actor,
                            t.request = this.actor.send(n, {
                                type: this.type,
                                uid: t.uid,
                                tileID: t.tileID,
                                zoom: t.tileID.overscaledZ,
                                maxZoom: this.maxzoom,
                                tileSize: this.tileSize,
                                source: this.id,
                                pixelRatio: e.browser.devicePixelRatio,
                                showCollisionBoxes: this.map.showCollisionBoxes,
                                promoteId: this.promoteId
                            }, (function(e, a) {
                                return delete t.request,
                                t.unloadVectorData(),
                                t.aborted ? i(null) : e ? i(e) : (t.loadVectorData(a, r.map.painter, "reloadTile" === n),
                                i(null))
                            }
                            ))
                        }
                        ,
                        i.prototype.abortTile = function(e) {
                            e.request && (e.request.cancel(),
                            delete e.request),
                            e.aborted = !0
                        }
                        ,
                        i.prototype.unloadTile = function(e) {
                            e.unloadVectorData(),
                            this.actor.send("removeTile", {
                                uid: e.uid,
                                type: this.type,
                                source: this.id
                            })
                        }
                        ,
                        i.prototype.onRemove = function() {
                            this._removed = !0,
                            this.actor.send("removeSource", {
                                type: this.type,
                                source: this.id
                            })
                        }
                        ,
                        i.prototype.serialize = function() {
                            return e.extend({}, this._options, {
                                type: this.type,
                                data: this._data
                            })
                        }
                        ,
                        i.prototype.hasTransition = function() {
                            return !1
                        }
                        ,
                        i
                    }(e.Evented)
                      , I = e.createLayout([{
                        name: "a_pos",
                        type: "Int16",
                        components: 2
                    }, {
                        name: "a_texture_pos",
                        type: "Int16",
                        components: 2
                    }])
                      , k = function(t) {
                        function i(e, i, r, n) {
                            t.call(this),
                            this.id = e,
                            this.dispatcher = r,
                            this.coordinates = i.coordinates,
                            this.type = "image",
                            this.minzoom = 0,
                            this.maxzoom = 22,
                            this.tileSize = 512,
                            this.tiles = {},
                            this._loaded = !1,
                            this.setEventedParent(n),
                            this.options = i
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.load = function(t, i) {
                            var r = this;
                            this._loaded = !1,
                            this.fire(new e.Event("dataloading",{
                                dataType: "source"
                            })),
                            this.url = this.options.url,
                            e.getImage(this.map._requestManager.transformRequest(this.url, e.ResourceType.Image), (function(n, a) {
                                r._loaded = !0,
                                n ? r.fire(new e.ErrorEvent(n)) : a && (r.image = a,
                                t && (r.coordinates = t),
                                i && i(),
                                r._finishLoading())
                            }
                            ))
                        }
                        ,
                        i.prototype.loaded = function() {
                            return this._loaded
                        }
                        ,
                        i.prototype.updateImage = function(e) {
                            var t = this;
                            return this.image && e.url ? (this.options.url = e.url,
                            this.load(e.coordinates, (function() {
                                t.texture = null
                            }
                            )),
                            this) : this
                        }
                        ,
                        i.prototype._finishLoading = function() {
                            this.map && (this.setCoordinates(this.coordinates),
                            this.fire(new e.Event("data",{
                                dataType: "source",
                                sourceDataType: "metadata"
                            })))
                        }
                        ,
                        i.prototype.onAdd = function(e) {
                            this.map = e,
                            this.load()
                        }
                        ,
                        i.prototype.setCoordinates = function(t) {
                            var i = this;
                            this.coordinates = t;
                            var r = t.map(e.MercatorCoordinate.fromLngLat);
                            this.tileID = function(t) {
                                for (var i = 1 / 0, r = 1 / 0, n = -1 / 0, a = -1 / 0, o = 0, s = t; o < s.length; o += 1) {
                                    var l = s[o];
                                    i = Math.min(i, l.x),
                                    r = Math.min(r, l.y),
                                    n = Math.max(n, l.x),
                                    a = Math.max(a, l.y)
                                }
                                var u = Math.max(n - i, a - r)
                                  , c = Math.max(0, Math.floor(-Math.log(u) / Math.LN2))
                                  , h = Math.pow(2, c);
                                return new e.CanonicalTileID(c,Math.floor((i + n) / 2 * h),Math.floor((r + a) / 2 * h))
                            }(r),
                            this.minzoom = this.maxzoom = this.tileID.z;
                            var n = r.map((function(e) {
                                return i.tileID.getTilePoint(e)._round()
                            }
                            ));
                            return this._boundsArray = new e.StructArrayLayout4i8,
                            this._boundsArray.emplaceBack(n[0].x, n[0].y, 0, 0),
                            this._boundsArray.emplaceBack(n[1].x, n[1].y, e.EXTENT, 0),
                            this._boundsArray.emplaceBack(n[3].x, n[3].y, 0, e.EXTENT),
                            this._boundsArray.emplaceBack(n[2].x, n[2].y, e.EXTENT, e.EXTENT),
                            this.boundsBuffer && (this.boundsBuffer.destroy(),
                            delete this.boundsBuffer),
                            this.fire(new e.Event("data",{
                                dataType: "source",
                                sourceDataType: "content"
                            })),
                            this
                        }
                        ,
                        i.prototype.prepare = function() {
                            if (0 !== Object.keys(this.tiles).length && this.image) {
                                var t = this.map.painter.context
                                  , i = t.gl;
                                for (var r in this.boundsBuffer || (this.boundsBuffer = t.createVertexBuffer(this._boundsArray, I.members)),
                                this.boundsSegments || (this.boundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2)),
                                this.texture || (this.texture = new e.Texture(t,this.image,i.RGBA),
                                this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE)),
                                this.tiles) {
                                    var n = this.tiles[r];
                                    "loaded" !== n.state && (n.state = "loaded",
                                    n.texture = this.texture)
                                }
                            }
                        }
                        ,
                        i.prototype.loadTile = function(e, t) {
                            this.tileID && this.tileID.equals(e.tileID.canonical) ? (this.tiles[String(e.tileID.wrap)] = e,
                            e.buckets = {},
                            t(null)) : (e.state = "errored",
                            t(null))
                        }
                        ,
                        i.prototype.serialize = function() {
                            return {
                                type: "image",
                                url: this.options.url,
                                coordinates: this.coordinates
                            }
                        }
                        ,
                        i.prototype.hasTransition = function() {
                            return !1
                        }
                        ,
                        i
                    }(e.Evented)
                      , z = function(t) {
                        function i(e, i, r, n) {
                            t.call(this, e, i, r, n),
                            this.roundZoom = !0,
                            this.type = "video",
                            this.options = i
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.load = function() {
                            var t = this;
                            this._loaded = !1;
                            var i = this.options;
                            this.urls = [];
                            for (var r = 0, n = i.urls; r < n.length; r += 1)
                                this.urls.push(this.map._requestManager.transformRequest(n[r], e.ResourceType.Source).url);
                            e.getVideo(this.urls, (function(i, r) {
                                t._loaded = !0,
                                i ? t.fire(new e.ErrorEvent(i)) : r && (t.video = r,
                                t.video.loop = !0,
                                t.video.addEventListener("playing", (function() {
                                    t.map.triggerRepaint()
                                }
                                )),
                                t.map && t.video.play(),
                                t._finishLoading())
                            }
                            ))
                        }
                        ,
                        i.prototype.pause = function() {
                            this.video && this.video.pause()
                        }
                        ,
                        i.prototype.play = function() {
                            this.video && this.video.play()
                        }
                        ,
                        i.prototype.seek = function(t) {
                            if (this.video) {
                                var i = this.video.seekable;
                                t < i.start(0) || t > i.end(0) ? this.fire(new e.ErrorEvent(new e.ValidationError("sources." + this.id,null,"Playback for this video can be set only between the " + i.start(0) + " and " + i.end(0) + "-second mark."))) : this.video.currentTime = t
                            }
                        }
                        ,
                        i.prototype.getVideo = function() {
                            return this.video
                        }
                        ,
                        i.prototype.onAdd = function(e) {
                            this.map || (this.map = e,
                            this.load(),
                            this.video && (this.video.play(),
                            this.setCoordinates(this.coordinates)))
                        }
                        ,
                        i.prototype.prepare = function() {
                            if (!(0 === Object.keys(this.tiles).length || this.video.readyState < 2)) {
                                var t = this.map.painter.context
                                  , i = t.gl;
                                for (var r in this.boundsBuffer || (this.boundsBuffer = t.createVertexBuffer(this._boundsArray, I.members)),
                                this.boundsSegments || (this.boundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2)),
                                this.texture ? this.video.paused || (this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE),
                                i.texSubImage2D(i.TEXTURE_2D, 0, 0, 0, i.RGBA, i.UNSIGNED_BYTE, this.video)) : (this.texture = new e.Texture(t,this.video,i.RGBA),
                                this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE)),
                                this.tiles) {
                                    var n = this.tiles[r];
                                    "loaded" !== n.state && (n.state = "loaded",
                                    n.texture = this.texture)
                                }
                            }
                        }
                        ,
                        i.prototype.serialize = function() {
                            return {
                                type: "video",
                                urls: this.urls,
                                coordinates: this.coordinates
                            }
                        }
                        ,
                        i.prototype.hasTransition = function() {
                            return this.video && !this.video.paused
                        }
                        ,
                        i
                    }(k)
                      , D = function(t) {
                        function i(i, r, n, a) {
                            t.call(this, i, r, n, a),
                            r.coordinates ? Array.isArray(r.coordinates) && 4 === r.coordinates.length && !r.coordinates.some((function(e) {
                                return !Array.isArray(e) || 2 !== e.length || e.some((function(e) {
                                    return "number" != typeof e
                                }
                                ))
                            }
                            )) || this.fire(new e.ErrorEvent(new e.ValidationError("sources." + i,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))) : this.fire(new e.ErrorEvent(new e.ValidationError("sources." + i,null,'missing required property "coordinates"'))),
                            r.animate && "boolean" != typeof r.animate && this.fire(new e.ErrorEvent(new e.ValidationError("sources." + i,null,'optional "animate" property must be a boolean value'))),
                            r.canvas ? "string" == typeof r.canvas || r.canvas instanceof e.window.HTMLCanvasElement || this.fire(new e.ErrorEvent(new e.ValidationError("sources." + i,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))) : this.fire(new e.ErrorEvent(new e.ValidationError("sources." + i,null,'missing required property "canvas"'))),
                            this.options = r,
                            this.animate = void 0 === r.animate || r.animate
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.load = function() {
                            this._loaded = !0,
                            this.canvas || (this.canvas = this.options.canvas instanceof e.window.HTMLCanvasElement ? this.options.canvas : e.window.document.getElementById(this.options.canvas)),
                            this.width = this.canvas.width,
                            this.height = this.canvas.height,
                            this._hasInvalidDimensions() ? this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))) : (this.play = function() {
                                this._playing = !0,
                                this.map.triggerRepaint()
                            }
                            ,
                            this.pause = function() {
                                this._playing && (this.prepare(),
                                this._playing = !1)
                            }
                            ,
                            this._finishLoading())
                        }
                        ,
                        i.prototype.getCanvas = function() {
                            return this.canvas
                        }
                        ,
                        i.prototype.onAdd = function(e) {
                            this.map = e,
                            this.load(),
                            this.canvas && this.animate && this.play()
                        }
                        ,
                        i.prototype.onRemove = function() {
                            this.pause()
                        }
                        ,
                        i.prototype.prepare = function() {
                            var t = !1;
                            if (this.canvas.width !== this.width && (this.width = this.canvas.width,
                            t = !0),
                            this.canvas.height !== this.height && (this.height = this.canvas.height,
                            t = !0),
                            !this._hasInvalidDimensions() && 0 !== Object.keys(this.tiles).length) {
                                var i = this.map.painter.context
                                  , r = i.gl;
                                for (var n in this.boundsBuffer || (this.boundsBuffer = i.createVertexBuffer(this._boundsArray, I.members)),
                                this.boundsSegments || (this.boundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2)),
                                this.texture ? (t || this._playing) && this.texture.update(this.canvas, {
                                    premultiply: !0
                                }) : this.texture = new e.Texture(i,this.canvas,r.RGBA,{
                                    premultiply: !0
                                }),
                                this.tiles) {
                                    var a = this.tiles[n];
                                    "loaded" !== a.state && (a.state = "loaded",
                                    a.texture = this.texture)
                                }
                            }
                        }
                        ,
                        i.prototype.serialize = function() {
                            return {
                                type: "canvas",
                                coordinates: this.coordinates
                            }
                        }
                        ,
                        i.prototype.hasTransition = function() {
                            return this._playing
                        }
                        ,
                        i.prototype._hasInvalidDimensions = function() {
                            for (var e = 0, t = [this.canvas.width, this.canvas.height]; e < t.length; e += 1) {
                                var i = t[e];
                                if (isNaN(i) || i <= 0)
                                    return !0
                            }
                            return !1
                        }
                        ,
                        i
                    }(k)
                      , R = {
                        vector: A,
                        raster: P,
                        "raster-dem": C,
                        geojson: L,
                        video: z,
                        image: k,
                        canvas: D
                    };
                    function O(t, i) {
                        var r = e.identity([]);
                        return e.translate(r, r, [1, 1, 0]),
                        e.scale(r, r, [.5 * t.width, .5 * t.height, 1]),
                        e.multiply(r, r, t.calculatePosMatrix(i.toUnwrapped()))
                    }
                    function B(e, t, i, r, n, a) {
                        var o = function(e, t, i) {
                            if (e)
                                for (var r = 0, n = e; r < n.length; r += 1) {
                                    var a = t[n[r]];
                                    if (a && a.source === i && "fill-extrusion" === a.type)
                                        return !0
                                }
                            else
                                for (var o in t) {
                                    var s = t[o];
                                    if (s.source === i && "fill-extrusion" === s.type)
                                        return !0
                                }
                            return !1
                        }(n && n.layers, t, e.id)
                          , s = a.maxPitchScaleFactor()
                          , l = e.tilesIn(r, s, o);
                        l.sort(F);
                        for (var u = [], c = 0, h = l; c < h.length; c += 1) {
                            var p = h[c];
                            u.push({
                                wrappedTileID: p.tileID.wrapped().key,
                                queryResults: p.tile.queryRenderedFeatures(t, i, e._state, p.queryGeometry, p.cameraQueryGeometry, p.scale, n, a, s, O(e.transform, p.tileID))
                            })
                        }
                        var f = function(e) {
                            for (var t = {}, i = {}, r = 0, n = e; r < n.length; r += 1) {
                                var a = n[r]
                                  , o = a.queryResults
                                  , s = a.wrappedTileID
                                  , l = i[s] = i[s] || {};
                                for (var u in o)
                                    for (var c = o[u], h = l[u] = l[u] || {}, p = t[u] = t[u] || [], f = 0, d = c; f < d.length; f += 1) {
                                        var m = d[f];
                                        h[m.featureIndex] || (h[m.featureIndex] = !0,
                                        p.push(m))
                                    }
                            }
                            return t
                        }(u);
                        for (var d in f)
                            f[d].forEach((function(t) {
                                var i = t.feature
                                  , r = e.getFeatureState(i.layer["source-layer"], i.id);
                                i.source = i.layer.source,
                                i.layer["source-layer"] && (i.sourceLayer = i.layer["source-layer"]),
                                i.state = r
                            }
                            ));
                        return f
                    }
                    function F(e, t) {
                        var i = e.tileID
                          , r = t.tileID;
                        return i.overscaledZ - r.overscaledZ || i.canonical.y - r.canonical.y || i.wrap - r.wrap || i.canonical.x - r.canonical.x
                    }
                    var N = function(e, t) {
                        this.max = e,
                        this.onRemove = t,
                        this.reset()
                    };
                    N.prototype.reset = function() {
                        for (var e in this.data)
                            for (var t = 0, i = this.data[e]; t < i.length; t += 1) {
                                var r = i[t];
                                r.timeout && clearTimeout(r.timeout),
                                this.onRemove(r.value)
                            }
                        return this.data = {},
                        this.order = [],
                        this
                    }
                    ,
                    N.prototype.add = function(e, t, i) {
                        var r = this
                          , n = e.wrapped().key;
                        void 0 === this.data[n] && (this.data[n] = []);
                        var a = {
                            value: t,
                            timeout: void 0
                        };
                        if (void 0 !== i && (a.timeout = setTimeout((function() {
                            r.remove(e, a)
                        }
                        ), i)),
                        this.data[n].push(a),
                        this.order.push(n),
                        this.order.length > this.max) {
                            var o = this._getAndRemoveByKey(this.order[0]);
                            o && this.onRemove(o)
                        }
                        return this
                    }
                    ,
                    N.prototype.has = function(e) {
                        return e.wrapped().key in this.data
                    }
                    ,
                    N.prototype.getAndRemove = function(e) {
                        return this.has(e) ? this._getAndRemoveByKey(e.wrapped().key) : null
                    }
                    ,
                    N.prototype._getAndRemoveByKey = function(e) {
                        var t = this.data[e].shift();
                        return t.timeout && clearTimeout(t.timeout),
                        0 === this.data[e].length && delete this.data[e],
                        this.order.splice(this.order.indexOf(e), 1),
                        t.value
                    }
                    ,
                    N.prototype.getByKey = function(e) {
                        var t = this.data[e];
                        return t ? t[0].value : null
                    }
                    ,
                    N.prototype.get = function(e) {
                        return this.has(e) ? this.data[e.wrapped().key][0].value : null
                    }
                    ,
                    N.prototype.remove = function(e, t) {
                        if (!this.has(e))
                            return this;
                        var i = e.wrapped().key
                          , r = void 0 === t ? 0 : this.data[i].indexOf(t)
                          , n = this.data[i][r];
                        return this.data[i].splice(r, 1),
                        n.timeout && clearTimeout(n.timeout),
                        0 === this.data[i].length && delete this.data[i],
                        this.onRemove(n.value),
                        this.order.splice(this.order.indexOf(i), 1),
                        this
                    }
                    ,
                    N.prototype.setMaxSize = function(e) {
                        for (this.max = e; this.order.length > this.max; ) {
                            var t = this._getAndRemoveByKey(this.order[0]);
                            t && this.onRemove(t)
                        }
                        return this
                    }
                    ,
                    N.prototype.filter = function(e) {
                        var t = [];
                        for (var i in this.data)
                            for (var r = 0, n = this.data[i]; r < n.length; r += 1) {
                                var a = n[r];
                                e(a.value) || t.push(a)
                            }
                        for (var o = 0, s = t; o < s.length; o += 1) {
                            var l = s[o];
                            this.remove(l.value.tileID, l)
                        }
                    }
                    ;
                    var U = function(e, t, i) {
                        this.context = e;
                        var r = e.gl;
                        this.buffer = r.createBuffer(),
                        this.dynamicDraw = Boolean(i),
                        this.context.unbindVAO(),
                        e.bindElementBuffer.set(this.buffer),
                        r.bufferData(r.ELEMENT_ARRAY_BUFFER, t.arrayBuffer, this.dynamicDraw ? r.DYNAMIC_DRAW : r.STATIC_DRAW),
                        this.dynamicDraw || delete t.arrayBuffer
                    };
                    U.prototype.bind = function() {
                        this.context.bindElementBuffer.set(this.buffer)
                    }
                    ,
                    U.prototype.updateData = function(e) {
                        var t = this.context.gl;
                        this.context.unbindVAO(),
                        this.bind(),
                        t.bufferSubData(t.ELEMENT_ARRAY_BUFFER, 0, e.arrayBuffer)
                    }
                    ,
                    U.prototype.destroy = function() {
                        this.buffer && (this.context.gl.deleteBuffer(this.buffer),
                        delete this.buffer)
                    }
                    ;
                    var V = {
                        Int8: "BYTE",
                        Uint8: "UNSIGNED_BYTE",
                        Int16: "SHORT",
                        Uint16: "UNSIGNED_SHORT",
                        Int32: "INT",
                        Uint32: "UNSIGNED_INT",
                        Float32: "FLOAT"
                    }
                      , G = function(e, t, i, r) {
                        this.length = t.length,
                        this.attributes = i,
                        this.itemSize = t.bytesPerElement,
                        this.dynamicDraw = r,
                        this.context = e;
                        var n = e.gl;
                        this.buffer = n.createBuffer(),
                        e.bindVertexBuffer.set(this.buffer),
                        n.bufferData(n.ARRAY_BUFFER, t.arrayBuffer, this.dynamicDraw ? n.DYNAMIC_DRAW : n.STATIC_DRAW),
                        this.dynamicDraw || delete t.arrayBuffer
                    };
                    G.prototype.bind = function() {
                        this.context.bindVertexBuffer.set(this.buffer)
                    }
                    ,
                    G.prototype.updateData = function(e) {
                        var t = this.context.gl;
                        this.bind(),
                        t.bufferSubData(t.ARRAY_BUFFER, 0, e.arrayBuffer)
                    }
                    ,
                    G.prototype.enableAttributes = function(e, t) {
                        for (var i = 0; i < this.attributes.length; i++) {
                            var r = t.attributes[this.attributes[i].name];
                            void 0 !== r && e.enableVertexAttribArray(r)
                        }
                    }
                    ,
                    G.prototype.setVertexAttribPointers = function(e, t, i) {
                        for (var r = 0; r < this.attributes.length; r++) {
                            var n = this.attributes[r]
                              , a = t.attributes[n.name];
                            void 0 !== a && e.vertexAttribPointer(a, n.components, e[V[n.type]], !1, this.itemSize, n.offset + this.itemSize * (i || 0))
                        }
                    }
                    ,
                    G.prototype.destroy = function() {
                        this.buffer && (this.context.gl.deleteBuffer(this.buffer),
                        delete this.buffer)
                    }
                    ;
                    var j = function(e) {
                        this.gl = e.gl,
                        this.default = this.getDefault(),
                        this.current = this.default,
                        this.dirty = !1
                    };
                    j.prototype.get = function() {
                        return this.current
                    }
                    ,
                    j.prototype.set = function(e) {}
                    ,
                    j.prototype.getDefault = function() {
                        return this.default
                    }
                    ,
                    j.prototype.setDefault = function() {
                        this.set(this.default)
                    }
                    ;
                    var H = function(t) {
                        function i() {
                            t.apply(this, arguments)
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.getDefault = function() {
                            return e.Color.transparent
                        }
                        ,
                        i.prototype.set = function(e) {
                            var t = this.current;
                            (e.r !== t.r || e.g !== t.g || e.b !== t.b || e.a !== t.a || this.dirty) && (this.gl.clearColor(e.r, e.g, e.b, e.a),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        i
                    }(j)
                      , q = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return 1
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.clearDepth(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , W = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return 0
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.clearStencil(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , Z = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return [!0, !0, !0, !0]
                        }
                        ,
                        t.prototype.set = function(e) {
                            var t = this.current;
                            (e[0] !== t[0] || e[1] !== t[1] || e[2] !== t[2] || e[3] !== t[3] || this.dirty) && (this.gl.colorMask(e[0], e[1], e[2], e[3]),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , X = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return !0
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.depthMask(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , Y = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return 255
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.stencilMask(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , K = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return {
                                func: this.gl.ALWAYS,
                                ref: 0,
                                mask: 255
                            }
                        }
                        ,
                        t.prototype.set = function(e) {
                            var t = this.current;
                            (e.func !== t.func || e.ref !== t.ref || e.mask !== t.mask || this.dirty) && (this.gl.stencilFunc(e.func, e.ref, e.mask),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , J = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            var e = this.gl;
                            return [e.KEEP, e.KEEP, e.KEEP]
                        }
                        ,
                        t.prototype.set = function(e) {
                            var t = this.current;
                            (e[0] !== t[0] || e[1] !== t[1] || e[2] !== t[2] || this.dirty) && (this.gl.stencilOp(e[0], e[1], e[2]),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , Q = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return !1
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                e ? t.enable(t.STENCIL_TEST) : t.disable(t.STENCIL_TEST),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , $ = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return [0, 1]
                        }
                        ,
                        t.prototype.set = function(e) {
                            var t = this.current;
                            (e[0] !== t[0] || e[1] !== t[1] || this.dirty) && (this.gl.depthRange(e[0], e[1]),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , ee = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return !1
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                e ? t.enable(t.DEPTH_TEST) : t.disable(t.DEPTH_TEST),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , te = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return this.gl.LESS
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.depthFunc(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , ie = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return !1
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                e ? t.enable(t.BLEND) : t.disable(t.BLEND),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , re = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            var e = this.gl;
                            return [e.ONE, e.ZERO]
                        }
                        ,
                        t.prototype.set = function(e) {
                            var t = this.current;
                            (e[0] !== t[0] || e[1] !== t[1] || this.dirty) && (this.gl.blendFunc(e[0], e[1]),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , ne = function(t) {
                        function i() {
                            t.apply(this, arguments)
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.getDefault = function() {
                            return e.Color.transparent
                        }
                        ,
                        i.prototype.set = function(e) {
                            var t = this.current;
                            (e.r !== t.r || e.g !== t.g || e.b !== t.b || e.a !== t.a || this.dirty) && (this.gl.blendColor(e.r, e.g, e.b, e.a),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        i
                    }(j)
                      , ae = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return this.gl.FUNC_ADD
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.blendEquation(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , oe = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return !1
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                e ? t.enable(t.CULL_FACE) : t.disable(t.CULL_FACE),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , se = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return this.gl.BACK
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.cullFace(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , le = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return this.gl.CCW
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.frontFace(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , ue = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return null
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.useProgram(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , ce = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return this.gl.TEXTURE0
                        }
                        ,
                        t.prototype.set = function(e) {
                            (e !== this.current || this.dirty) && (this.gl.activeTexture(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , he = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            var e = this.gl;
                            return [0, 0, e.drawingBufferWidth, e.drawingBufferHeight]
                        }
                        ,
                        t.prototype.set = function(e) {
                            var t = this.current;
                            (e[0] !== t[0] || e[1] !== t[1] || e[2] !== t[2] || e[3] !== t[3] || this.dirty) && (this.gl.viewport(e[0], e[1], e[2], e[3]),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , pe = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return null
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                t.bindFramebuffer(t.FRAMEBUFFER, e),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , fe = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return null
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                t.bindRenderbuffer(t.RENDERBUFFER, e),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , de = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return null
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                t.bindTexture(t.TEXTURE_2D, e),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , me = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return null
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                t.bindBuffer(t.ARRAY_BUFFER, e),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , ve = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return null
                        }
                        ,
                        t.prototype.set = function(e) {
                            var t = this.gl;
                            t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, e),
                            this.current = e,
                            this.dirty = !1
                        }
                        ,
                        t
                    }(j)
                      , ge = function(e) {
                        function t(t) {
                            e.call(this, t),
                            this.vao = t.extVertexArrayObject
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return null
                        }
                        ,
                        t.prototype.set = function(e) {
                            this.vao && (e !== this.current || this.dirty) && (this.vao.bindVertexArrayOES(e),
                            this.current = e,
                            this.dirty = !1)
                        }
                        ,
                        t
                    }(j)
                      , ye = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return 4
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                t.pixelStorei(t.UNPACK_ALIGNMENT, e),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , _e = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return !1
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL, e),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , xe = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return !1
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                var t = this.gl;
                                t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL, e),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(j)
                      , be = function(e) {
                        function t(t, i) {
                            e.call(this, t),
                            this.context = t,
                            this.parent = i
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.getDefault = function() {
                            return null
                        }
                        ,
                        t
                    }(j)
                      , we = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.setDirty = function() {
                            this.dirty = !0
                        }
                        ,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                this.context.bindFramebuffer.set(this.parent);
                                var t = this.gl;
                                t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, e, 0),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(be)
                      , Se = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.set = function(e) {
                            if (e !== this.current || this.dirty) {
                                this.context.bindFramebuffer.set(this.parent);
                                var t = this.gl;
                                t.framebufferRenderbuffer(t.FRAMEBUFFER, t.DEPTH_ATTACHMENT, t.RENDERBUFFER, e),
                                this.current = e,
                                this.dirty = !1
                            }
                        }
                        ,
                        t
                    }(be)
                      , Me = function(e, t, i, r) {
                        this.context = e,
                        this.width = t,
                        this.height = i;
                        var n = this.framebuffer = e.gl.createFramebuffer();
                        this.colorAttachment = new we(e,n),
                        r && (this.depthAttachment = new Se(e,n))
                    };
                    Me.prototype.destroy = function() {
                        var e = this.context.gl
                          , t = this.colorAttachment.get();
                        if (t && e.deleteTexture(t),
                        this.depthAttachment) {
                            var i = this.depthAttachment.get();
                            i && e.deleteRenderbuffer(i)
                        }
                        e.deleteFramebuffer(this.framebuffer)
                    }
                    ;
                    var Te = function(e, t, i) {
                        this.func = e,
                        this.mask = t,
                        this.range = i
                    };
                    Te.ReadOnly = !1,
                    Te.ReadWrite = !0,
                    Te.disabled = new Te(519,Te.ReadOnly,[0, 1]);
                    var Ee = function(e, t, i, r, n, a) {
                        this.test = e,
                        this.ref = t,
                        this.mask = i,
                        this.fail = r,
                        this.depthFail = n,
                        this.pass = a
                    };
                    Ee.disabled = new Ee({
                        func: 519,
                        mask: 0
                    },0,0,7680,7680,7680);
                    var Ae = function(e, t, i) {
                        this.blendFunction = e,
                        this.blendColor = t,
                        this.mask = i
                    };
                    Ae.disabled = new Ae(Ae.Replace = [1, 0],e.Color.transparent,[!1, !1, !1, !1]),
                    Ae.unblended = new Ae(Ae.Replace,e.Color.transparent,[!0, !0, !0, !0]),
                    Ae.alphaBlended = new Ae([1, 771],e.Color.transparent,[!0, !0, !0, !0]);
                    var Pe = function(e, t, i) {
                        this.enable = e,
                        this.mode = t,
                        this.frontFace = i
                    };
                    Pe.disabled = new Pe(!1,1029,2305),
                    Pe.backCCW = new Pe(!0,1029,2305);
                    var Ce = function(e) {
                        this.gl = e,
                        this.extVertexArrayObject = this.gl.getExtension("OES_vertex_array_object"),
                        this.clearColor = new H(this),
                        this.clearDepth = new q(this),
                        this.clearStencil = new W(this),
                        this.colorMask = new Z(this),
                        this.depthMask = new X(this),
                        this.stencilMask = new Y(this),
                        this.stencilFunc = new K(this),
                        this.stencilOp = new J(this),
                        this.stencilTest = new Q(this),
                        this.depthRange = new $(this),
                        this.depthTest = new ee(this),
                        this.depthFunc = new te(this),
                        this.blend = new ie(this),
                        this.blendFunc = new re(this),
                        this.blendColor = new ne(this),
                        this.blendEquation = new ae(this),
                        this.cullFace = new oe(this),
                        this.cullFaceSide = new se(this),
                        this.frontFace = new le(this),
                        this.program = new ue(this),
                        this.activeTexture = new ce(this),
                        this.viewport = new he(this),
                        this.bindFramebuffer = new pe(this),
                        this.bindRenderbuffer = new fe(this),
                        this.bindTexture = new de(this),
                        this.bindVertexBuffer = new me(this),
                        this.bindElementBuffer = new ve(this),
                        this.bindVertexArrayOES = this.extVertexArrayObject && new ge(this),
                        this.pixelStoreUnpack = new ye(this),
                        this.pixelStoreUnpackPremultiplyAlpha = new _e(this),
                        this.pixelStoreUnpackFlipY = new xe(this),
                        this.extTextureFilterAnisotropic = e.getExtension("EXT_texture_filter_anisotropic") || e.getExtension("MOZ_EXT_texture_filter_anisotropic") || e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),
                        this.extTextureFilterAnisotropic && (this.extTextureFilterAnisotropicMax = e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),
                        this.extTextureHalfFloat = e.getExtension("OES_texture_half_float"),
                        this.extTextureHalfFloat && (e.getExtension("OES_texture_half_float_linear"),
                        this.extRenderToTextureHalfFloat = e.getExtension("EXT_color_buffer_half_float")),
                        this.extTimerQuery = e.getExtension("EXT_disjoint_timer_query"),
                        this.maxTextureSize = e.getParameter(e.MAX_TEXTURE_SIZE)
                    };
                    Ce.prototype.setDefault = function() {
                        this.unbindVAO(),
                        this.clearColor.setDefault(),
                        this.clearDepth.setDefault(),
                        this.clearStencil.setDefault(),
                        this.colorMask.setDefault(),
                        this.depthMask.setDefault(),
                        this.stencilMask.setDefault(),
                        this.stencilFunc.setDefault(),
                        this.stencilOp.setDefault(),
                        this.stencilTest.setDefault(),
                        this.depthRange.setDefault(),
                        this.depthTest.setDefault(),
                        this.depthFunc.setDefault(),
                        this.blend.setDefault(),
                        this.blendFunc.setDefault(),
                        this.blendColor.setDefault(),
                        this.blendEquation.setDefault(),
                        this.cullFace.setDefault(),
                        this.cullFaceSide.setDefault(),
                        this.frontFace.setDefault(),
                        this.program.setDefault(),
                        this.activeTexture.setDefault(),
                        this.bindFramebuffer.setDefault(),
                        this.pixelStoreUnpack.setDefault(),
                        this.pixelStoreUnpackPremultiplyAlpha.setDefault(),
                        this.pixelStoreUnpackFlipY.setDefault()
                    }
                    ,
                    Ce.prototype.setDirty = function() {
                        this.clearColor.dirty = !0,
                        this.clearDepth.dirty = !0,
                        this.clearStencil.dirty = !0,
                        this.colorMask.dirty = !0,
                        this.depthMask.dirty = !0,
                        this.stencilMask.dirty = !0,
                        this.stencilFunc.dirty = !0,
                        this.stencilOp.dirty = !0,
                        this.stencilTest.dirty = !0,
                        this.depthRange.dirty = !0,
                        this.depthTest.dirty = !0,
                        this.depthFunc.dirty = !0,
                        this.blend.dirty = !0,
                        this.blendFunc.dirty = !0,
                        this.blendColor.dirty = !0,
                        this.blendEquation.dirty = !0,
                        this.cullFace.dirty = !0,
                        this.cullFaceSide.dirty = !0,
                        this.frontFace.dirty = !0,
                        this.program.dirty = !0,
                        this.activeTexture.dirty = !0,
                        this.viewport.dirty = !0,
                        this.bindFramebuffer.dirty = !0,
                        this.bindRenderbuffer.dirty = !0,
                        this.bindTexture.dirty = !0,
                        this.bindVertexBuffer.dirty = !0,
                        this.bindElementBuffer.dirty = !0,
                        this.extVertexArrayObject && (this.bindVertexArrayOES.dirty = !0),
                        this.pixelStoreUnpack.dirty = !0,
                        this.pixelStoreUnpackPremultiplyAlpha.dirty = !0,
                        this.pixelStoreUnpackFlipY.dirty = !0
                    }
                    ,
                    Ce.prototype.createIndexBuffer = function(e, t) {
                        return new U(this,e,t)
                    }
                    ,
                    Ce.prototype.createVertexBuffer = function(e, t, i) {
                        return new G(this,e,t,i)
                    }
                    ,
                    Ce.prototype.createRenderbuffer = function(e, t, i) {
                        var r = this.gl
                          , n = r.createRenderbuffer();
                        return this.bindRenderbuffer.set(n),
                        r.renderbufferStorage(r.RENDERBUFFER, e, t, i),
                        this.bindRenderbuffer.set(null),
                        n
                    }
                    ,
                    Ce.prototype.createFramebuffer = function(e, t, i) {
                        return new Me(this,e,t,i)
                    }
                    ,
                    Ce.prototype.clear = function(e) {
                        var t = e.color
                          , i = e.depth
                          , r = this.gl
                          , n = 0;
                        t && (n |= r.COLOR_BUFFER_BIT,
                        this.clearColor.set(t),
                        this.colorMask.set([!0, !0, !0, !0])),
                        void 0 !== i && (n |= r.DEPTH_BUFFER_BIT,
                        this.depthRange.set([0, 1]),
                        this.clearDepth.set(i),
                        this.depthMask.set(!0)),
                        r.clear(n)
                    }
                    ,
                    Ce.prototype.setCullFace = function(e) {
                        !1 === e.enable ? this.cullFace.set(!1) : (this.cullFace.set(!0),
                        this.cullFaceSide.set(e.mode),
                        this.frontFace.set(e.frontFace))
                    }
                    ,
                    Ce.prototype.setDepthMode = function(e) {
                        e.func !== this.gl.ALWAYS || e.mask ? (this.depthTest.set(!0),
                        this.depthFunc.set(e.func),
                        this.depthMask.set(e.mask),
                        this.depthRange.set(e.range)) : this.depthTest.set(!1)
                    }
                    ,
                    Ce.prototype.setStencilMode = function(e) {
                        e.test.func !== this.gl.ALWAYS || e.mask ? (this.stencilTest.set(!0),
                        this.stencilMask.set(e.mask),
                        this.stencilOp.set([e.fail, e.depthFail, e.pass]),
                        this.stencilFunc.set({
                            func: e.test.func,
                            ref: e.ref,
                            mask: e.test.mask
                        })) : this.stencilTest.set(!1)
                    }
                    ,
                    Ce.prototype.setColorMode = function(t) {
                        e.deepEqual(t.blendFunction, Ae.Replace) ? this.blend.set(!1) : (this.blend.set(!0),
                        this.blendFunc.set(t.blendFunction),
                        this.blendColor.set(t.blendColor)),
                        this.colorMask.set(t.mask)
                    }
                    ,
                    Ce.prototype.unbindVAO = function() {
                        this.extVertexArrayObject && this.bindVertexArrayOES.set(null)
                    }
                    ;
                    var Le = function(t) {
                        function i(i, r, n) {
                            var a = this;
                            t.call(this),
                            this.id = i,
                            this.dispatcher = n,
                            this.on("data", (function(e) {
                                "source" === e.dataType && "metadata" === e.sourceDataType && (a._sourceLoaded = !0),
                                a._sourceLoaded && !a._paused && "source" === e.dataType && "content" === e.sourceDataType && (a.reload(),
                                a.transform && a.update(a.transform))
                            }
                            )),
                            this.on("error", (function() {
                                a._sourceErrored = !0
                            }
                            )),
                            this._source = function(t, i, r, n) {
                                var a = new R[i.type](t,i,r,n);
                                if (a.id !== t)
                                    throw new Error("Expected Source id to be " + t + " instead of " + a.id);
                                return e.bindAll(["load", "abort", "unload", "serialize", "prepare"], a),
                                a
                            }(i, r, n, this),
                            this._tiles = {},
                            this._cache = new N(0,this._unloadTile.bind(this)),
                            this._timers = {},
                            this._cacheTimers = {},
                            this._maxTileCacheSize = null,
                            this._loadedParentTiles = {},
                            this._coveredTiles = {},
                            this._state = new e.SourceFeatureState
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.onAdd = function(e) {
                            this.map = e,
                            this._maxTileCacheSize = e ? e._maxTileCacheSize : null,
                            this._source && this._source.onAdd && this._source.onAdd(e)
                        }
                        ,
                        i.prototype.onRemove = function(e) {
                            this._source && this._source.onRemove && this._source.onRemove(e)
                        }
                        ,
                        i.prototype.loaded = function() {
                            if (this._sourceErrored)
                                return !0;
                            if (!this._sourceLoaded)
                                return !1;
                            if (!this._source.loaded())
                                return !1;
                            for (var e in this._tiles) {
                                var t = this._tiles[e];
                                if ("loaded" !== t.state && "errored" !== t.state)
                                    return !1
                            }
                            return !0
                        }
                        ,
                        i.prototype.getSource = function() {
                            return this._source
                        }
                        ,
                        i.prototype.pause = function() {
                            this._paused = !0
                        }
                        ,
                        i.prototype.resume = function() {
                            if (this._paused) {
                                var e = this._shouldReloadOnResume;
                                this._paused = !1,
                                this._shouldReloadOnResume = !1,
                                e && this.reload(),
                                this.transform && this.update(this.transform)
                            }
                        }
                        ,
                        i.prototype._loadTile = function(e, t) {
                            return this._source.loadTile(e, t)
                        }
                        ,
                        i.prototype._unloadTile = function(e) {
                            if (this._source.unloadTile)
                                return this._source.unloadTile(e, (function() {}
                                ))
                        }
                        ,
                        i.prototype._abortTile = function(e) {
                            if (this._source.abortTile)
                                return this._source.abortTile(e, (function() {}
                                ))
                        }
                        ,
                        i.prototype.serialize = function() {
                            return this._source.serialize()
                        }
                        ,
                        i.prototype.prepare = function(e) {
                            for (var t in this._source.prepare && this._source.prepare(),
                            this._state.coalesceChanges(this._tiles, this.map ? this.map.painter : null),
                            this._tiles) {
                                var i = this._tiles[t];
                                i.upload(e),
                                i.prepare(this.map.style.imageManager)
                            }
                        }
                        ,
                        i.prototype.getIds = function() {
                            return e.values(this._tiles).map((function(e) {
                                return e.tileID
                            }
                            )).sort(Ie).map((function(e) {
                                return e.key
                            }
                            ))
                        }
                        ,
                        i.prototype.getRenderableIds = function(t) {
                            var i = this
                              , r = [];
                            for (var n in this._tiles)
                                this._isIdRenderable(n, t) && r.push(this._tiles[n]);
                            return t ? r.sort((function(t, r) {
                                var n = t.tileID
                                  , a = r.tileID
                                  , o = new e.Point(n.canonical.x,n.canonical.y)._rotate(i.transform.angle)
                                  , s = new e.Point(a.canonical.x,a.canonical.y)._rotate(i.transform.angle);
                                return n.overscaledZ - a.overscaledZ || s.y - o.y || s.x - o.x
                            }
                            )).map((function(e) {
                                return e.tileID.key
                            }
                            )) : r.map((function(e) {
                                return e.tileID
                            }
                            )).sort(Ie).map((function(e) {
                                return e.key
                            }
                            ))
                        }
                        ,
                        i.prototype.hasRenderableParent = function(e) {
                            var t = this.findLoadedParent(e, 0);
                            return !!t && this._isIdRenderable(t.tileID.key)
                        }
                        ,
                        i.prototype._isIdRenderable = function(e, t) {
                            return this._tiles[e] && this._tiles[e].hasData() && !this._coveredTiles[e] && (t || !this._tiles[e].holdingForFade())
                        }
                        ,
                        i.prototype.reload = function() {
                            if (this._paused)
                                this._shouldReloadOnResume = !0;
                            else
                                for (var e in this._cache.reset(),
                                this._tiles)
                                    "errored" !== this._tiles[e].state && this._reloadTile(e, "reloading")
                        }
                        ,
                        i.prototype._reloadTile = function(e, t) {
                            var i = this._tiles[e];
                            i && ("loading" !== i.state && (i.state = t),
                            this._loadTile(i, this._tileLoaded.bind(this, i, e, t)))
                        }
                        ,
                        i.prototype._tileLoaded = function(t, i, r, n) {
                            if (n)
                                return t.state = "errored",
                                void (404 !== n.status ? this._source.fire(new e.ErrorEvent(n,{
                                    tile: t
                                })) : this.update(this.transform));
                            t.timeAdded = e.browser.now(),
                            "expired" === r && (t.refreshedUponExpiration = !0),
                            this._setTileReloadTimer(i, t),
                            "raster-dem" === this.getSource().type && t.dem && this._backfillDEM(t),
                            this._state.initializeTileState(t, this.map ? this.map.painter : null),
                            this._source.fire(new e.Event("data",{
                                dataType: "source",
                                tile: t,
                                coord: t.tileID
                            }))
                        }
                        ,
                        i.prototype._backfillDEM = function(e) {
                            for (var t = this.getRenderableIds(), i = 0; i < t.length; i++) {
                                var r = t[i];
                                if (e.neighboringTiles && e.neighboringTiles[r]) {
                                    var n = this.getTileByID(r);
                                    a(e, n),
                                    a(n, e)
                                }
                            }
                            function a(e, t) {
                                e.needsHillshadePrepare = !0;
                                var i = t.tileID.canonical.x - e.tileID.canonical.x
                                  , r = t.tileID.canonical.y - e.tileID.canonical.y
                                  , n = Math.pow(2, e.tileID.canonical.z)
                                  , a = t.tileID.key;
                                0 === i && 0 === r || Math.abs(r) > 1 || (Math.abs(i) > 1 && (1 === Math.abs(i + n) ? i += n : 1 === Math.abs(i - n) && (i -= n)),
                                t.dem && e.dem && (e.dem.backfillBorder(t.dem, i, r),
                                e.neighboringTiles && e.neighboringTiles[a] && (e.neighboringTiles[a].backfilled = !0)))
                            }
                        }
                        ,
                        i.prototype.getTile = function(e) {
                            return this.getTileByID(e.key)
                        }
                        ,
                        i.prototype.getTileByID = function(e) {
                            return this._tiles[e]
                        }
                        ,
                        i.prototype._retainLoadedChildren = function(e, t, i, r) {
                            for (var n in this._tiles) {
                                var a = this._tiles[n];
                                if (!(r[n] || !a.hasData() || a.tileID.overscaledZ <= t || a.tileID.overscaledZ > i)) {
                                    for (var o = a.tileID; a && a.tileID.overscaledZ > t + 1; ) {
                                        var s = a.tileID.scaledTo(a.tileID.overscaledZ - 1);
                                        (a = this._tiles[s.key]) && a.hasData() && (o = s)
                                    }
                                    for (var l = o; l.overscaledZ > t; )
                                        if (e[(l = l.scaledTo(l.overscaledZ - 1)).key]) {
                                            r[o.key] = o;
                                            break
                                        }
                                }
                            }
                        }
                        ,
                        i.prototype.findLoadedParent = function(e, t) {
                            if (e.key in this._loadedParentTiles) {
                                var i = this._loadedParentTiles[e.key];
                                return i && i.tileID.overscaledZ >= t ? i : null
                            }
                            for (var r = e.overscaledZ - 1; r >= t; r--) {
                                var n = e.scaledTo(r)
                                  , a = this._getLoadedTile(n);
                                if (a)
                                    return a
                            }
                        }
                        ,
                        i.prototype._getLoadedTile = function(e) {
                            var t = this._tiles[e.key];
                            return t && t.hasData() ? t : this._cache.getByKey(e.wrapped().key)
                        }
                        ,
                        i.prototype.updateCacheSize = function(e) {
                            var t = Math.ceil(e.width / this._source.tileSize) + 1
                              , i = Math.ceil(e.height / this._source.tileSize) + 1
                              , r = Math.floor(t * i * 5)
                              , n = "number" == typeof this._maxTileCacheSize ? Math.min(this._maxTileCacheSize, r) : r;
                            this._cache.setMaxSize(n)
                        }
                        ,
                        i.prototype.handleWrapJump = function(e) {
                            var t = Math.round((e - (void 0 === this._prevLng ? e : this._prevLng)) / 360);
                            if (this._prevLng = e,
                            t) {
                                var i = {};
                                for (var r in this._tiles) {
                                    var n = this._tiles[r];
                                    n.tileID = n.tileID.unwrapTo(n.tileID.wrap + t),
                                    i[n.tileID.key] = n
                                }
                                for (var a in this._tiles = i,
                                this._timers)
                                    clearTimeout(this._timers[a]),
                                    delete this._timers[a];
                                for (var o in this._tiles)
                                    this._setTileReloadTimer(o, this._tiles[o])
                            }
                        }
                        ,
                        i.prototype.update = function(t) {
                            var r = this;
                            if (this.transform = t,
                            this._sourceLoaded && !this._paused) {
                                var n;
                                this.updateCacheSize(t),
                                this.handleWrapJump(this.transform.center.lng),
                                this._coveredTiles = {},
                                this.used ? this._source.tileID ? n = t.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(t) {
                                    return new e.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)
                                }
                                )) : (n = t.coveringTiles({
                                    tileSize: this._source.tileSize,
                                    minzoom: this._source.minzoom,
                                    maxzoom: this._source.maxzoom,
                                    roundZoom: this._source.roundZoom,
                                    reparseOverscaled: this._source.reparseOverscaled
                                }),
                                this._source.hasTile && (n = n.filter((function(e) {
                                    return r._source.hasTile(e)
                                }
                                )))) : n = [];
                                var a = t.coveringZoomLevel(this._source)
                                  , o = Math.max(a - i.maxOverzooming, this._source.minzoom)
                                  , s = Math.max(a + i.maxUnderzooming, this._source.minzoom)
                                  , l = this._updateRetainedTiles(n, a);
                                if (ke(this._source.type)) {
                                    for (var u = {}, c = {}, h = 0, p = Object.keys(l); h < p.length; h += 1) {
                                        var f = p[h]
                                          , d = l[f]
                                          , m = this._tiles[f];
                                        if (m && !(m.fadeEndTime && m.fadeEndTime <= e.browser.now())) {
                                            var v = this.findLoadedParent(d, o);
                                            v && (this._addTile(v.tileID),
                                            u[v.tileID.key] = v.tileID),
                                            c[f] = d
                                        }
                                    }
                                    for (var g in this._retainLoadedChildren(c, a, s, l),
                                    u)
                                        l[g] || (this._coveredTiles[g] = !0,
                                        l[g] = u[g])
                                }
                                for (var y in l)
                                    this._tiles[y].clearFadeHold();
                                for (var _ = 0, x = e.keysDifference(this._tiles, l); _ < x.length; _ += 1) {
                                    var b = x[_]
                                      , w = this._tiles[b];
                                    w.hasSymbolBuckets && !w.holdingForFade() ? w.setHoldDuration(this.map._fadeDuration) : w.hasSymbolBuckets && !w.symbolFadeFinished() || this._removeTile(b)
                                }
                                this._updateLoadedParentTileCache()
                            }
                        }
                        ,
                        i.prototype.releaseSymbolFadeTiles = function() {
                            for (var e in this._tiles)
                                this._tiles[e].holdingForFade() && this._removeTile(e)
                        }
                        ,
                        i.prototype._updateRetainedTiles = function(e, t) {
                            for (var r = {}, n = {}, a = Math.max(t - i.maxOverzooming, this._source.minzoom), o = Math.max(t + i.maxUnderzooming, this._source.minzoom), s = {}, l = 0, u = e; l < u.length; l += 1) {
                                var c = u[l]
                                  , h = this._addTile(c);
                                r[c.key] = c,
                                h.hasData() || t < this._source.maxzoom && (s[c.key] = c)
                            }
                            this._retainLoadedChildren(s, t, o, r);
                            for (var p = 0, f = e; p < f.length; p += 1) {
                                var d = f[p]
                                  , m = this._tiles[d.key];
                                if (!m.hasData()) {
                                    if (t + 1 > this._source.maxzoom) {
                                        var v = d.children(this._source.maxzoom)[0]
                                          , g = this.getTile(v);
                                        if (g && g.hasData()) {
                                            r[v.key] = v;
                                            continue
                                        }
                                    } else {
                                        var y = d.children(this._source.maxzoom);
                                        if (r[y[0].key] && r[y[1].key] && r[y[2].key] && r[y[3].key])
                                            continue
                                    }
                                    for (var _ = m.wasRequested(), x = d.overscaledZ - 1; x >= a; --x) {
                                        var b = d.scaledTo(x);
                                        if (n[b.key])
                                            break;
                                        if (n[b.key] = !0,
                                        !(m = this.getTile(b)) && _ && (m = this._addTile(b)),
                                        m && (r[b.key] = b,
                                        _ = m.wasRequested(),
                                        m.hasData()))
                                            break
                                    }
                                }
                            }
                            return r
                        }
                        ,
                        i.prototype._updateLoadedParentTileCache = function() {
                            for (var e in this._loadedParentTiles = {},
                            this._tiles) {
                                for (var t = [], i = void 0, r = this._tiles[e].tileID; r.overscaledZ > 0; ) {
                                    if (r.key in this._loadedParentTiles) {
                                        i = this._loadedParentTiles[r.key];
                                        break
                                    }
                                    t.push(r.key);
                                    var n = r.scaledTo(r.overscaledZ - 1);
                                    if (i = this._getLoadedTile(n))
                                        break;
                                    r = n
                                }
                                for (var a = 0, o = t; a < o.length; a += 1)
                                    this._loadedParentTiles[o[a]] = i
                            }
                        }
                        ,
                        i.prototype._addTile = function(t) {
                            var i = this._tiles[t.key];
                            if (i)
                                return i;
                            (i = this._cache.getAndRemove(t)) && (this._setTileReloadTimer(t.key, i),
                            i.tileID = t,
                            this._state.initializeTileState(i, this.map ? this.map.painter : null),
                            this._cacheTimers[t.key] && (clearTimeout(this._cacheTimers[t.key]),
                            delete this._cacheTimers[t.key],
                            this._setTileReloadTimer(t.key, i)));
                            var r = Boolean(i);
                            return r || (i = new e.Tile(t,this._source.tileSize * t.overscaleFactor()),
                            this._loadTile(i, this._tileLoaded.bind(this, i, t.key, i.state))),
                            i ? (i.uses++,
                            this._tiles[t.key] = i,
                            r || this._source.fire(new e.Event("dataloading",{
                                tile: i,
                                coord: i.tileID,
                                dataType: "source"
                            })),
                            i) : null
                        }
                        ,
                        i.prototype._setTileReloadTimer = function(e, t) {
                            var i = this;
                            e in this._timers && (clearTimeout(this._timers[e]),
                            delete this._timers[e]);
                            var r = t.getExpiryTimeout();
                            r && (this._timers[e] = setTimeout((function() {
                                i._reloadTile(e, "expired"),
                                delete i._timers[e]
                            }
                            ), r))
                        }
                        ,
                        i.prototype._removeTile = function(e) {
                            var t = this._tiles[e];
                            t && (t.uses--,
                            delete this._tiles[e],
                            this._timers[e] && (clearTimeout(this._timers[e]),
                            delete this._timers[e]),
                            t.uses > 0 || (t.hasData() && "reloading" !== t.state ? this._cache.add(t.tileID, t, t.getExpiryTimeout()) : (t.aborted = !0,
                            this._abortTile(t),
                            this._unloadTile(t))))
                        }
                        ,
                        i.prototype.clearTiles = function() {
                            for (var e in this._shouldReloadOnResume = !1,
                            this._paused = !1,
                            this._tiles)
                                this._removeTile(e);
                            this._cache.reset()
                        }
                        ,
                        i.prototype.tilesIn = function(t, i, r) {
                            var n = this
                              , a = []
                              , o = this.transform;
                            if (!o)
                                return a;
                            for (var s = r ? o.getCameraQueryGeometry(t) : t, l = t.map((function(e) {
                                return o.pointCoordinate(e)
                            }
                            )), u = s.map((function(e) {
                                return o.pointCoordinate(e)
                            }
                            )), c = this.getIds(), h = 1 / 0, p = 1 / 0, f = -1 / 0, d = -1 / 0, m = 0, v = u; m < v.length; m += 1) {
                                var g = v[m];
                                h = Math.min(h, g.x),
                                p = Math.min(p, g.y),
                                f = Math.max(f, g.x),
                                d = Math.max(d, g.y)
                            }
                            for (var y = function(t) {
                                var r = n._tiles[c[t]];
                                if (!r.holdingForFade()) {
                                    var s = r.tileID
                                      , m = Math.pow(2, o.zoom - r.tileID.overscaledZ)
                                      , v = i * r.queryPadding * e.EXTENT / r.tileSize / m
                                      , g = [s.getTilePoint(new e.MercatorCoordinate(h,p)), s.getTilePoint(new e.MercatorCoordinate(f,d))];
                                    if (g[0].x - v < e.EXTENT && g[0].y - v < e.EXTENT && g[1].x + v >= 0 && g[1].y + v >= 0) {
                                        var y = l.map((function(e) {
                                            return s.getTilePoint(e)
                                        }
                                        ))
                                          , _ = u.map((function(e) {
                                            return s.getTilePoint(e)
                                        }
                                        ));
                                        a.push({
                                            tile: r,
                                            tileID: s,
                                            queryGeometry: y,
                                            cameraQueryGeometry: _,
                                            scale: m
                                        })
                                    }
                                }
                            }, _ = 0; _ < c.length; _++)
                                y(_);
                            return a
                        }
                        ,
                        i.prototype.getVisibleCoordinates = function(e) {
                            for (var t = this, i = this.getRenderableIds(e).map((function(e) {
                                return t._tiles[e].tileID
                            }
                            )), r = 0, n = i; r < n.length; r += 1) {
                                var a = n[r];
                                a.posMatrix = this.transform.calculatePosMatrix(a.toUnwrapped())
                            }
                            return i
                        }
                        ,
                        i.prototype.hasTransition = function() {
                            if (this._source.hasTransition())
                                return !0;
                            if (ke(this._source.type))
                                for (var t in this._tiles) {
                                    var i = this._tiles[t];
                                    if (void 0 !== i.fadeEndTime && i.fadeEndTime >= e.browser.now())
                                        return !0
                                }
                            return !1
                        }
                        ,
                        i.prototype.setFeatureState = function(e, t, i) {
                            this._state.updateState(e = e || "_geojsonTileLayer", t, i)
                        }
                        ,
                        i.prototype.removeFeatureState = function(e, t, i) {
                            this._state.removeFeatureState(e = e || "_geojsonTileLayer", t, i)
                        }
                        ,
                        i.prototype.getFeatureState = function(e, t) {
                            return this._state.getState(e = e || "_geojsonTileLayer", t)
                        }
                        ,
                        i.prototype.setDependencies = function(e, t, i) {
                            var r = this._tiles[e];
                            r && r.setDependencies(t, i)
                        }
                        ,
                        i.prototype.reloadTilesForDependencies = function(e, t) {
                            for (var i in this._tiles)
                                this._tiles[i].hasDependency(e, t) && this._reloadTile(i, "reloading");
                            this._cache.filter((function(i) {
                                return !i.hasDependency(e, t)
                            }
                            ))
                        }
                        ,
                        i
                    }(e.Evented);
                    function Ie(e, t) {
                        var i = Math.abs(2 * e.wrap) - +(e.wrap < 0)
                          , r = Math.abs(2 * t.wrap) - +(t.wrap < 0);
                        return e.overscaledZ - t.overscaledZ || r - i || t.canonical.y - e.canonical.y || t.canonical.x - e.canonical.x
                    }
                    function ke(e) {
                        return "raster" === e || "image" === e || "video" === e
                    }
                    function ze() {
                        return new e.window.Worker(Yn.workerUrl)
                    }
                    Le.maxOverzooming = 10,
                    Le.maxUnderzooming = 3;
                    var De = "mapboxgl_preloaded_worker_pool"
                      , Re = function() {
                        this.active = {}
                    };
                    Re.prototype.acquire = function(e) {
                        if (!this.workers)
                            for (this.workers = []; this.workers.length < Re.workerCount; )
                                this.workers.push(new ze);
                        return this.active[e] = !0,
                        this.workers.slice()
                    }
                    ,
                    Re.prototype.release = function(e) {
                        delete this.active[e],
                        0 === this.numActive() && (this.workers.forEach((function(e) {
                            e.terminate()
                        }
                        )),
                        this.workers = null)
                    }
                    ,
                    Re.prototype.isPreloaded = function() {
                        return !!this.active[De]
                    }
                    ,
                    Re.prototype.numActive = function() {
                        return Object.keys(this.active).length
                    }
                    ;
                    var Oe, Be = Math.floor(e.browser.hardwareConcurrency / 2);
                    function Fe() {
                        return Oe || (Oe = new Re),
                        Oe
                    }
                    function Ne(t, i) {
                        var r = {};
                        for (var n in t)
                            "ref" !== n && (r[n] = t[n]);
                        return e.refProperties.forEach((function(e) {
                            e in i && (r[e] = i[e])
                        }
                        )),
                        r
                    }
                    function Ue(e) {
                        e = e.slice();
                        for (var t = Object.create(null), i = 0; i < e.length; i++)
                            t[e[i].id] = e[i];
                        for (var r = 0; r < e.length; r++)
                            "ref"in e[r] && (e[r] = Ne(e[r], t[e[r].ref]));
                        return e
                    }
                    Re.workerCount = Math.max(Math.min(Be, 6), 1);
                    var Ve = {
                        setStyle: "setStyle",
                        addLayer: "addLayer",
                        removeLayer: "removeLayer",
                        setPaintProperty: "setPaintProperty",
                        setLayoutProperty: "setLayoutProperty",
                        setFilter: "setFilter",
                        addSource: "addSource",
                        removeSource: "removeSource",
                        setGeoJSONSourceData: "setGeoJSONSourceData",
                        setLayerZoomRange: "setLayerZoomRange",
                        setLayerProperty: "setLayerProperty",
                        setCenter: "setCenter",
                        setZoom: "setZoom",
                        setBearing: "setBearing",
                        setPitch: "setPitch",
                        setSprite: "setSprite",
                        setGlyphs: "setGlyphs",
                        setTransition: "setTransition",
                        setLight: "setLight"
                    };
                    function Ge(e, t, i) {
                        i.push({
                            command: Ve.addSource,
                            args: [e, t[e]]
                        })
                    }
                    function je(e, t, i) {
                        t.push({
                            command: Ve.removeSource,
                            args: [e]
                        }),
                        i[e] = !0
                    }
                    function He(e, t, i, r) {
                        je(e, i, r),
                        Ge(e, t, i)
                    }
                    function qe(t, i, r) {
                        var n;
                        for (n in t[r])
                            if (t[r].hasOwnProperty(n) && "data" !== n && !e.deepEqual(t[r][n], i[r][n]))
                                return !1;
                        for (n in i[r])
                            if (i[r].hasOwnProperty(n) && "data" !== n && !e.deepEqual(t[r][n], i[r][n]))
                                return !1;
                        return !0
                    }
                    function We(t, i, r, n, a, o) {
                        var s;
                        for (s in i = i || {},
                        t = t || {})
                            t.hasOwnProperty(s) && (e.deepEqual(t[s], i[s]) || r.push({
                                command: o,
                                args: [n, s, i[s], a]
                            }));
                        for (s in i)
                            i.hasOwnProperty(s) && !t.hasOwnProperty(s) && (e.deepEqual(t[s], i[s]) || r.push({
                                command: o,
                                args: [n, s, i[s], a]
                            }))
                    }
                    function Ze(e) {
                        return e.id
                    }
                    function Xe(e, t) {
                        return e[t.id] = t,
                        e
                    }
                    var Ye = function(e, t) {
                        this.reset(e, t)
                    };
                    Ye.prototype.reset = function(e, t) {
                        this.points = e || [],
                        this._distances = [0];
                        for (var i = 1; i < this.points.length; i++)
                            this._distances[i] = this._distances[i - 1] + this.points[i].dist(this.points[i - 1]);
                        this.length = this._distances[this._distances.length - 1],
                        this.padding = Math.min(t || 0, .5 * this.length),
                        this.paddedLength = this.length - 2 * this.padding
                    }
                    ,
                    Ye.prototype.lerp = function(t) {
                        if (1 === this.points.length)
                            return this.points[0];
                        t = e.clamp(t, 0, 1);
                        for (var i = 1, r = this._distances[i], n = t * this.paddedLength + this.padding; r < n && i < this._distances.length; )
                            r = this._distances[++i];
                        var a = i - 1
                          , o = this._distances[a]
                          , s = r - o
                          , l = s > 0 ? (n - o) / s : 0;
                        return this.points[a].mult(1 - l).add(this.points[i].mult(l))
                    }
                    ;
                    var Ke = function(e, t, i) {
                        var r = this.boxCells = []
                          , n = this.circleCells = [];
                        this.xCellCount = Math.ceil(e / i),
                        this.yCellCount = Math.ceil(t / i);
                        for (var a = 0; a < this.xCellCount * this.yCellCount; a++)
                            r.push([]),
                            n.push([]);
                        this.circleKeys = [],
                        this.boxKeys = [],
                        this.bboxes = [],
                        this.circles = [],
                        this.width = e,
                        this.height = t,
                        this.xScale = this.xCellCount / e,
                        this.yScale = this.yCellCount / t,
                        this.boxUid = 0,
                        this.circleUid = 0
                    };
                    function Je(t, i, r, n, a) {
                        var o = e.create();
                        return i ? (e.scale(o, o, [1 / a, 1 / a, 1]),
                        r || e.rotateZ(o, o, n.angle)) : e.multiply(o, n.labelPlaneMatrix, t),
                        o
                    }
                    function Qe(t, i, r, n, a) {
                        if (i) {
                            var o = e.clone(t);
                            return e.scale(o, o, [a, a, 1]),
                            r || e.rotateZ(o, o, -n.angle),
                            o
                        }
                        return n.glCoordMatrix
                    }
                    function $e(t, i) {
                        var r = [t.x, t.y, 0, 1];
                        ct(r, r, i);
                        var n = r[3];
                        return {
                            point: new e.Point(r[0] / n,r[1] / n),
                            signedDistanceFromCamera: n
                        }
                    }
                    function et(e, t) {
                        return .5 + e / t * .5
                    }
                    function tt(e, t) {
                        var i = e[0] / e[3]
                          , r = e[1] / e[3];
                        return i >= -t[0] && i <= t[0] && r >= -t[1] && r <= t[1]
                    }
                    function it(t, i, r, n, a, o, s, l) {
                        var u = n ? t.textSizeData : t.iconSizeData
                          , c = e.evaluateSizeForZoom(u, r.transform.zoom)
                          , h = [256 / r.width * 2 + 1, 256 / r.height * 2 + 1]
                          , p = n ? t.text.dynamicLayoutVertexArray : t.icon.dynamicLayoutVertexArray;
                        p.clear();
                        for (var f = t.lineVertexArray, d = n ? t.text.placedSymbolArray : t.icon.placedSymbolArray, m = r.transform.width / r.transform.height, v = !1, g = 0; g < d.length; g++) {
                            var y = d.get(g);
                            if (y.hidden || y.writingMode === e.WritingMode.vertical && !v)
                                ut(y.numGlyphs, p);
                            else {
                                v = !1;
                                var _ = [y.anchorX, y.anchorY, 0, 1];
                                if (e.transformMat4(_, _, i),
                                tt(_, h)) {
                                    var x = et(r.transform.cameraToCenterDistance, _[3])
                                      , b = e.evaluateSizeForFeature(u, c, y)
                                      , w = s ? b / x : b * x
                                      , S = new e.Point(y.anchorX,y.anchorY)
                                      , M = $e(S, a).point
                                      , T = {}
                                      , E = at(y, w, !1, l, i, a, o, t.glyphOffsetArray, f, p, M, S, T, m);
                                    v = E.useVertical,
                                    (E.notEnoughRoom || v || E.needsFlipping && at(y, w, !0, l, i, a, o, t.glyphOffsetArray, f, p, M, S, T, m).notEnoughRoom) && ut(y.numGlyphs, p)
                                } else
                                    ut(y.numGlyphs, p)
                            }
                        }
                        n ? t.text.dynamicLayoutVertexBuffer.updateData(p) : t.icon.dynamicLayoutVertexBuffer.updateData(p)
                    }
                    function rt(e, t, i, r, n, a, o, s, l, u, c) {
                        var h = s.glyphStartIndex + s.numGlyphs
                          , p = s.lineStartIndex
                          , f = s.lineStartIndex + s.lineLength
                          , d = t.getoffsetX(s.glyphStartIndex)
                          , m = t.getoffsetX(h - 1)
                          , v = st(e * d, i, r, n, a, o, s.segment, p, f, l, u, c);
                        if (!v)
                            return null;
                        var g = st(e * m, i, r, n, a, o, s.segment, p, f, l, u, c);
                        return g ? {
                            first: v,
                            last: g
                        } : null
                    }
                    function nt(t, i, r, n) {
                        return t === e.WritingMode.horizontal && Math.abs(r.y - i.y) > Math.abs(r.x - i.x) * n ? {
                            useVertical: !0
                        } : (t === e.WritingMode.vertical ? i.y < r.y : i.x > r.x) ? {
                            needsFlipping: !0
                        } : null
                    }
                    function at(t, i, r, n, a, o, s, l, u, c, h, p, f, d) {
                        var m, v = i / 24, g = t.lineOffsetX * v, y = t.lineOffsetY * v;
                        if (t.numGlyphs > 1) {
                            var _ = t.glyphStartIndex + t.numGlyphs
                              , x = t.lineStartIndex
                              , b = t.lineStartIndex + t.lineLength
                              , w = rt(v, l, g, y, r, h, p, t, u, o, f);
                            if (!w)
                                return {
                                    notEnoughRoom: !0
                                };
                            var S = $e(w.first.point, s).point
                              , M = $e(w.last.point, s).point;
                            if (n && !r) {
                                var T = nt(t.writingMode, S, M, d);
                                if (T)
                                    return T
                            }
                            m = [w.first];
                            for (var E = t.glyphStartIndex + 1; E < _ - 1; E++)
                                m.push(st(v * l.getoffsetX(E), g, y, r, h, p, t.segment, x, b, u, o, f));
                            m.push(w.last)
                        } else {
                            if (n && !r) {
                                var A = $e(p, a).point
                                  , P = t.lineStartIndex + t.segment + 1
                                  , C = new e.Point(u.getx(P),u.gety(P))
                                  , L = $e(C, a)
                                  , I = L.signedDistanceFromCamera > 0 ? L.point : ot(p, C, A, 1, a)
                                  , k = nt(t.writingMode, A, I, d);
                                if (k)
                                    return k
                            }
                            var z = st(v * l.getoffsetX(t.glyphStartIndex), g, y, r, h, p, t.segment, t.lineStartIndex, t.lineStartIndex + t.lineLength, u, o, f);
                            if (!z)
                                return {
                                    notEnoughRoom: !0
                                };
                            m = [z]
                        }
                        for (var D = 0, R = m; D < R.length; D += 1) {
                            var O = R[D];
                            e.addDynamicAttributes(c, O.point, O.angle)
                        }
                        return {}
                    }
                    function ot(e, t, i, r, n) {
                        var a = $e(e.add(e.sub(t)._unit()), n).point
                          , o = i.sub(a);
                        return i.add(o._mult(r / o.mag()))
                    }
                    function st(t, i, r, n, a, o, s, l, u, c, h, p) {
                        var f = n ? t - i : t + i
                          , d = f > 0 ? 1 : -1
                          , m = 0;
                        n && (d *= -1,
                        m = Math.PI),
                        d < 0 && (m += Math.PI);
                        for (var v = d > 0 ? l + s : l + s + 1, g = a, y = a, _ = 0, x = 0, b = Math.abs(f), w = []; _ + x <= b; ) {
                            if ((v += d) < l || v >= u)
                                return null;
                            if (y = g,
                            w.push(g),
                            void 0 === (g = p[v])) {
                                var S = new e.Point(c.getx(v),c.gety(v))
                                  , M = $e(S, h);
                                if (M.signedDistanceFromCamera > 0)
                                    g = p[v] = M.point;
                                else {
                                    var T = v - d;
                                    g = ot(0 === _ ? o : new e.Point(c.getx(T),c.gety(T)), S, y, b - _ + 1, h)
                                }
                            }
                            _ += x,
                            x = y.dist(g)
                        }
                        var E = (b - _) / x
                          , A = g.sub(y)
                          , P = A.mult(E)._add(y);
                        P._add(A._unit()._perp()._mult(r * d));
                        var C = m + Math.atan2(g.y - y.y, g.x - y.x);
                        return w.push(P),
                        {
                            point: P,
                            angle: C,
                            path: w
                        }
                    }
                    Ke.prototype.keysLength = function() {
                        return this.boxKeys.length + this.circleKeys.length
                    }
                    ,
                    Ke.prototype.insert = function(e, t, i, r, n) {
                        this._forEachCell(t, i, r, n, this._insertBoxCell, this.boxUid++),
                        this.boxKeys.push(e),
                        this.bboxes.push(t),
                        this.bboxes.push(i),
                        this.bboxes.push(r),
                        this.bboxes.push(n)
                    }
                    ,
                    Ke.prototype.insertCircle = function(e, t, i, r) {
                        this._forEachCell(t - r, i - r, t + r, i + r, this._insertCircleCell, this.circleUid++),
                        this.circleKeys.push(e),
                        this.circles.push(t),
                        this.circles.push(i),
                        this.circles.push(r)
                    }
                    ,
                    Ke.prototype._insertBoxCell = function(e, t, i, r, n, a) {
                        this.boxCells[n].push(a)
                    }
                    ,
                    Ke.prototype._insertCircleCell = function(e, t, i, r, n, a) {
                        this.circleCells[n].push(a)
                    }
                    ,
                    Ke.prototype._query = function(e, t, i, r, n, a) {
                        if (i < 0 || e > this.width || r < 0 || t > this.height)
                            return !n && [];
                        var o = [];
                        if (e <= 0 && t <= 0 && this.width <= i && this.height <= r) {
                            if (n)
                                return !0;
                            for (var s = 0; s < this.boxKeys.length; s++)
                                o.push({
                                    key: this.boxKeys[s],
                                    x1: this.bboxes[4 * s],
                                    y1: this.bboxes[4 * s + 1],
                                    x2: this.bboxes[4 * s + 2],
                                    y2: this.bboxes[4 * s + 3]
                                });
                            for (var l = 0; l < this.circleKeys.length; l++) {
                                var u = this.circles[3 * l]
                                  , c = this.circles[3 * l + 1]
                                  , h = this.circles[3 * l + 2];
                                o.push({
                                    key: this.circleKeys[l],
                                    x1: u - h,
                                    y1: c - h,
                                    x2: u + h,
                                    y2: c + h
                                })
                            }
                            return a ? o.filter(a) : o
                        }
                        return this._forEachCell(e, t, i, r, this._queryCell, o, {
                            hitTest: n,
                            seenUids: {
                                box: {},
                                circle: {}
                            }
                        }, a),
                        n ? o.length > 0 : o
                    }
                    ,
                    Ke.prototype._queryCircle = function(e, t, i, r, n) {
                        var a = e - i
                          , o = e + i
                          , s = t - i
                          , l = t + i;
                        if (o < 0 || a > this.width || l < 0 || s > this.height)
                            return !r && [];
                        var u = [];
                        return this._forEachCell(a, s, o, l, this._queryCellCircle, u, {
                            hitTest: r,
                            circle: {
                                x: e,
                                y: t,
                                radius: i
                            },
                            seenUids: {
                                box: {},
                                circle: {}
                            }
                        }, n),
                        r ? u.length > 0 : u
                    }
                    ,
                    Ke.prototype.query = function(e, t, i, r, n) {
                        return this._query(e, t, i, r, !1, n)
                    }
                    ,
                    Ke.prototype.hitTest = function(e, t, i, r, n) {
                        return this._query(e, t, i, r, !0, n)
                    }
                    ,
                    Ke.prototype.hitTestCircle = function(e, t, i, r) {
                        return this._queryCircle(e, t, i, !0, r)
                    }
                    ,
                    Ke.prototype._queryCell = function(e, t, i, r, n, a, o, s) {
                        var l = o.seenUids
                          , u = this.boxCells[n];
                        if (null !== u)
                            for (var c = this.bboxes, h = 0, p = u; h < p.length; h += 1) {
                                var f = p[h];
                                if (!l.box[f]) {
                                    l.box[f] = !0;
                                    var d = 4 * f;
                                    if (e <= c[d + 2] && t <= c[d + 3] && i >= c[d + 0] && r >= c[d + 1] && (!s || s(this.boxKeys[f]))) {
                                        if (o.hitTest)
                                            return a.push(!0),
                                            !0;
                                        a.push({
                                            key: this.boxKeys[f],
                                            x1: c[d],
                                            y1: c[d + 1],
                                            x2: c[d + 2],
                                            y2: c[d + 3]
                                        })
                                    }
                                }
                            }
                        var m = this.circleCells[n];
                        if (null !== m)
                            for (var v = this.circles, g = 0, y = m; g < y.length; g += 1) {
                                var _ = y[g];
                                if (!l.circle[_]) {
                                    l.circle[_] = !0;
                                    var x = 3 * _;
                                    if (this._circleAndRectCollide(v[x], v[x + 1], v[x + 2], e, t, i, r) && (!s || s(this.circleKeys[_]))) {
                                        if (o.hitTest)
                                            return a.push(!0),
                                            !0;
                                        var b = v[x]
                                          , w = v[x + 1]
                                          , S = v[x + 2];
                                        a.push({
                                            key: this.circleKeys[_],
                                            x1: b - S,
                                            y1: w - S,
                                            x2: b + S,
                                            y2: w + S
                                        })
                                    }
                                }
                            }
                    }
                    ,
                    Ke.prototype._queryCellCircle = function(e, t, i, r, n, a, o, s) {
                        var l = o.circle
                          , u = o.seenUids
                          , c = this.boxCells[n];
                        if (null !== c)
                            for (var h = this.bboxes, p = 0, f = c; p < f.length; p += 1) {
                                var d = f[p];
                                if (!u.box[d]) {
                                    u.box[d] = !0;
                                    var m = 4 * d;
                                    if (this._circleAndRectCollide(l.x, l.y, l.radius, h[m + 0], h[m + 1], h[m + 2], h[m + 3]) && (!s || s(this.boxKeys[d])))
                                        return a.push(!0),
                                        !0
                                }
                            }
                        var v = this.circleCells[n];
                        if (null !== v)
                            for (var g = this.circles, y = 0, _ = v; y < _.length; y += 1) {
                                var x = _[y];
                                if (!u.circle[x]) {
                                    u.circle[x] = !0;
                                    var b = 3 * x;
                                    if (this._circlesCollide(g[b], g[b + 1], g[b + 2], l.x, l.y, l.radius) && (!s || s(this.circleKeys[x])))
                                        return a.push(!0),
                                        !0
                                }
                            }
                    }
                    ,
                    Ke.prototype._forEachCell = function(e, t, i, r, n, a, o, s) {
                        for (var l = this._convertToXCellCoord(e), u = this._convertToYCellCoord(t), c = this._convertToXCellCoord(i), h = this._convertToYCellCoord(r), p = l; p <= c; p++)
                            for (var f = u; f <= h; f++)
                                if (n.call(this, e, t, i, r, this.xCellCount * f + p, a, o, s))
                                    return
                    }
                    ,
                    Ke.prototype._convertToXCellCoord = function(e) {
                        return Math.max(0, Math.min(this.xCellCount - 1, Math.floor(e * this.xScale)))
                    }
                    ,
                    Ke.prototype._convertToYCellCoord = function(e) {
                        return Math.max(0, Math.min(this.yCellCount - 1, Math.floor(e * this.yScale)))
                    }
                    ,
                    Ke.prototype._circlesCollide = function(e, t, i, r, n, a) {
                        var o = r - e
                          , s = n - t
                          , l = i + a;
                        return l * l > o * o + s * s
                    }
                    ,
                    Ke.prototype._circleAndRectCollide = function(e, t, i, r, n, a, o) {
                        var s = (a - r) / 2
                          , l = Math.abs(e - (r + s));
                        if (l > s + i)
                            return !1;
                        var u = (o - n) / 2
                          , c = Math.abs(t - (n + u));
                        if (c > u + i)
                            return !1;
                        if (l <= s || c <= u)
                            return !0;
                        var h = l - s
                          , p = c - u;
                        return h * h + p * p <= i * i
                    }
                    ;
                    var lt = new Float32Array([-1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0]);
                    function ut(e, t) {
                        for (var i = 0; i < e; i++) {
                            var r = t.length;
                            t.resize(r + 4),
                            t.float32.set(lt, 3 * r)
                        }
                    }
                    function ct(e, t, i) {
                        var r = t[0]
                          , n = t[1];
                        return e[0] = i[0] * r + i[4] * n + i[12],
                        e[1] = i[1] * r + i[5] * n + i[13],
                        e[3] = i[3] * r + i[7] * n + i[15],
                        e
                    }
                    var ht = function(e, t, i) {
                        void 0 === t && (t = new Ke(e.width + 200,e.height + 200,25)),
                        void 0 === i && (i = new Ke(e.width + 200,e.height + 200,25)),
                        this.transform = e,
                        this.grid = t,
                        this.ignoredGrid = i,
                        this.pitchfactor = Math.cos(e._pitch) * e.cameraToCenterDistance,
                        this.screenRightBoundary = e.width + 100,
                        this.screenBottomBoundary = e.height + 100,
                        this.gridRightBoundary = e.width + 200,
                        this.gridBottomBoundary = e.height + 200
                    };
                    function pt(t, i, r) {
                        return i * (e.EXTENT / (t.tileSize * Math.pow(2, r - t.tileID.overscaledZ)))
                    }
                    ht.prototype.placeCollisionBox = function(e, t, i, r, n) {
                        var a = this.projectAndGetPerspectiveRatio(r, e.anchorPointX, e.anchorPointY)
                          , o = i * a.perspectiveRatio
                          , s = e.x1 * o + a.point.x
                          , l = e.y1 * o + a.point.y
                          , u = e.x2 * o + a.point.x
                          , c = e.y2 * o + a.point.y;
                        return !this.isInsideGrid(s, l, u, c) || !t && this.grid.hitTest(s, l, u, c, n) ? {
                            box: [],
                            offscreen: !1
                        } : {
                            box: [s, l, u, c],
                            offscreen: this.isOffscreen(s, l, u, c)
                        }
                    }
                    ,
                    ht.prototype.placeCollisionCircles = function(t, i, r, n, a, o, s, l, u, c, h, p, f) {
                        var d = []
                          , m = new e.Point(i.anchorX,i.anchorY)
                          , v = $e(m, o)
                          , g = et(this.transform.cameraToCenterDistance, v.signedDistanceFromCamera)
                          , y = (c ? a / g : a * g) / e.ONE_EM
                          , _ = $e(m, s).point
                          , x = rt(y, n, i.lineOffsetX * y, i.lineOffsetY * y, !1, _, m, i, r, s, {})
                          , b = !1
                          , w = !1
                          , S = !0;
                        if (x) {
                            for (var M = .5 * p * g + f, T = new e.Point(-100,-100), E = new e.Point(this.screenRightBoundary,this.screenBottomBoundary), A = new Ye, P = x.first, C = x.last, L = [], I = P.path.length - 1; I >= 1; I--)
                                L.push(P.path[I]);
                            for (var k = 1; k < C.path.length; k++)
                                L.push(C.path[k]);
                            var z = 2.5 * M;
                            if (l) {
                                var D = L.map((function(e) {
                                    return $e(e, l)
                                }
                                ));
                                L = D.some((function(e) {
                                    return e.signedDistanceFromCamera <= 0
                                }
                                )) ? [] : D.map((function(e) {
                                    return e.point
                                }
                                ))
                            }
                            var R = [];
                            if (L.length > 0) {
                                for (var O = L[0].clone(), B = L[0].clone(), F = 1; F < L.length; F++)
                                    O.x = Math.min(O.x, L[F].x),
                                    O.y = Math.min(O.y, L[F].y),
                                    B.x = Math.max(B.x, L[F].x),
                                    B.y = Math.max(B.y, L[F].y);
                                R = O.x >= T.x && B.x <= E.x && O.y >= T.y && B.y <= E.y ? [L] : B.x < T.x || O.x > E.x || B.y < T.y || O.y > E.y ? [] : e.clipLine([L], T.x, T.y, E.x, E.y)
                            }
                            for (var N = 0, U = R; N < U.length; N += 1) {
                                var V;
                                A.reset(U[N], .25 * M),
                                V = A.length <= .5 * M ? 1 : Math.ceil(A.paddedLength / z) + 1;
                                for (var G = 0; G < V; G++) {
                                    var j = G / Math.max(V - 1, 1)
                                      , H = A.lerp(j)
                                      , q = H.x + 100
                                      , W = H.y + 100;
                                    d.push(q, W, M, 0);
                                    var Z = q - M
                                      , X = W - M
                                      , Y = q + M
                                      , K = W + M;
                                    if (S = S && this.isOffscreen(Z, X, Y, K),
                                    w = w || this.isInsideGrid(Z, X, Y, K),
                                    !t && this.grid.hitTestCircle(q, W, M, h) && (b = !0,
                                    !u))
                                        return {
                                            circles: [],
                                            offscreen: !1,
                                            collisionDetected: b
                                        }
                                }
                            }
                        }
                        return {
                            circles: !u && b || !w ? [] : d,
                            offscreen: S,
                            collisionDetected: b
                        }
                    }
                    ,
                    ht.prototype.queryRenderedSymbols = function(t) {
                        if (0 === t.length || 0 === this.grid.keysLength() && 0 === this.ignoredGrid.keysLength())
                            return {};
                        for (var i = [], r = 1 / 0, n = 1 / 0, a = -1 / 0, o = -1 / 0, s = 0, l = t; s < l.length; s += 1) {
                            var u = l[s]
                              , c = new e.Point(u.x + 100,u.y + 100);
                            r = Math.min(r, c.x),
                            n = Math.min(n, c.y),
                            a = Math.max(a, c.x),
                            o = Math.max(o, c.y),
                            i.push(c)
                        }
                        for (var h = {}, p = {}, f = 0, d = this.grid.query(r, n, a, o).concat(this.ignoredGrid.query(r, n, a, o)); f < d.length; f += 1) {
                            var m = d[f]
                              , v = m.key;
                            if (void 0 === h[v.bucketInstanceId] && (h[v.bucketInstanceId] = {}),
                            !h[v.bucketInstanceId][v.featureIndex]) {
                                var g = [new e.Point(m.x1,m.y1), new e.Point(m.x2,m.y1), new e.Point(m.x2,m.y2), new e.Point(m.x1,m.y2)];
                                e.polygonIntersectsPolygon(i, g) && (h[v.bucketInstanceId][v.featureIndex] = !0,
                                void 0 === p[v.bucketInstanceId] && (p[v.bucketInstanceId] = []),
                                p[v.bucketInstanceId].push(v.featureIndex))
                            }
                        }
                        return p
                    }
                    ,
                    ht.prototype.insertCollisionBox = function(e, t, i, r, n) {
                        (t ? this.ignoredGrid : this.grid).insert({
                            bucketInstanceId: i,
                            featureIndex: r,
                            collisionGroupID: n
                        }, e[0], e[1], e[2], e[3])
                    }
                    ,
                    ht.prototype.insertCollisionCircles = function(e, t, i, r, n) {
                        for (var a = t ? this.ignoredGrid : this.grid, o = {
                            bucketInstanceId: i,
                            featureIndex: r,
                            collisionGroupID: n
                        }, s = 0; s < e.length; s += 4)
                            a.insertCircle(o, e[s], e[s + 1], e[s + 2])
                    }
                    ,
                    ht.prototype.projectAndGetPerspectiveRatio = function(t, i, r) {
                        var n = [i, r, 0, 1];
                        return ct(n, n, t),
                        {
                            point: new e.Point((n[0] / n[3] + 1) / 2 * this.transform.width + 100,(-n[1] / n[3] + 1) / 2 * this.transform.height + 100),
                            perspectiveRatio: .5 + this.transform.cameraToCenterDistance / n[3] * .5
                        }
                    }
                    ,
                    ht.prototype.isOffscreen = function(e, t, i, r) {
                        return i < 100 || e >= this.screenRightBoundary || r < 100 || t > this.screenBottomBoundary
                    }
                    ,
                    ht.prototype.isInsideGrid = function(e, t, i, r) {
                        return i >= 0 && e < this.gridRightBoundary && r >= 0 && t < this.gridBottomBoundary
                    }
                    ,
                    ht.prototype.getViewportMatrix = function() {
                        var t = e.identity([]);
                        return e.translate(t, t, [-100, -100, 0]),
                        t
                    }
                    ;
                    var ft = function(e, t, i, r) {
                        this.opacity = e ? Math.max(0, Math.min(1, e.opacity + (e.placed ? t : -t))) : r && i ? 1 : 0,
                        this.placed = i
                    };
                    ft.prototype.isHidden = function() {
                        return 0 === this.opacity && !this.placed
                    }
                    ;
                    var dt = function(e, t, i, r, n) {
                        this.text = new ft(e ? e.text : null,t,i,n),
                        this.icon = new ft(e ? e.icon : null,t,r,n)
                    };
                    dt.prototype.isHidden = function() {
                        return this.text.isHidden() && this.icon.isHidden()
                    }
                    ;
                    var mt = function(e, t, i) {
                        this.text = e,
                        this.icon = t,
                        this.skipFade = i
                    }
                      , vt = function() {
                        this.invProjMatrix = e.create(),
                        this.viewportMatrix = e.create(),
                        this.circles = []
                    }
                      , gt = function(e, t, i, r, n) {
                        this.bucketInstanceId = e,
                        this.featureIndex = t,
                        this.sourceLayerIndex = i,
                        this.bucketIndex = r,
                        this.tileID = n
                    }
                      , yt = function(e) {
                        this.crossSourceCollisions = e,
                        this.maxGroupID = 0,
                        this.collisionGroups = {}
                    };
                    function _t(t, i, r, n, a) {
                        var o = e.getAnchorAlignment(t)
                          , s = -(o.horizontalAlign - .5) * i
                          , l = -(o.verticalAlign - .5) * r
                          , u = e.evaluateVariableOffset(t, n);
                        return new e.Point(s + u[0] * a,l + u[1] * a)
                    }
                    function xt(t, i, r, n, a, o) {
                        var s = t.x1
                          , l = t.x2
                          , u = t.y1
                          , c = t.y2
                          , h = t.anchorPointX
                          , p = t.anchorPointY
                          , f = new e.Point(i,r);
                        return n && f._rotate(a ? o : -o),
                        {
                            x1: s + f.x,
                            y1: u + f.y,
                            x2: l + f.x,
                            y2: c + f.y,
                            anchorPointX: h,
                            anchorPointY: p
                        }
                    }
                    yt.prototype.get = function(e) {
                        if (this.crossSourceCollisions)
                            return {
                                ID: 0,
                                predicate: null
                            };
                        if (!this.collisionGroups[e]) {
                            var t = ++this.maxGroupID;
                            this.collisionGroups[e] = {
                                ID: t,
                                predicate: function(e) {
                                    return e.collisionGroupID === t
                                }
                            }
                        }
                        return this.collisionGroups[e]
                    }
                    ;
                    var bt = function(e, t, i, r) {
                        this.transform = e.clone(),
                        this.collisionIndex = new ht(this.transform),
                        this.placements = {},
                        this.opacities = {},
                        this.variableOffsets = {},
                        this.stale = !1,
                        this.commitTime = 0,
                        this.fadeDuration = t,
                        this.retainedQueryData = {},
                        this.collisionGroups = new yt(i),
                        this.collisionCircleArrays = {},
                        this.prevPlacement = r,
                        r && (r.prevPlacement = void 0),
                        this.placedOrientations = {}
                    };
                    function wt(e, t, i, r, n) {
                        e.emplaceBack(t ? 1 : 0, i ? 1 : 0, r || 0, n || 0),
                        e.emplaceBack(t ? 1 : 0, i ? 1 : 0, r || 0, n || 0),
                        e.emplaceBack(t ? 1 : 0, i ? 1 : 0, r || 0, n || 0),
                        e.emplaceBack(t ? 1 : 0, i ? 1 : 0, r || 0, n || 0)
                    }
                    bt.prototype.getBucketParts = function(t, i, r, n) {
                        var a = r.getBucket(i)
                          , o = r.latestFeatureIndex;
                        if (a && o && i.id === a.layerIds[0]) {
                            var s = r.collisionBoxArray
                              , l = a.layers[0].layout
                              , u = Math.pow(2, this.transform.zoom - r.tileID.overscaledZ)
                              , c = r.tileSize / e.EXTENT
                              , h = this.transform.calculatePosMatrix(r.tileID.toUnwrapped())
                              , p = "map" === l.get("text-pitch-alignment")
                              , f = "map" === l.get("text-rotation-alignment")
                              , d = pt(r, 1, this.transform.zoom)
                              , m = Je(h, p, f, this.transform, d)
                              , v = null;
                            if (p) {
                                var g = Qe(h, p, f, this.transform, d);
                                v = e.multiply([], this.transform.labelPlaneMatrix, g)
                            }
                            this.retainedQueryData[a.bucketInstanceId] = new gt(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,r.tileID);
                            var y = {
                                bucket: a,
                                layout: l,
                                posMatrix: h,
                                textLabelPlaneMatrix: m,
                                labelToScreenMatrix: v,
                                scale: u,
                                textPixelRatio: c,
                                holdingForFade: r.holdingForFade(),
                                collisionBoxArray: s,
                                partiallyEvaluatedTextSize: e.evaluateSizeForZoom(a.textSizeData, this.transform.zoom),
                                collisionGroup: this.collisionGroups.get(a.sourceID)
                            };
                            if (n)
                                for (var _ = 0, x = a.sortKeyRanges; _ < x.length; _ += 1) {
                                    var b = x[_];
                                    t.push({
                                        sortKey: b.sortKey,
                                        symbolInstanceStart: b.symbolInstanceStart,
                                        symbolInstanceEnd: b.symbolInstanceEnd,
                                        parameters: y
                                    })
                                }
                            else
                                t.push({
                                    symbolInstanceStart: 0,
                                    symbolInstanceEnd: a.symbolInstances.length,
                                    parameters: y
                                })
                        }
                    }
                    ,
                    bt.prototype.attemptAnchorPlacement = function(e, t, i, r, n, a, o, s, l, u, c, h, p, f, d) {
                        var m, v = [h.textOffset0, h.textOffset1], g = _t(e, i, r, v, n), y = this.collisionIndex.placeCollisionBox(xt(t, g.x, g.y, a, o, this.transform.angle), c, s, l, u.predicate);
                        if (!d || 0 !== this.collisionIndex.placeCollisionBox(xt(d, g.x, g.y, a, o, this.transform.angle), c, s, l, u.predicate).box.length)
                            return y.box.length > 0 ? (this.prevPlacement && this.prevPlacement.variableOffsets[h.crossTileID] && this.prevPlacement.placements[h.crossTileID] && this.prevPlacement.placements[h.crossTileID].text && (m = this.prevPlacement.variableOffsets[h.crossTileID].anchor),
                            this.variableOffsets[h.crossTileID] = {
                                textOffset: v,
                                width: i,
                                height: r,
                                anchor: e,
                                textBoxScale: n,
                                prevAnchor: m
                            },
                            this.markUsedJustification(p, e, h, f),
                            p.allowVerticalPlacement && (this.markUsedOrientation(p, f, h),
                            this.placedOrientations[h.crossTileID] = f),
                            {
                                shift: g,
                                placedGlyphBoxes: y
                            }) : void 0
                    }
                    ,
                    bt.prototype.placeLayerBucketPart = function(t, i, r) {
                        var n = this
                          , a = t.parameters
                          , o = a.bucket
                          , s = a.layout
                          , l = a.posMatrix
                          , u = a.textLabelPlaneMatrix
                          , c = a.labelToScreenMatrix
                          , h = a.textPixelRatio
                          , p = a.holdingForFade
                          , f = a.collisionBoxArray
                          , d = a.partiallyEvaluatedTextSize
                          , m = a.collisionGroup
                          , v = s.get("text-optional")
                          , g = s.get("icon-optional")
                          , y = s.get("text-allow-overlap")
                          , _ = s.get("icon-allow-overlap")
                          , x = "map" === s.get("text-rotation-alignment")
                          , b = "map" === s.get("text-pitch-alignment")
                          , w = "none" !== s.get("icon-text-fit")
                          , S = "viewport-y" === s.get("symbol-z-order")
                          , M = y && (_ || !o.hasIconData() || g)
                          , T = _ && (y || !o.hasTextData() || v);
                        !o.collisionArrays && f && o.deserializeCollisionBoxes(f);
                        var E = function(t, a) {
                            if (!i[t.crossTileID])
                                if (p)
                                    n.placements[t.crossTileID] = new mt(!1,!1,!1);
                                else {
                                    var f, S = !1, E = !1, A = !0, P = null, C = {
                                        box: null,
                                        offscreen: null
                                    }, L = {
                                        box: null,
                                        offscreen: null
                                    }, I = null, k = null, z = 0, D = 0, R = 0;
                                    a.textFeatureIndex ? z = a.textFeatureIndex : t.useRuntimeCollisionCircles && (z = t.featureIndex),
                                    a.verticalTextFeatureIndex && (D = a.verticalTextFeatureIndex);
                                    var O = a.textBox;
                                    if (O) {
                                        var B = function(i) {
                                            var r = e.WritingMode.horizontal;
                                            if (o.allowVerticalPlacement && !i && n.prevPlacement) {
                                                var a = n.prevPlacement.placedOrientations[t.crossTileID];
                                                a && (n.placedOrientations[t.crossTileID] = a,
                                                n.markUsedOrientation(o, r = a, t))
                                            }
                                            return r
                                        }
                                          , F = function(i, r) {
                                            if (o.allowVerticalPlacement && t.numVerticalGlyphVertices > 0 && a.verticalTextBox)
                                                for (var n = 0, s = o.writingModes; n < s.length && (s[n] === e.WritingMode.vertical ? (C = r(),
                                                L = C) : C = i(),
                                                !(C && C.box && C.box.length)); n += 1)
                                                    ;
                                            else
                                                C = i()
                                        };
                                        if (s.get("text-variable-anchor")) {
                                            var N = s.get("text-variable-anchor");
                                            if (n.prevPlacement && n.prevPlacement.variableOffsets[t.crossTileID]) {
                                                var U = n.prevPlacement.variableOffsets[t.crossTileID];
                                                N.indexOf(U.anchor) > 0 && (N = N.filter((function(e) {
                                                    return e !== U.anchor
                                                }
                                                ))).unshift(U.anchor)
                                            }
                                            var V = function(e, i, r) {
                                                for (var a = e.x2 - e.x1, s = e.y2 - e.y1, u = t.textBoxScale, c = w && !_ ? i : null, p = {
                                                    box: [],
                                                    offscreen: !1
                                                }, f = y ? 2 * N.length : N.length, d = 0; d < f; ++d) {
                                                    var v = n.attemptAnchorPlacement(N[d % N.length], e, a, s, u, x, b, h, l, m, d >= N.length, t, o, r, c);
                                                    if (v && (p = v.placedGlyphBoxes) && p.box && p.box.length) {
                                                        S = !0,
                                                        P = v.shift;
                                                        break
                                                    }
                                                }
                                                return p
                                            };
                                            F((function() {
                                                return V(O, a.iconBox, e.WritingMode.horizontal)
                                            }
                                            ), (function() {
                                                var i = a.verticalTextBox;
                                                return o.allowVerticalPlacement && !(C && C.box && C.box.length) && t.numVerticalGlyphVertices > 0 && i ? V(i, a.verticalIconBox, e.WritingMode.vertical) : {
                                                    box: null,
                                                    offscreen: null
                                                }
                                            }
                                            )),
                                            C && (S = C.box,
                                            A = C.offscreen);
                                            var G = B(C && C.box);
                                            if (!S && n.prevPlacement) {
                                                var j = n.prevPlacement.variableOffsets[t.crossTileID];
                                                j && (n.variableOffsets[t.crossTileID] = j,
                                                n.markUsedJustification(o, j.anchor, t, G))
                                            }
                                        } else {
                                            var H = function(e, i) {
                                                var r = n.collisionIndex.placeCollisionBox(e, y, h, l, m.predicate);
                                                return r && r.box && r.box.length && (n.markUsedOrientation(o, i, t),
                                                n.placedOrientations[t.crossTileID] = i),
                                                r
                                            };
                                            F((function() {
                                                return H(O, e.WritingMode.horizontal)
                                            }
                                            ), (function() {
                                                var i = a.verticalTextBox;
                                                return o.allowVerticalPlacement && t.numVerticalGlyphVertices > 0 && i ? H(i, e.WritingMode.vertical) : {
                                                    box: null,
                                                    offscreen: null
                                                }
                                            }
                                            )),
                                            B(C && C.box && C.box.length)
                                        }
                                    }
                                    if (S = (f = C) && f.box && f.box.length > 0,
                                    A = f && f.offscreen,
                                    t.useRuntimeCollisionCircles) {
                                        var q = o.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex)
                                          , W = e.evaluateSizeForFeature(o.textSizeData, d, q)
                                          , Z = s.get("text-padding");
                                        I = n.collisionIndex.placeCollisionCircles(y, q, o.lineVertexArray, o.glyphOffsetArray, W, l, u, c, r, b, m.predicate, t.collisionCircleDiameter, Z),
                                        S = y || I.circles.length > 0 && !I.collisionDetected,
                                        A = A && I.offscreen
                                    }
                                    if (a.iconFeatureIndex && (R = a.iconFeatureIndex),
                                    a.iconBox) {
                                        var X = function(e) {
                                            var t = w && P ? xt(e, P.x, P.y, x, b, n.transform.angle) : e;
                                            return n.collisionIndex.placeCollisionBox(t, _, h, l, m.predicate)
                                        };
                                        E = L && L.box && L.box.length && a.verticalIconBox ? (k = X(a.verticalIconBox)).box.length > 0 : (k = X(a.iconBox)).box.length > 0,
                                        A = A && k.offscreen
                                    }
                                    var Y = v || 0 === t.numHorizontalGlyphVertices && 0 === t.numVerticalGlyphVertices
                                      , K = g || 0 === t.numIconVertices;
                                    if (Y || K ? K ? Y || (E = E && S) : S = E && S : E = S = E && S,
                                    S && f && f.box && n.collisionIndex.insertCollisionBox(f.box, s.get("text-ignore-placement"), o.bucketInstanceId, L && L.box && D ? D : z, m.ID),
                                    E && k && n.collisionIndex.insertCollisionBox(k.box, s.get("icon-ignore-placement"), o.bucketInstanceId, R, m.ID),
                                    I && (S && n.collisionIndex.insertCollisionCircles(I.circles, s.get("text-ignore-placement"), o.bucketInstanceId, z, m.ID),
                                    r)) {
                                        var J = o.bucketInstanceId
                                          , Q = n.collisionCircleArrays[J];
                                        void 0 === Q && (Q = n.collisionCircleArrays[J] = new vt);
                                        for (var $ = 0; $ < I.circles.length; $ += 4)
                                            Q.circles.push(I.circles[$ + 0]),
                                            Q.circles.push(I.circles[$ + 1]),
                                            Q.circles.push(I.circles[$ + 2]),
                                            Q.circles.push(I.collisionDetected ? 1 : 0)
                                    }
                                    n.placements[t.crossTileID] = new mt(S || M,E || T,A || o.justReloaded),
                                    i[t.crossTileID] = !0
                                }
                        };
                        if (S)
                            for (var A = o.getSortedSymbolIndexes(this.transform.angle), P = A.length - 1; P >= 0; --P) {
                                var C = A[P];
                                E(o.symbolInstances.get(C), o.collisionArrays[C])
                            }
                        else
                            for (var L = t.symbolInstanceStart; L < t.symbolInstanceEnd; L++)
                                E(o.symbolInstances.get(L), o.collisionArrays[L]);
                        if (r && o.bucketInstanceId in this.collisionCircleArrays) {
                            var I = this.collisionCircleArrays[o.bucketInstanceId];
                            e.invert(I.invProjMatrix, l),
                            I.viewportMatrix = this.collisionIndex.getViewportMatrix()
                        }
                        o.justReloaded = !1
                    }
                    ,
                    bt.prototype.markUsedJustification = function(t, i, r, n) {
                        var a;
                        a = n === e.WritingMode.vertical ? r.verticalPlacedTextSymbolIndex : {
                            left: r.leftJustifiedTextSymbolIndex,
                            center: r.centerJustifiedTextSymbolIndex,
                            right: r.rightJustifiedTextSymbolIndex
                        }[e.getAnchorJustification(i)];
                        for (var o = 0, s = [r.leftJustifiedTextSymbolIndex, r.centerJustifiedTextSymbolIndex, r.rightJustifiedTextSymbolIndex, r.verticalPlacedTextSymbolIndex]; o < s.length; o += 1) {
                            var l = s[o];
                            l >= 0 && (t.text.placedSymbolArray.get(l).crossTileID = a >= 0 && l !== a ? 0 : r.crossTileID)
                        }
                    }
                    ,
                    bt.prototype.markUsedOrientation = function(t, i, r) {
                        for (var n = i === e.WritingMode.horizontal || i === e.WritingMode.horizontalOnly ? i : 0, a = i === e.WritingMode.vertical ? i : 0, o = 0, s = [r.leftJustifiedTextSymbolIndex, r.centerJustifiedTextSymbolIndex, r.rightJustifiedTextSymbolIndex]; o < s.length; o += 1)
                            t.text.placedSymbolArray.get(s[o]).placedOrientation = n;
                        r.verticalPlacedTextSymbolIndex && (t.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation = a)
                    }
                    ,
                    bt.prototype.commit = function(e) {
                        this.commitTime = e,
                        this.zoomAtLastRecencyCheck = this.transform.zoom;
                        var t = this.prevPlacement
                          , i = !1;
                        this.prevZoomAdjustment = t ? t.zoomAdjustment(this.transform.zoom) : 0;
                        var r = t ? t.symbolFadeChange(e) : 1
                          , n = t ? t.opacities : {}
                          , a = t ? t.variableOffsets : {}
                          , o = t ? t.placedOrientations : {};
                        for (var s in this.placements) {
                            var l = this.placements[s]
                              , u = n[s];
                            u ? (this.opacities[s] = new dt(u,r,l.text,l.icon),
                            i = i || l.text !== u.text.placed || l.icon !== u.icon.placed) : (this.opacities[s] = new dt(null,r,l.text,l.icon,l.skipFade),
                            i = i || l.text || l.icon)
                        }
                        for (var c in n) {
                            var h = n[c];
                            if (!this.opacities[c]) {
                                var p = new dt(h,r,!1,!1);
                                p.isHidden() || (this.opacities[c] = p,
                                i = i || h.text.placed || h.icon.placed)
                            }
                        }
                        for (var f in a)
                            this.variableOffsets[f] || !this.opacities[f] || this.opacities[f].isHidden() || (this.variableOffsets[f] = a[f]);
                        for (var d in o)
                            this.placedOrientations[d] || !this.opacities[d] || this.opacities[d].isHidden() || (this.placedOrientations[d] = o[d]);
                        i ? this.lastPlacementChangeTime = e : "number" != typeof this.lastPlacementChangeTime && (this.lastPlacementChangeTime = t ? t.lastPlacementChangeTime : e)
                    }
                    ,
                    bt.prototype.updateLayerOpacities = function(e, t) {
                        for (var i = {}, r = 0, n = t; r < n.length; r += 1) {
                            var a = n[r]
                              , o = a.getBucket(e);
                            o && a.latestFeatureIndex && e.id === o.layerIds[0] && this.updateBucketOpacities(o, i, a.collisionBoxArray)
                        }
                    }
                    ,
                    bt.prototype.updateBucketOpacities = function(t, i, r) {
                        var n = this;
                        t.hasTextData() && t.text.opacityVertexArray.clear(),
                        t.hasIconData() && t.icon.opacityVertexArray.clear(),
                        t.hasIconCollisionBoxData() && t.iconCollisionBox.collisionVertexArray.clear(),
                        t.hasTextCollisionBoxData() && t.textCollisionBox.collisionVertexArray.clear();
                        var a = t.layers[0].layout
                          , o = new dt(null,0,!1,!1,!0)
                          , s = a.get("text-allow-overlap")
                          , l = a.get("icon-allow-overlap")
                          , u = a.get("text-variable-anchor")
                          , c = "map" === a.get("text-rotation-alignment")
                          , h = "map" === a.get("text-pitch-alignment")
                          , p = "none" !== a.get("icon-text-fit")
                          , f = new dt(null,0,s && (l || !t.hasIconData() || a.get("icon-optional")),l && (s || !t.hasTextData() || a.get("text-optional")),!0);
                        !t.collisionArrays && r && (t.hasIconCollisionBoxData() || t.hasTextCollisionBoxData()) && t.deserializeCollisionBoxes(r);
                        for (var d = function(e, t, i) {
                            for (var r = 0; r < t / 4; r++)
                                e.opacityVertexArray.emplaceBack(i)
                        }, m = function(r) {
                            var a = t.symbolInstances.get(r)
                              , s = a.numHorizontalGlyphVertices
                              , l = a.numVerticalGlyphVertices
                              , m = a.crossTileID
                              , v = n.opacities[m];
                            i[m] ? v = o : v || (n.opacities[m] = v = f),
                            i[m] = !0;
                            var g = a.numIconVertices > 0
                              , y = n.placedOrientations[a.crossTileID]
                              , _ = y === e.WritingMode.vertical
                              , x = y === e.WritingMode.horizontal || y === e.WritingMode.horizontalOnly;
                            if (s > 0 || l > 0) {
                                var b = Lt(v.text);
                                d(t.text, s, _ ? It : b),
                                d(t.text, l, x ? It : b);
                                var w = v.text.isHidden();
                                [a.rightJustifiedTextSymbolIndex, a.centerJustifiedTextSymbolIndex, a.leftJustifiedTextSymbolIndex].forEach((function(e) {
                                    e >= 0 && (t.text.placedSymbolArray.get(e).hidden = w || _ ? 1 : 0)
                                }
                                )),
                                a.verticalPlacedTextSymbolIndex >= 0 && (t.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).hidden = w || x ? 1 : 0);
                                var S = n.variableOffsets[a.crossTileID];
                                S && n.markUsedJustification(t, S.anchor, a, y);
                                var M = n.placedOrientations[a.crossTileID];
                                M && (n.markUsedJustification(t, "left", a, M),
                                n.markUsedOrientation(t, M, a))
                            }
                            if (g) {
                                var T = Lt(v.icon)
                                  , E = !(p && a.verticalPlacedIconSymbolIndex && _);
                                a.placedIconSymbolIndex >= 0 && (d(t.icon, a.numIconVertices, E ? T : It),
                                t.icon.placedSymbolArray.get(a.placedIconSymbolIndex).hidden = v.icon.isHidden()),
                                a.verticalPlacedIconSymbolIndex >= 0 && (d(t.icon, a.numVerticalIconVertices, E ? It : T),
                                t.icon.placedSymbolArray.get(a.verticalPlacedIconSymbolIndex).hidden = v.icon.isHidden())
                            }
                            if (t.hasIconCollisionBoxData() || t.hasTextCollisionBoxData()) {
                                var A = t.collisionArrays[r];
                                if (A) {
                                    var P = new e.Point(0,0);
                                    if (A.textBox || A.verticalTextBox) {
                                        var C = !0;
                                        if (u) {
                                            var L = n.variableOffsets[m];
                                            L ? (P = _t(L.anchor, L.width, L.height, L.textOffset, L.textBoxScale),
                                            c && P._rotate(h ? n.transform.angle : -n.transform.angle)) : C = !1
                                        }
                                        A.textBox && wt(t.textCollisionBox.collisionVertexArray, v.text.placed, !C || _, P.x, P.y),
                                        A.verticalTextBox && wt(t.textCollisionBox.collisionVertexArray, v.text.placed, !C || x, P.x, P.y)
                                    }
                                    var I = Boolean(!x && A.verticalIconBox);
                                    A.iconBox && wt(t.iconCollisionBox.collisionVertexArray, v.icon.placed, I, p ? P.x : 0, p ? P.y : 0),
                                    A.verticalIconBox && wt(t.iconCollisionBox.collisionVertexArray, v.icon.placed, !I, p ? P.x : 0, p ? P.y : 0)
                                }
                            }
                        }, v = 0; v < t.symbolInstances.length; v++)
                            m(v);
                        if (t.sortFeatures(this.transform.angle),
                        this.retainedQueryData[t.bucketInstanceId] && (this.retainedQueryData[t.bucketInstanceId].featureSortOrder = t.featureSortOrder),
                        t.hasTextData() && t.text.opacityVertexBuffer && t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),
                        t.hasIconData() && t.icon.opacityVertexBuffer && t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),
                        t.hasIconCollisionBoxData() && t.iconCollisionBox.collisionVertexBuffer && t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),
                        t.hasTextCollisionBoxData() && t.textCollisionBox.collisionVertexBuffer && t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),
                        t.bucketInstanceId in this.collisionCircleArrays) {
                            var g = this.collisionCircleArrays[t.bucketInstanceId];
                            t.placementInvProjMatrix = g.invProjMatrix,
                            t.placementViewportMatrix = g.viewportMatrix,
                            t.collisionCircleArray = g.circles,
                            delete this.collisionCircleArrays[t.bucketInstanceId]
                        }
                    }
                    ,
                    bt.prototype.symbolFadeChange = function(e) {
                        return 0 === this.fadeDuration ? 1 : (e - this.commitTime) / this.fadeDuration + this.prevZoomAdjustment
                    }
                    ,
                    bt.prototype.zoomAdjustment = function(e) {
                        return Math.max(0, (this.transform.zoom - e) / 1.5)
                    }
                    ,
                    bt.prototype.hasTransitions = function(e) {
                        return this.stale || e - this.lastPlacementChangeTime < this.fadeDuration
                    }
                    ,
                    bt.prototype.stillRecent = function(e, t) {
                        var i = this.zoomAtLastRecencyCheck === t ? 1 - this.zoomAdjustment(t) : 1;
                        return this.zoomAtLastRecencyCheck = t,
                        this.commitTime + this.fadeDuration * i > e
                    }
                    ,
                    bt.prototype.setStale = function() {
                        this.stale = !0
                    }
                    ;
                    var St = Math.pow(2, 25)
                      , Mt = Math.pow(2, 24)
                      , Tt = Math.pow(2, 17)
                      , Et = Math.pow(2, 16)
                      , At = Math.pow(2, 9)
                      , Pt = Math.pow(2, 8)
                      , Ct = Math.pow(2, 1);
                    function Lt(e) {
                        if (0 === e.opacity && !e.placed)
                            return 0;
                        if (1 === e.opacity && e.placed)
                            return 4294967295;
                        var t = e.placed ? 1 : 0
                          , i = Math.floor(127 * e.opacity);
                        return i * St + t * Mt + i * Tt + t * Et + i * At + t * Pt + i * Ct + t
                    }
                    var It = 0
                      , kt = function(e) {
                        this._sortAcrossTiles = "viewport-y" !== e.layout.get("symbol-z-order") && void 0 !== e.layout.get("symbol-sort-key").constantOr(1),
                        this._currentTileIndex = 0,
                        this._currentPartIndex = 0,
                        this._seenCrossTileIDs = {},
                        this._bucketParts = []
                    };
                    kt.prototype.continuePlacement = function(e, t, i, r, n) {
                        for (var a = this._bucketParts; this._currentTileIndex < e.length; )
                            if (t.getBucketParts(a, r, e[this._currentTileIndex], this._sortAcrossTiles),
                            this._currentTileIndex++,
                            n())
                                return !0;
                        for (this._sortAcrossTiles && (this._sortAcrossTiles = !1,
                        a.sort((function(e, t) {
                            return e.sortKey - t.sortKey
                        }
                        ))); this._currentPartIndex < a.length; )
                            if (t.placeLayerBucketPart(a[this._currentPartIndex], this._seenCrossTileIDs, i),
                            this._currentPartIndex++,
                            n())
                                return !0;
                        return !1
                    }
                    ;
                    var zt = function(e, t, i, r, n, a, o) {
                        this.placement = new bt(e,n,a,o),
                        this._currentPlacementIndex = t.length - 1,
                        this._forceFullPlacement = i,
                        this._showCollisionBoxes = r,
                        this._done = !1
                    };
                    zt.prototype.isDone = function() {
                        return this._done
                    }
                    ,
                    zt.prototype.continuePlacement = function(t, i, r) {
                        for (var n = this, a = e.browser.now(), o = function() {
                            var t = e.browser.now() - a;
                            return !n._forceFullPlacement && t > 2
                        }; this._currentPlacementIndex >= 0; ) {
                            var s = i[t[this._currentPlacementIndex]]
                              , l = this.placement.collisionIndex.transform.zoom;
                            if ("symbol" === s.type && (!s.minzoom || s.minzoom <= l) && (!s.maxzoom || s.maxzoom > l)) {
                                if (this._inProgressLayer || (this._inProgressLayer = new kt(s)),
                                this._inProgressLayer.continuePlacement(r[s.source], this.placement, this._showCollisionBoxes, s, o))
                                    return;
                                delete this._inProgressLayer
                            }
                            this._currentPlacementIndex--
                        }
                        this._done = !0
                    }
                    ,
                    zt.prototype.commit = function(e) {
                        return this.placement.commit(e),
                        this.placement
                    }
                    ;
                    var Dt = 512 / e.EXTENT / 2
                      , Rt = function(e, t, i) {
                        this.tileID = e,
                        this.indexedSymbolInstances = {},
                        this.bucketInstanceId = i;
                        for (var r = 0; r < t.length; r++) {
                            var n = t.get(r)
                              , a = n.key;
                            this.indexedSymbolInstances[a] || (this.indexedSymbolInstances[a] = []),
                            this.indexedSymbolInstances[a].push({
                                crossTileID: n.crossTileID,
                                coord: this.getScaledCoordinates(n, e)
                            })
                        }
                    };
                    Rt.prototype.getScaledCoordinates = function(t, i) {
                        var r = Dt / Math.pow(2, i.canonical.z - this.tileID.canonical.z);
                        return {
                            x: Math.floor((i.canonical.x * e.EXTENT + t.anchorX) * r),
                            y: Math.floor((i.canonical.y * e.EXTENT + t.anchorY) * r)
                        }
                    }
                    ,
                    Rt.prototype.findMatches = function(e, t, i) {
                        for (var r = this.tileID.canonical.z < t.canonical.z ? 1 : Math.pow(2, this.tileID.canonical.z - t.canonical.z), n = 0; n < e.length; n++) {
                            var a = e.get(n);
                            if (!a.crossTileID) {
                                var o = this.indexedSymbolInstances[a.key];
                                if (o)
                                    for (var s = this.getScaledCoordinates(a, t), l = 0, u = o; l < u.length; l += 1) {
                                        var c = u[l];
                                        if (Math.abs(c.coord.x - s.x) <= r && Math.abs(c.coord.y - s.y) <= r && !i[c.crossTileID]) {
                                            i[c.crossTileID] = !0,
                                            a.crossTileID = c.crossTileID;
                                            break
                                        }
                                    }
                            }
                        }
                    }
                    ;
                    var Ot = function() {
                        this.maxCrossTileID = 0
                    };
                    Ot.prototype.generate = function() {
                        return ++this.maxCrossTileID
                    }
                    ;
                    var Bt = function() {
                        this.indexes = {},
                        this.usedCrossTileIDs = {},
                        this.lng = 0
                    };
                    Bt.prototype.handleWrapJump = function(e) {
                        var t = Math.round((e - this.lng) / 360);
                        if (0 !== t)
                            for (var i in this.indexes) {
                                var r = this.indexes[i]
                                  , n = {};
                                for (var a in r) {
                                    var o = r[a];
                                    o.tileID = o.tileID.unwrapTo(o.tileID.wrap + t),
                                    n[o.tileID.key] = o
                                }
                                this.indexes[i] = n
                            }
                        this.lng = e
                    }
                    ,
                    Bt.prototype.addBucket = function(e, t, i) {
                        if (this.indexes[e.overscaledZ] && this.indexes[e.overscaledZ][e.key]) {
                            if (this.indexes[e.overscaledZ][e.key].bucketInstanceId === t.bucketInstanceId)
                                return !1;
                            this.removeBucketCrossTileIDs(e.overscaledZ, this.indexes[e.overscaledZ][e.key])
                        }
                        for (var r = 0; r < t.symbolInstances.length; r++)
                            t.symbolInstances.get(r).crossTileID = 0;
                        this.usedCrossTileIDs[e.overscaledZ] || (this.usedCrossTileIDs[e.overscaledZ] = {});
                        var n = this.usedCrossTileIDs[e.overscaledZ];
                        for (var a in this.indexes) {
                            var o = this.indexes[a];
                            if (Number(a) > e.overscaledZ)
                                for (var s in o) {
                                    var l = o[s];
                                    l.tileID.isChildOf(e) && l.findMatches(t.symbolInstances, e, n)
                                }
                            else {
                                var u = o[e.scaledTo(Number(a)).key];
                                u && u.findMatches(t.symbolInstances, e, n)
                            }
                        }
                        for (var c = 0; c < t.symbolInstances.length; c++) {
                            var h = t.symbolInstances.get(c);
                            h.crossTileID || (h.crossTileID = i.generate(),
                            n[h.crossTileID] = !0)
                        }
                        return void 0 === this.indexes[e.overscaledZ] && (this.indexes[e.overscaledZ] = {}),
                        this.indexes[e.overscaledZ][e.key] = new Rt(e,t.symbolInstances,t.bucketInstanceId),
                        !0
                    }
                    ,
                    Bt.prototype.removeBucketCrossTileIDs = function(e, t) {
                        for (var i in t.indexedSymbolInstances)
                            for (var r = 0, n = t.indexedSymbolInstances[i]; r < n.length; r += 1)
                                delete this.usedCrossTileIDs[e][n[r].crossTileID]
                    }
                    ,
                    Bt.prototype.removeStaleBuckets = function(e) {
                        var t = !1;
                        for (var i in this.indexes) {
                            var r = this.indexes[i];
                            for (var n in r)
                                e[r[n].bucketInstanceId] || (this.removeBucketCrossTileIDs(i, r[n]),
                                delete r[n],
                                t = !0)
                        }
                        return t
                    }
                    ;
                    var Ft = function() {
                        this.layerIndexes = {},
                        this.crossTileIDs = new Ot,
                        this.maxBucketInstanceId = 0,
                        this.bucketsInCurrentPlacement = {}
                    };
                    Ft.prototype.addLayer = function(e, t, i) {
                        var r = this.layerIndexes[e.id];
                        void 0 === r && (r = this.layerIndexes[e.id] = new Bt);
                        var n = !1
                          , a = {};
                        r.handleWrapJump(i);
                        for (var o = 0, s = t; o < s.length; o += 1) {
                            var l = s[o]
                              , u = l.getBucket(e);
                            u && e.id === u.layerIds[0] && (u.bucketInstanceId || (u.bucketInstanceId = ++this.maxBucketInstanceId),
                            r.addBucket(l.tileID, u, this.crossTileIDs) && (n = !0),
                            a[u.bucketInstanceId] = !0)
                        }
                        return r.removeStaleBuckets(a) && (n = !0),
                        n
                    }
                    ,
                    Ft.prototype.pruneUnusedLayers = function(e) {
                        var t = {};
                        for (var i in e.forEach((function(e) {
                            t[e] = !0
                        }
                        )),
                        this.layerIndexes)
                            t[i] || delete this.layerIndexes[i]
                    }
                    ;
                    var Nt = function(t, i) {
                        return e.emitValidationErrors(t, i && i.filter((function(e) {
                            return "source.canvas" !== e.identifier
                        }
                        )))
                    }
                      , Ut = e.pick(Ve, ["addLayer", "removeLayer", "setPaintProperty", "setLayoutProperty", "setFilter", "addSource", "removeSource", "setLayerZoomRange", "setLight", "setTransition", "setGeoJSONSourceData"])
                      , Vt = e.pick(Ve, ["setCenter", "setZoom", "setBearing", "setPitch"])
                      , Gt = function() {
                        var t = {}
                          , i = e.styleSpec.$version;
                        for (var r in e.styleSpec.$root) {
                            var n, a = e.styleSpec.$root[r];
                            a.required && null != (n = "version" === r ? i : "array" === a.type ? [] : {}) && (t[r] = n)
                        }
                        return t
                    }()
                      , jt = function(t) {
                        function i(r, n) {
                            var a = this;
                            void 0 === n && (n = {}),
                            t.call(this),
                            this.map = r,
                            this.dispatcher = new M(Fe(),this),
                            this.imageManager = new p,
                            this.imageManager.setEventedParent(this),
                            this.glyphManager = new _(r._requestManager,n.localIdeographFontFamily),
                            this.lineAtlas = new S(256,512),
                            this.crossTileSymbolIndex = new Ft,
                            this._layers = {},
                            this._serializedLayers = {},
                            this._order = [],
                            this.sourceCaches = {},
                            this.zoomHistory = new e.ZoomHistory,
                            this._loaded = !1,
                            this._availableImages = [],
                            this._resetUpdates(),
                            this.dispatcher.broadcast("setReferrer", e.getReferrer());
                            var o = this;
                            this._rtlTextPluginCallback = i.registerForPluginStateChange((function(t) {
                                o.dispatcher.broadcast("syncRTLPluginState", {
                                    pluginStatus: t.pluginStatus,
                                    pluginURL: t.pluginURL
                                }, (function(t, i) {
                                    if (e.triggerPluginCompletionEvent(t),
                                    i && i.every((function(e) {
                                        return e
                                    }
                                    )))
                                        for (var r in o.sourceCaches)
                                            o.sourceCaches[r].reload()
                                }
                                ))
                            }
                            )),
                            this.on("data", (function(e) {
                                if ("source" === e.dataType && "metadata" === e.sourceDataType) {
                                    var t = a.sourceCaches[e.sourceId];
                                    if (t) {
                                        var i = t.getSource();
                                        if (i && i.vectorLayerIds)
                                            for (var r in a._layers) {
                                                var n = a._layers[r];
                                                n.source === i.id && a._validateLayer(n)
                                            }
                                    }
                                }
                            }
                            ))
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.loadURL = function(t, i) {
                            var r = this;
                            void 0 === i && (i = {}),
                            this.fire(new e.Event("dataloading",{
                                dataType: "style"
                            }));
                            var n = "boolean" == typeof i.validate ? i.validate : !e.isMapboxURL(t);
                            t = this.map._requestManager.normalizeStyleURL(t, i.accessToken);
                            var a = this.map._requestManager.transformRequest(t, e.ResourceType.Style);
                            this._request = e.getJSON(a, (function(t, i) {
                                r._request = null,
                                t ? r.fire(new e.ErrorEvent(t)) : i && r._load(i, n)
                            }
                            ))
                        }
                        ,
                        i.prototype.loadJSON = function(t, i) {
                            var r = this;
                            void 0 === i && (i = {}),
                            this.fire(new e.Event("dataloading",{
                                dataType: "style"
                            })),
                            this._request = e.browser.frame((function() {
                                r._request = null,
                                r._load(t, !1 !== i.validate)
                            }
                            ))
                        }
                        ,
                        i.prototype.loadEmpty = function() {
                            this.fire(new e.Event("dataloading",{
                                dataType: "style"
                            })),
                            this._load(Gt, !1)
                        }
                        ,
                        i.prototype._load = function(t, i) {
                            if (!i || !Nt(this, e.validateStyle(t))) {
                                for (var r in this._loaded = !0,
                                this.stylesheet = t,
                                t.sources)
                                    this.addSource(r, t.sources[r], {
                                        validate: !1
                                    });
                                t.sprite ? this._loadSprite(t.sprite) : this.imageManager.setLoaded(!0),
                                this.glyphManager.setURL(t.glyphs);
                                var n = Ue(this.stylesheet.layers);
                                this._order = n.map((function(e) {
                                    return e.id
                                }
                                )),
                                this._layers = {},
                                this._serializedLayers = {};
                                for (var a = 0, o = n; a < o.length; a += 1) {
                                    var s = o[a];
                                    (s = e.createStyleLayer(s)).setEventedParent(this, {
                                        layer: {
                                            id: s.id
                                        }
                                    }),
                                    this._layers[s.id] = s,
                                    this._serializedLayers[s.id] = s.serialize()
                                }
                                this.dispatcher.broadcast("setLayers", this._serializeLayers(this._order)),
                                this.light = new w(this.stylesheet.light),
                                this.fire(new e.Event("data",{
                                    dataType: "style"
                                })),
                                this.fire(new e.Event("style.load"))
                            }
                        }
                        ,
                        i.prototype._loadSprite = function(t) {
                            var i = this;
                            this._spriteRequest = function(t, i, r) {
                                var n, a, o, s = e.browser.devicePixelRatio > 1 ? "@2x" : "", l = e.getJSON(i.transformRequest(i.normalizeSpriteURL(t, s, ".json"), e.ResourceType.SpriteJSON), (function(e, t) {
                                    l = null,
                                    o || (o = e,
                                    n = t,
                                    c())
                                }
                                )), u = e.getImage(i.transformRequest(i.normalizeSpriteURL(t, s, ".png"), e.ResourceType.SpriteImage), (function(e, t) {
                                    u = null,
                                    o || (o = e,
                                    a = t,
                                    c())
                                }
                                ));
                                function c() {
                                    if (o)
                                        r(o);
                                    else if (n && a) {
                                        var t = e.browser.getImageData(a)
                                          , i = {};
                                        for (var s in n) {
                                            var l = n[s]
                                              , u = l.width
                                              , c = l.height
                                              , h = l.x
                                              , p = l.y
                                              , f = l.sdf
                                              , d = l.pixelRatio
                                              , m = l.stretchX
                                              , v = l.stretchY
                                              , g = l.content
                                              , y = new e.RGBAImage({
                                                width: u,
                                                height: c
                                            });
                                            e.RGBAImage.copy(t, y, {
                                                x: h,
                                                y: p
                                            }, {
                                                x: 0,
                                                y: 0
                                            }, {
                                                width: u,
                                                height: c
                                            }),
                                            i[s] = {
                                                data: y,
                                                pixelRatio: d,
                                                sdf: f,
                                                stretchX: m,
                                                stretchY: v,
                                                content: g
                                            }
                                        }
                                        r(null, i)
                                    }
                                }
                                return {
                                    cancel: function() {
                                        l && (l.cancel(),
                                        l = null),
                                        u && (u.cancel(),
                                        u = null)
                                    }
                                }
                            }(t, this.map._requestManager, (function(t, r) {
                                if (i._spriteRequest = null,
                                t)
                                    i.fire(new e.ErrorEvent(t));
                                else if (r)
                                    for (var n in r)
                                        i.imageManager.addImage(n, r[n]);
                                i.imageManager.setLoaded(!0),
                                i._availableImages = i.imageManager.listImages(),
                                i.dispatcher.broadcast("setImages", i._availableImages),
                                i.fire(new e.Event("data",{
                                    dataType: "style"
                                }))
                            }
                            ))
                        }
                        ,
                        i.prototype._validateLayer = function(t) {
                            var i = this.sourceCaches[t.source];
                            if (i) {
                                var r = t.sourceLayer;
                                if (r) {
                                    var n = i.getSource();
                                    ("geojson" === n.type || n.vectorLayerIds && -1 === n.vectorLayerIds.indexOf(r)) && this.fire(new e.ErrorEvent(new Error('Source layer "' + r + '" does not exist on source "' + n.id + '" as specified by style layer "' + t.id + '"')))
                                }
                            }
                        }
                        ,
                        i.prototype.loaded = function() {
                            if (!this._loaded)
                                return !1;
                            if (Object.keys(this._updatedSources).length)
                                return !1;
                            for (var e in this.sourceCaches)
                                if (!this.sourceCaches[e].loaded())
                                    return !1;
                            return !!this.imageManager.isLoaded()
                        }
                        ,
                        i.prototype._serializeLayers = function(e) {
                            for (var t = [], i = 0, r = e; i < r.length; i += 1) {
                                var n = this._layers[r[i]];
                                "custom" !== n.type && t.push(n.serialize())
                            }
                            return t
                        }
                        ,
                        i.prototype.hasTransitions = function() {
                            if (this.light && this.light.hasTransition())
                                return !0;
                            for (var e in this.sourceCaches)
                                if (this.sourceCaches[e].hasTransition())
                                    return !0;
                            for (var t in this._layers)
                                if (this._layers[t].hasTransition())
                                    return !0;
                            return !1
                        }
                        ,
                        i.prototype._checkLoaded = function() {
                            if (!this._loaded)
                                throw new Error("Style is not done loading")
                        }
                        ,
                        i.prototype.update = function(t) {
                            if (this._loaded) {
                                var i = this._changed;
                                if (this._changed) {
                                    var r = Object.keys(this._updatedLayers)
                                      , n = Object.keys(this._removedLayers);
                                    for (var a in (r.length || n.length) && this._updateWorkerLayers(r, n),
                                    this._updatedSources) {
                                        var o = this._updatedSources[a];
                                        "reload" === o ? this._reloadSource(a) : "clear" === o && this._clearSource(a)
                                    }
                                    for (var s in this._updateTilesForChangedImages(),
                                    this._updatedPaintProps)
                                        this._layers[s].updateTransitions(t);
                                    this.light.updateTransitions(t),
                                    this._resetUpdates()
                                }
                                var l = {};
                                for (var u in this.sourceCaches) {
                                    var c = this.sourceCaches[u];
                                    l[u] = c.used,
                                    c.used = !1
                                }
                                for (var h = 0, p = this._order; h < p.length; h += 1) {
                                    var f = this._layers[p[h]];
                                    f.recalculate(t, this._availableImages),
                                    !f.isHidden(t.zoom) && f.source && (this.sourceCaches[f.source].used = !0)
                                }
                                for (var d in l) {
                                    var m = this.sourceCaches[d];
                                    l[d] !== m.used && m.fire(new e.Event("data",{
                                        sourceDataType: "visibility",
                                        dataType: "source",
                                        sourceId: d
                                    }))
                                }
                                this.light.recalculate(t),
                                this.z = t.zoom,
                                i && this.fire(new e.Event("data",{
                                    dataType: "style"
                                }))
                            }
                        }
                        ,
                        i.prototype._updateTilesForChangedImages = function() {
                            var e = Object.keys(this._changedImages);
                            if (e.length) {
                                for (var t in this.sourceCaches)
                                    this.sourceCaches[t].reloadTilesForDependencies(["icons", "patterns"], e);
                                this._changedImages = {}
                            }
                        }
                        ,
                        i.prototype._updateWorkerLayers = function(e, t) {
                            this.dispatcher.broadcast("updateLayers", {
                                layers: this._serializeLayers(e),
                                removedIds: t
                            })
                        }
                        ,
                        i.prototype._resetUpdates = function() {
                            this._changed = !1,
                            this._updatedLayers = {},
                            this._removedLayers = {},
                            this._updatedSources = {},
                            this._updatedPaintProps = {},
                            this._changedImages = {}
                        }
                        ,
                        i.prototype.setState = function(t) {
                            var i = this;
                            if (this._checkLoaded(),
                            Nt(this, e.validateStyle(t)))
                                return !1;
                            (t = e.clone$1(t)).layers = Ue(t.layers);
                            var r = function(t, i) {
                                if (!t)
                                    return [{
                                        command: Ve.setStyle,
                                        args: [i]
                                    }];
                                var r = [];
                                try {
                                    if (!e.deepEqual(t.version, i.version))
                                        return [{
                                            command: Ve.setStyle,
                                            args: [i]
                                        }];
                                    e.deepEqual(t.center, i.center) || r.push({
                                        command: Ve.setCenter,
                                        args: [i.center]
                                    }),
                                    e.deepEqual(t.zoom, i.zoom) || r.push({
                                        command: Ve.setZoom,
                                        args: [i.zoom]
                                    }),
                                    e.deepEqual(t.bearing, i.bearing) || r.push({
                                        command: Ve.setBearing,
                                        args: [i.bearing]
                                    }),
                                    e.deepEqual(t.pitch, i.pitch) || r.push({
                                        command: Ve.setPitch,
                                        args: [i.pitch]
                                    }),
                                    e.deepEqual(t.sprite, i.sprite) || r.push({
                                        command: Ve.setSprite,
                                        args: [i.sprite]
                                    }),
                                    e.deepEqual(t.glyphs, i.glyphs) || r.push({
                                        command: Ve.setGlyphs,
                                        args: [i.glyphs]
                                    }),
                                    e.deepEqual(t.transition, i.transition) || r.push({
                                        command: Ve.setTransition,
                                        args: [i.transition]
                                    }),
                                    e.deepEqual(t.light, i.light) || r.push({
                                        command: Ve.setLight,
                                        args: [i.light]
                                    });
                                    var n = {}
                                      , a = [];
                                    !function(t, i, r, n) {
                                        var a;
                                        for (a in i = i || {},
                                        t = t || {})
                                            t.hasOwnProperty(a) && (i.hasOwnProperty(a) || je(a, r, n));
                                        for (a in i)
                                            i.hasOwnProperty(a) && (t.hasOwnProperty(a) ? e.deepEqual(t[a], i[a]) || ("geojson" === t[a].type && "geojson" === i[a].type && qe(t, i, a) ? r.push({
                                                command: Ve.setGeoJSONSourceData,
                                                args: [a, i[a].data]
                                            }) : He(a, i, r, n)) : Ge(a, i, r))
                                    }(t.sources, i.sources, a, n);
                                    var o = [];
                                    t.layers && t.layers.forEach((function(e) {
                                        n[e.source] ? r.push({
                                            command: Ve.removeLayer,
                                            args: [e.id]
                                        }) : o.push(e)
                                    }
                                    )),
                                    r = r.concat(a),
                                    function(t, i, r) {
                                        i = i || [];
                                        var n, a, o, s, l, u, c, h = (t = t || []).map(Ze), p = i.map(Ze), f = t.reduce(Xe, {}), d = i.reduce(Xe, {}), m = h.slice(), v = Object.create(null);
                                        for (n = 0,
                                        a = 0; n < h.length; n++)
                                            d.hasOwnProperty(o = h[n]) ? a++ : (r.push({
                                                command: Ve.removeLayer,
                                                args: [o]
                                            }),
                                            m.splice(m.indexOf(o, a), 1));
                                        for (n = 0,
                                        a = 0; n < p.length; n++)
                                            m[m.length - 1 - n] !== (o = p[p.length - 1 - n]) && (f.hasOwnProperty(o) ? (r.push({
                                                command: Ve.removeLayer,
                                                args: [o]
                                            }),
                                            m.splice(m.lastIndexOf(o, m.length - a), 1)) : a++,
                                            r.push({
                                                command: Ve.addLayer,
                                                args: [d[o], u = m[m.length - n]]
                                            }),
                                            m.splice(m.length - n, 0, o),
                                            v[o] = !0);
                                        for (n = 0; n < p.length; n++)
                                            if (s = f[o = p[n]],
                                            l = d[o],
                                            !v[o] && !e.deepEqual(s, l))
                                                if (e.deepEqual(s.source, l.source) && e.deepEqual(s["source-layer"], l["source-layer"]) && e.deepEqual(s.type, l.type)) {
                                                    for (c in We(s.layout, l.layout, r, o, null, Ve.setLayoutProperty),
                                                    We(s.paint, l.paint, r, o, null, Ve.setPaintProperty),
                                                    e.deepEqual(s.filter, l.filter) || r.push({
                                                        command: Ve.setFilter,
                                                        args: [o, l.filter]
                                                    }),
                                                    e.deepEqual(s.minzoom, l.minzoom) && e.deepEqual(s.maxzoom, l.maxzoom) || r.push({
                                                        command: Ve.setLayerZoomRange,
                                                        args: [o, l.minzoom, l.maxzoom]
                                                    }),
                                                    s)
                                                        s.hasOwnProperty(c) && "layout" !== c && "paint" !== c && "filter" !== c && "metadata" !== c && "minzoom" !== c && "maxzoom" !== c && (0 === c.indexOf("paint.") ? We(s[c], l[c], r, o, c.slice(6), Ve.setPaintProperty) : e.deepEqual(s[c], l[c]) || r.push({
                                                            command: Ve.setLayerProperty,
                                                            args: [o, c, l[c]]
                                                        }));
                                                    for (c in l)
                                                        l.hasOwnProperty(c) && !s.hasOwnProperty(c) && "layout" !== c && "paint" !== c && "filter" !== c && "metadata" !== c && "minzoom" !== c && "maxzoom" !== c && (0 === c.indexOf("paint.") ? We(s[c], l[c], r, o, c.slice(6), Ve.setPaintProperty) : e.deepEqual(s[c], l[c]) || r.push({
                                                            command: Ve.setLayerProperty,
                                                            args: [o, c, l[c]]
                                                        }))
                                                } else
                                                    r.push({
                                                        command: Ve.removeLayer,
                                                        args: [o]
                                                    }),
                                                    u = m[m.lastIndexOf(o) + 1],
                                                    r.push({
                                                        command: Ve.addLayer,
                                                        args: [l, u]
                                                    })
                                    }(o, i.layers, r)
                                } catch (e) {
                                    console.warn("Unable to compute style diff:", e),
                                    r = [{
                                        command: Ve.setStyle,
                                        args: [i]
                                    }]
                                }
                                return r
                            }(this.serialize(), t).filter((function(e) {
                                return !(e.command in Vt)
                            }
                            ));
                            if (0 === r.length)
                                return !1;
                            var n = r.filter((function(e) {
                                return !(e.command in Ut)
                            }
                            ));
                            if (n.length > 0)
                                throw new Error("Unimplemented: " + n.map((function(e) {
                                    return e.command
                                }
                                )).join(", ") + ".");
                            return r.forEach((function(e) {
                                "setTransition" !== e.command && i[e.command].apply(i, e.args)
                            }
                            )),
                            this.stylesheet = t,
                            !0
                        }
                        ,
                        i.prototype.addImage = function(t, i) {
                            if (this.getImage(t))
                                return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));
                            this.imageManager.addImage(t, i),
                            this._afterImageUpdated(t)
                        }
                        ,
                        i.prototype.updateImage = function(e, t) {
                            this.imageManager.updateImage(e, t)
                        }
                        ,
                        i.prototype.getImage = function(e) {
                            return this.imageManager.getImage(e)
                        }
                        ,
                        i.prototype.removeImage = function(t) {
                            if (!this.getImage(t))
                                return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));
                            this.imageManager.removeImage(t),
                            this._afterImageUpdated(t)
                        }
                        ,
                        i.prototype._afterImageUpdated = function(t) {
                            this._availableImages = this.imageManager.listImages(),
                            this._changedImages[t] = !0,
                            this._changed = !0,
                            this.dispatcher.broadcast("setImages", this._availableImages),
                            this.fire(new e.Event("data",{
                                dataType: "style"
                            }))
                        }
                        ,
                        i.prototype.listImages = function() {
                            return this._checkLoaded(),
                            this.imageManager.listImages()
                        }
                        ,
                        i.prototype.addSource = function(t, i, r) {
                            var n = this;
                            if (void 0 === r && (r = {}),
                            this._checkLoaded(),
                            void 0 !== this.sourceCaches[t])
                                throw new Error("There is already a source with this ID");
                            if (!i.type)
                                throw new Error("The type property must be defined, but only the following properties were given: " + Object.keys(i).join(", ") + ".");
                            if (!(["vector", "raster", "geojson", "video", "image"].indexOf(i.type) >= 0 && this._validate(e.validateStyle.source, "sources." + t, i, null, r))) {
                                this.map && this.map._collectResourceTiming && (i.collectResourceTiming = !0);
                                var a = this.sourceCaches[t] = new Le(t,i,this.dispatcher);
                                a.style = this,
                                a.setEventedParent(this, (function() {
                                    return {
                                        isSourceLoaded: n.loaded(),
                                        source: a.serialize(),
                                        sourceId: t
                                    }
                                }
                                )),
                                a.onAdd(this.map),
                                this._changed = !0
                            }
                        }
                        ,
                        i.prototype.removeSource = function(t) {
                            if (this._checkLoaded(),
                            void 0 === this.sourceCaches[t])
                                throw new Error("There is no source with this ID");
                            for (var i in this._layers)
                                if (this._layers[i].source === t)
                                    return this.fire(new e.ErrorEvent(new Error('Source "' + t + '" cannot be removed while layer "' + i + '" is using it.')));
                            var r = this.sourceCaches[t];
                            delete this.sourceCaches[t],
                            delete this._updatedSources[t],
                            r.fire(new e.Event("data",{
                                sourceDataType: "metadata",
                                dataType: "source",
                                sourceId: t
                            })),
                            r.setEventedParent(null),
                            r.clearTiles(),
                            r.onRemove && r.onRemove(this.map),
                            this._changed = !0
                        }
                        ,
                        i.prototype.setGeoJSONSourceData = function(e, t) {
                            this._checkLoaded(),
                            this.sourceCaches[e].getSource().setData(t),
                            this._changed = !0
                        }
                        ,
                        i.prototype.getSource = function(e) {
                            return this.sourceCaches[e] && this.sourceCaches[e].getSource()
                        }
                        ,
                        i.prototype.addLayer = function(t, i, r) {
                            void 0 === r && (r = {}),
                            this._checkLoaded();
                            var n = t.id;
                            if (this.getLayer(n))
                                this.fire(new e.ErrorEvent(new Error('Layer with id "' + n + '" already exists on this map')));
                            else {
                                var a;
                                if ("custom" === t.type) {
                                    if (Nt(this, e.validateCustomStyleLayer(t)))
                                        return;
                                    a = e.createStyleLayer(t)
                                } else {
                                    if ("object" == typeof t.source && (this.addSource(n, t.source),
                                    t = e.clone$1(t),
                                    t = e.extend(t, {
                                        source: n
                                    })),
                                    this._validate(e.validateStyle.layer, "layers." + n, t, {
                                        arrayIndex: -1
                                    }, r))
                                        return;
                                    a = e.createStyleLayer(t),
                                    this._validateLayer(a),
                                    a.setEventedParent(this, {
                                        layer: {
                                            id: n
                                        }
                                    }),
                                    this._serializedLayers[a.id] = a.serialize()
                                }
                                var o = i ? this._order.indexOf(i) : this._order.length;
                                if (i && -1 === o)
                                    this.fire(new e.ErrorEvent(new Error('Layer with id "' + i + '" does not exist on this map.')));
                                else {
                                    if (this._order.splice(o, 0, n),
                                    this._layerOrderChanged = !0,
                                    this._layers[n] = a,
                                    this._removedLayers[n] && a.source && "custom" !== a.type) {
                                        var s = this._removedLayers[n];
                                        delete this._removedLayers[n],
                                        s.type !== a.type ? this._updatedSources[a.source] = "clear" : (this._updatedSources[a.source] = "reload",
                                        this.sourceCaches[a.source].pause())
                                    }
                                    this._updateLayer(a),
                                    a.onAdd && a.onAdd(this.map)
                                }
                            }
                        }
                        ,
                        i.prototype.moveLayer = function(t, i) {
                            if (this._checkLoaded(),
                            this._changed = !0,
                            this._layers[t]) {
                                if (t !== i) {
                                    var r = this._order.indexOf(t);
                                    this._order.splice(r, 1);
                                    var n = i ? this._order.indexOf(i) : this._order.length;
                                    i && -1 === n ? this.fire(new e.ErrorEvent(new Error('Layer with id "' + i + '" does not exist on this map.'))) : (this._order.splice(n, 0, t),
                                    this._layerOrderChanged = !0)
                                }
                            } else
                                this.fire(new e.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be moved.")))
                        }
                        ,
                        i.prototype.removeLayer = function(t) {
                            this._checkLoaded();
                            var i = this._layers[t];
                            if (i) {
                                i.setEventedParent(null);
                                var r = this._order.indexOf(t);
                                this._order.splice(r, 1),
                                this._layerOrderChanged = !0,
                                this._changed = !0,
                                this._removedLayers[t] = i,
                                delete this._layers[t],
                                delete this._serializedLayers[t],
                                delete this._updatedLayers[t],
                                delete this._updatedPaintProps[t],
                                i.onRemove && i.onRemove(this.map)
                            } else
                                this.fire(new e.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be removed.")))
                        }
                        ,
                        i.prototype.getLayer = function(e) {
                            return this._layers[e]
                        }
                        ,
                        i.prototype.hasLayer = function(e) {
                            return e in this._layers
                        }
                        ,
                        i.prototype.setLayerZoomRange = function(t, i, r) {
                            this._checkLoaded();
                            var n = this.getLayer(t);
                            n ? n.minzoom === i && n.maxzoom === r || (null != i && (n.minzoom = i),
                            null != r && (n.maxzoom = r),
                            this._updateLayer(n)) : this.fire(new e.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot have zoom extent.")))
                        }
                        ,
                        i.prototype.setFilter = function(t, i, r) {
                            void 0 === r && (r = {}),
                            this._checkLoaded();
                            var n = this.getLayer(t);
                            if (n) {
                                if (!e.deepEqual(n.filter, i))
                                    return null == i ? (n.filter = void 0,
                                    void this._updateLayer(n)) : void (this._validate(e.validateStyle.filter, "layers." + n.id + ".filter", i, null, r) || (n.filter = e.clone$1(i),
                                    this._updateLayer(n)))
                            } else
                                this.fire(new e.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be filtered.")))
                        }
                        ,
                        i.prototype.getFilter = function(t) {
                            return e.clone$1(this.getLayer(t).filter)
                        }
                        ,
                        i.prototype.setLayoutProperty = function(t, i, r, n) {
                            void 0 === n && (n = {}),
                            this._checkLoaded();
                            var a = this.getLayer(t);
                            a ? e.deepEqual(a.getLayoutProperty(i), r) || (a.setLayoutProperty(i, r, n),
                            this._updateLayer(a)) : this.fire(new e.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be styled.")))
                        }
                        ,
                        i.prototype.getLayoutProperty = function(t, i) {
                            var r = this.getLayer(t);
                            if (r)
                                return r.getLayoutProperty(i);
                            this.fire(new e.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style.")))
                        }
                        ,
                        i.prototype.setPaintProperty = function(t, i, r, n) {
                            void 0 === n && (n = {}),
                            this._checkLoaded();
                            var a = this.getLayer(t);
                            a ? e.deepEqual(a.getPaintProperty(i), r) || (a.setPaintProperty(i, r, n) && this._updateLayer(a),
                            this._changed = !0,
                            this._updatedPaintProps[t] = !0) : this.fire(new e.ErrorEvent(new Error("The layer '" + t + "' does not exist in the map's style and cannot be styled.")))
                        }
                        ,
                        i.prototype.getPaintProperty = function(e, t) {
                            return this.getLayer(e).getPaintProperty(t)
                        }
                        ,
                        i.prototype.setFeatureState = function(t, i) {
                            this._checkLoaded();
                            var r = t.source
                              , n = t.sourceLayer
                              , a = this.sourceCaches[r];
                            if (void 0 !== a) {
                                var o = a.getSource().type;
                                "geojson" === o && n ? this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))) : "vector" !== o || n ? (void 0 === t.id && this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),
                                a.setFeatureState(n, t.id, i)) : this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))
                            } else
                                this.fire(new e.ErrorEvent(new Error("The source '" + r + "' does not exist in the map's style.")))
                        }
                        ,
                        i.prototype.removeFeatureState = function(t, i) {
                            this._checkLoaded();
                            var r = t.source
                              , n = this.sourceCaches[r];
                            if (void 0 !== n) {
                                var a = n.getSource().type
                                  , o = "vector" === a ? t.sourceLayer : void 0;
                                "vector" !== a || o ? i && "string" != typeof t.id && "number" != typeof t.id ? this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property."))) : n.removeFeatureState(o, t.id, i) : this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))
                            } else
                                this.fire(new e.ErrorEvent(new Error("The source '" + r + "' does not exist in the map's style.")))
                        }
                        ,
                        i.prototype.getFeatureState = function(t) {
                            this._checkLoaded();
                            var i = t.source
                              , r = t.sourceLayer
                              , n = this.sourceCaches[i];
                            if (void 0 !== n) {
                                if ("vector" !== n.getSource().type || r)
                                    return void 0 === t.id && this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),
                                    n.getFeatureState(r, t.id);
                                this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))
                            } else
                                this.fire(new e.ErrorEvent(new Error("The source '" + i + "' does not exist in the map's style.")))
                        }
                        ,
                        i.prototype.getTransition = function() {
                            return e.extend({
                                duration: 300,
                                delay: 0
                            }, this.stylesheet && this.stylesheet.transition)
                        }
                        ,
                        i.prototype.serialize = function() {
                            return e.filterObject({
                                version: this.stylesheet.version,
                                name: this.stylesheet.name,
                                metadata: this.stylesheet.metadata,
                                light: this.stylesheet.light,
                                center: this.stylesheet.center,
                                zoom: this.stylesheet.zoom,
                                bearing: this.stylesheet.bearing,
                                pitch: this.stylesheet.pitch,
                                sprite: this.stylesheet.sprite,
                                glyphs: this.stylesheet.glyphs,
                                transition: this.stylesheet.transition,
                                sources: e.mapObject(this.sourceCaches, (function(e) {
                                    return e.serialize()
                                }
                                )),
                                layers: this._serializeLayers(this._order)
                            }, (function(e) {
                                return void 0 !== e
                            }
                            ))
                        }
                        ,
                        i.prototype._updateLayer = function(e) {
                            this._updatedLayers[e.id] = !0,
                            e.source && !this._updatedSources[e.source] && "raster" !== this.sourceCaches[e.source].getSource().type && (this._updatedSources[e.source] = "reload",
                            this.sourceCaches[e.source].pause()),
                            this._changed = !0
                        }
                        ,
                        i.prototype._flattenAndSortRenderedFeatures = function(e) {
                            for (var t = this, i = function(e) {
                                return "fill-extrusion" === t._layers[e].type
                            }, r = {}, n = [], a = this._order.length - 1; a >= 0; a--) {
                                var o = this._order[a];
                                if (i(o)) {
                                    r[o] = a;
                                    for (var s = 0, l = e; s < l.length; s += 1) {
                                        var u = l[s][o];
                                        if (u)
                                            for (var c = 0, h = u; c < h.length; c += 1)
                                                n.push(h[c])
                                    }
                                }
                            }
                            n.sort((function(e, t) {
                                return t.intersectionZ - e.intersectionZ
                            }
                            ));
                            for (var p = [], f = this._order.length - 1; f >= 0; f--) {
                                var d = this._order[f];
                                if (i(d))
                                    for (var m = n.length - 1; m >= 0; m--) {
                                        var v = n[m].feature;
                                        if (r[v.layer.id] < f)
                                            break;
                                        p.push(v),
                                        n.pop()
                                    }
                                else
                                    for (var g = 0, y = e; g < y.length; g += 1) {
                                        var _ = y[g][d];
                                        if (_)
                                            for (var x = 0, b = _; x < b.length; x += 1)
                                                p.push(b[x].feature)
                                    }
                            }
                            return p
                        }
                        ,
                        i.prototype.queryRenderedFeatures = function(t, i, r) {
                            i && i.filter && this._validate(e.validateStyle.filter, "queryRenderedFeatures.filter", i.filter, null, i);
                            var n = {};
                            if (i && i.layers) {
                                if (!Array.isArray(i.layers))
                                    return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),
                                    [];
                                for (var a = 0, o = i.layers; a < o.length; a += 1) {
                                    var s = o[a]
                                      , l = this._layers[s];
                                    if (!l)
                                        return this.fire(new e.ErrorEvent(new Error("The layer '" + s + "' does not exist in the map's style and cannot be queried for features."))),
                                        [];
                                    n[l.source] = !0
                                }
                            }
                            var u = [];
                            for (var c in i.availableImages = this._availableImages,
                            this.sourceCaches)
                                i.layers && !n[c] || u.push(B(this.sourceCaches[c], this._layers, this._serializedLayers, t, i, r));
                            return this.placement && u.push(function(e, t, i, r, n, a, o) {
                                for (var s = {}, l = a.queryRenderedSymbols(r), u = [], c = 0, h = Object.keys(l).map(Number); c < h.length; c += 1)
                                    u.push(o[h[c]]);
                                u.sort(F);
                                for (var p = function() {
                                    var i = d[f]
                                      , r = i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId], t, i.bucketIndex, i.sourceLayerIndex, n.filter, n.layers, n.availableImages, e);
                                    for (var a in r) {
                                        var o = s[a] = s[a] || []
                                          , u = r[a];
                                        u.sort((function(e, t) {
                                            var r = i.featureSortOrder;
                                            if (r) {
                                                var n = r.indexOf(e.featureIndex);
                                                return r.indexOf(t.featureIndex) - n
                                            }
                                            return t.featureIndex - e.featureIndex
                                        }
                                        ));
                                        for (var c = 0, h = u; c < h.length; c += 1)
                                            o.push(h[c])
                                    }
                                }, f = 0, d = u; f < d.length; f += 1)
                                    p();
                                var m = function(t) {
                                    s[t].forEach((function(r) {
                                        var n = r.feature
                                          , a = i[e[t].source].getFeatureState(n.layer["source-layer"], n.id);
                                        n.source = n.layer.source,
                                        n.layer["source-layer"] && (n.sourceLayer = n.layer["source-layer"]),
                                        n.state = a
                                    }
                                    ))
                                };
                                for (var v in s)
                                    m(v);
                                return s
                            }(this._layers, this._serializedLayers, this.sourceCaches, t, i, this.placement.collisionIndex, this.placement.retainedQueryData)),
                            this._flattenAndSortRenderedFeatures(u)
                        }
                        ,
                        i.prototype.querySourceFeatures = function(t, i) {
                            i && i.filter && this._validate(e.validateStyle.filter, "querySourceFeatures.filter", i.filter, null, i);
                            var r = this.sourceCaches[t];
                            return r ? function(e, t) {
                                for (var i = e.getRenderableIds().map((function(t) {
                                    return e.getTileByID(t)
                                }
                                )), r = [], n = {}, a = 0; a < i.length; a++) {
                                    var o = i[a]
                                      , s = o.tileID.canonical.key;
                                    n[s] || (n[s] = !0,
                                    o.querySourceFeatures(r, t))
                                }
                                return r
                            }(r, i) : []
                        }
                        ,
                        i.prototype.addSourceType = function(e, t, r) {
                            return i.getSourceType(e) ? r(new Error('A source type called "' + e + '" already exists.')) : (i.setSourceType(e, t),
                            t.workerSourceURL ? void this.dispatcher.broadcast("loadWorkerSource", {
                                name: e,
                                url: t.workerSourceURL
                            }, r) : r(null, null))
                        }
                        ,
                        i.prototype.getLight = function() {
                            return this.light.getLight()
                        }
                        ,
                        i.prototype.setLight = function(t, i) {
                            void 0 === i && (i = {}),
                            this._checkLoaded();
                            var r = this.light.getLight()
                              , n = !1;
                            for (var a in t)
                                if (!e.deepEqual(t[a], r[a])) {
                                    n = !0;
                                    break
                                }
                            if (n) {
                                var o = {
                                    now: e.browser.now(),
                                    transition: e.extend({
                                        duration: 300,
                                        delay: 0
                                    }, this.stylesheet.transition)
                                };
                                this.light.setLight(t, i),
                                this.light.updateTransitions(o)
                            }
                        }
                        ,
                        i.prototype._validate = function(t, i, r, n, a) {
                            return void 0 === a && (a = {}),
                            (!a || !1 !== a.validate) && Nt(this, t.call(e.validateStyle, e.extend({
                                key: i,
                                style: this.serialize(),
                                value: r,
                                styleSpec: e.styleSpec
                            }, n)))
                        }
                        ,
                        i.prototype._remove = function() {
                            for (var t in this._request && (this._request.cancel(),
                            this._request = null),
                            this._spriteRequest && (this._spriteRequest.cancel(),
                            this._spriteRequest = null),
                            e.evented.off("pluginStateChange", this._rtlTextPluginCallback),
                            this._layers)
                                this._layers[t].setEventedParent(null);
                            for (var i in this.sourceCaches)
                                this.sourceCaches[i].clearTiles(),
                                this.sourceCaches[i].setEventedParent(null);
                            this.imageManager.setEventedParent(null),
                            this.setEventedParent(null),
                            this.dispatcher.remove()
                        }
                        ,
                        i.prototype._clearSource = function(e) {
                            this.sourceCaches[e].clearTiles()
                        }
                        ,
                        i.prototype._reloadSource = function(e) {
                            this.sourceCaches[e].resume(),
                            this.sourceCaches[e].reload()
                        }
                        ,
                        i.prototype._updateSources = function(e) {
                            for (var t in this.sourceCaches)
                                this.sourceCaches[t].update(e)
                        }
                        ,
                        i.prototype._generateCollisionBoxes = function() {
                            for (var e in this.sourceCaches)
                                this._reloadSource(e)
                        }
                        ,
                        i.prototype._updatePlacement = function(t, i, r, n, a) {
                            void 0 === a && (a = !1);
                            for (var o = !1, s = !1, l = {}, u = 0, c = this._order; u < c.length; u += 1) {
                                var h = this._layers[c[u]];
                                if ("symbol" === h.type) {
                                    if (!l[h.source]) {
                                        var p = this.sourceCaches[h.source];
                                        l[h.source] = p.getRenderableIds(!0).map((function(e) {
                                            return p.getTileByID(e)
                                        }
                                        )).sort((function(e, t) {
                                            return t.tileID.overscaledZ - e.tileID.overscaledZ || (e.tileID.isLessThan(t.tileID) ? -1 : 1)
                                        }
                                        ))
                                    }
                                    var f = this.crossTileSymbolIndex.addLayer(h, l[h.source], t.center.lng);
                                    o = o || f
                                }
                            }
                            if (this.crossTileSymbolIndex.pruneUnusedLayers(this._order),
                            ((a = a || this._layerOrderChanged || 0 === r) || !this.pauseablePlacement || this.pauseablePlacement.isDone() && !this.placement.stillRecent(e.browser.now(), t.zoom)) && (this.pauseablePlacement = new zt(t,this._order,a,i,r,n,this.placement),
                            this._layerOrderChanged = !1),
                            this.pauseablePlacement.isDone() ? this.placement.setStale() : (this.pauseablePlacement.continuePlacement(this._order, this._layers, l),
                            this.pauseablePlacement.isDone() && (this.placement = this.pauseablePlacement.commit(e.browser.now()),
                            s = !0),
                            o && this.pauseablePlacement.placement.setStale()),
                            s || o)
                                for (var d = 0, m = this._order; d < m.length; d += 1) {
                                    var v = this._layers[m[d]];
                                    "symbol" === v.type && this.placement.updateLayerOpacities(v, l[v.source])
                                }
                            return !this.pauseablePlacement.isDone() || this.placement.hasTransitions(e.browser.now())
                        }
                        ,
                        i.prototype._releaseSymbolFadeTiles = function() {
                            for (var e in this.sourceCaches)
                                this.sourceCaches[e].releaseSymbolFadeTiles()
                        }
                        ,
                        i.prototype.getImages = function(e, t, i) {
                            this.imageManager.getImages(t.icons, i),
                            this._updateTilesForChangedImages();
                            var r = this.sourceCaches[t.source];
                            r && r.setDependencies(t.tileID.key, t.type, t.icons)
                        }
                        ,
                        i.prototype.getGlyphs = function(e, t, i) {
                            this.glyphManager.getGlyphs(t.stacks, i)
                        }
                        ,
                        i.prototype.getResource = function(t, i, r) {
                            return e.makeRequest(i, r)
                        }
                        ,
                        i
                    }(e.Evented);
                    jt.getSourceType = function(e) {
                        return R[e]
                    }
                    ,
                    jt.setSourceType = function(e, t) {
                        R[e] = t
                    }
                    ,
                    jt.registerForPluginStateChange = e.registerForPluginStateChange;
                    var Ht = e.createLayout([{
                        name: "a_pos",
                        type: "Int16",
                        components: 2
                    }])
                      , qt = gi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif", "#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}")
                      , Wt = gi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}")
                      , Zt = gi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}")
                      , Xt = gi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}")
                      , Yt = gi("void main() {gl_FragColor=vec4(1.0);}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}")
                      , Kt = gi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}")
                      , Jt = gi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}")
                      , Qt = gi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}", "attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}")
                      , $t = gi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}", "attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}")
                      , ei = gi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}", "attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}")
                      , ti = gi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}")
                      , ii = gi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}")
                      , ri = gi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}")
                      , ni = gi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}")
                      , ai = gi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}")
                      , oi = gi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}")
                      , si = gi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}")
                      , li = gi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}")
                      , ui = gi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}")
                      , ci = gi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}")
                      , hi = gi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}")
                      , pi = gi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}")
                      , fi = gi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}")
                      , di = gi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}")
                      , mi = gi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}")
                      , vi = gi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");
                    function gi(e, t) {
                        var i = /#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g
                          , r = t.match(/attribute ([\w]+) ([\w]+)/g)
                          , n = e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g)
                          , a = t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g)
                          , o = a ? a.concat(n) : n
                          , s = {};
                        return {
                            fragmentSource: e = e.replace(i, (function(e, t, i, r, n) {
                                return s[n] = !0,
                                "define" === t ? "\n#ifndef HAS_UNIFORM_u_" + n + "\nvarying " + i + " " + r + " " + n + ";\n#else\nuniform " + i + " " + r + " u_" + n + ";\n#endif\n" : "\n#ifdef HAS_UNIFORM_u_" + n + "\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n"
                            }
                            )),
                            vertexSource: t = t.replace(i, (function(e, t, i, r, n) {
                                var a = "float" === r ? "vec2" : "vec4"
                                  , o = n.match(/color/) ? "color" : a;
                                return s[n] ? "define" === t ? "\n#ifndef HAS_UNIFORM_u_" + n + "\nuniform lowp float u_" + n + "_t;\nattribute " + i + " " + a + " a_" + n + ";\nvarying " + i + " " + r + " " + n + ";\n#else\nuniform " + i + " " + r + " u_" + n + ";\n#endif\n" : "vec4" === o ? "\n#ifndef HAS_UNIFORM_u_" + n + "\n    " + n + " = a_" + n + ";\n#else\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n" : "\n#ifndef HAS_UNIFORM_u_" + n + "\n    " + n + " = unpack_mix_" + o + "(a_" + n + ", u_" + n + "_t);\n#else\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n" : "define" === t ? "\n#ifndef HAS_UNIFORM_u_" + n + "\nuniform lowp float u_" + n + "_t;\nattribute " + i + " " + a + " a_" + n + ";\n#else\nuniform " + i + " " + r + " u_" + n + ";\n#endif\n" : "vec4" === o ? "\n#ifndef HAS_UNIFORM_u_" + n + "\n    " + i + " " + r + " " + n + " = a_" + n + ";\n#else\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n" : "\n#ifndef HAS_UNIFORM_u_" + n + "\n    " + i + " " + r + " " + n + " = unpack_mix_" + o + "(a_" + n + ", u_" + n + "_t);\n#else\n    " + i + " " + r + " " + n + " = u_" + n + ";\n#endif\n"
                            }
                            )),
                            staticAttributes: r,
                            staticUniforms: o
                        }
                    }
                    var yi = Object.freeze({
                        __proto__: null,
                        prelude: qt,
                        background: Wt,
                        backgroundPattern: Zt,
                        circle: Xt,
                        clippingMask: Yt,
                        heatmap: Kt,
                        heatmapTexture: Jt,
                        collisionBox: Qt,
                        collisionCircle: $t,
                        debug: ei,
                        fill: ti,
                        fillOutline: ii,
                        fillOutlinePattern: ri,
                        fillPattern: ni,
                        fillExtrusion: ai,
                        fillExtrusionPattern: oi,
                        hillshadePrepare: si,
                        hillshade: li,
                        line: ui,
                        lineGradient: ci,
                        linePattern: hi,
                        lineSDF: pi,
                        raster: fi,
                        symbolIcon: di,
                        symbolSDF: mi,
                        symbolTextAndIcon: vi
                    })
                      , _i = function() {
                        this.boundProgram = null,
                        this.boundLayoutVertexBuffer = null,
                        this.boundPaintVertexBuffers = [],
                        this.boundIndexBuffer = null,
                        this.boundVertexOffset = null,
                        this.boundDynamicVertexBuffer = null,
                        this.vao = null
                    };
                    function xi(e) {
                        for (var t = [], i = 0; i < e.length; i++)
                            if (null !== e[i]) {
                                var r = e[i].split(" ");
                                t.push(r.pop())
                            }
                        return t
                    }
                    _i.prototype.bind = function(e, t, i, r, n, a, o, s) {
                        this.context = e;
                        for (var l = this.boundPaintVertexBuffers.length !== r.length, u = 0; !l && u < r.length; u++)
                            this.boundPaintVertexBuffers[u] !== r[u] && (l = !0);
                        e.extVertexArrayObject && this.vao && this.boundProgram === t && this.boundLayoutVertexBuffer === i && !l && this.boundIndexBuffer === n && this.boundVertexOffset === a && this.boundDynamicVertexBuffer === o && this.boundDynamicVertexBuffer2 === s ? (e.bindVertexArrayOES.set(this.vao),
                        o && o.bind(),
                        n && n.dynamicDraw && n.bind(),
                        s && s.bind()) : this.freshBind(t, i, r, n, a, o, s)
                    }
                    ,
                    _i.prototype.freshBind = function(e, t, i, r, n, a, o) {
                        var s, l = e.numAttributes, u = this.context, c = u.gl;
                        if (u.extVertexArrayObject)
                            this.vao && this.destroy(),
                            this.vao = u.extVertexArrayObject.createVertexArrayOES(),
                            u.bindVertexArrayOES.set(this.vao),
                            s = 0,
                            this.boundProgram = e,
                            this.boundLayoutVertexBuffer = t,
                            this.boundPaintVertexBuffers = i,
                            this.boundIndexBuffer = r,
                            this.boundVertexOffset = n,
                            this.boundDynamicVertexBuffer = a,
                            this.boundDynamicVertexBuffer2 = o;
                        else {
                            s = u.currentNumAttributes || 0;
                            for (var h = l; h < s; h++)
                                c.disableVertexAttribArray(h)
                        }
                        t.enableAttributes(c, e);
                        for (var p = 0, f = i; p < f.length; p += 1)
                            f[p].enableAttributes(c, e);
                        a && a.enableAttributes(c, e),
                        o && o.enableAttributes(c, e),
                        t.bind(),
                        t.setVertexAttribPointers(c, e, n);
                        for (var d = 0, m = i; d < m.length; d += 1) {
                            var v = m[d];
                            v.bind(),
                            v.setVertexAttribPointers(c, e, n)
                        }
                        a && (a.bind(),
                        a.setVertexAttribPointers(c, e, n)),
                        r && r.bind(),
                        o && (o.bind(),
                        o.setVertexAttribPointers(c, e, n)),
                        u.currentNumAttributes = l
                    }
                    ,
                    _i.prototype.destroy = function() {
                        this.vao && (this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),
                        this.vao = null)
                    }
                    ;
                    var bi = function(e, t, i, r, n, a) {
                        var o = e.gl;
                        this.program = o.createProgram();
                        for (var s = xi(i.staticAttributes), l = r ? r.getBinderAttributes() : [], u = s.concat(l), c = i.staticUniforms ? xi(i.staticUniforms) : [], h = r ? r.getBinderUniforms() : [], p = [], f = 0, d = c.concat(h); f < d.length; f += 1) {
                            var m = d[f];
                            p.indexOf(m) < 0 && p.push(m)
                        }
                        var v = r ? r.defines() : [];
                        a && v.push("#define OVERDRAW_INSPECTOR;");
                        var g = v.concat(qt.fragmentSource, i.fragmentSource).join("\n")
                          , y = v.concat(qt.vertexSource, i.vertexSource).join("\n")
                          , _ = o.createShader(o.FRAGMENT_SHADER);
                        if (o.isContextLost())
                            this.failedToCreate = !0;
                        else {
                            o.shaderSource(_, g),
                            o.compileShader(_),
                            o.attachShader(this.program, _);
                            var x = o.createShader(o.VERTEX_SHADER);
                            if (o.isContextLost())
                                this.failedToCreate = !0;
                            else {
                                o.shaderSource(x, y),
                                o.compileShader(x),
                                o.attachShader(this.program, x),
                                this.attributes = {};
                                var b = {};
                                this.numAttributes = u.length;
                                for (var w = 0; w < this.numAttributes; w++)
                                    u[w] && (o.bindAttribLocation(this.program, w, u[w]),
                                    this.attributes[u[w]] = w);
                                o.linkProgram(this.program),
                                o.deleteShader(x),
                                o.deleteShader(_);
                                for (var S = 0; S < p.length; S++) {
                                    var M = p[S];
                                    if (M && !b[M]) {
                                        var T = o.getUniformLocation(this.program, M);
                                        T && (b[M] = T)
                                    }
                                }
                                this.fixedUniforms = n(e, b),
                                this.binderUniforms = r ? r.getUniforms(e, b) : []
                            }
                        }
                    };
                    function wi(e, t, i) {
                        var r = 1 / pt(i, 1, t.transform.tileZoom)
                          , n = Math.pow(2, i.tileID.overscaledZ)
                          , a = i.tileSize * Math.pow(2, t.transform.tileZoom) / n
                          , o = a * (i.tileID.canonical.x + i.tileID.wrap * n)
                          , s = a * i.tileID.canonical.y;
                        return {
                            u_image: 0,
                            u_texsize: i.imageAtlasTexture.size,
                            u_scale: [r, e.fromScale, e.toScale],
                            u_fade: e.t,
                            u_pixel_coord_upper: [o >> 16, s >> 16],
                            u_pixel_coord_lower: [65535 & o, 65535 & s]
                        }
                    }
                    bi.prototype.draw = function(e, t, i, r, n, a, o, s, l, u, c, h, p, f, d, m) {
                        var v, g = e.gl;
                        if (!this.failedToCreate) {
                            for (var y in e.program.set(this.program),
                            e.setDepthMode(i),
                            e.setStencilMode(r),
                            e.setColorMode(n),
                            e.setCullFace(a),
                            this.fixedUniforms)
                                this.fixedUniforms[y].set(o[y]);
                            f && f.setUniforms(e, this.binderUniforms, h, {
                                zoom: p
                            });
                            for (var _ = (v = {},
                            v[g.LINES] = 2,
                            v[g.TRIANGLES] = 3,
                            v[g.LINE_STRIP] = 1,
                            v)[t], x = 0, b = c.get(); x < b.length; x += 1) {
                                var w = b[x]
                                  , S = w.vaos || (w.vaos = {});
                                (S[s] || (S[s] = new _i)).bind(e, this, l, f ? f.getPaintVertexBuffers() : [], u, w.vertexOffset, d, m),
                                g.drawElements(t, w.primitiveLength * _, g.UNSIGNED_SHORT, w.primitiveOffset * _ * 2)
                            }
                        }
                    }
                    ;
                    var Si = function(t, i, r, n) {
                        var a = i.style.light
                          , o = a.properties.get("position")
                          , s = [o.x, o.y, o.z]
                          , l = e.create$1();
                        "viewport" === a.properties.get("anchor") && e.fromRotation(l, -i.transform.angle),
                        e.transformMat3(s, s, l);
                        var u = a.properties.get("color");
                        return {
                            u_matrix: t,
                            u_lightpos: s,
                            u_lightintensity: a.properties.get("intensity"),
                            u_lightcolor: [u.r, u.g, u.b],
                            u_vertical_gradient: +r,
                            u_opacity: n
                        }
                    }
                      , Mi = function(t, i, r, n, a, o, s) {
                        return e.extend(Si(t, i, r, n), wi(o, i, s), {
                            u_height_factor: -Math.pow(2, a.overscaledZ) / s.tileSize / 8
                        })
                    }
                      , Ti = function(e) {
                        return {
                            u_matrix: e
                        }
                    }
                      , Ei = function(t, i, r, n) {
                        return e.extend(Ti(t), wi(r, i, n))
                    }
                      , Ai = function(e, t) {
                        return {
                            u_matrix: e,
                            u_world: t
                        }
                    }
                      , Pi = function(t, i, r, n, a) {
                        return e.extend(Ei(t, i, r, n), {
                            u_world: a
                        })
                    }
                      , Ci = function(t, i, r, n) {
                        var a, o, s = t.transform;
                        if ("map" === n.paint.get("circle-pitch-alignment")) {
                            var l = pt(r, 1, s.zoom);
                            a = !0,
                            o = [l, l]
                        } else
                            a = !1,
                            o = s.pixelsToGLUnits;
                        return {
                            u_camera_to_center_distance: s.cameraToCenterDistance,
                            u_scale_with_map: +("map" === n.paint.get("circle-pitch-scale")),
                            u_matrix: t.translatePosMatrix(i.posMatrix, r, n.paint.get("circle-translate"), n.paint.get("circle-translate-anchor")),
                            u_pitch_with_map: +a,
                            u_device_pixel_ratio: e.browser.devicePixelRatio,
                            u_extrude_scale: o
                        }
                    }
                      , Li = function(e, t, i) {
                        var r = pt(i, 1, t.zoom)
                          , n = Math.pow(2, t.zoom - i.tileID.overscaledZ)
                          , a = i.tileID.overscaleFactor();
                        return {
                            u_matrix: e,
                            u_camera_to_center_distance: t.cameraToCenterDistance,
                            u_pixels_to_tile_units: r,
                            u_extrude_scale: [t.pixelsToGLUnits[0] / (r * n), t.pixelsToGLUnits[1] / (r * n)],
                            u_overscale_factor: a
                        }
                    }
                      , Ii = function(e, t, i) {
                        return {
                            u_matrix: e,
                            u_inv_matrix: t,
                            u_camera_to_center_distance: i.cameraToCenterDistance,
                            u_viewport_size: [i.width, i.height]
                        }
                    }
                      , ki = function(e, t, i) {
                        return void 0 === i && (i = 1),
                        {
                            u_matrix: e,
                            u_color: t,
                            u_overlay: 0,
                            u_overlay_scale: i
                        }
                    }
                      , zi = function(e) {
                        return {
                            u_matrix: e
                        }
                    }
                      , Di = function(e, t, i, r) {
                        return {
                            u_matrix: e,
                            u_extrude_scale: pt(t, 1, i),
                            u_intensity: r
                        }
                    }
                      , Ri = function(t, i, r) {
                        var n = t.transform;
                        return {
                            u_matrix: Ui(t, i, r),
                            u_ratio: 1 / pt(i, 1, n.zoom),
                            u_device_pixel_ratio: e.browser.devicePixelRatio,
                            u_units_to_pixels: [1 / n.pixelsToGLUnits[0], 1 / n.pixelsToGLUnits[1]]
                        }
                    }
                      , Oi = function(t, i, r, n) {
                        return e.extend(Ri(t, i, r), {
                            u_image: 0,
                            u_image_height: n
                        })
                    }
                      , Bi = function(t, i, r, n) {
                        var a = t.transform
                          , o = Ni(i, a);
                        return {
                            u_matrix: Ui(t, i, r),
                            u_texsize: i.imageAtlasTexture.size,
                            u_ratio: 1 / pt(i, 1, a.zoom),
                            u_device_pixel_ratio: e.browser.devicePixelRatio,
                            u_image: 0,
                            u_scale: [o, n.fromScale, n.toScale],
                            u_fade: n.t,
                            u_units_to_pixels: [1 / a.pixelsToGLUnits[0], 1 / a.pixelsToGLUnits[1]]
                        }
                    }
                      , Fi = function(t, i, r, n, a) {
                        var o = t.lineAtlas
                          , s = Ni(i, t.transform)
                          , l = "round" === r.layout.get("line-cap")
                          , u = o.getDash(n.from, l)
                          , c = o.getDash(n.to, l)
                          , h = u.width * a.fromScale
                          , p = c.width * a.toScale;
                        return e.extend(Ri(t, i, r), {
                            u_patternscale_a: [s / h, -u.height / 2],
                            u_patternscale_b: [s / p, -c.height / 2],
                            u_sdfgamma: o.width / (256 * Math.min(h, p) * e.browser.devicePixelRatio) / 2,
                            u_image: 0,
                            u_tex_y_a: u.y,
                            u_tex_y_b: c.y,
                            u_mix: a.t
                        })
                    };
                    function Ni(e, t) {
                        return 1 / pt(e, 1, t.tileZoom)
                    }
                    function Ui(e, t, i) {
                        return e.translatePosMatrix(t.tileID.posMatrix, t, i.paint.get("line-translate"), i.paint.get("line-translate-anchor"))
                    }
                    var Vi = function(e, t, i, r, n) {
                        return {
                            u_matrix: e,
                            u_tl_parent: t,
                            u_scale_parent: i,
                            u_buffer_scale: 1,
                            u_fade_t: r.mix,
                            u_opacity: r.opacity * n.paint.get("raster-opacity"),
                            u_image0: 0,
                            u_image1: 1,
                            u_brightness_low: n.paint.get("raster-brightness-min"),
                            u_brightness_high: n.paint.get("raster-brightness-max"),
                            u_saturation_factor: (o = n.paint.get("raster-saturation"),
                            o > 0 ? 1 - 1 / (1.001 - o) : -o),
                            u_contrast_factor: (a = n.paint.get("raster-contrast"),
                            a > 0 ? 1 / (1 - a) : 1 + a),
                            u_spin_weights: Gi(n.paint.get("raster-hue-rotate"))
                        };
                        var a, o
                    };
                    function Gi(e) {
                        e *= Math.PI / 180;
                        var t = Math.sin(e)
                          , i = Math.cos(e);
                        return [(2 * i + 1) / 3, (-Math.sqrt(3) * t - i + 1) / 3, (Math.sqrt(3) * t - i + 1) / 3]
                    }
                    var ji, Hi = function(e, t, i, r, n, a, o, s, l, u) {
                        var c = n.transform;
                        return {
                            u_is_size_zoom_constant: +("constant" === e || "source" === e),
                            u_is_size_feature_constant: +("constant" === e || "camera" === e),
                            u_size_t: t ? t.uSizeT : 0,
                            u_size: t ? t.uSize : 0,
                            u_camera_to_center_distance: c.cameraToCenterDistance,
                            u_pitch: c.pitch / 360 * 2 * Math.PI,
                            u_rotate_symbol: +i,
                            u_aspect_ratio: c.width / c.height,
                            u_fade_change: n.options.fadeDuration ? n.symbolFadeChange : 1,
                            u_matrix: a,
                            u_label_plane_matrix: o,
                            u_coord_matrix: s,
                            u_is_text: +l,
                            u_pitch_with_map: +r,
                            u_texsize: u,
                            u_texture: 0
                        }
                    }, qi = function(t, i, r, n, a, o, s, l, u, c, h) {
                        var p = a.transform;
                        return e.extend(Hi(t, i, r, n, a, o, s, l, u, c), {
                            u_gamma_scale: n ? Math.cos(p._pitch) * p.cameraToCenterDistance : 1,
                            u_device_pixel_ratio: e.browser.devicePixelRatio,
                            u_is_halo: +h
                        })
                    }, Wi = function(t, i, r, n, a, o, s, l, u, c) {
                        return e.extend(qi(t, i, r, n, a, o, s, l, !0, u, !0), {
                            u_texsize_icon: c,
                            u_texture_icon: 1
                        })
                    }, Zi = function(e, t, i) {
                        return {
                            u_matrix: e,
                            u_opacity: t,
                            u_color: i
                        }
                    }, Xi = function(t, i, r, n, a, o) {
                        return e.extend(function(e, t, i, r) {
                            var n = i.imageManager.getPattern(e.from.toString())
                              , a = i.imageManager.getPattern(e.to.toString())
                              , o = i.imageManager.getPixelSize()
                              , s = o.width
                              , l = o.height
                              , u = Math.pow(2, r.tileID.overscaledZ)
                              , c = r.tileSize * Math.pow(2, i.transform.tileZoom) / u
                              , h = c * (r.tileID.canonical.x + r.tileID.wrap * u)
                              , p = c * r.tileID.canonical.y;
                            return {
                                u_image: 0,
                                u_pattern_tl_a: n.tl,
                                u_pattern_br_a: n.br,
                                u_pattern_tl_b: a.tl,
                                u_pattern_br_b: a.br,
                                u_texsize: [s, l],
                                u_mix: t.t,
                                u_pattern_size_a: n.displaySize,
                                u_pattern_size_b: a.displaySize,
                                u_scale_a: t.fromScale,
                                u_scale_b: t.toScale,
                                u_tile_units_to_pixels: 1 / pt(r, 1, i.transform.tileZoom),
                                u_pixel_coord_upper: [h >> 16, p >> 16],
                                u_pixel_coord_lower: [65535 & h, 65535 & p]
                            }
                        }(n, o, r, a), {
                            u_matrix: t,
                            u_opacity: i
                        })
                    }, Yi = {
                        fillExtrusion: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_lightpos: new e.Uniform3f(t,i.u_lightpos),
                                u_lightintensity: new e.Uniform1f(t,i.u_lightintensity),
                                u_lightcolor: new e.Uniform3f(t,i.u_lightcolor),
                                u_vertical_gradient: new e.Uniform1f(t,i.u_vertical_gradient),
                                u_opacity: new e.Uniform1f(t,i.u_opacity)
                            }
                        },
                        fillExtrusionPattern: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_lightpos: new e.Uniform3f(t,i.u_lightpos),
                                u_lightintensity: new e.Uniform1f(t,i.u_lightintensity),
                                u_lightcolor: new e.Uniform3f(t,i.u_lightcolor),
                                u_vertical_gradient: new e.Uniform1f(t,i.u_vertical_gradient),
                                u_height_factor: new e.Uniform1f(t,i.u_height_factor),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_texsize: new e.Uniform2f(t,i.u_texsize),
                                u_pixel_coord_upper: new e.Uniform2f(t,i.u_pixel_coord_upper),
                                u_pixel_coord_lower: new e.Uniform2f(t,i.u_pixel_coord_lower),
                                u_scale: new e.Uniform3f(t,i.u_scale),
                                u_fade: new e.Uniform1f(t,i.u_fade),
                                u_opacity: new e.Uniform1f(t,i.u_opacity)
                            }
                        },
                        fill: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix)
                            }
                        },
                        fillPattern: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_texsize: new e.Uniform2f(t,i.u_texsize),
                                u_pixel_coord_upper: new e.Uniform2f(t,i.u_pixel_coord_upper),
                                u_pixel_coord_lower: new e.Uniform2f(t,i.u_pixel_coord_lower),
                                u_scale: new e.Uniform3f(t,i.u_scale),
                                u_fade: new e.Uniform1f(t,i.u_fade)
                            }
                        },
                        fillOutline: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_world: new e.Uniform2f(t,i.u_world)
                            }
                        },
                        fillOutlinePattern: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_world: new e.Uniform2f(t,i.u_world),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_texsize: new e.Uniform2f(t,i.u_texsize),
                                u_pixel_coord_upper: new e.Uniform2f(t,i.u_pixel_coord_upper),
                                u_pixel_coord_lower: new e.Uniform2f(t,i.u_pixel_coord_lower),
                                u_scale: new e.Uniform3f(t,i.u_scale),
                                u_fade: new e.Uniform1f(t,i.u_fade)
                            }
                        },
                        circle: function(t, i) {
                            return {
                                u_camera_to_center_distance: new e.Uniform1f(t,i.u_camera_to_center_distance),
                                u_scale_with_map: new e.Uniform1i(t,i.u_scale_with_map),
                                u_pitch_with_map: new e.Uniform1i(t,i.u_pitch_with_map),
                                u_extrude_scale: new e.Uniform2f(t,i.u_extrude_scale),
                                u_device_pixel_ratio: new e.Uniform1f(t,i.u_device_pixel_ratio),
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix)
                            }
                        },
                        collisionBox: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_camera_to_center_distance: new e.Uniform1f(t,i.u_camera_to_center_distance),
                                u_pixels_to_tile_units: new e.Uniform1f(t,i.u_pixels_to_tile_units),
                                u_extrude_scale: new e.Uniform2f(t,i.u_extrude_scale),
                                u_overscale_factor: new e.Uniform1f(t,i.u_overscale_factor)
                            }
                        },
                        collisionCircle: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_inv_matrix: new e.UniformMatrix4f(t,i.u_inv_matrix),
                                u_camera_to_center_distance: new e.Uniform1f(t,i.u_camera_to_center_distance),
                                u_viewport_size: new e.Uniform2f(t,i.u_viewport_size)
                            }
                        },
                        debug: function(t, i) {
                            return {
                                u_color: new e.UniformColor(t,i.u_color),
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_overlay: new e.Uniform1i(t,i.u_overlay),
                                u_overlay_scale: new e.Uniform1f(t,i.u_overlay_scale)
                            }
                        },
                        clippingMask: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix)
                            }
                        },
                        heatmap: function(t, i) {
                            return {
                                u_extrude_scale: new e.Uniform1f(t,i.u_extrude_scale),
                                u_intensity: new e.Uniform1f(t,i.u_intensity),
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix)
                            }
                        },
                        heatmapTexture: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_world: new e.Uniform2f(t,i.u_world),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_color_ramp: new e.Uniform1i(t,i.u_color_ramp),
                                u_opacity: new e.Uniform1f(t,i.u_opacity)
                            }
                        },
                        hillshade: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_latrange: new e.Uniform2f(t,i.u_latrange),
                                u_light: new e.Uniform2f(t,i.u_light),
                                u_shadow: new e.UniformColor(t,i.u_shadow),
                                u_highlight: new e.UniformColor(t,i.u_highlight),
                                u_accent: new e.UniformColor(t,i.u_accent)
                            }
                        },
                        hillshadePrepare: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_dimension: new e.Uniform2f(t,i.u_dimension),
                                u_zoom: new e.Uniform1f(t,i.u_zoom),
                                u_unpack: new e.Uniform4f(t,i.u_unpack)
                            }
                        },
                        line: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_ratio: new e.Uniform1f(t,i.u_ratio),
                                u_device_pixel_ratio: new e.Uniform1f(t,i.u_device_pixel_ratio),
                                u_units_to_pixels: new e.Uniform2f(t,i.u_units_to_pixels)
                            }
                        },
                        lineGradient: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_ratio: new e.Uniform1f(t,i.u_ratio),
                                u_device_pixel_ratio: new e.Uniform1f(t,i.u_device_pixel_ratio),
                                u_units_to_pixels: new e.Uniform2f(t,i.u_units_to_pixels),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_image_height: new e.Uniform1f(t,i.u_image_height)
                            }
                        },
                        linePattern: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_texsize: new e.Uniform2f(t,i.u_texsize),
                                u_ratio: new e.Uniform1f(t,i.u_ratio),
                                u_device_pixel_ratio: new e.Uniform1f(t,i.u_device_pixel_ratio),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_units_to_pixels: new e.Uniform2f(t,i.u_units_to_pixels),
                                u_scale: new e.Uniform3f(t,i.u_scale),
                                u_fade: new e.Uniform1f(t,i.u_fade)
                            }
                        },
                        lineSDF: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_ratio: new e.Uniform1f(t,i.u_ratio),
                                u_device_pixel_ratio: new e.Uniform1f(t,i.u_device_pixel_ratio),
                                u_units_to_pixels: new e.Uniform2f(t,i.u_units_to_pixels),
                                u_patternscale_a: new e.Uniform2f(t,i.u_patternscale_a),
                                u_patternscale_b: new e.Uniform2f(t,i.u_patternscale_b),
                                u_sdfgamma: new e.Uniform1f(t,i.u_sdfgamma),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_tex_y_a: new e.Uniform1f(t,i.u_tex_y_a),
                                u_tex_y_b: new e.Uniform1f(t,i.u_tex_y_b),
                                u_mix: new e.Uniform1f(t,i.u_mix)
                            }
                        },
                        raster: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_tl_parent: new e.Uniform2f(t,i.u_tl_parent),
                                u_scale_parent: new e.Uniform1f(t,i.u_scale_parent),
                                u_buffer_scale: new e.Uniform1f(t,i.u_buffer_scale),
                                u_fade_t: new e.Uniform1f(t,i.u_fade_t),
                                u_opacity: new e.Uniform1f(t,i.u_opacity),
                                u_image0: new e.Uniform1i(t,i.u_image0),
                                u_image1: new e.Uniform1i(t,i.u_image1),
                                u_brightness_low: new e.Uniform1f(t,i.u_brightness_low),
                                u_brightness_high: new e.Uniform1f(t,i.u_brightness_high),
                                u_saturation_factor: new e.Uniform1f(t,i.u_saturation_factor),
                                u_contrast_factor: new e.Uniform1f(t,i.u_contrast_factor),
                                u_spin_weights: new e.Uniform3f(t,i.u_spin_weights)
                            }
                        },
                        symbolIcon: function(t, i) {
                            return {
                                u_is_size_zoom_constant: new e.Uniform1i(t,i.u_is_size_zoom_constant),
                                u_is_size_feature_constant: new e.Uniform1i(t,i.u_is_size_feature_constant),
                                u_size_t: new e.Uniform1f(t,i.u_size_t),
                                u_size: new e.Uniform1f(t,i.u_size),
                                u_camera_to_center_distance: new e.Uniform1f(t,i.u_camera_to_center_distance),
                                u_pitch: new e.Uniform1f(t,i.u_pitch),
                                u_rotate_symbol: new e.Uniform1i(t,i.u_rotate_symbol),
                                u_aspect_ratio: new e.Uniform1f(t,i.u_aspect_ratio),
                                u_fade_change: new e.Uniform1f(t,i.u_fade_change),
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_label_plane_matrix: new e.UniformMatrix4f(t,i.u_label_plane_matrix),
                                u_coord_matrix: new e.UniformMatrix4f(t,i.u_coord_matrix),
                                u_is_text: new e.Uniform1i(t,i.u_is_text),
                                u_pitch_with_map: new e.Uniform1i(t,i.u_pitch_with_map),
                                u_texsize: new e.Uniform2f(t,i.u_texsize),
                                u_texture: new e.Uniform1i(t,i.u_texture)
                            }
                        },
                        symbolSDF: function(t, i) {
                            return {
                                u_is_size_zoom_constant: new e.Uniform1i(t,i.u_is_size_zoom_constant),
                                u_is_size_feature_constant: new e.Uniform1i(t,i.u_is_size_feature_constant),
                                u_size_t: new e.Uniform1f(t,i.u_size_t),
                                u_size: new e.Uniform1f(t,i.u_size),
                                u_camera_to_center_distance: new e.Uniform1f(t,i.u_camera_to_center_distance),
                                u_pitch: new e.Uniform1f(t,i.u_pitch),
                                u_rotate_symbol: new e.Uniform1i(t,i.u_rotate_symbol),
                                u_aspect_ratio: new e.Uniform1f(t,i.u_aspect_ratio),
                                u_fade_change: new e.Uniform1f(t,i.u_fade_change),
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_label_plane_matrix: new e.UniformMatrix4f(t,i.u_label_plane_matrix),
                                u_coord_matrix: new e.UniformMatrix4f(t,i.u_coord_matrix),
                                u_is_text: new e.Uniform1i(t,i.u_is_text),
                                u_pitch_with_map: new e.Uniform1i(t,i.u_pitch_with_map),
                                u_texsize: new e.Uniform2f(t,i.u_texsize),
                                u_texture: new e.Uniform1i(t,i.u_texture),
                                u_gamma_scale: new e.Uniform1f(t,i.u_gamma_scale),
                                u_device_pixel_ratio: new e.Uniform1f(t,i.u_device_pixel_ratio),
                                u_is_halo: new e.Uniform1i(t,i.u_is_halo)
                            }
                        },
                        symbolTextAndIcon: function(t, i) {
                            return {
                                u_is_size_zoom_constant: new e.Uniform1i(t,i.u_is_size_zoom_constant),
                                u_is_size_feature_constant: new e.Uniform1i(t,i.u_is_size_feature_constant),
                                u_size_t: new e.Uniform1f(t,i.u_size_t),
                                u_size: new e.Uniform1f(t,i.u_size),
                                u_camera_to_center_distance: new e.Uniform1f(t,i.u_camera_to_center_distance),
                                u_pitch: new e.Uniform1f(t,i.u_pitch),
                                u_rotate_symbol: new e.Uniform1i(t,i.u_rotate_symbol),
                                u_aspect_ratio: new e.Uniform1f(t,i.u_aspect_ratio),
                                u_fade_change: new e.Uniform1f(t,i.u_fade_change),
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_label_plane_matrix: new e.UniformMatrix4f(t,i.u_label_plane_matrix),
                                u_coord_matrix: new e.UniformMatrix4f(t,i.u_coord_matrix),
                                u_is_text: new e.Uniform1i(t,i.u_is_text),
                                u_pitch_with_map: new e.Uniform1i(t,i.u_pitch_with_map),
                                u_texsize: new e.Uniform2f(t,i.u_texsize),
                                u_texsize_icon: new e.Uniform2f(t,i.u_texsize_icon),
                                u_texture: new e.Uniform1i(t,i.u_texture),
                                u_texture_icon: new e.Uniform1i(t,i.u_texture_icon),
                                u_gamma_scale: new e.Uniform1f(t,i.u_gamma_scale),
                                u_device_pixel_ratio: new e.Uniform1f(t,i.u_device_pixel_ratio),
                                u_is_halo: new e.Uniform1i(t,i.u_is_halo)
                            }
                        },
                        background: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_opacity: new e.Uniform1f(t,i.u_opacity),
                                u_color: new e.UniformColor(t,i.u_color)
                            }
                        },
                        backgroundPattern: function(t, i) {
                            return {
                                u_matrix: new e.UniformMatrix4f(t,i.u_matrix),
                                u_opacity: new e.Uniform1f(t,i.u_opacity),
                                u_image: new e.Uniform1i(t,i.u_image),
                                u_pattern_tl_a: new e.Uniform2f(t,i.u_pattern_tl_a),
                                u_pattern_br_a: new e.Uniform2f(t,i.u_pattern_br_a),
                                u_pattern_tl_b: new e.Uniform2f(t,i.u_pattern_tl_b),
                                u_pattern_br_b: new e.Uniform2f(t,i.u_pattern_br_b),
                                u_texsize: new e.Uniform2f(t,i.u_texsize),
                                u_mix: new e.Uniform1f(t,i.u_mix),
                                u_pattern_size_a: new e.Uniform2f(t,i.u_pattern_size_a),
                                u_pattern_size_b: new e.Uniform2f(t,i.u_pattern_size_b),
                                u_scale_a: new e.Uniform1f(t,i.u_scale_a),
                                u_scale_b: new e.Uniform1f(t,i.u_scale_b),
                                u_pixel_coord_upper: new e.Uniform2f(t,i.u_pixel_coord_upper),
                                u_pixel_coord_lower: new e.Uniform2f(t,i.u_pixel_coord_lower),
                                u_tile_units_to_pixels: new e.Uniform1f(t,i.u_tile_units_to_pixels)
                            }
                        }
                    };
                    function Ki(t, i, r, n, a, o, s) {
                        for (var l = t.context, u = l.gl, c = t.useProgram("collisionBox"), h = [], p = 0, f = 0, d = 0; d < n.length; d++) {
                            var m = n[d]
                              , v = i.getTile(m)
                              , g = v.getBucket(r);
                            if (g) {
                                var y = m.posMatrix;
                                0 === a[0] && 0 === a[1] || (y = t.translatePosMatrix(m.posMatrix, v, a, o));
                                var _ = s ? g.textCollisionBox : g.iconCollisionBox
                                  , x = g.collisionCircleArray;
                                if (x.length > 0) {
                                    var b = e.create()
                                      , w = y;
                                    e.mul(b, g.placementInvProjMatrix, t.transform.glCoordMatrix),
                                    e.mul(b, b, g.placementViewportMatrix),
                                    h.push({
                                        circleArray: x,
                                        circleOffset: f,
                                        transform: w,
                                        invTransform: b
                                    }),
                                    f = p += x.length / 4
                                }
                                _ && c.draw(l, u.LINES, Te.disabled, Ee.disabled, t.colorModeForRenderPass(), Pe.disabled, Li(y, t.transform, v), r.id, _.layoutVertexBuffer, _.indexBuffer, _.segments, null, t.transform.zoom, null, null, _.collisionVertexBuffer)
                            }
                        }
                        if (s && h.length) {
                            var S = t.useProgram("collisionCircle")
                              , M = new e.StructArrayLayout2f1f2i16;
                            M.resize(4 * p),
                            M._trim();
                            for (var T = 0, E = 0, A = h; E < A.length; E += 1)
                                for (var P = A[E], C = 0; C < P.circleArray.length / 4; C++) {
                                    var L = 4 * C
                                      , I = P.circleArray[L + 0]
                                      , k = P.circleArray[L + 1]
                                      , z = P.circleArray[L + 2]
                                      , D = P.circleArray[L + 3];
                                    M.emplace(T++, I, k, z, D, 0),
                                    M.emplace(T++, I, k, z, D, 1),
                                    M.emplace(T++, I, k, z, D, 2),
                                    M.emplace(T++, I, k, z, D, 3)
                                }
                            (!ji || ji.length < 2 * p) && (ji = function(t) {
                                var i = 2 * t
                                  , r = new e.StructArrayLayout3ui6;
                                r.resize(i),
                                r._trim();
                                for (var n = 0; n < i; n++) {
                                    var a = 6 * n;
                                    r.uint16[a + 0] = 4 * n + 0,
                                    r.uint16[a + 1] = 4 * n + 1,
                                    r.uint16[a + 2] = 4 * n + 2,
                                    r.uint16[a + 3] = 4 * n + 2,
                                    r.uint16[a + 4] = 4 * n + 3,
                                    r.uint16[a + 5] = 4 * n + 0
                                }
                                return r
                            }(p));
                            for (var R = l.createIndexBuffer(ji, !0), O = l.createVertexBuffer(M, e.collisionCircleLayout.members, !0), B = 0, F = h; B < F.length; B += 1) {
                                var N = F[B]
                                  , U = Ii(N.transform, N.invTransform, t.transform);
                                S.draw(l, u.TRIANGLES, Te.disabled, Ee.disabled, t.colorModeForRenderPass(), Pe.disabled, U, r.id, O, R, e.SegmentVector.simpleSegment(0, 2 * N.circleOffset, N.circleArray.length, N.circleArray.length / 2), null, t.transform.zoom, null, null, null)
                            }
                            O.destroy(),
                            R.destroy()
                        }
                    }
                    var Ji = e.identity(new Float32Array(16));
                    function Qi(t, i, r, n, a, o) {
                        var s = e.getAnchorAlignment(t)
                          , l = -(s.horizontalAlign - .5) * i
                          , u = -(s.verticalAlign - .5) * r
                          , c = e.evaluateVariableOffset(t, n);
                        return new e.Point((l / a + c[0]) * o,(u / a + c[1]) * o)
                    }
                    function $i(t, i, r, n, a, o, s, l, u, c, h) {
                        var p = t.text.placedSymbolArray
                          , f = t.text.dynamicLayoutVertexArray
                          , d = t.icon.dynamicLayoutVertexArray
                          , m = {};
                        f.clear();
                        for (var v = 0; v < p.length; v++) {
                            var g = p.get(v)
                              , y = g.hidden || !g.crossTileID || t.allowVerticalPlacement && !g.placedOrientation ? null : n[g.crossTileID];
                            if (y) {
                                var _ = new e.Point(g.anchorX,g.anchorY)
                                  , x = $e(_, r ? l : s)
                                  , b = et(o.cameraToCenterDistance, x.signedDistanceFromCamera)
                                  , w = a.evaluateSizeForFeature(t.textSizeData, c, g) * b / e.ONE_EM;
                                r && (w *= t.tilePixelRatio / u);
                                for (var S = Qi(y.anchor, y.width, y.height, y.textOffset, y.textBoxScale, w), M = r ? $e(_.add(S), s).point : x.point.add(i ? S.rotate(-o.angle) : S), T = t.allowVerticalPlacement && g.placedOrientation === e.WritingMode.vertical ? Math.PI / 2 : 0, E = 0; E < g.numGlyphs; E++)
                                    e.addDynamicAttributes(f, M, T);
                                h && g.associatedIconIndex >= 0 && (m[g.associatedIconIndex] = {
                                    shiftedAnchor: M,
                                    angle: T
                                })
                            } else
                                ut(g.numGlyphs, f)
                        }
                        if (h) {
                            d.clear();
                            for (var A = t.icon.placedSymbolArray, P = 0; P < A.length; P++) {
                                var C = A.get(P);
                                if (C.hidden)
                                    ut(C.numGlyphs, d);
                                else {
                                    var L = m[P];
                                    if (L)
                                        for (var I = 0; I < C.numGlyphs; I++)
                                            e.addDynamicAttributes(d, L.shiftedAnchor, L.angle);
                                    else
                                        ut(C.numGlyphs, d)
                                }
                            }
                            t.icon.dynamicLayoutVertexBuffer.updateData(d)
                        }
                        t.text.dynamicLayoutVertexBuffer.updateData(f)
                    }
                    function er(e, t, i) {
                        return i.iconsInText && t ? "symbolTextAndIcon" : e ? "symbolSDF" : "symbolIcon"
                    }
                    function tr(t, i, r, n, a, o, s, l, u, c, h, p) {
                        for (var f = t.context, d = f.gl, m = t.transform, v = "map" === l, g = "map" === u, y = v && "point" !== r.layout.get("symbol-placement"), _ = v && !g && !y, x = void 0 !== r.layout.get("symbol-sort-key").constantOr(1), b = !1, w = t.depthModeForSublayer(0, Te.ReadOnly), S = r.layout.get("text-variable-anchor"), M = [], T = 0, E = n; T < E.length; T += 1) {
                            var A = E[T]
                              , P = i.getTile(A)
                              , C = P.getBucket(r);
                            if (C) {
                                var L = a ? C.text : C.icon;
                                if (L && L.segments.get().length) {
                                    var I = L.programConfigurations.get(r.id)
                                      , k = a || C.sdfIcons
                                      , z = a ? C.textSizeData : C.iconSizeData
                                      , D = g || 0 !== m.pitch
                                      , R = t.useProgram(er(k, a, C), I)
                                      , O = e.evaluateSizeForZoom(z, m.zoom)
                                      , B = void 0
                                      , F = [0, 0]
                                      , N = void 0
                                      , U = void 0
                                      , V = null
                                      , G = void 0;
                                    if (a)
                                        N = P.glyphAtlasTexture,
                                        U = d.LINEAR,
                                        B = P.glyphAtlasTexture.size,
                                        C.iconsInText && (F = P.imageAtlasTexture.size,
                                        V = P.imageAtlasTexture,
                                        G = D || t.options.rotating || t.options.zooming || "composite" === z.kind || "camera" === z.kind ? d.LINEAR : d.NEAREST);
                                    else {
                                        var j = 1 !== r.layout.get("icon-size").constantOr(0) || C.iconsNeedLinear;
                                        N = P.imageAtlasTexture,
                                        U = k || t.options.rotating || t.options.zooming || j || D ? d.LINEAR : d.NEAREST,
                                        B = P.imageAtlasTexture.size
                                    }
                                    var H = pt(P, 1, t.transform.zoom)
                                      , q = Je(A.posMatrix, g, v, t.transform, H)
                                      , W = Qe(A.posMatrix, g, v, t.transform, H)
                                      , Z = S && C.hasTextData()
                                      , X = "none" !== r.layout.get("icon-text-fit") && Z && C.hasIconData();
                                    y && it(C, A.posMatrix, t, a, q, W, g, c);
                                    var Y = t.translatePosMatrix(A.posMatrix, P, o, s)
                                      , K = y || a && S || X ? Ji : q
                                      , J = t.translatePosMatrix(W, P, o, s, !0)
                                      , Q = k && 0 !== r.paint.get(a ? "text-halo-width" : "icon-halo-width").constantOr(1)
                                      , $ = {
                                        program: R,
                                        buffers: L,
                                        uniformValues: k ? C.iconsInText ? Wi(z.kind, O, _, g, t, Y, K, J, B, F) : qi(z.kind, O, _, g, t, Y, K, J, a, B, !0) : Hi(z.kind, O, _, g, t, Y, K, J, a, B),
                                        atlasTexture: N,
                                        atlasTextureIcon: V,
                                        atlasInterpolation: U,
                                        atlasInterpolationIcon: G,
                                        isSDF: k,
                                        hasHalo: Q
                                    };
                                    if (x && C.canOverlap) {
                                        b = !0;
                                        for (var ee = 0, te = L.segments.get(); ee < te.length; ee += 1) {
                                            var ie = te[ee];
                                            M.push({
                                                segments: new e.SegmentVector([ie]),
                                                sortKey: ie.sortKey,
                                                state: $
                                            })
                                        }
                                    } else
                                        M.push({
                                            segments: L.segments,
                                            sortKey: 0,
                                            state: $
                                        })
                                }
                            }
                        }
                        b && M.sort((function(e, t) {
                            return e.sortKey - t.sortKey
                        }
                        ));
                        for (var re = 0, ne = M; re < ne.length; re += 1) {
                            var ae = ne[re]
                              , oe = ae.state;
                            if (f.activeTexture.set(d.TEXTURE0),
                            oe.atlasTexture.bind(oe.atlasInterpolation, d.CLAMP_TO_EDGE),
                            oe.atlasTextureIcon && (f.activeTexture.set(d.TEXTURE1),
                            oe.atlasTextureIcon && oe.atlasTextureIcon.bind(oe.atlasInterpolationIcon, d.CLAMP_TO_EDGE)),
                            oe.isSDF) {
                                var se = oe.uniformValues;
                                oe.hasHalo && (se.u_is_halo = 1,
                                ir(oe.buffers, ae.segments, r, t, oe.program, w, h, p, se)),
                                se.u_is_halo = 0
                            }
                            ir(oe.buffers, ae.segments, r, t, oe.program, w, h, p, oe.uniformValues)
                        }
                    }
                    function ir(e, t, i, r, n, a, o, s, l) {
                        var u = r.context;
                        n.draw(u, u.gl.TRIANGLES, a, o, s, Pe.disabled, l, i.id, e.layoutVertexBuffer, e.indexBuffer, t, i.paint, r.transform.zoom, e.programConfigurations.get(i.id), e.dynamicLayoutVertexBuffer, e.opacityVertexBuffer)
                    }
                    function rr(e, t, i, r, n, a, o) {
                        var s, l, u, c, h, p = e.context.gl, f = i.paint.get("fill-pattern"), d = f && f.constantOr(1), m = i.getCrossfadeParameters();
                        o ? (l = d && !i.getPaintProperty("fill-outline-color") ? "fillOutlinePattern" : "fillOutline",
                        s = p.LINES) : (l = d ? "fillPattern" : "fill",
                        s = p.TRIANGLES);
                        for (var v = 0, g = r; v < g.length; v += 1) {
                            var y = g[v]
                              , _ = t.getTile(y);
                            if (!d || _.patternsLoaded()) {
                                var x = _.getBucket(i);
                                if (x) {
                                    var b = x.programConfigurations.get(i.id)
                                      , w = e.useProgram(l, b);
                                    d && (e.context.activeTexture.set(p.TEXTURE0),
                                    _.imageAtlasTexture.bind(p.LINEAR, p.CLAMP_TO_EDGE),
                                    b.updatePaintBuffers(m));
                                    var S = f.constantOr(null);
                                    if (S && _.imageAtlas) {
                                        var M = _.imageAtlas
                                          , T = M.patternPositions[S.to.toString()]
                                          , E = M.patternPositions[S.from.toString()];
                                        T && E && b.setConstantPatternPositions(T, E)
                                    }
                                    var A = e.translatePosMatrix(y.posMatrix, _, i.paint.get("fill-translate"), i.paint.get("fill-translate-anchor"));
                                    if (o) {
                                        c = x.indexBuffer2,
                                        h = x.segments2;
                                        var P = [p.drawingBufferWidth, p.drawingBufferHeight];
                                        u = "fillOutlinePattern" === l && d ? Pi(A, e, m, _, P) : Ai(A, P)
                                    } else
                                        c = x.indexBuffer,
                                        h = x.segments,
                                        u = d ? Ei(A, e, m, _) : Ti(A);
                                    w.draw(e.context, s, n, e.stencilModeForClipping(y), a, Pe.disabled, u, i.id, x.layoutVertexBuffer, c, h, i.paint, e.transform.zoom, b)
                                }
                            }
                        }
                    }
                    function nr(e, t, i, r, n, a, o) {
                        for (var s = e.context, l = s.gl, u = i.paint.get("fill-extrusion-pattern"), c = u.constantOr(1), h = i.getCrossfadeParameters(), p = i.paint.get("fill-extrusion-opacity"), f = 0, d = r; f < d.length; f += 1) {
                            var m = d[f]
                              , v = t.getTile(m)
                              , g = v.getBucket(i);
                            if (g) {
                                var y = g.programConfigurations.get(i.id)
                                  , _ = e.useProgram(c ? "fillExtrusionPattern" : "fillExtrusion", y);
                                c && (e.context.activeTexture.set(l.TEXTURE0),
                                v.imageAtlasTexture.bind(l.LINEAR, l.CLAMP_TO_EDGE),
                                y.updatePaintBuffers(h));
                                var x = u.constantOr(null);
                                if (x && v.imageAtlas) {
                                    var b = v.imageAtlas
                                      , w = b.patternPositions[x.to.toString()]
                                      , S = b.patternPositions[x.from.toString()];
                                    w && S && y.setConstantPatternPositions(w, S)
                                }
                                var M = e.translatePosMatrix(m.posMatrix, v, i.paint.get("fill-extrusion-translate"), i.paint.get("fill-extrusion-translate-anchor"))
                                  , T = i.paint.get("fill-extrusion-vertical-gradient")
                                  , E = c ? Mi(M, e, T, p, m, h, v) : Si(M, e, T, p);
                                _.draw(s, s.gl.TRIANGLES, n, a, o, Pe.backCCW, E, i.id, g.layoutVertexBuffer, g.indexBuffer, g.segments, i.paint, e.transform.zoom, y)
                            }
                        }
                    }
                    function ar(t, i, r, n, a, o) {
                        var s = t.context
                          , l = s.gl
                          , u = i.fbo;
                        if (u) {
                            var c = t.useProgram("hillshade");
                            s.activeTexture.set(l.TEXTURE0),
                            l.bindTexture(l.TEXTURE_2D, u.colorAttachment.get());
                            var h = function(t, i, r) {
                                var n = r.paint.get("hillshade-shadow-color")
                                  , a = r.paint.get("hillshade-highlight-color")
                                  , o = r.paint.get("hillshade-accent-color")
                                  , s = r.paint.get("hillshade-illumination-direction") * (Math.PI / 180);
                                "viewport" === r.paint.get("hillshade-illumination-anchor") && (s -= t.transform.angle);
                                var l, u, c, h = !t.options.moving;
                                return {
                                    u_matrix: t.transform.calculatePosMatrix(i.tileID.toUnwrapped(), h),
                                    u_image: 0,
                                    u_latrange: (l = i.tileID,
                                    u = Math.pow(2, l.canonical.z),
                                    c = l.canonical.y,
                                    [new e.MercatorCoordinate(0,c / u).toLngLat().lat, new e.MercatorCoordinate(0,(c + 1) / u).toLngLat().lat]),
                                    u_light: [r.paint.get("hillshade-exaggeration"), s],
                                    u_shadow: n,
                                    u_highlight: a,
                                    u_accent: o
                                }
                            }(t, i, r);
                            c.draw(s, l.TRIANGLES, n, a, o, Pe.disabled, h, r.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments)
                        }
                    }
                    function or(t, i, r, n, a, o) {
                        var s = t.context
                          , l = s.gl
                          , u = i.dem;
                        if (u && u.data) {
                            var c = u.dim
                              , h = u.stride
                              , p = u.getPixels();
                            if (s.activeTexture.set(l.TEXTURE1),
                            s.pixelStoreUnpackPremultiplyAlpha.set(!1),
                            i.demTexture = i.demTexture || t.getTileTexture(h),
                            i.demTexture) {
                                var f = i.demTexture;
                                f.update(p, {
                                    premultiply: !1
                                }),
                                f.bind(l.NEAREST, l.CLAMP_TO_EDGE)
                            } else
                                i.demTexture = new e.Texture(s,p,l.RGBA,{
                                    premultiply: !1
                                }),
                                i.demTexture.bind(l.NEAREST, l.CLAMP_TO_EDGE);
                            s.activeTexture.set(l.TEXTURE0);
                            var d = i.fbo;
                            if (!d) {
                                var m = new e.Texture(s,{
                                    width: c,
                                    height: c,
                                    data: null
                                },l.RGBA);
                                m.bind(l.LINEAR, l.CLAMP_TO_EDGE),
                                (d = i.fbo = s.createFramebuffer(c, c, !0)).colorAttachment.set(m.texture)
                            }
                            s.bindFramebuffer.set(d.framebuffer),
                            s.viewport.set([0, 0, c, c]),
                            t.useProgram("hillshadePrepare").draw(s, l.TRIANGLES, n, a, o, Pe.disabled, function(t, i) {
                                var r = i.stride
                                  , n = e.create();
                                return e.ortho(n, 0, e.EXTENT, -e.EXTENT, 0, 0, 1),
                                e.translate(n, n, [0, -e.EXTENT, 0]),
                                {
                                    u_matrix: n,
                                    u_image: 1,
                                    u_dimension: [r, r],
                                    u_zoom: t.overscaledZ,
                                    u_unpack: i.getUnpackVector()
                                }
                            }(i.tileID, u), r.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments),
                            i.needsHillshadePrepare = !1
                        }
                    }
                    function sr(t, i, r, n, a) {
                        var o = n.paint.get("raster-fade-duration");
                        if (o > 0) {
                            var s = e.browser.now()
                              , l = (s - t.timeAdded) / o
                              , u = i ? (s - i.timeAdded) / o : -1
                              , c = r.getSource()
                              , h = a.coveringZoomLevel({
                                tileSize: c.tileSize,
                                roundZoom: c.roundZoom
                            })
                              , p = !i || Math.abs(i.tileID.overscaledZ - h) > Math.abs(t.tileID.overscaledZ - h)
                              , f = p && t.refreshedUponExpiration ? 1 : e.clamp(p ? l : 1 - u, 0, 1);
                            return t.refreshedUponExpiration && l >= 1 && (t.refreshedUponExpiration = !1),
                            i ? {
                                opacity: 1,
                                mix: 1 - f
                            } : {
                                opacity: f,
                                mix: 0
                            }
                        }
                        return {
                            opacity: 1,
                            mix: 0
                        }
                    }
                    var lr = new e.Color(1,0,0,1)
                      , ur = new e.Color(0,1,0,1)
                      , cr = new e.Color(0,0,1,1)
                      , hr = new e.Color(1,0,1,1)
                      , pr = new e.Color(0,1,1,1);
                    function fr(e, t, i, r) {
                        mr(e, 0, t + i / 2, e.transform.width, i, r)
                    }
                    function dr(e, t, i, r) {
                        mr(e, t - i / 2, 0, i, e.transform.height, r)
                    }
                    function mr(t, i, r, n, a, o) {
                        var s = t.context
                          , l = s.gl;
                        l.enable(l.SCISSOR_TEST),
                        l.scissor(i * e.browser.devicePixelRatio, r * e.browser.devicePixelRatio, n * e.browser.devicePixelRatio, a * e.browser.devicePixelRatio),
                        s.clear({
                            color: o
                        }),
                        l.disable(l.SCISSOR_TEST)
                    }
                    function vr(t, i, r) {
                        var n = t.context
                          , a = n.gl
                          , o = r.posMatrix
                          , s = t.useProgram("debug")
                          , l = Te.disabled
                          , u = Ee.disabled
                          , c = t.colorModeForRenderPass();
                        n.activeTexture.set(a.TEXTURE0),
                        t.emptyTexture.bind(a.LINEAR, a.CLAMP_TO_EDGE),
                        s.draw(n, a.LINE_STRIP, l, u, c, Pe.disabled, ki(o, e.Color.red), "$debug", t.debugBuffer, t.tileBorderIndexBuffer, t.debugSegments);
                        var h = i.getTileByID(r.key).latestRawTileData
                          , p = Math.floor((h && h.byteLength || 0) / 1024)
                          , f = i.getTile(r).tileSize
                          , d = 512 / Math.min(f, 512) * (r.overscaledZ / t.transform.zoom) * .5
                          , m = r.canonical.toString();
                        r.overscaledZ !== r.canonical.z && (m += " => " + r.overscaledZ),
                        function(e, t) {
                            e.initDebugOverlayCanvas();
                            var i = e.debugOverlayCanvas
                              , r = e.context.gl
                              , n = e.debugOverlayCanvas.getContext("2d");
                            n.clearRect(0, 0, i.width, i.height),
                            n.shadowColor = "white",
                            n.shadowBlur = 2,
                            n.lineWidth = 1.5,
                            n.strokeStyle = "white",
                            n.textBaseline = "top",
                            n.font = "bold 36px Open Sans, sans-serif",
                            n.fillText(t, 5, 5),
                            n.strokeText(t, 5, 5),
                            e.debugOverlayTexture.update(i),
                            e.debugOverlayTexture.bind(r.LINEAR, r.CLAMP_TO_EDGE)
                        }(t, m + " " + p + "kb"),
                        s.draw(n, a.TRIANGLES, l, u, Ae.alphaBlended, Pe.disabled, ki(o, e.Color.transparent, d), "$debug", t.debugBuffer, t.quadTriangleIndexBuffer, t.debugSegments)
                    }
                    var gr = {
                        symbol: function(t, i, r, n, a) {
                            if ("translucent" === t.renderPass) {
                                var o = Ee.disabled
                                  , s = t.colorModeForRenderPass();
                                r.layout.get("text-variable-anchor") && function(t, i, r, n, a, o, s) {
                                    for (var l = i.transform, u = "map" === a, c = "map" === o, h = 0, p = t; h < p.length; h += 1) {
                                        var f = p[h]
                                          , d = n.getTile(f)
                                          , m = d.getBucket(r);
                                        if (m && m.text && m.text.segments.get().length) {
                                            var v = e.evaluateSizeForZoom(m.textSizeData, l.zoom)
                                              , g = pt(d, 1, i.transform.zoom)
                                              , y = Je(f.posMatrix, c, u, i.transform, g)
                                              , _ = "none" !== r.layout.get("icon-text-fit") && m.hasIconData();
                                            if (v) {
                                                var x = Math.pow(2, l.zoom - d.tileID.overscaledZ);
                                                $i(m, u, c, s, e.symbolSize, l, y, f.posMatrix, x, v, _)
                                            }
                                        }
                                    }
                                }(n, t, r, i, r.layout.get("text-rotation-alignment"), r.layout.get("text-pitch-alignment"), a),
                                0 !== r.paint.get("icon-opacity").constantOr(1) && tr(t, i, r, n, !1, r.paint.get("icon-translate"), r.paint.get("icon-translate-anchor"), r.layout.get("icon-rotation-alignment"), r.layout.get("icon-pitch-alignment"), r.layout.get("icon-keep-upright"), o, s),
                                0 !== r.paint.get("text-opacity").constantOr(1) && tr(t, i, r, n, !0, r.paint.get("text-translate"), r.paint.get("text-translate-anchor"), r.layout.get("text-rotation-alignment"), r.layout.get("text-pitch-alignment"), r.layout.get("text-keep-upright"), o, s),
                                i.map.showCollisionBoxes && (Ki(t, i, r, n, r.paint.get("text-translate"), r.paint.get("text-translate-anchor"), !0),
                                Ki(t, i, r, n, r.paint.get("icon-translate"), r.paint.get("icon-translate-anchor"), !1))
                            }
                        },
                        circle: function(t, i, r, n) {
                            if ("translucent" === t.renderPass) {
                                var a = r.paint.get("circle-opacity")
                                  , o = r.paint.get("circle-stroke-width")
                                  , s = r.paint.get("circle-stroke-opacity")
                                  , l = void 0 !== r.layout.get("circle-sort-key").constantOr(1);
                                if (0 !== a.constantOr(1) || 0 !== o.constantOr(1) && 0 !== s.constantOr(1)) {
                                    for (var u = t.context, c = u.gl, h = t.depthModeForSublayer(0, Te.ReadOnly), p = Ee.disabled, f = t.colorModeForRenderPass(), d = [], m = 0; m < n.length; m++) {
                                        var v = n[m]
                                          , g = i.getTile(v)
                                          , y = g.getBucket(r);
                                        if (y) {
                                            var _ = y.programConfigurations.get(r.id)
                                              , x = {
                                                programConfiguration: _,
                                                program: t.useProgram("circle", _),
                                                layoutVertexBuffer: y.layoutVertexBuffer,
                                                indexBuffer: y.indexBuffer,
                                                uniformValues: Ci(t, v, g, r)
                                            };
                                            if (l)
                                                for (var b = 0, w = y.segments.get(); b < w.length; b += 1) {
                                                    var S = w[b];
                                                    d.push({
                                                        segments: new e.SegmentVector([S]),
                                                        sortKey: S.sortKey,
                                                        state: x
                                                    })
                                                }
                                            else
                                                d.push({
                                                    segments: y.segments,
                                                    sortKey: 0,
                                                    state: x
                                                })
                                        }
                                    }
                                    l && d.sort((function(e, t) {
                                        return e.sortKey - t.sortKey
                                    }
                                    ));
                                    for (var M = 0, T = d; M < T.length; M += 1) {
                                        var E = T[M]
                                          , A = E.state;
                                        A.program.draw(u, c.TRIANGLES, h, p, f, Pe.disabled, A.uniformValues, r.id, A.layoutVertexBuffer, A.indexBuffer, E.segments, r.paint, t.transform.zoom, A.programConfiguration)
                                    }
                                }
                            }
                        },
                        heatmap: function(t, i, r, n) {
                            if (0 !== r.paint.get("heatmap-opacity"))
                                if ("offscreen" === t.renderPass) {
                                    var a = t.context
                                      , o = a.gl
                                      , s = Ee.disabled
                                      , l = new Ae([o.ONE, o.ONE],e.Color.transparent,[!0, !0, !0, !0]);
                                    !function(e, t, i) {
                                        var r = e.gl;
                                        e.activeTexture.set(r.TEXTURE1),
                                        e.viewport.set([0, 0, t.width / 4, t.height / 4]);
                                        var n = i.heatmapFbo;
                                        if (n)
                                            r.bindTexture(r.TEXTURE_2D, n.colorAttachment.get()),
                                            e.bindFramebuffer.set(n.framebuffer);
                                        else {
                                            var a = r.createTexture();
                                            r.bindTexture(r.TEXTURE_2D, a),
                                            r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, r.CLAMP_TO_EDGE),
                                            r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, r.CLAMP_TO_EDGE),
                                            r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, r.LINEAR),
                                            r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, r.LINEAR),
                                            n = i.heatmapFbo = e.createFramebuffer(t.width / 4, t.height / 4, !1),
                                            function(e, t, i, r) {
                                                var n = e.gl;
                                                n.texImage2D(n.TEXTURE_2D, 0, n.RGBA, t.width / 4, t.height / 4, 0, n.RGBA, e.extRenderToTextureHalfFloat ? e.extTextureHalfFloat.HALF_FLOAT_OES : n.UNSIGNED_BYTE, null),
                                                r.colorAttachment.set(i)
                                            }(e, t, a, n)
                                        }
                                    }(a, t, r),
                                    a.clear({
                                        color: e.Color.transparent
                                    });
                                    for (var u = 0; u < n.length; u++) {
                                        var c = n[u];
                                        if (!i.hasRenderableParent(c)) {
                                            var h = i.getTile(c)
                                              , p = h.getBucket(r);
                                            if (p) {
                                                var f = p.programConfigurations.get(r.id);
                                                t.useProgram("heatmap", f).draw(a, o.TRIANGLES, Te.disabled, s, l, Pe.disabled, Di(c.posMatrix, h, t.transform.zoom, r.paint.get("heatmap-intensity")), r.id, p.layoutVertexBuffer, p.indexBuffer, p.segments, r.paint, t.transform.zoom, f)
                                            }
                                        }
                                    }
                                    a.viewport.set([0, 0, t.width, t.height])
                                } else
                                    "translucent" === t.renderPass && (t.context.setColorMode(t.colorModeForRenderPass()),
                                    function(t, i) {
                                        var r = t.context
                                          , n = r.gl
                                          , a = i.heatmapFbo;
                                        if (a) {
                                            r.activeTexture.set(n.TEXTURE0),
                                            n.bindTexture(n.TEXTURE_2D, a.colorAttachment.get()),
                                            r.activeTexture.set(n.TEXTURE1);
                                            var o = i.colorRampTexture;
                                            o || (o = i.colorRampTexture = new e.Texture(r,i.colorRamp,n.RGBA)),
                                            o.bind(n.LINEAR, n.CLAMP_TO_EDGE),
                                            t.useProgram("heatmapTexture").draw(r, n.TRIANGLES, Te.disabled, Ee.disabled, t.colorModeForRenderPass(), Pe.disabled, function(t, i, r, n) {
                                                var a = e.create();
                                                e.ortho(a, 0, t.width, t.height, 0, 0, 1);
                                                var o = t.context.gl;
                                                return {
                                                    u_matrix: a,
                                                    u_world: [o.drawingBufferWidth, o.drawingBufferHeight],
                                                    u_image: 0,
                                                    u_color_ramp: 1,
                                                    u_opacity: i.paint.get("heatmap-opacity")
                                                }
                                            }(t, i), i.id, t.viewportBuffer, t.quadTriangleIndexBuffer, t.viewportSegments, i.paint, t.transform.zoom)
                                        }
                                    }(t, r))
                        },
                        line: function(t, i, r, n) {
                            if ("translucent" === t.renderPass) {
                                var a = r.paint.get("line-opacity")
                                  , o = r.paint.get("line-width");
                                if (0 !== a.constantOr(1) && 0 !== o.constantOr(1))
                                    for (var s = t.depthModeForSublayer(0, Te.ReadOnly), l = t.colorModeForRenderPass(), u = r.paint.get("line-dasharray"), c = r.paint.get("line-pattern"), h = c.constantOr(1), p = r.paint.get("line-gradient"), f = r.getCrossfadeParameters(), d = h ? "linePattern" : u ? "lineSDF" : p ? "lineGradient" : "line", m = t.context, v = m.gl, g = !0, y = 0, _ = n; y < _.length; y += 1) {
                                        var x = _[y]
                                          , b = i.getTile(x);
                                        if (!h || b.patternsLoaded()) {
                                            var w = b.getBucket(r);
                                            if (w) {
                                                var S = w.programConfigurations.get(r.id)
                                                  , M = t.context.program.get()
                                                  , T = t.useProgram(d, S)
                                                  , E = g || T.program !== M
                                                  , A = c.constantOr(null);
                                                if (A && b.imageAtlas) {
                                                    var P = b.imageAtlas
                                                      , C = P.patternPositions[A.to.toString()]
                                                      , L = P.patternPositions[A.from.toString()];
                                                    C && L && S.setConstantPatternPositions(C, L)
                                                }
                                                var I = h ? Bi(t, b, r, f) : u ? Fi(t, b, r, u, f) : p ? Oi(t, b, r, w.lineClipsArray.length) : Ri(t, b, r);
                                                if (h)
                                                    m.activeTexture.set(v.TEXTURE0),
                                                    b.imageAtlasTexture.bind(v.LINEAR, v.CLAMP_TO_EDGE),
                                                    S.updatePaintBuffers(f);
                                                else if (u && (E || t.lineAtlas.dirty))
                                                    m.activeTexture.set(v.TEXTURE0),
                                                    t.lineAtlas.bind(m);
                                                else if (p) {
                                                    var k = w.gradients[r.id]
                                                      , z = k.texture;
                                                    if (r.gradientVersion !== k.version) {
                                                        var D = 256;
                                                        if (r.stepInterpolant) {
                                                            var R = i.getSource().maxzoom
                                                              , O = x.canonical.z === R ? Math.ceil(1 << t.transform.maxZoom - x.canonical.z) : 1;
                                                            D = e.clamp(e.nextPowerOfTwo(w.maxLineLength / e.EXTENT * 1024 * O), 256, m.maxTextureSize)
                                                        }
                                                        k.gradient = e.renderColorRamp({
                                                            expression: r.gradientExpression(),
                                                            evaluationKey: "lineProgress",
                                                            resolution: D,
                                                            image: k.gradient || void 0,
                                                            clips: w.lineClipsArray
                                                        }),
                                                        k.texture ? k.texture.update(k.gradient) : k.texture = new e.Texture(m,k.gradient,v.RGBA),
                                                        k.version = r.gradientVersion,
                                                        z = k.texture
                                                    }
                                                    m.activeTexture.set(v.TEXTURE0),
                                                    z.bind(r.stepInterpolant ? v.NEAREST : v.LINEAR, v.CLAMP_TO_EDGE)
                                                }
                                                T.draw(m, v.TRIANGLES, s, t.stencilModeForClipping(x), l, Pe.disabled, I, r.id, w.layoutVertexBuffer, w.indexBuffer, w.segments, r.paint, t.transform.zoom, S, w.layoutVertexBuffer2),
                                                g = !1
                                            }
                                        }
                                    }
                            }
                        },
                        fill: function(t, i, r, n) {
                            var a = r.paint.get("fill-color")
                              , o = r.paint.get("fill-opacity");
                            if (0 !== o.constantOr(1)) {
                                var s = t.colorModeForRenderPass()
                                  , l = r.paint.get("fill-pattern")
                                  , u = t.opaquePassEnabledForLayer() && !l.constantOr(1) && 1 === a.constantOr(e.Color.transparent).a && 1 === o.constantOr(0) ? "opaque" : "translucent";
                                if (t.renderPass === u) {
                                    var c = t.depthModeForSublayer(1, "opaque" === t.renderPass ? Te.ReadWrite : Te.ReadOnly);
                                    rr(t, i, r, n, c, s, !1)
                                }
                                if ("translucent" === t.renderPass && r.paint.get("fill-antialias")) {
                                    var h = t.depthModeForSublayer(r.getPaintProperty("fill-outline-color") ? 2 : 0, Te.ReadOnly);
                                    rr(t, i, r, n, h, s, !0)
                                }
                            }
                        },
                        "fill-extrusion": function(e, t, i, r) {
                            var n = i.paint.get("fill-extrusion-opacity");
                            if (0 !== n && "translucent" === e.renderPass) {
                                var a = new Te(e.context.gl.LEQUAL,Te.ReadWrite,e.depthRangeFor3D);
                                if (1 !== n || i.paint.get("fill-extrusion-pattern").constantOr(1))
                                    nr(e, t, i, r, a, Ee.disabled, Ae.disabled),
                                    nr(e, t, i, r, a, e.stencilModeFor3D(), e.colorModeForRenderPass());
                                else {
                                    var o = e.colorModeForRenderPass();
                                    nr(e, t, i, r, a, Ee.disabled, o)
                                }
                            }
                        },
                        hillshade: function(e, t, i, r) {
                            if ("offscreen" === e.renderPass || "translucent" === e.renderPass) {
                                for (var n = e.context, a = e.depthModeForSublayer(0, Te.ReadOnly), o = e.colorModeForRenderPass(), s = "translucent" === e.renderPass ? e.stencilConfigForOverlap(r) : [{}, r], l = s[0], u = 0, c = s[1]; u < c.length; u += 1) {
                                    var h = c[u]
                                      , p = t.getTile(h);
                                    p.needsHillshadePrepare && "offscreen" === e.renderPass ? or(e, p, i, a, Ee.disabled, o) : "translucent" === e.renderPass && ar(e, p, i, a, l[h.overscaledZ], o)
                                }
                                n.viewport.set([0, 0, e.width, e.height])
                            }
                        },
                        raster: function(e, t, i, r) {
                            if ("translucent" === e.renderPass && 0 !== i.paint.get("raster-opacity") && r.length)
                                for (var n = e.context, a = n.gl, o = t.getSource(), s = e.useProgram("raster"), l = e.colorModeForRenderPass(), u = o instanceof k ? [{}, r] : e.stencilConfigForOverlap(r), c = u[0], h = u[1], p = h[h.length - 1].overscaledZ, f = !e.options.moving, d = 0, m = h; d < m.length; d += 1) {
                                    var v = m[d]
                                      , g = e.depthModeForSublayer(v.overscaledZ - p, 1 === i.paint.get("raster-opacity") ? Te.ReadWrite : Te.ReadOnly, a.LESS)
                                      , y = t.getTile(v)
                                      , _ = e.transform.calculatePosMatrix(v.toUnwrapped(), f);
                                    y.registerFadeDuration(i.paint.get("raster-fade-duration"));
                                    var x = t.findLoadedParent(v, 0)
                                      , b = sr(y, x, t, i, e.transform)
                                      , w = void 0
                                      , S = void 0
                                      , M = "nearest" === i.paint.get("raster-resampling") ? a.NEAREST : a.LINEAR;
                                    n.activeTexture.set(a.TEXTURE0),
                                    y.texture.bind(M, a.CLAMP_TO_EDGE, a.LINEAR_MIPMAP_NEAREST),
                                    n.activeTexture.set(a.TEXTURE1),
                                    x ? (x.texture.bind(M, a.CLAMP_TO_EDGE, a.LINEAR_MIPMAP_NEAREST),
                                    w = Math.pow(2, x.tileID.overscaledZ - y.tileID.overscaledZ),
                                    S = [y.tileID.canonical.x * w % 1, y.tileID.canonical.y * w % 1]) : y.texture.bind(M, a.CLAMP_TO_EDGE, a.LINEAR_MIPMAP_NEAREST);
                                    var T = Vi(_, S || [0, 0], w || 1, b, i);
                                    o instanceof k ? s.draw(n, a.TRIANGLES, g, Ee.disabled, l, Pe.disabled, T, i.id, o.boundsBuffer, e.quadTriangleIndexBuffer, o.boundsSegments) : s.draw(n, a.TRIANGLES, g, c[v.overscaledZ], l, Pe.disabled, T, i.id, e.rasterBoundsBuffer, e.quadTriangleIndexBuffer, e.rasterBoundsSegments)
                                }
                        },
                        background: function(e, t, i) {
                            var r = i.paint.get("background-color")
                              , n = i.paint.get("background-opacity");
                            if (0 !== n) {
                                var a = e.context
                                  , o = a.gl
                                  , s = e.transform
                                  , l = s.tileSize
                                  , u = i.paint.get("background-pattern");
                                if (!e.isPatternMissing(u)) {
                                    var c = !u && 1 === r.a && 1 === n && e.opaquePassEnabledForLayer() ? "opaque" : "translucent";
                                    if (e.renderPass === c) {
                                        var h = Ee.disabled
                                          , p = e.depthModeForSublayer(0, "opaque" === c ? Te.ReadWrite : Te.ReadOnly)
                                          , f = e.colorModeForRenderPass()
                                          , d = e.useProgram(u ? "backgroundPattern" : "background")
                                          , m = s.coveringTiles({
                                            tileSize: l
                                        });
                                        u && (a.activeTexture.set(o.TEXTURE0),
                                        e.imageManager.bind(e.context));
                                        for (var v = i.getCrossfadeParameters(), g = 0, y = m; g < y.length; g += 1) {
                                            var _ = y[g]
                                              , x = e.transform.calculatePosMatrix(_.toUnwrapped())
                                              , b = u ? Xi(x, n, e, u, {
                                                tileID: _,
                                                tileSize: l
                                            }, v) : Zi(x, n, r);
                                            d.draw(a, o.TRIANGLES, p, h, f, Pe.disabled, b, i.id, e.tileExtentBuffer, e.quadTriangleIndexBuffer, e.tileExtentSegments)
                                        }
                                    }
                                }
                            }
                        },
                        debug: function(e, t, i) {
                            for (var r = 0; r < i.length; r++)
                                vr(e, t, i[r])
                        },
                        custom: function(e, t, i) {
                            var r = e.context
                              , n = i.implementation;
                            if ("offscreen" === e.renderPass) {
                                var a = n.prerender;
                                a && (e.setCustomLayerDefaults(),
                                r.setColorMode(e.colorModeForRenderPass()),
                                a.call(n, r.gl, e.transform.customLayerMatrix()),
                                r.setDirty(),
                                e.setBaseState())
                            } else if ("translucent" === e.renderPass) {
                                e.setCustomLayerDefaults(),
                                r.setColorMode(e.colorModeForRenderPass()),
                                r.setStencilMode(Ee.disabled);
                                var o = "3d" === n.renderingMode ? new Te(e.context.gl.LEQUAL,Te.ReadWrite,e.depthRangeFor3D) : e.depthModeForSublayer(0, Te.ReadOnly);
                                r.setDepthMode(o),
                                n.render(r.gl, e.transform.customLayerMatrix()),
                                r.setDirty(),
                                e.setBaseState(),
                                r.bindFramebuffer.set(null)
                            }
                        }
                    }
                      , yr = function(e, t) {
                        this.context = new Ce(e),
                        this.transform = t,
                        this._tileTextures = {},
                        this.setup(),
                        this.numSublayers = Le.maxUnderzooming + Le.maxOverzooming + 1,
                        this.depthEpsilon = 1 / Math.pow(2, 16),
                        this.crossTileSymbolIndex = new Ft,
                        this.gpuTimers = {}
                    };
                    yr.prototype.resize = function(t, i) {
                        if (this.width = t * e.browser.devicePixelRatio,
                        this.height = i * e.browser.devicePixelRatio,
                        this.context.viewport.set([0, 0, this.width, this.height]),
                        this.style)
                            for (var r = 0, n = this.style._order; r < n.length; r += 1)
                                this.style._layers[n[r]].resize()
                    }
                    ,
                    yr.prototype.setup = function() {
                        var t = this.context
                          , i = new e.StructArrayLayout2i4;
                        i.emplaceBack(0, 0),
                        i.emplaceBack(e.EXTENT, 0),
                        i.emplaceBack(0, e.EXTENT),
                        i.emplaceBack(e.EXTENT, e.EXTENT),
                        this.tileExtentBuffer = t.createVertexBuffer(i, Ht.members),
                        this.tileExtentSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);
                        var r = new e.StructArrayLayout2i4;
                        r.emplaceBack(0, 0),
                        r.emplaceBack(e.EXTENT, 0),
                        r.emplaceBack(0, e.EXTENT),
                        r.emplaceBack(e.EXTENT, e.EXTENT),
                        this.debugBuffer = t.createVertexBuffer(r, Ht.members),
                        this.debugSegments = e.SegmentVector.simpleSegment(0, 0, 4, 5);
                        var n = new e.StructArrayLayout4i8;
                        n.emplaceBack(0, 0, 0, 0),
                        n.emplaceBack(e.EXTENT, 0, e.EXTENT, 0),
                        n.emplaceBack(0, e.EXTENT, 0, e.EXTENT),
                        n.emplaceBack(e.EXTENT, e.EXTENT, e.EXTENT, e.EXTENT),
                        this.rasterBoundsBuffer = t.createVertexBuffer(n, I.members),
                        this.rasterBoundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);
                        var a = new e.StructArrayLayout2i4;
                        a.emplaceBack(0, 0),
                        a.emplaceBack(1, 0),
                        a.emplaceBack(0, 1),
                        a.emplaceBack(1, 1),
                        this.viewportBuffer = t.createVertexBuffer(a, Ht.members),
                        this.viewportSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);
                        var o = new e.StructArrayLayout1ui2;
                        o.emplaceBack(0),
                        o.emplaceBack(1),
                        o.emplaceBack(3),
                        o.emplaceBack(2),
                        o.emplaceBack(0),
                        this.tileBorderIndexBuffer = t.createIndexBuffer(o);
                        var s = new e.StructArrayLayout3ui6;
                        s.emplaceBack(0, 1, 2),
                        s.emplaceBack(2, 1, 3),
                        this.quadTriangleIndexBuffer = t.createIndexBuffer(s),
                        this.emptyTexture = new e.Texture(t,{
                            width: 1,
                            height: 1,
                            data: new Uint8Array([0, 0, 0, 0])
                        },t.gl.RGBA);
                        var l = this.context.gl;
                        this.stencilClearMode = new Ee({
                            func: l.ALWAYS,
                            mask: 0
                        },0,255,l.ZERO,l.ZERO,l.ZERO)
                    }
                    ,
                    yr.prototype.clearStencil = function() {
                        var t = this.context
                          , i = t.gl;
                        this.nextStencilID = 1,
                        this.currentStencilSource = void 0;
                        var r = e.create();
                        e.ortho(r, 0, this.width, this.height, 0, 0, 1),
                        e.scale(r, r, [i.drawingBufferWidth, i.drawingBufferHeight, 0]),
                        this.useProgram("clippingMask").draw(t, i.TRIANGLES, Te.disabled, this.stencilClearMode, Ae.disabled, Pe.disabled, zi(r), "$clipping", this.viewportBuffer, this.quadTriangleIndexBuffer, this.viewportSegments)
                    }
                    ,
                    yr.prototype._renderTileClippingMasks = function(e, t) {
                        if (this.currentStencilSource !== e.source && e.isTileClipped() && t && t.length) {
                            this.currentStencilSource = e.source;
                            var i = this.context
                              , r = i.gl;
                            this.nextStencilID + t.length > 256 && this.clearStencil(),
                            i.setColorMode(Ae.disabled),
                            i.setDepthMode(Te.disabled);
                            var n = this.useProgram("clippingMask");
                            this._tileClippingMaskIDs = {};
                            for (var a = 0, o = t; a < o.length; a += 1) {
                                var s = o[a]
                                  , l = this._tileClippingMaskIDs[s.key] = this.nextStencilID++;
                                n.draw(i, r.TRIANGLES, Te.disabled, new Ee({
                                    func: r.ALWAYS,
                                    mask: 0
                                },l,255,r.KEEP,r.KEEP,r.REPLACE), Ae.disabled, Pe.disabled, zi(s.posMatrix), "$clipping", this.tileExtentBuffer, this.quadTriangleIndexBuffer, this.tileExtentSegments)
                            }
                        }
                    }
                    ,
                    yr.prototype.stencilModeFor3D = function() {
                        this.currentStencilSource = void 0,
                        this.nextStencilID + 1 > 256 && this.clearStencil();
                        var e = this.nextStencilID++
                          , t = this.context.gl;
                        return new Ee({
                            func: t.NOTEQUAL,
                            mask: 255
                        },e,255,t.KEEP,t.KEEP,t.REPLACE)
                    }
                    ,
                    yr.prototype.stencilModeForClipping = function(e) {
                        var t = this.context.gl;
                        return new Ee({
                            func: t.EQUAL,
                            mask: 255
                        },this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)
                    }
                    ,
                    yr.prototype.stencilConfigForOverlap = function(e) {
                        var t, i = this.context.gl, r = e.sort((function(e, t) {
                            return t.overscaledZ - e.overscaledZ
                        }
                        )), n = r[r.length - 1].overscaledZ, a = r[0].overscaledZ - n + 1;
                        if (a > 1) {
                            this.currentStencilSource = void 0,
                            this.nextStencilID + a > 256 && this.clearStencil();
                            for (var o = {}, s = 0; s < a; s++)
                                o[s + n] = new Ee({
                                    func: i.GEQUAL,
                                    mask: 255
                                },s + this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);
                            return this.nextStencilID += a,
                            [o, r]
                        }
                        return [(t = {},
                        t[n] = Ee.disabled,
                        t), r]
                    }
                    ,
                    yr.prototype.colorModeForRenderPass = function() {
                        var t = this.context.gl;
                        return this._showOverdrawInspector ? new Ae([t.CONSTANT_COLOR, t.ONE],new e.Color(1 / 8,1 / 8,1 / 8,0),[!0, !0, !0, !0]) : "opaque" === this.renderPass ? Ae.unblended : Ae.alphaBlended
                    }
                    ,
                    yr.prototype.depthModeForSublayer = function(e, t, i) {
                        if (!this.opaquePassEnabledForLayer())
                            return Te.disabled;
                        var r = 1 - ((1 + this.currentLayer) * this.numSublayers + e) * this.depthEpsilon;
                        return new Te(i || this.context.gl.LEQUAL,t,[r, r])
                    }
                    ,
                    yr.prototype.opaquePassEnabledForLayer = function() {
                        return this.currentLayer < this.opaquePassCutoff
                    }
                    ,
                    yr.prototype.render = function(t, i) {
                        var r = this;
                        this.style = t,
                        this.options = i,
                        this.lineAtlas = t.lineAtlas,
                        this.imageManager = t.imageManager,
                        this.glyphManager = t.glyphManager,
                        this.symbolFadeChange = t.placement.symbolFadeChange(e.browser.now()),
                        this.imageManager.beginFrame();
                        var n = this.style._order
                          , a = this.style.sourceCaches;
                        for (var o in a) {
                            var s = a[o];
                            s.used && s.prepare(this.context)
                        }
                        var l, u, c = {}, h = {}, p = {};
                        for (var f in a) {
                            var d = a[f];
                            c[f] = d.getVisibleCoordinates(),
                            h[f] = c[f].slice().reverse(),
                            p[f] = d.getVisibleCoordinates(!0).reverse()
                        }
                        this.opaquePassCutoff = 1 / 0;
                        for (var m = 0; m < n.length; m++)
                            if (this.style._layers[n[m]].is3D()) {
                                this.opaquePassCutoff = m;
                                break
                            }
                        this.renderPass = "offscreen";
                        for (var v = 0, g = n; v < g.length; v += 1) {
                            var y = this.style._layers[g[v]];
                            if (y.hasOffscreenPass() && !y.isHidden(this.transform.zoom)) {
                                var _ = h[y.source];
                                ("custom" === y.type || _.length) && this.renderLayer(this, a[y.source], y, _)
                            }
                        }
                        for (this.context.bindFramebuffer.set(null),
                        this.context.clear({
                            color: i.showOverdrawInspector ? e.Color.black : e.Color.transparent,
                            depth: 1
                        }),
                        this.clearStencil(),
                        this._showOverdrawInspector = i.showOverdrawInspector,
                        this.depthRangeFor3D = [0, 1 - (t._order.length + 2) * this.numSublayers * this.depthEpsilon],
                        this.renderPass = "opaque",
                        this.currentLayer = n.length - 1; this.currentLayer >= 0; this.currentLayer--) {
                            var x = this.style._layers[n[this.currentLayer]]
                              , b = a[x.source]
                              , w = c[x.source];
                            this._renderTileClippingMasks(x, w),
                            this.renderLayer(this, b, x, w)
                        }
                        for (this.renderPass = "translucent",
                        this.currentLayer = 0; this.currentLayer < n.length; this.currentLayer++) {
                            var S = this.style._layers[n[this.currentLayer]]
                              , M = a[S.source]
                              , T = ("symbol" === S.type ? p : h)[S.source];
                            this._renderTileClippingMasks(S, c[S.source]),
                            this.renderLayer(this, M, S, T)
                        }
                        this.options.showTileBoundaries && (e.values(this.style._layers).forEach((function(e) {
                            e.source && !e.isHidden(r.transform.zoom) && (e.source !== (u && u.id) && (u = r.style.sourceCaches[e.source]),
                            (!l || l.getSource().maxzoom < u.getSource().maxzoom) && (l = u))
                        }
                        )),
                        l && gr.debug(this, l, l.getVisibleCoordinates())),
                        this.options.showPadding && function(e) {
                            var t = e.transform.padding;
                            fr(e, e.transform.height - (t.top || 0), 3, lr),
                            fr(e, t.bottom || 0, 3, ur),
                            dr(e, t.left || 0, 3, cr),
                            dr(e, e.transform.width - (t.right || 0), 3, hr);
                            var i = e.transform.centerPoint;
                            !function(e, t, i, r) {
                                mr(e, t - 1, i - 10, 2, 20, r),
                                mr(e, t - 10, i - 1, 20, 2, r)
                            }(e, i.x, e.transform.height - i.y, pr)
                        }(this),
                        this.context.setDefault()
                    }
                    ,
                    yr.prototype.renderLayer = function(e, t, i, r) {
                        i.isHidden(this.transform.zoom) || ("background" === i.type || "custom" === i.type || r.length) && (this.id = i.id,
                        this.gpuTimingStart(i),
                        gr[i.type](e, t, i, r, this.style.placement.variableOffsets),
                        this.gpuTimingEnd())
                    }
                    ,
                    yr.prototype.gpuTimingStart = function(e) {
                        if (this.options.gpuTiming) {
                            var t = this.context.extTimerQuery
                              , i = this.gpuTimers[e.id];
                            i || (i = this.gpuTimers[e.id] = {
                                calls: 0,
                                cpuTime: 0,
                                query: t.createQueryEXT()
                            }),
                            i.calls++,
                            t.beginQueryEXT(t.TIME_ELAPSED_EXT, i.query)
                        }
                    }
                    ,
                    yr.prototype.gpuTimingEnd = function() {
                        if (this.options.gpuTiming) {
                            var e = this.context.extTimerQuery;
                            e.endQueryEXT(e.TIME_ELAPSED_EXT)
                        }
                    }
                    ,
                    yr.prototype.collectGpuTimers = function() {
                        var e = this.gpuTimers;
                        return this.gpuTimers = {},
                        e
                    }
                    ,
                    yr.prototype.queryGpuTimers = function(e) {
                        var t = {};
                        for (var i in e) {
                            var r = e[i]
                              , n = this.context.extTimerQuery
                              , a = n.getQueryObjectEXT(r.query, n.QUERY_RESULT_EXT) / 1e6;
                            n.deleteQueryEXT(r.query),
                            t[i] = a
                        }
                        return t
                    }
                    ,
                    yr.prototype.translatePosMatrix = function(t, i, r, n, a) {
                        if (!r[0] && !r[1])
                            return t;
                        var o = a ? "map" === n ? this.transform.angle : 0 : "viewport" === n ? -this.transform.angle : 0;
                        if (o) {
                            var s = Math.sin(o)
                              , l = Math.cos(o);
                            r = [r[0] * l - r[1] * s, r[0] * s + r[1] * l]
                        }
                        var u = [a ? r[0] : pt(i, r[0], this.transform.zoom), a ? r[1] : pt(i, r[1], this.transform.zoom), 0]
                          , c = new Float32Array(16);
                        return e.translate(c, t, u),
                        c
                    }
                    ,
                    yr.prototype.saveTileTexture = function(e) {
                        var t = this._tileTextures[e.size[0]];
                        t ? t.push(e) : this._tileTextures[e.size[0]] = [e]
                    }
                    ,
                    yr.prototype.getTileTexture = function(e) {
                        var t = this._tileTextures[e];
                        return t && t.length > 0 ? t.pop() : null
                    }
                    ,
                    yr.prototype.isPatternMissing = function(e) {
                        if (!e)
                            return !1;
                        if (!e.from || !e.to)
                            return !0;
                        var t = this.imageManager.getPattern(e.from.toString())
                          , i = this.imageManager.getPattern(e.to.toString());
                        return !t || !i
                    }
                    ,
                    yr.prototype.useProgram = function(e, t) {
                        this.cache = this.cache || {};
                        var i = "" + e + (t ? t.cacheKey : "") + (this._showOverdrawInspector ? "/overdraw" : "");
                        return this.cache[i] || (this.cache[i] = new bi(this.context,e,yi[e],t,Yi[e],this._showOverdrawInspector)),
                        this.cache[i]
                    }
                    ,
                    yr.prototype.setCustomLayerDefaults = function() {
                        this.context.unbindVAO(),
                        this.context.cullFace.setDefault(),
                        this.context.activeTexture.setDefault(),
                        this.context.pixelStoreUnpack.setDefault(),
                        this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),
                        this.context.pixelStoreUnpackFlipY.setDefault()
                    }
                    ,
                    yr.prototype.setBaseState = function() {
                        var e = this.context.gl;
                        this.context.cullFace.set(!1),
                        this.context.viewport.set([0, 0, this.width, this.height]),
                        this.context.blendEquation.set(e.FUNC_ADD)
                    }
                    ,
                    yr.prototype.initDebugOverlayCanvas = function() {
                        null == this.debugOverlayCanvas && (this.debugOverlayCanvas = e.window.document.createElement("canvas"),
                        this.debugOverlayCanvas.width = 512,
                        this.debugOverlayCanvas.height = 512,
                        this.debugOverlayTexture = new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))
                    }
                    ,
                    yr.prototype.destroy = function() {
                        this.emptyTexture.destroy(),
                        this.debugOverlayTexture && this.debugOverlayTexture.destroy()
                    }
                    ;
                    var _r = function(e, t) {
                        this.points = e,
                        this.planes = t
                    };
                    _r.fromInvProjectionMatrix = function(t, i, r) {
                        var n = Math.pow(2, r)
                          , a = [[-1, 1, -1, 1], [1, 1, -1, 1], [1, -1, -1, 1], [-1, -1, -1, 1], [-1, 1, 1, 1], [1, 1, 1, 1], [1, -1, 1, 1], [-1, -1, 1, 1]].map((function(i) {
                            return e.transformMat4([], i, t)
                        }
                        )).map((function(t) {
                            return e.scale$1([], t, 1 / t[3] / i * n)
                        }
                        ))
                          , o = [[0, 1, 2], [6, 5, 4], [0, 3, 7], [2, 1, 5], [3, 2, 6], [0, 4, 5]].map((function(t) {
                            var i = e.sub([], a[t[0]], a[t[1]])
                              , r = e.sub([], a[t[2]], a[t[1]])
                              , n = e.normalize([], e.cross([], i, r))
                              , o = -e.dot(n, a[t[1]]);
                            return n.concat(o)
                        }
                        ));
                        return new _r(a,o)
                    }
                    ;
                    var xr = function(t, i) {
                        this.min = t,
                        this.max = i,
                        this.center = e.scale$2([], e.add([], this.min, this.max), .5)
                    };
                    xr.prototype.quadrant = function(t) {
                        for (var i = [t % 2 == 0, t < 2], r = e.clone$2(this.min), n = e.clone$2(this.max), a = 0; a < i.length; a++)
                            r[a] = i[a] ? this.min[a] : this.center[a],
                            n[a] = i[a] ? this.center[a] : this.max[a];
                        return n[2] = this.max[2],
                        new xr(r,n)
                    }
                    ,
                    xr.prototype.distanceX = function(e) {
                        return Math.max(Math.min(this.max[0], e[0]), this.min[0]) - e[0]
                    }
                    ,
                    xr.prototype.distanceY = function(e) {
                        return Math.max(Math.min(this.max[1], e[1]), this.min[1]) - e[1]
                    }
                    ,
                    xr.prototype.intersects = function(t) {
                        for (var i = [[this.min[0], this.min[1], 0, 1], [this.max[0], this.min[1], 0, 1], [this.max[0], this.max[1], 0, 1], [this.min[0], this.max[1], 0, 1]], r = !0, n = 0; n < t.planes.length; n++) {
                            for (var a = t.planes[n], o = 0, s = 0; s < i.length; s++)
                                o += e.dot$1(a, i[s]) >= 0;
                            if (0 === o)
                                return 0;
                            o !== i.length && (r = !1)
                        }
                        if (r)
                            return 2;
                        for (var l = 0; l < 3; l++) {
                            for (var u = Number.MAX_VALUE, c = -Number.MAX_VALUE, h = 0; h < t.points.length; h++) {
                                var p = t.points[h][l] - this.min[l];
                                u = Math.min(u, p),
                                c = Math.max(c, p)
                            }
                            if (c < 0 || u > this.max[l] - this.min[l])
                                return 0
                        }
                        return 1
                    }
                    ;
                    var br = function(e, t, i, r) {
                        if (void 0 === e && (e = 0),
                        void 0 === t && (t = 0),
                        void 0 === i && (i = 0),
                        void 0 === r && (r = 0),
                        isNaN(e) || e < 0 || isNaN(t) || t < 0 || isNaN(i) || i < 0 || isNaN(r) || r < 0)
                            throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");
                        this.top = e,
                        this.bottom = t,
                        this.left = i,
                        this.right = r
                    };
                    br.prototype.interpolate = function(t, i, r) {
                        return null != i.top && null != t.top && (this.top = e.number(t.top, i.top, r)),
                        null != i.bottom && null != t.bottom && (this.bottom = e.number(t.bottom, i.bottom, r)),
                        null != i.left && null != t.left && (this.left = e.number(t.left, i.left, r)),
                        null != i.right && null != t.right && (this.right = e.number(t.right, i.right, r)),
                        this
                    }
                    ,
                    br.prototype.getCenter = function(t, i) {
                        var r = e.clamp((this.left + t - this.right) / 2, 0, t)
                          , n = e.clamp((this.top + i - this.bottom) / 2, 0, i);
                        return new e.Point(r,n)
                    }
                    ,
                    br.prototype.equals = function(e) {
                        return this.top === e.top && this.bottom === e.bottom && this.left === e.left && this.right === e.right
                    }
                    ,
                    br.prototype.clone = function() {
                        return new br(this.top,this.bottom,this.left,this.right)
                    }
                    ,
                    br.prototype.toJSON = function() {
                        return {
                            top: this.top,
                            bottom: this.bottom,
                            left: this.left,
                            right: this.right
                        }
                    }
                    ;
                    var wr = function(t, i, r, n, a) {
                        this.tileSize = 512,
                        this.maxValidLatitude = 85.051129,
                        this._renderWorldCopies = void 0 === a || a,
                        this._minZoom = t || 0,
                        this._maxZoom = i || 22,
                        this._minPitch = null == r ? 0 : r,
                        this._maxPitch = null == n ? 60 : n,
                        this.setMaxBounds(),
                        this.width = 0,
                        this.height = 0,
                        this._center = new e.LngLat(0,0),
                        this.zoom = 0,
                        this.angle = 0,
                        this._fov = .6435011087932844,
                        this._pitch = 0,
                        this._unmodified = !0,
                        this._edgeInsets = new br,
                        this._posMatrixCache = {},
                        this._alignedPosMatrixCache = {}
                    }
                      , Sr = {
                        minZoom: {
                            configurable: !0
                        },
                        maxZoom: {
                            configurable: !0
                        },
                        minPitch: {
                            configurable: !0
                        },
                        maxPitch: {
                            configurable: !0
                        },
                        renderWorldCopies: {
                            configurable: !0
                        },
                        worldSize: {
                            configurable: !0
                        },
                        centerOffset: {
                            configurable: !0
                        },
                        size: {
                            configurable: !0
                        },
                        bearing: {
                            configurable: !0
                        },
                        pitch: {
                            configurable: !0
                        },
                        fov: {
                            configurable: !0
                        },
                        zoom: {
                            configurable: !0
                        },
                        center: {
                            configurable: !0
                        },
                        padding: {
                            configurable: !0
                        },
                        centerPoint: {
                            configurable: !0
                        },
                        unmodified: {
                            configurable: !0
                        },
                        point: {
                            configurable: !0
                        }
                    };
                    wr.prototype.clone = function() {
                        var e = new wr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);
                        return e.tileSize = this.tileSize,
                        e.latRange = this.latRange,
                        e.width = this.width,
                        e.height = this.height,
                        e._center = this._center,
                        e.zoom = this.zoom,
                        e.angle = this.angle,
                        e._fov = this._fov,
                        e._pitch = this._pitch,
                        e._unmodified = this._unmodified,
                        e._edgeInsets = this._edgeInsets.clone(),
                        e._calcMatrices(),
                        e
                    }
                    ,
                    Sr.minZoom.get = function() {
                        return this._minZoom
                    }
                    ,
                    Sr.minZoom.set = function(e) {
                        this._minZoom !== e && (this._minZoom = e,
                        this.zoom = Math.max(this.zoom, e))
                    }
                    ,
                    Sr.maxZoom.get = function() {
                        return this._maxZoom
                    }
                    ,
                    Sr.maxZoom.set = function(e) {
                        this._maxZoom !== e && (this._maxZoom = e,
                        this.zoom = Math.min(this.zoom, e))
                    }
                    ,
                    Sr.minPitch.get = function() {
                        return this._minPitch
                    }
                    ,
                    Sr.minPitch.set = function(e) {
                        this._minPitch !== e && (this._minPitch = e,
                        this.pitch = Math.max(this.pitch, e))
                    }
                    ,
                    Sr.maxPitch.get = function() {
                        return this._maxPitch
                    }
                    ,
                    Sr.maxPitch.set = function(e) {
                        this._maxPitch !== e && (this._maxPitch = e,
                        this.pitch = Math.min(this.pitch, e))
                    }
                    ,
                    Sr.renderWorldCopies.get = function() {
                        return this._renderWorldCopies
                    }
                    ,
                    Sr.renderWorldCopies.set = function(e) {
                        void 0 === e ? e = !0 : null === e && (e = !1),
                        this._renderWorldCopies = e
                    }
                    ,
                    Sr.worldSize.get = function() {
                        return this.tileSize * this.scale
                    }
                    ,
                    Sr.centerOffset.get = function() {
                        return this.centerPoint._sub(this.size._div(2))
                    }
                    ,
                    Sr.size.get = function() {
                        return new e.Point(this.width,this.height)
                    }
                    ,
                    Sr.bearing.get = function() {
                        return -this.angle / Math.PI * 180
                    }
                    ,
                    Sr.bearing.set = function(t) {
                        var i = -e.wrap(t, -180, 180) * Math.PI / 180;
                        this.angle !== i && (this._unmodified = !1,
                        this.angle = i,
                        this._calcMatrices(),
                        this.rotationMatrix = e.create$2(),
                        e.rotate(this.rotationMatrix, this.rotationMatrix, this.angle))
                    }
                    ,
                    Sr.pitch.get = function() {
                        return this._pitch / Math.PI * 180
                    }
                    ,
                    Sr.pitch.set = function(t) {
                        var i = e.clamp(t, this.minPitch, this.maxPitch) / 180 * Math.PI;
                        this._pitch !== i && (this._unmodified = !1,
                        this._pitch = i,
                        this._calcMatrices())
                    }
                    ,
                    Sr.fov.get = function() {
                        return this._fov / Math.PI * 180
                    }
                    ,
                    Sr.fov.set = function(e) {
                        e = Math.max(.01, Math.min(60, e)),
                        this._fov !== e && (this._unmodified = !1,
                        this._fov = e / 180 * Math.PI,
                        this._calcMatrices())
                    }
                    ,
                    Sr.zoom.get = function() {
                        return this._zoom
                    }
                    ,
                    Sr.zoom.set = function(e) {
                        var t = Math.min(Math.max(e, this.minZoom), this.maxZoom);
                        this._zoom !== t && (this._unmodified = !1,
                        this._zoom = t,
                        this.scale = this.zoomScale(t),
                        this.tileZoom = Math.floor(t),
                        this.zoomFraction = t - this.tileZoom,
                        this._constrain(),
                        this._calcMatrices())
                    }
                    ,
                    Sr.center.get = function() {
                        return this._center
                    }
                    ,
                    Sr.center.set = function(e) {
                        e.lat === this._center.lat && e.lng === this._center.lng || (this._unmodified = !1,
                        this._center = e,
                        this._constrain(),
                        this._calcMatrices())
                    }
                    ,
                    Sr.padding.get = function() {
                        return this._edgeInsets.toJSON()
                    }
                    ,
                    Sr.padding.set = function(e) {
                        this._edgeInsets.equals(e) || (this._unmodified = !1,
                        this._edgeInsets.interpolate(this._edgeInsets, e, 1),
                        this._calcMatrices())
                    }
                    ,
                    Sr.centerPoint.get = function() {
                        return this._edgeInsets.getCenter(this.width, this.height)
                    }
                    ,
                    wr.prototype.isPaddingEqual = function(e) {
                        return this._edgeInsets.equals(e)
                    }
                    ,
                    wr.prototype.interpolatePadding = function(e, t, i) {
                        this._unmodified = !1,
                        this._edgeInsets.interpolate(e, t, i),
                        this._constrain(),
                        this._calcMatrices()
                    }
                    ,
                    wr.prototype.coveringZoomLevel = function(e) {
                        var t = (e.roundZoom ? Math.round : Math.floor)(this.zoom + this.scaleZoom(this.tileSize / e.tileSize));
                        return Math.max(0, t)
                    }
                    ,
                    wr.prototype.getVisibleUnwrappedCoordinates = function(t) {
                        var i = [new e.UnwrappedTileID(0,t)];
                        if (this._renderWorldCopies)
                            for (var r = this.pointCoordinate(new e.Point(0,0)), n = this.pointCoordinate(new e.Point(this.width,0)), a = this.pointCoordinate(new e.Point(this.width,this.height)), o = this.pointCoordinate(new e.Point(0,this.height)), s = Math.floor(Math.min(r.x, n.x, a.x, o.x)), l = Math.floor(Math.max(r.x, n.x, a.x, o.x)), u = s - 1; u <= l + 1; u++)
                                0 !== u && i.push(new e.UnwrappedTileID(u,t));
                        return i
                    }
                    ,
                    wr.prototype.coveringTiles = function(t) {
                        var i = this.coveringZoomLevel(t)
                          , r = i;
                        if (void 0 !== t.minzoom && i < t.minzoom)
                            return [];
                        void 0 !== t.maxzoom && i > t.maxzoom && (i = t.maxzoom);
                        var n = e.MercatorCoordinate.fromLngLat(this.center)
                          , a = Math.pow(2, i)
                          , o = [a * n.x, a * n.y, 0]
                          , s = _r.fromInvProjectionMatrix(this.invProjMatrix, this.worldSize, i)
                          , l = t.minzoom || 0;
                        this.pitch <= 60 && this._edgeInsets.top < .1 && (l = i);
                        var u = function(e) {
                            return {
                                aabb: new xr([e * a, 0, 0],[(e + 1) * a, a, 0]),
                                zoom: 0,
                                x: 0,
                                y: 0,
                                wrap: e,
                                fullyVisible: !1
                            }
                        }
                          , c = []
                          , h = []
                          , p = i
                          , f = t.reparseOverscaled ? r : i;
                        if (this._renderWorldCopies)
                            for (var d = 1; d <= 3; d++)
                                c.push(u(-d)),
                                c.push(u(d));
                        for (c.push(u(0)); c.length > 0; ) {
                            var m = c.pop()
                              , v = m.x
                              , g = m.y
                              , y = m.fullyVisible;
                            if (!y) {
                                var _ = m.aabb.intersects(s);
                                if (0 === _)
                                    continue;
                                y = 2 === _
                            }
                            var x = m.aabb.distanceX(o)
                              , b = m.aabb.distanceY(o)
                              , w = Math.max(Math.abs(x), Math.abs(b));
                            if (m.zoom === p || w > 3 + (1 << p - m.zoom) - 2 && m.zoom >= l)
                                h.push({
                                    tileID: new e.OverscaledTileID(m.zoom === p ? f : m.zoom,m.wrap,m.zoom,v,g),
                                    distanceSq: e.sqrLen([o[0] - .5 - v, o[1] - .5 - g])
                                });
                            else
                                for (var S = 0; S < 4; S++) {
                                    var M = (v << 1) + S % 2
                                      , T = (g << 1) + (S >> 1);
                                    c.push({
                                        aabb: m.aabb.quadrant(S),
                                        zoom: m.zoom + 1,
                                        x: M,
                                        y: T,
                                        wrap: m.wrap,
                                        fullyVisible: y
                                    })
                                }
                        }
                        return h.sort((function(e, t) {
                            return e.distanceSq - t.distanceSq
                        }
                        )).map((function(e) {
                            return e.tileID
                        }
                        ))
                    }
                    ,
                    wr.prototype.resize = function(e, t) {
                        this.width = e,
                        this.height = t,
                        this.pixelsToGLUnits = [2 / e, -2 / t],
                        this._constrain(),
                        this._calcMatrices()
                    }
                    ,
                    Sr.unmodified.get = function() {
                        return this._unmodified
                    }
                    ,
                    wr.prototype.zoomScale = function(e) {
                        return Math.pow(2, e)
                    }
                    ,
                    wr.prototype.scaleZoom = function(e) {
                        return Math.log(e) / Math.LN2
                    }
                    ,
                    wr.prototype.project = function(t) {
                        var i = e.clamp(t.lat, -this.maxValidLatitude, this.maxValidLatitude);
                        return new e.Point(e.mercatorXfromLng(t.lng) * this.worldSize,e.mercatorYfromLat(i) * this.worldSize)
                    }
                    ,
                    wr.prototype.unproject = function(t) {
                        return new e.MercatorCoordinate(t.x / this.worldSize,t.y / this.worldSize).toLngLat()
                    }
                    ,
                    Sr.point.get = function() {
                        return this.project(this.center)
                    }
                    ,
                    wr.prototype.setLocationAtPoint = function(t, i) {
                        var r = this.pointCoordinate(i)
                          , n = this.pointCoordinate(this.centerPoint)
                          , a = this.locationCoordinate(t)
                          , o = new e.MercatorCoordinate(a.x - (r.x - n.x),a.y - (r.y - n.y));
                        this.center = this.coordinateLocation(o),
                        this._renderWorldCopies && (this.center = this.center.wrap())
                    }
                    ,
                    wr.prototype.locationPoint = function(e) {
                        return this.coordinatePoint(this.locationCoordinate(e))
                    }
                    ,
                    wr.prototype.pointLocation = function(e) {
                        return this.coordinateLocation(this.pointCoordinate(e))
                    }
                    ,
                    wr.prototype.locationCoordinate = function(t) {
                        return e.MercatorCoordinate.fromLngLat(t)
                    }
                    ,
                    wr.prototype.coordinateLocation = function(e) {
                        return e.toLngLat()
                    }
                    ,
                    wr.prototype.pointCoordinate = function(t) {
                        var i = [t.x, t.y, 0, 1]
                          , r = [t.x, t.y, 1, 1];
                        e.transformMat4(i, i, this.pixelMatrixInverse),
                        e.transformMat4(r, r, this.pixelMatrixInverse);
                        var n = i[3]
                          , a = r[3]
                          , o = i[1] / n
                          , s = r[1] / a
                          , l = i[2] / n
                          , u = r[2] / a
                          , c = l === u ? 0 : (0 - l) / (u - l);
                        return new e.MercatorCoordinate(e.number(i[0] / n, r[0] / a, c) / this.worldSize,e.number(o, s, c) / this.worldSize)
                    }
                    ,
                    wr.prototype.coordinatePoint = function(t) {
                        var i = [t.x * this.worldSize, t.y * this.worldSize, 0, 1];
                        return e.transformMat4(i, i, this.pixelMatrix),
                        new e.Point(i[0] / i[3],i[1] / i[3])
                    }
                    ,
                    wr.prototype.getBounds = function() {
                        return (new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))
                    }
                    ,
                    wr.prototype.getMaxBounds = function() {
                        return this.latRange && 2 === this.latRange.length && this.lngRange && 2 === this.lngRange.length ? new e.LngLatBounds([this.lngRange[0], this.latRange[0]],[this.lngRange[1], this.latRange[1]]) : null
                    }
                    ,
                    wr.prototype.setMaxBounds = function(e) {
                        e ? (this.lngRange = [e.getWest(), e.getEast()],
                        this.latRange = [e.getSouth(), e.getNorth()],
                        this._constrain()) : (this.lngRange = null,
                        this.latRange = [-this.maxValidLatitude, this.maxValidLatitude])
                    }
                    ,
                    wr.prototype.calculatePosMatrix = function(t, i) {
                        void 0 === i && (i = !1);
                        var r = t.key
                          , n = i ? this._alignedPosMatrixCache : this._posMatrixCache;
                        if (n[r])
                            return n[r];
                        var a = t.canonical
                          , o = this.worldSize / this.zoomScale(a.z)
                          , s = a.x + Math.pow(2, a.z) * t.wrap
                          , l = e.identity(new Float64Array(16));
                        return e.translate(l, l, [s * o, a.y * o, 0]),
                        e.scale(l, l, [o / e.EXTENT, o / e.EXTENT, 1]),
                        e.multiply(l, i ? this.alignedProjMatrix : this.projMatrix, l),
                        n[r] = new Float32Array(l),
                        n[r]
                    }
                    ,
                    wr.prototype.customLayerMatrix = function() {
                        return this.mercatorMatrix.slice()
                    }
                    ,
                    wr.prototype._constrain = function() {
                        if (this.center && this.width && this.height && !this._constraining) {
                            this._constraining = !0;
                            var t, i, r, n, a = -90, o = 90, s = -180, l = 180, u = this.size, c = this._unmodified;
                            if (this.latRange) {
                                var h = this.latRange;
                                a = e.mercatorYfromLat(h[1]) * this.worldSize,
                                t = (o = e.mercatorYfromLat(h[0]) * this.worldSize) - a < u.y ? u.y / (o - a) : 0
                            }
                            if (this.lngRange) {
                                var p = this.lngRange;
                                s = e.mercatorXfromLng(p[0]) * this.worldSize,
                                i = (l = e.mercatorXfromLng(p[1]) * this.worldSize) - s < u.x ? u.x / (l - s) : 0
                            }
                            var f = this.point
                              , d = Math.max(i || 0, t || 0);
                            if (d)
                                return this.center = this.unproject(new e.Point(i ? (l + s) / 2 : f.x,t ? (o + a) / 2 : f.y)),
                                this.zoom += this.scaleZoom(d),
                                this._unmodified = c,
                                void (this._constraining = !1);
                            if (this.latRange) {
                                var m = f.y
                                  , v = u.y / 2;
                                m - v < a && (n = a + v),
                                m + v > o && (n = o - v)
                            }
                            if (this.lngRange) {
                                var g = f.x
                                  , y = u.x / 2;
                                g - y < s && (r = s + y),
                                g + y > l && (r = l - y)
                            }
                            void 0 === r && void 0 === n || (this.center = this.unproject(new e.Point(void 0 !== r ? r : f.x,void 0 !== n ? n : f.y))),
                            this._unmodified = c,
                            this._constraining = !1
                        }
                    }
                    ,
                    wr.prototype._calcMatrices = function() {
                        if (this.height) {
                            var t = this.centerOffset;
                            this.cameraToCenterDistance = .5 / Math.tan(this._fov / 2) * this.height;
                            var i = Math.PI / 2 + this._pitch
                              , r = this._fov * (.5 + t.y / this.height)
                              , n = Math.sin(r) * this.cameraToCenterDistance / Math.sin(e.clamp(Math.PI - i - r, .01, Math.PI - .01))
                              , a = this.point
                              , o = a.x
                              , s = a.y
                              , l = 1.01 * (Math.cos(Math.PI / 2 - this._pitch) * n + this.cameraToCenterDistance)
                              , u = this.height / 50
                              , c = new Float64Array(16);
                            e.perspective(c, this._fov, this.width / this.height, u, l),
                            c[8] = 2 * -t.x / this.width,
                            c[9] = 2 * t.y / this.height,
                            e.scale(c, c, [1, -1, 1]),
                            e.translate(c, c, [0, 0, -this.cameraToCenterDistance]),
                            e.rotateX(c, c, this._pitch),
                            e.rotateZ(c, c, this.angle),
                            e.translate(c, c, [-o, -s, 0]),
                            this.mercatorMatrix = e.scale([], c, [this.worldSize, this.worldSize, this.worldSize]),
                            e.scale(c, c, [1, 1, e.mercatorZfromAltitude(1, this.center.lat) * this.worldSize, 1]),
                            this.projMatrix = c,
                            this.invProjMatrix = e.invert([], this.projMatrix);
                            var h = this.width % 2 / 2
                              , p = this.height % 2 / 2
                              , f = Math.cos(this.angle)
                              , d = Math.sin(this.angle)
                              , m = o - Math.round(o) + f * h + d * p
                              , v = s - Math.round(s) + f * p + d * h
                              , g = new Float64Array(c);
                            if (e.translate(g, g, [m > .5 ? m - 1 : m, v > .5 ? v - 1 : v, 0]),
                            this.alignedProjMatrix = g,
                            c = e.create(),
                            e.scale(c, c, [this.width / 2, -this.height / 2, 1]),
                            e.translate(c, c, [1, -1, 0]),
                            this.labelPlaneMatrix = c,
                            c = e.create(),
                            e.scale(c, c, [1, -1, 1]),
                            e.translate(c, c, [-1, -1, 0]),
                            e.scale(c, c, [2 / this.width, 2 / this.height, 1]),
                            this.glCoordMatrix = c,
                            this.pixelMatrix = e.multiply(new Float64Array(16), this.labelPlaneMatrix, this.projMatrix),
                            !(c = e.invert(new Float64Array(16), this.pixelMatrix)))
                                throw new Error("failed to invert matrix");
                            this.pixelMatrixInverse = c,
                            this._posMatrixCache = {},
                            this._alignedPosMatrixCache = {}
                        }
                    }
                    ,
                    wr.prototype.maxPitchScaleFactor = function() {
                        if (!this.pixelMatrixInverse)
                            return 1;
                        var t = this.pointCoordinate(new e.Point(0,0))
                          , i = [t.x * this.worldSize, t.y * this.worldSize, 0, 1];
                        return e.transformMat4(i, i, this.pixelMatrix)[3] / this.cameraToCenterDistance
                    }
                    ,
                    wr.prototype.getCameraPoint = function() {
                        var t = Math.tan(this._pitch) * (this.cameraToCenterDistance || 1);
                        return this.centerPoint.add(new e.Point(0,t))
                    }
                    ,
                    wr.prototype.getCameraQueryGeometry = function(t) {
                        var i = this.getCameraPoint();
                        if (1 === t.length)
                            return [t[0], i];
                        for (var r = i.x, n = i.y, a = i.x, o = i.y, s = 0, l = t; s < l.length; s += 1) {
                            var u = l[s];
                            r = Math.min(r, u.x),
                            n = Math.min(n, u.y),
                            a = Math.max(a, u.x),
                            o = Math.max(o, u.y)
                        }
                        return [new e.Point(r,n), new e.Point(a,n), new e.Point(a,o), new e.Point(r,o), new e.Point(r,n)]
                    }
                    ,
                    Object.defineProperties(wr.prototype, Sr);
                    var Mr = function(t) {
                        var i, r, n, a;
                        this._hashName = t && encodeURIComponent(t),
                        e.bindAll(["_getCurrentHash", "_onHashChange", "_updateHash"], this),
                        this._updateHash = (i = this._updateHashUnthrottled.bind(this),
                        r = !1,
                        n = null,
                        a = function() {
                            n = null,
                            r && (i(),
                            n = setTimeout(a, 300),
                            r = !1)
                        }
                        ,
                        function() {
                            return r = !0,
                            n || a(),
                            n
                        }
                        )
                    };
                    Mr.prototype.addTo = function(t) {
                        return this._map = t,
                        e.window.addEventListener("hashchange", this._onHashChange, !1),
                        this._map.on("moveend", this._updateHash),
                        this
                    }
                    ,
                    Mr.prototype.remove = function() {
                        return e.window.removeEventListener("hashchange", this._onHashChange, !1),
                        this._map.off("moveend", this._updateHash),
                        clearTimeout(this._updateHash()),
                        delete this._map,
                        this
                    }
                    ,
                    Mr.prototype.getHashString = function(t) {
                        var i = this._map.getCenter()
                          , r = Math.round(100 * this._map.getZoom()) / 100
                          , n = Math.ceil((r * Math.LN2 + Math.log(512 / 360 / .5)) / Math.LN10)
                          , a = Math.pow(10, n)
                          , o = Math.round(i.lng * a) / a
                          , s = Math.round(i.lat * a) / a
                          , l = this._map.getBearing()
                          , u = this._map.getPitch()
                          , c = "";
                        if (c += t ? "/" + o + "/" + s + "/" + r : r + "/" + s + "/" + o,
                        (l || u) && (c += "/" + Math.round(10 * l) / 10),
                        u && (c += "/" + Math.round(u)),
                        this._hashName) {
                            var h = this._hashName
                              , p = !1
                              , f = e.window.location.hash.slice(1).split("&").map((function(e) {
                                var t = e.split("=")[0];
                                return t === h ? (p = !0,
                                t + "=" + c) : e
                            }
                            )).filter((function(e) {
                                return e
                            }
                            ));
                            return p || f.push(h + "=" + c),
                            "#" + f.join("&")
                        }
                        return "#" + c
                    }
                    ,
                    Mr.prototype._getCurrentHash = function() {
                        var t, i = this, r = e.window.location.hash.replace("#", "");
                        return this._hashName ? (r.split("&").map((function(e) {
                            return e.split("=")
                        }
                        )).forEach((function(e) {
                            e[0] === i._hashName && (t = e)
                        }
                        )),
                        (t && t[1] || "").split("/")) : r.split("/")
                    }
                    ,
                    Mr.prototype._onHashChange = function() {
                        var e = this._getCurrentHash();
                        if (e.length >= 3 && !e.some((function(e) {
                            return isNaN(e)
                        }
                        ))) {
                            var t = this._map.dragRotate.isEnabled() && this._map.touchZoomRotate.isEnabled() ? +(e[3] || 0) : this._map.getBearing();
                            return this._map.jumpTo({
                                center: [+e[2], +e[1]],
                                zoom: +e[0],
                                bearing: t,
                                pitch: +(e[4] || 0)
                            }),
                            !0
                        }
                        return !1
                    }
                    ,
                    Mr.prototype._updateHashUnthrottled = function() {
                        var t = e.window.location.href.replace(/(#.+)?$/, this.getHashString());
                        try {
                            e.window.history.replaceState(e.window.history.state, null, t)
                        } catch (e) {}
                    }
                    ;
                    var Tr = {
                        linearity: .3,
                        easing: e.bezier(0, 0, .3, 1)
                    }
                      , Er = e.extend({
                        deceleration: 2500,
                        maxSpeed: 1400
                    }, Tr)
                      , Ar = e.extend({
                        deceleration: 20,
                        maxSpeed: 1400
                    }, Tr)
                      , Pr = e.extend({
                        deceleration: 1e3,
                        maxSpeed: 360
                    }, Tr)
                      , Cr = e.extend({
                        deceleration: 1e3,
                        maxSpeed: 90
                    }, Tr)
                      , Lr = function(e) {
                        this._map = e,
                        this.clear()
                    };
                    function Ir(e, t) {
                        (!e.duration || e.duration < t.duration) && (e.duration = t.duration,
                        e.easing = t.easing)
                    }
                    function kr(t, i, r) {
                        var n = r.maxSpeed
                          , a = r.linearity
                          , o = r.deceleration
                          , s = e.clamp(t * a / (i / 1e3), -n, n)
                          , l = Math.abs(s) / (o * a);
                        return {
                            easing: r.easing,
                            duration: 1e3 * l,
                            amount: s * (l / 2)
                        }
                    }
                    Lr.prototype.clear = function() {
                        this._inertiaBuffer = []
                    }
                    ,
                    Lr.prototype.record = function(t) {
                        this._drainInertiaBuffer(),
                        this._inertiaBuffer.push({
                            time: e.browser.now(),
                            settings: t
                        })
                    }
                    ,
                    Lr.prototype._drainInertiaBuffer = function() {
                        for (var t = this._inertiaBuffer, i = e.browser.now(); t.length > 0 && i - t[0].time > 160; )
                            t.shift()
                    }
                    ,
                    Lr.prototype._onMoveEnd = function(t) {
                        if (this._drainInertiaBuffer(),
                        !(this._inertiaBuffer.length < 2)) {
                            for (var i = {
                                zoom: 0,
                                bearing: 0,
                                pitch: 0,
                                pan: new e.Point(0,0),
                                pinchAround: void 0,
                                around: void 0
                            }, r = 0, n = this._inertiaBuffer; r < n.length; r += 1) {
                                var a = n[r].settings;
                                i.zoom += a.zoomDelta || 0,
                                i.bearing += a.bearingDelta || 0,
                                i.pitch += a.pitchDelta || 0,
                                a.panDelta && i.pan._add(a.panDelta),
                                a.around && (i.around = a.around),
                                a.pinchAround && (i.pinchAround = a.pinchAround)
                            }
                            var o = this._inertiaBuffer[this._inertiaBuffer.length - 1].time - this._inertiaBuffer[0].time
                              , s = {};
                            if (i.pan.mag()) {
                                var l = kr(i.pan.mag(), o, e.extend({}, Er, t || {}));
                                s.offset = i.pan.mult(l.amount / i.pan.mag()),
                                s.center = this._map.transform.center,
                                Ir(s, l)
                            }
                            if (i.zoom) {
                                var u = kr(i.zoom, o, Ar);
                                s.zoom = this._map.transform.zoom + u.amount,
                                Ir(s, u)
                            }
                            if (i.bearing) {
                                var c = kr(i.bearing, o, Pr);
                                s.bearing = this._map.transform.bearing + e.clamp(c.amount, -179, 179),
                                Ir(s, c)
                            }
                            if (i.pitch) {
                                var h = kr(i.pitch, o, Cr);
                                s.pitch = this._map.transform.pitch + h.amount,
                                Ir(s, h)
                            }
                            if (s.zoom || s.bearing) {
                                var p = void 0 === i.pinchAround ? i.around : i.pinchAround;
                                s.around = p ? this._map.unproject(p) : this._map.getCenter()
                            }
                            return this.clear(),
                            e.extend(s, {
                                noMoveStart: !0
                            })
                        }
                    }
                    ;
                    var zr = function(t) {
                        function r(r, n, a, o) {
                            void 0 === o && (o = {});
                            var s = i.mousePos(n.getCanvasContainer(), a)
                              , l = n.unproject(s);
                            t.call(this, r, e.extend({
                                point: s,
                                lngLat: l,
                                originalEvent: a
                            }, o)),
                            this._defaultPrevented = !1,
                            this.target = n
                        }
                        t && (r.__proto__ = t),
                        (r.prototype = Object.create(t && t.prototype)).constructor = r;
                        var n = {
                            defaultPrevented: {
                                configurable: !0
                            }
                        };
                        return r.prototype.preventDefault = function() {
                            this._defaultPrevented = !0
                        }
                        ,
                        n.defaultPrevented.get = function() {
                            return this._defaultPrevented
                        }
                        ,
                        Object.defineProperties(r.prototype, n),
                        r
                    }(e.Event)
                      , Dr = function(t) {
                        function r(r, n, a) {
                            var o = "touchend" === r ? a.changedTouches : a.touches
                              , s = i.touchPos(n.getCanvasContainer(), o)
                              , l = s.map((function(e) {
                                return n.unproject(e)
                            }
                            ))
                              , u = s.reduce((function(e, t, i, r) {
                                return e.add(t.div(r.length))
                            }
                            ), new e.Point(0,0))
                              , c = n.unproject(u);
                            t.call(this, r, {
                                points: s,
                                point: u,
                                lngLats: l,
                                lngLat: c,
                                originalEvent: a
                            }),
                            this._defaultPrevented = !1
                        }
                        t && (r.__proto__ = t),
                        (r.prototype = Object.create(t && t.prototype)).constructor = r;
                        var n = {
                            defaultPrevented: {
                                configurable: !0
                            }
                        };
                        return r.prototype.preventDefault = function() {
                            this._defaultPrevented = !0
                        }
                        ,
                        n.defaultPrevented.get = function() {
                            return this._defaultPrevented
                        }
                        ,
                        Object.defineProperties(r.prototype, n),
                        r
                    }(e.Event)
                      , Rr = function(e) {
                        function t(t, i, r) {
                            e.call(this, t, {
                                originalEvent: r
                            }),
                            this._defaultPrevented = !1
                        }
                        e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t;
                        var i = {
                            defaultPrevented: {
                                configurable: !0
                            }
                        };
                        return t.prototype.preventDefault = function() {
                            this._defaultPrevented = !0
                        }
                        ,
                        i.defaultPrevented.get = function() {
                            return this._defaultPrevented
                        }
                        ,
                        Object.defineProperties(t.prototype, i),
                        t
                    }(e.Event)
                      , Or = function(e, t) {
                        this._map = e,
                        this._clickTolerance = t.clickTolerance
                    };
                    Or.prototype.reset = function() {
                        delete this._mousedownPos
                    }
                    ,
                    Or.prototype.wheel = function(e) {
                        return this._firePreventable(new Rr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.mousedown = function(e, t) {
                        return this._mousedownPos = t,
                        this._firePreventable(new zr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.mouseup = function(e) {
                        this._map.fire(new zr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.click = function(e, t) {
                        this._mousedownPos && this._mousedownPos.dist(t) >= this._clickTolerance || this._map.fire(new zr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.dblclick = function(e) {
                        return this._firePreventable(new zr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.mouseover = function(e) {
                        this._map.fire(new zr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.mouseout = function(e) {
                        this._map.fire(new zr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.touchstart = function(e) {
                        return this._firePreventable(new Dr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.touchmove = function(e) {
                        this._map.fire(new Dr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.touchend = function(e) {
                        this._map.fire(new Dr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype.touchcancel = function(e) {
                        this._map.fire(new Dr(e.type,this._map,e))
                    }
                    ,
                    Or.prototype._firePreventable = function(e) {
                        if (this._map.fire(e),
                        e.defaultPrevented)
                            return {}
                    }
                    ,
                    Or.prototype.isEnabled = function() {
                        return !0
                    }
                    ,
                    Or.prototype.isActive = function() {
                        return !1
                    }
                    ,
                    Or.prototype.enable = function() {}
                    ,
                    Or.prototype.disable = function() {}
                    ;
                    var Br = function(e) {
                        this._map = e
                    };
                    Br.prototype.reset = function() {
                        this._delayContextMenu = !1,
                        delete this._contextMenuEvent
                    }
                    ,
                    Br.prototype.mousemove = function(e) {
                        this._map.fire(new zr(e.type,this._map,e))
                    }
                    ,
                    Br.prototype.mousedown = function() {
                        this._delayContextMenu = !0
                    }
                    ,
                    Br.prototype.mouseup = function() {
                        this._delayContextMenu = !1,
                        this._contextMenuEvent && (this._map.fire(new zr("contextmenu",this._map,this._contextMenuEvent)),
                        delete this._contextMenuEvent)
                    }
                    ,
                    Br.prototype.contextmenu = function(e) {
                        this._delayContextMenu ? this._contextMenuEvent = e : this._map.fire(new zr(e.type,this._map,e)),
                        this._map.listens("contextmenu") && e.preventDefault()
                    }
                    ,
                    Br.prototype.isEnabled = function() {
                        return !0
                    }
                    ,
                    Br.prototype.isActive = function() {
                        return !1
                    }
                    ,
                    Br.prototype.enable = function() {}
                    ,
                    Br.prototype.disable = function() {}
                    ;
                    var Fr = function(e, t) {
                        this._map = e,
                        this._el = e.getCanvasContainer(),
                        this._container = e.getContainer(),
                        this._clickTolerance = t.clickTolerance || 1
                    };
                    function Nr(e, t) {
                        for (var i = {}, r = 0; r < e.length; r++)
                            i[e[r].identifier] = t[r];
                        return i
                    }
                    Fr.prototype.isEnabled = function() {
                        return !!this._enabled
                    }
                    ,
                    Fr.prototype.isActive = function() {
                        return !!this._active
                    }
                    ,
                    Fr.prototype.enable = function() {
                        this.isEnabled() || (this._enabled = !0)
                    }
                    ,
                    Fr.prototype.disable = function() {
                        this.isEnabled() && (this._enabled = !1)
                    }
                    ,
                    Fr.prototype.mousedown = function(e, t) {
                        this.isEnabled() && e.shiftKey && 0 === e.button && (i.disableDrag(),
                        this._startPos = this._lastPos = t,
                        this._active = !0)
                    }
                    ,
                    Fr.prototype.mousemoveWindow = function(e, t) {
                        if (this._active) {
                            var r = t;
                            if (!(this._lastPos.equals(r) || !this._box && r.dist(this._startPos) < this._clickTolerance)) {
                                var n = this._startPos;
                                this._lastPos = r,
                                this._box || (this._box = i.create("div", "mapboxgl-boxzoom", this._container),
                                this._container.classList.add("mapboxgl-crosshair"),
                                this._fireEvent("boxzoomstart", e));
                                var a = Math.min(n.x, r.x)
                                  , o = Math.max(n.x, r.x)
                                  , s = Math.min(n.y, r.y)
                                  , l = Math.max(n.y, r.y);
                                i.setTransform(this._box, "translate(" + a + "px," + s + "px)"),
                                this._box.style.width = o - a + "px",
                                this._box.style.height = l - s + "px"
                            }
                        }
                    }
                    ,
                    Fr.prototype.mouseupWindow = function(t, r) {
                        var n = this;
                        if (this._active && 0 === t.button) {
                            var a = this._startPos
                              , o = r;
                            if (this.reset(),
                            i.suppressClick(),
                            a.x !== o.x || a.y !== o.y)
                                return this._map.fire(new e.Event("boxzoomend",{
                                    originalEvent: t
                                })),
                                {
                                    cameraAnimation: function(e) {
                                        return e.fitScreenCoordinates(a, o, n._map.getBearing(), {
                                            linear: !0
                                        })
                                    }
                                };
                            this._fireEvent("boxzoomcancel", t)
                        }
                    }
                    ,
                    Fr.prototype.keydown = function(e) {
                        this._active && 27 === e.keyCode && (this.reset(),
                        this._fireEvent("boxzoomcancel", e))
                    }
                    ,
                    Fr.prototype.reset = function() {
                        this._active = !1,
                        this._container.classList.remove("mapboxgl-crosshair"),
                        this._box && (i.remove(this._box),
                        this._box = null),
                        i.enableDrag(),
                        delete this._startPos,
                        delete this._lastPos
                    }
                    ,
                    Fr.prototype._fireEvent = function(t, i) {
                        return this._map.fire(new e.Event(t,{
                            originalEvent: i
                        }))
                    }
                    ;
                    var Ur = function(e) {
                        this.reset(),
                        this.numTouches = e.numTouches
                    };
                    Ur.prototype.reset = function() {
                        delete this.centroid,
                        delete this.startTime,
                        delete this.touches,
                        this.aborted = !1
                    }
                    ,
                    Ur.prototype.touchstart = function(t, i, r) {
                        (this.centroid || r.length > this.numTouches) && (this.aborted = !0),
                        this.aborted || (void 0 === this.startTime && (this.startTime = t.timeStamp),
                        r.length === this.numTouches && (this.centroid = function(t) {
                            for (var i = new e.Point(0,0), r = 0, n = t; r < n.length; r += 1)
                                i._add(n[r]);
                            return i.div(t.length)
                        }(i),
                        this.touches = Nr(r, i)))
                    }
                    ,
                    Ur.prototype.touchmove = function(e, t, i) {
                        if (!this.aborted && this.centroid) {
                            var r = Nr(i, t);
                            for (var n in this.touches) {
                                var a = r[n];
                                (!a || a.dist(this.touches[n]) > 30) && (this.aborted = !0)
                            }
                        }
                    }
                    ,
                    Ur.prototype.touchend = function(e, t, i) {
                        if ((!this.centroid || e.timeStamp - this.startTime > 500) && (this.aborted = !0),
                        0 === i.length) {
                            var r = !this.aborted && this.centroid;
                            if (this.reset(),
                            r)
                                return r
                        }
                    }
                    ;
                    var Vr = function(e) {
                        this.singleTap = new Ur(e),
                        this.numTaps = e.numTaps,
                        this.reset()
                    };
                    Vr.prototype.reset = function() {
                        this.lastTime = 1 / 0,
                        delete this.lastTap,
                        this.count = 0,
                        this.singleTap.reset()
                    }
                    ,
                    Vr.prototype.touchstart = function(e, t, i) {
                        this.singleTap.touchstart(e, t, i)
                    }
                    ,
                    Vr.prototype.touchmove = function(e, t, i) {
                        this.singleTap.touchmove(e, t, i)
                    }
                    ,
                    Vr.prototype.touchend = function(e, t, i) {
                        var r = this.singleTap.touchend(e, t, i);
                        if (r) {
                            var n = e.timeStamp - this.lastTime < 500
                              , a = !this.lastTap || this.lastTap.dist(r) < 30;
                            if (n && a || this.reset(),
                            this.count++,
                            this.lastTime = e.timeStamp,
                            this.lastTap = r,
                            this.count === this.numTaps)
                                return this.reset(),
                                r
                        }
                    }
                    ;
                    var Gr = function() {
                        this._zoomIn = new Vr({
                            numTouches: 1,
                            numTaps: 2
                        }),
                        this._zoomOut = new Vr({
                            numTouches: 2,
                            numTaps: 1
                        }),
                        this.reset()
                    };
                    Gr.prototype.reset = function() {
                        this._active = !1,
                        this._zoomIn.reset(),
                        this._zoomOut.reset()
                    }
                    ,
                    Gr.prototype.touchstart = function(e, t, i) {
                        this._zoomIn.touchstart(e, t, i),
                        this._zoomOut.touchstart(e, t, i)
                    }
                    ,
                    Gr.prototype.touchmove = function(e, t, i) {
                        this._zoomIn.touchmove(e, t, i),
                        this._zoomOut.touchmove(e, t, i)
                    }
                    ,
                    Gr.prototype.touchend = function(e, t, i) {
                        var r = this
                          , n = this._zoomIn.touchend(e, t, i)
                          , a = this._zoomOut.touchend(e, t, i);
                        return n ? (this._active = !0,
                        e.preventDefault(),
                        setTimeout((function() {
                            return r.reset()
                        }
                        ), 0),
                        {
                            cameraAnimation: function(t) {
                                return t.easeTo({
                                    duration: 300,
                                    zoom: t.getZoom() + 1,
                                    around: t.unproject(n)
                                }, {
                                    originalEvent: e
                                })
                            }
                        }) : a ? (this._active = !0,
                        e.preventDefault(),
                        setTimeout((function() {
                            return r.reset()
                        }
                        ), 0),
                        {
                            cameraAnimation: function(t) {
                                return t.easeTo({
                                    duration: 300,
                                    zoom: t.getZoom() - 1,
                                    around: t.unproject(a)
                                }, {
                                    originalEvent: e
                                })
                            }
                        }) : void 0
                    }
                    ,
                    Gr.prototype.touchcancel = function() {
                        this.reset()
                    }
                    ,
                    Gr.prototype.enable = function() {
                        this._enabled = !0
                    }
                    ,
                    Gr.prototype.disable = function() {
                        this._enabled = !1,
                        this.reset()
                    }
                    ,
                    Gr.prototype.isEnabled = function() {
                        return this._enabled
                    }
                    ,
                    Gr.prototype.isActive = function() {
                        return this._active
                    }
                    ;
                    var jr = {
                        0: 1,
                        2: 2
                    }
                      , Hr = function(e) {
                        this.reset(),
                        this._clickTolerance = e.clickTolerance || 1
                    };
                    Hr.prototype.reset = function() {
                        this._active = !1,
                        this._moved = !1,
                        delete this._lastPoint,
                        delete this._eventButton
                    }
                    ,
                    Hr.prototype._correctButton = function(e, t) {
                        return !1
                    }
                    ,
                    Hr.prototype._move = function(e, t) {
                        return {}
                    }
                    ,
                    Hr.prototype.mousedown = function(e, t) {
                        if (!this._lastPoint) {
                            var r = i.mouseButton(e);
                            this._correctButton(e, r) && (this._lastPoint = t,
                            this._eventButton = r)
                        }
                    }
                    ,
                    Hr.prototype.mousemoveWindow = function(e, t) {
                        var i = this._lastPoint;
                        if (i)
                            if (e.preventDefault(),
                            function(e, t) {
                                var i = jr[t];
                                return void 0 === e.buttons || (e.buttons & i) !== i
                            }(e, this._eventButton))
                                this.reset();
                            else if (this._moved || !(t.dist(i) < this._clickTolerance))
                                return this._moved = !0,
                                this._lastPoint = t,
                                this._move(i, t)
                    }
                    ,
                    Hr.prototype.mouseupWindow = function(e) {
                        this._lastPoint && i.mouseButton(e) === this._eventButton && (this._moved && i.suppressClick(),
                        this.reset())
                    }
                    ,
                    Hr.prototype.enable = function() {
                        this._enabled = !0
                    }
                    ,
                    Hr.prototype.disable = function() {
                        this._enabled = !1,
                        this.reset()
                    }
                    ,
                    Hr.prototype.isEnabled = function() {
                        return this._enabled
                    }
                    ,
                    Hr.prototype.isActive = function() {
                        return this._active
                    }
                    ;
                    var qr = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.mousedown = function(t, i) {
                            e.prototype.mousedown.call(this, t, i),
                            this._lastPoint && (this._active = !0)
                        }
                        ,
                        t.prototype._correctButton = function(e, t) {
                            return 0 === t && !e.ctrlKey
                        }
                        ,
                        t.prototype._move = function(e, t) {
                            return {
                                around: t,
                                panDelta: t.sub(e)
                            }
                        }
                        ,
                        t
                    }(Hr)
                      , Wr = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._correctButton = function(e, t) {
                            return 0 === t && e.ctrlKey || 2 === t
                        }
                        ,
                        t.prototype._move = function(e, t) {
                            var i = .8 * (t.x - e.x);
                            if (i)
                                return this._active = !0,
                                {
                                    bearingDelta: i
                                }
                        }
                        ,
                        t.prototype.contextmenu = function(e) {
                            e.preventDefault()
                        }
                        ,
                        t
                    }(Hr)
                      , Zr = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype._correctButton = function(e, t) {
                            return 0 === t && e.ctrlKey || 2 === t
                        }
                        ,
                        t.prototype._move = function(e, t) {
                            var i = -.5 * (t.y - e.y);
                            if (i)
                                return this._active = !0,
                                {
                                    pitchDelta: i
                                }
                        }
                        ,
                        t.prototype.contextmenu = function(e) {
                            e.preventDefault()
                        }
                        ,
                        t
                    }(Hr)
                      , Xr = function(e) {
                        this._minTouches = 1,
                        this._clickTolerance = e.clickTolerance || 1,
                        this.reset()
                    };
                    Xr.prototype.reset = function() {
                        this._active = !1,
                        this._touches = {},
                        this._sum = new e.Point(0,0)
                    }
                    ,
                    Xr.prototype.touchstart = function(e, t, i) {
                        return this._calculateTransform(e, t, i)
                    }
                    ,
                    Xr.prototype.touchmove = function(e, t, i) {
                        if (this._active && !(i.length < this._minTouches))
                            return e.preventDefault(),
                            this._calculateTransform(e, t, i)
                    }
                    ,
                    Xr.prototype.touchend = function(e, t, i) {
                        this._calculateTransform(e, t, i),
                        this._active && i.length < this._minTouches && this.reset()
                    }
                    ,
                    Xr.prototype.touchcancel = function() {
                        this.reset()
                    }
                    ,
                    Xr.prototype._calculateTransform = function(t, i, r) {
                        r.length > 0 && (this._active = !0);
                        var n = Nr(r, i)
                          , a = new e.Point(0,0)
                          , o = new e.Point(0,0)
                          , s = 0;
                        for (var l in n) {
                            var u = n[l]
                              , c = this._touches[l];
                            c && (a._add(u),
                            o._add(u.sub(c)),
                            s++,
                            n[l] = u)
                        }
                        if (this._touches = n,
                        !(s < this._minTouches) && o.mag()) {
                            var h = o.div(s);
                            if (this._sum._add(h),
                            !(this._sum.mag() < this._clickTolerance))
                                return {
                                    around: a.div(s),
                                    panDelta: h
                                }
                        }
                    }
                    ,
                    Xr.prototype.enable = function() {
                        this._enabled = !0
                    }
                    ,
                    Xr.prototype.disable = function() {
                        this._enabled = !1,
                        this.reset()
                    }
                    ,
                    Xr.prototype.isEnabled = function() {
                        return this._enabled
                    }
                    ,
                    Xr.prototype.isActive = function() {
                        return this._active
                    }
                    ;
                    var Yr = function() {
                        this.reset()
                    };
                    function Kr(e, t, i) {
                        for (var r = 0; r < e.length; r++)
                            if (e[r].identifier === i)
                                return t[r]
                    }
                    function Jr(e, t) {
                        return Math.log(e / t) / Math.LN2
                    }
                    Yr.prototype.reset = function() {
                        this._active = !1,
                        delete this._firstTwoTouches
                    }
                    ,
                    Yr.prototype._start = function(e) {}
                    ,
                    Yr.prototype._move = function(e, t, i) {
                        return {}
                    }
                    ,
                    Yr.prototype.touchstart = function(e, t, i) {
                        this._firstTwoTouches || i.length < 2 || (this._firstTwoTouches = [i[0].identifier, i[1].identifier],
                        this._start([t[0], t[1]]))
                    }
                    ,
                    Yr.prototype.touchmove = function(e, t, i) {
                        if (this._firstTwoTouches) {
                            e.preventDefault();
                            var r = this._firstTwoTouches
                              , n = r[1]
                              , a = Kr(i, t, r[0])
                              , o = Kr(i, t, n);
                            if (a && o) {
                                var s = this._aroundCenter ? null : a.add(o).div(2);
                                return this._move([a, o], s, e)
                            }
                        }
                    }
                    ,
                    Yr.prototype.touchend = function(e, t, r) {
                        if (this._firstTwoTouches) {
                            var n = this._firstTwoTouches
                              , a = n[1]
                              , o = Kr(r, t, n[0])
                              , s = Kr(r, t, a);
                            o && s || (this._active && i.suppressClick(),
                            this.reset())
                        }
                    }
                    ,
                    Yr.prototype.touchcancel = function() {
                        this.reset()
                    }
                    ,
                    Yr.prototype.enable = function(e) {
                        this._enabled = !0,
                        this._aroundCenter = !!e && "center" === e.around
                    }
                    ,
                    Yr.prototype.disable = function() {
                        this._enabled = !1,
                        this.reset()
                    }
                    ,
                    Yr.prototype.isEnabled = function() {
                        return this._enabled
                    }
                    ,
                    Yr.prototype.isActive = function() {
                        return this._active
                    }
                    ;
                    var Qr = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.reset = function() {
                            e.prototype.reset.call(this),
                            delete this._distance,
                            delete this._startDistance
                        }
                        ,
                        t.prototype._start = function(e) {
                            this._startDistance = this._distance = e[0].dist(e[1])
                        }
                        ,
                        t.prototype._move = function(e, t) {
                            var i = this._distance;
                            if (this._distance = e[0].dist(e[1]),
                            this._active || !(Math.abs(Jr(this._distance, this._startDistance)) < .1))
                                return this._active = !0,
                                {
                                    zoomDelta: Jr(this._distance, i),
                                    pinchAround: t
                                }
                        }
                        ,
                        t
                    }(Yr);
                    function $r(e, t) {
                        return 180 * e.angleWith(t) / Math.PI
                    }
                    var en = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.reset = function() {
                            e.prototype.reset.call(this),
                            delete this._minDiameter,
                            delete this._startVector,
                            delete this._vector
                        }
                        ,
                        t.prototype._start = function(e) {
                            this._startVector = this._vector = e[0].sub(e[1]),
                            this._minDiameter = e[0].dist(e[1])
                        }
                        ,
                        t.prototype._move = function(e, t) {
                            var i = this._vector;
                            if (this._vector = e[0].sub(e[1]),
                            this._active || !this._isBelowThreshold(this._vector))
                                return this._active = !0,
                                {
                                    bearingDelta: $r(this._vector, i),
                                    pinchAround: t
                                }
                        }
                        ,
                        t.prototype._isBelowThreshold = function(e) {
                            this._minDiameter = Math.min(this._minDiameter, e.mag());
                            var t = 25 / (Math.PI * this._minDiameter) * 360
                              , i = $r(e, this._startVector);
                            return Math.abs(i) < t
                        }
                        ,
                        t
                    }(Yr);
                    function tn(e) {
                        return Math.abs(e.y) > Math.abs(e.x)
                    }
                    var rn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t.prototype.reset = function() {
                            e.prototype.reset.call(this),
                            this._valid = void 0,
                            delete this._firstMove,
                            delete this._lastPoints
                        }
                        ,
                        t.prototype._start = function(e) {
                            this._lastPoints = e,
                            tn(e[0].sub(e[1])) && (this._valid = !1)
                        }
                        ,
                        t.prototype._move = function(e, t, i) {
                            var r = e[0].sub(this._lastPoints[0])
                              , n = e[1].sub(this._lastPoints[1]);
                            if (this._valid = this.gestureBeginsVertically(r, n, i.timeStamp),
                            this._valid)
                                return this._lastPoints = e,
                                this._active = !0,
                                {
                                    pitchDelta: (r.y + n.y) / 2 * -.5
                                }
                        }
                        ,
                        t.prototype.gestureBeginsVertically = function(e, t, i) {
                            if (void 0 !== this._valid)
                                return this._valid;
                            var r = e.mag() >= 2
                              , n = t.mag() >= 2;
                            if (r || n) {
                                if (!r || !n)
                                    return void 0 === this._firstMove && (this._firstMove = i),
                                    i - this._firstMove < 100 && void 0;
                                var a = e.y > 0 == t.y > 0;
                                return tn(e) && tn(t) && a
                            }
                        }
                        ,
                        t
                    }(Yr)
                      , nn = {
                        panStep: 100,
                        bearingStep: 15,
                        pitchStep: 10
                    }
                      , an = function() {
                        var e = nn;
                        this._panStep = e.panStep,
                        this._bearingStep = e.bearingStep,
                        this._pitchStep = e.pitchStep,
                        this._rotationDisabled = !1
                    };
                    function on(e) {
                        return e * (2 - e)
                    }
                    an.prototype.reset = function() {
                        this._active = !1
                    }
                    ,
                    an.prototype.keydown = function(e) {
                        var t = this;
                        if (!(e.altKey || e.ctrlKey || e.metaKey)) {
                            var i = 0
                              , r = 0
                              , n = 0
                              , a = 0
                              , o = 0;
                            switch (e.keyCode) {
                            case 61:
                            case 107:
                            case 171:
                            case 187:
                                i = 1;
                                break;
                            case 189:
                            case 109:
                            case 173:
                                i = -1;
                                break;
                            case 37:
                                e.shiftKey ? r = -1 : (e.preventDefault(),
                                a = -1);
                                break;
                            case 39:
                                e.shiftKey ? r = 1 : (e.preventDefault(),
                                a = 1);
                                break;
                            case 38:
                                e.shiftKey ? n = 1 : (e.preventDefault(),
                                o = -1);
                                break;
                            case 40:
                                e.shiftKey ? n = -1 : (e.preventDefault(),
                                o = 1);
                                break;
                            default:
                                return
                            }
                            return this._rotationDisabled && (r = 0,
                            n = 0),
                            {
                                cameraAnimation: function(s) {
                                    var l = s.getZoom();
                                    s.easeTo({
                                        duration: 300,
                                        easeId: "keyboardHandler",
                                        easing: on,
                                        zoom: i ? Math.round(l) + i * (e.shiftKey ? 2 : 1) : l,
                                        bearing: s.getBearing() + r * t._bearingStep,
                                        pitch: s.getPitch() + n * t._pitchStep,
                                        offset: [-a * t._panStep, -o * t._panStep],
                                        center: s.getCenter()
                                    }, {
                                        originalEvent: e
                                    })
                                }
                            }
                        }
                    }
                    ,
                    an.prototype.enable = function() {
                        this._enabled = !0
                    }
                    ,
                    an.prototype.disable = function() {
                        this._enabled = !1,
                        this.reset()
                    }
                    ,
                    an.prototype.isEnabled = function() {
                        return this._enabled
                    }
                    ,
                    an.prototype.isActive = function() {
                        return this._active
                    }
                    ,
                    an.prototype.disableRotation = function() {
                        this._rotationDisabled = !0
                    }
                    ,
                    an.prototype.enableRotation = function() {
                        this._rotationDisabled = !1
                    }
                    ;
                    var sn = function(t, i) {
                        this._map = t,
                        this._el = t.getCanvasContainer(),
                        this._handler = i,
                        this._delta = 0,
                        this._defaultZoomRate = .01,
                        this._wheelZoomRate = 1 / 450,
                        e.bindAll(["_onTimeout"], this)
                    };
                    sn.prototype.setZoomRate = function(e) {
                        this._defaultZoomRate = e
                    }
                    ,
                    sn.prototype.setWheelZoomRate = function(e) {
                        this._wheelZoomRate = e
                    }
                    ,
                    sn.prototype.isEnabled = function() {
                        return !!this._enabled
                    }
                    ,
                    sn.prototype.isActive = function() {
                        return !!this._active || void 0 !== this._finishTimeout
                    }
                    ,
                    sn.prototype.isZooming = function() {
                        return !!this._zooming
                    }
                    ,
                    sn.prototype.enable = function(e) {
                        this.isEnabled() || (this._enabled = !0,
                        this._aroundCenter = e && "center" === e.around)
                    }
                    ,
                    sn.prototype.disable = function() {
                        this.isEnabled() && (this._enabled = !1)
                    }
                    ,
                    sn.prototype.wheel = function(t) {
                        if (this.isEnabled()) {
                            var i = t.deltaMode === e.window.WheelEvent.DOM_DELTA_LINE ? 40 * t.deltaY : t.deltaY
                              , r = e.browser.now()
                              , n = r - (this._lastWheelEventTime || 0);
                            this._lastWheelEventTime = r,
                            0 !== i && i % 4.000244140625 == 0 ? this._type = "wheel" : 0 !== i && Math.abs(i) < 4 ? this._type = "trackpad" : n > 400 ? (this._type = null,
                            this._lastValue = i,
                            this._timeout = setTimeout(this._onTimeout, 40, t)) : this._type || (this._type = Math.abs(n * i) < 200 ? "trackpad" : "wheel",
                            this._timeout && (clearTimeout(this._timeout),
                            this._timeout = null,
                            i += this._lastValue)),
                            t.shiftKey && i && (i /= 4),
                            this._type && (this._lastWheelEvent = t,
                            this._delta -= i,
                            this._active || this._start(t)),
                            t.preventDefault()
                        }
                    }
                    ,
                    sn.prototype._onTimeout = function(e) {
                        this._type = "wheel",
                        this._delta -= this._lastValue,
                        this._active || this._start(e)
                    }
                    ,
                    sn.prototype._start = function(t) {
                        if (this._delta) {
                            this._frameId && (this._frameId = null),
                            this._active = !0,
                            this.isZooming() || (this._zooming = !0),
                            this._finishTimeout && (clearTimeout(this._finishTimeout),
                            delete this._finishTimeout);
                            var r = i.mousePos(this._el, t);
                            this._around = e.LngLat.convert(this._aroundCenter ? this._map.getCenter() : this._map.unproject(r)),
                            this._aroundPoint = this._map.transform.locationPoint(this._around),
                            this._frameId || (this._frameId = !0,
                            this._handler._triggerRenderFrame())
                        }
                    }
                    ,
                    sn.prototype.renderFrame = function() {
                        var t = this;
                        if (this._frameId && (this._frameId = null,
                        this.isActive())) {
                            var i = this._map.transform;
                            if (0 !== this._delta) {
                                var r = "wheel" === this._type && Math.abs(this._delta) > 4.000244140625 ? this._wheelZoomRate : this._defaultZoomRate
                                  , n = 2 / (1 + Math.exp(-Math.abs(this._delta * r)));
                                this._delta < 0 && 0 !== n && (n = 1 / n);
                                var a = "number" == typeof this._targetZoom ? i.zoomScale(this._targetZoom) : i.scale;
                                this._targetZoom = Math.min(i.maxZoom, Math.max(i.minZoom, i.scaleZoom(a * n))),
                                "wheel" === this._type && (this._startZoom = i.zoom,
                                this._easing = this._smoothOutEasing(200)),
                                this._delta = 0
                            }
                            var o, s = "number" == typeof this._targetZoom ? this._targetZoom : i.zoom, l = this._startZoom, u = this._easing, c = !1;
                            if ("wheel" === this._type && l && u) {
                                var h = Math.min((e.browser.now() - this._lastWheelEventTime) / 200, 1)
                                  , p = u(h);
                                o = e.number(l, s, p),
                                h < 1 ? this._frameId || (this._frameId = !0) : c = !0
                            } else
                                o = s,
                                c = !0;
                            return this._active = !0,
                            c && (this._active = !1,
                            this._finishTimeout = setTimeout((function() {
                                t._zooming = !1,
                                t._handler._triggerRenderFrame(),
                                delete t._targetZoom,
                                delete t._finishTimeout
                            }
                            ), 200)),
                            {
                                noInertia: !0,
                                needsRenderFrame: !c,
                                zoomDelta: o - i.zoom,
                                around: this._aroundPoint,
                                originalEvent: this._lastWheelEvent
                            }
                        }
                    }
                    ,
                    sn.prototype._smoothOutEasing = function(t) {
                        var i = e.ease;
                        if (this._prevEase) {
                            var r = this._prevEase
                              , n = (e.browser.now() - r.start) / r.duration
                              , a = r.easing(n + .01) - r.easing(n)
                              , o = .27 / Math.sqrt(a * a + 1e-4) * .01
                              , s = Math.sqrt(.0729 - o * o);
                            i = e.bezier(o, s, .25, 1)
                        }
                        return this._prevEase = {
                            start: e.browser.now(),
                            duration: t,
                            easing: i
                        },
                        i
                    }
                    ,
                    sn.prototype.reset = function() {
                        this._active = !1
                    }
                    ;
                    var ln = function(e, t) {
                        this._clickZoom = e,
                        this._tapZoom = t
                    };
                    ln.prototype.enable = function() {
                        this._clickZoom.enable(),
                        this._tapZoom.enable()
                    }
                    ,
                    ln.prototype.disable = function() {
                        this._clickZoom.disable(),
                        this._tapZoom.disable()
                    }
                    ,
                    ln.prototype.isEnabled = function() {
                        return this._clickZoom.isEnabled() && this._tapZoom.isEnabled()
                    }
                    ,
                    ln.prototype.isActive = function() {
                        return this._clickZoom.isActive() || this._tapZoom.isActive()
                    }
                    ;
                    var un = function() {
                        this.reset()
                    };
                    un.prototype.reset = function() {
                        this._active = !1
                    }
                    ,
                    un.prototype.dblclick = function(e, t) {
                        return e.preventDefault(),
                        {
                            cameraAnimation: function(i) {
                                i.easeTo({
                                    duration: 300,
                                    zoom: i.getZoom() + (e.shiftKey ? -1 : 1),
                                    around: i.unproject(t)
                                }, {
                                    originalEvent: e
                                })
                            }
                        }
                    }
                    ,
                    un.prototype.enable = function() {
                        this._enabled = !0
                    }
                    ,
                    un.prototype.disable = function() {
                        this._enabled = !1,
                        this.reset()
                    }
                    ,
                    un.prototype.isEnabled = function() {
                        return this._enabled
                    }
                    ,
                    un.prototype.isActive = function() {
                        return this._active
                    }
                    ;
                    var cn = function() {
                        this._tap = new Vr({
                            numTouches: 1,
                            numTaps: 1
                        }),
                        this.reset()
                    };
                    cn.prototype.reset = function() {
                        this._active = !1,
                        delete this._swipePoint,
                        delete this._swipeTouch,
                        delete this._tapTime,
                        this._tap.reset()
                    }
                    ,
                    cn.prototype.touchstart = function(e, t, i) {
                        this._swipePoint || (this._tapTime && e.timeStamp - this._tapTime > 500 && this.reset(),
                        this._tapTime ? i.length > 0 && (this._swipePoint = t[0],
                        this._swipeTouch = i[0].identifier) : this._tap.touchstart(e, t, i))
                    }
                    ,
                    cn.prototype.touchmove = function(e, t, i) {
                        if (this._tapTime) {
                            if (this._swipePoint) {
                                if (i[0].identifier !== this._swipeTouch)
                                    return;
                                var r = t[0]
                                  , n = r.y - this._swipePoint.y;
                                return this._swipePoint = r,
                                e.preventDefault(),
                                this._active = !0,
                                {
                                    zoomDelta: n / 128
                                }
                            }
                        } else
                            this._tap.touchmove(e, t, i)
                    }
                    ,
                    cn.prototype.touchend = function(e, t, i) {
                        this._tapTime ? this._swipePoint && 0 === i.length && this.reset() : this._tap.touchend(e, t, i) && (this._tapTime = e.timeStamp)
                    }
                    ,
                    cn.prototype.touchcancel = function() {
                        this.reset()
                    }
                    ,
                    cn.prototype.enable = function() {
                        this._enabled = !0
                    }
                    ,
                    cn.prototype.disable = function() {
                        this._enabled = !1,
                        this.reset()
                    }
                    ,
                    cn.prototype.isEnabled = function() {
                        return this._enabled
                    }
                    ,
                    cn.prototype.isActive = function() {
                        return this._active
                    }
                    ;
                    var hn = function(e, t, i) {
                        this._el = e,
                        this._mousePan = t,
                        this._touchPan = i
                    };
                    hn.prototype.enable = function(e) {
                        this._inertiaOptions = e || {},
                        this._mousePan.enable(),
                        this._touchPan.enable(),
                        this._el.classList.add("mapboxgl-touch-drag-pan")
                    }
                    ,
                    hn.prototype.disable = function() {
                        this._mousePan.disable(),
                        this._touchPan.disable(),
                        this._el.classList.remove("mapboxgl-touch-drag-pan")
                    }
                    ,
                    hn.prototype.isEnabled = function() {
                        return this._mousePan.isEnabled() && this._touchPan.isEnabled()
                    }
                    ,
                    hn.prototype.isActive = function() {
                        return this._mousePan.isActive() || this._touchPan.isActive()
                    }
                    ;
                    var pn = function(e, t, i) {
                        this._pitchWithRotate = e.pitchWithRotate,
                        this._mouseRotate = t,
                        this._mousePitch = i
                    };
                    pn.prototype.enable = function() {
                        this._mouseRotate.enable(),
                        this._pitchWithRotate && this._mousePitch.enable()
                    }
                    ,
                    pn.prototype.disable = function() {
                        this._mouseRotate.disable(),
                        this._mousePitch.disable()
                    }
                    ,
                    pn.prototype.isEnabled = function() {
                        return this._mouseRotate.isEnabled() && (!this._pitchWithRotate || this._mousePitch.isEnabled())
                    }
                    ,
                    pn.prototype.isActive = function() {
                        return this._mouseRotate.isActive() || this._mousePitch.isActive()
                    }
                    ;
                    var fn = function(e, t, i, r) {
                        this._el = e,
                        this._touchZoom = t,
                        this._touchRotate = i,
                        this._tapDragZoom = r,
                        this._rotationDisabled = !1,
                        this._enabled = !0
                    };
                    fn.prototype.enable = function(e) {
                        this._touchZoom.enable(e),
                        this._rotationDisabled || this._touchRotate.enable(e),
                        this._tapDragZoom.enable(),
                        this._el.classList.add("mapboxgl-touch-zoom-rotate")
                    }
                    ,
                    fn.prototype.disable = function() {
                        this._touchZoom.disable(),
                        this._touchRotate.disable(),
                        this._tapDragZoom.disable(),
                        this._el.classList.remove("mapboxgl-touch-zoom-rotate")
                    }
                    ,
                    fn.prototype.isEnabled = function() {
                        return this._touchZoom.isEnabled() && (this._rotationDisabled || this._touchRotate.isEnabled()) && this._tapDragZoom.isEnabled()
                    }
                    ,
                    fn.prototype.isActive = function() {
                        return this._touchZoom.isActive() || this._touchRotate.isActive() || this._tapDragZoom.isActive()
                    }
                    ,
                    fn.prototype.disableRotation = function() {
                        this._rotationDisabled = !0,
                        this._touchRotate.disable()
                    }
                    ,
                    fn.prototype.enableRotation = function() {
                        this._rotationDisabled = !1,
                        this._touchZoom.isEnabled() && this._touchRotate.enable()
                    }
                    ;
                    var dn = function(e) {
                        return e.zoom || e.drag || e.pitch || e.rotate
                    }
                      , mn = function(e) {
                        function t() {
                            e.apply(this, arguments)
                        }
                        return e && (t.__proto__ = e),
                        (t.prototype = Object.create(e && e.prototype)).constructor = t,
                        t
                    }(e.Event);
                    function vn(e) {
                        return e.panDelta && e.panDelta.mag() || e.zoomDelta || e.bearingDelta || e.pitchDelta
                    }
                    var gn = function(t, r) {
                        this._map = t,
                        this._el = this._map.getCanvasContainer(),
                        this._handlers = [],
                        this._handlersById = {},
                        this._changes = [],
                        this._inertia = new Lr(t),
                        this._bearingSnap = r.bearingSnap,
                        this._previousActiveHandlers = {},
                        this._eventsInProgress = {},
                        this._addDefaultHandlers(r),
                        e.bindAll(["handleEvent", "handleWindowEvent"], this);
                        var n = this._el;
                        this._listeners = [[n, "touchstart", {
                            passive: !0
                        }], [n, "touchmove", {
                            passive: !1
                        }], [n, "touchend", void 0], [n, "touchcancel", void 0], [n, "mousedown", void 0], [n, "mousemove", void 0], [n, "mouseup", void 0], [e.window.document, "mousemove", {
                            capture: !0
                        }], [e.window.document, "mouseup", void 0], [n, "mouseover", void 0], [n, "mouseout", void 0], [n, "dblclick", void 0], [n, "click", void 0], [n, "keydown", {
                            capture: !1
                        }], [n, "keyup", void 0], [n, "wheel", {
                            passive: !1
                        }], [n, "contextmenu", void 0], [e.window, "blur", void 0]];
                        for (var a = 0, o = this._listeners; a < o.length; a += 1) {
                            var s = o[a]
                              , l = s[0];
                            i.addEventListener(l, s[1], l === e.window.document ? this.handleWindowEvent : this.handleEvent, s[2])
                        }
                    };
                    gn.prototype.destroy = function() {
                        for (var t = 0, r = this._listeners; t < r.length; t += 1) {
                            var n = r[t]
                              , a = n[0];
                            i.removeEventListener(a, n[1], a === e.window.document ? this.handleWindowEvent : this.handleEvent, n[2])
                        }
                    }
                    ,
                    gn.prototype._addDefaultHandlers = function(e) {
                        var t = this._map
                          , i = t.getCanvasContainer();
                        this._add("mapEvent", new Or(t,e));
                        var r = t.boxZoom = new Fr(t,e);
                        this._add("boxZoom", r);
                        var n = new Gr
                          , a = new un;
                        t.doubleClickZoom = new ln(a,n),
                        this._add("tapZoom", n),
                        this._add("clickZoom", a);
                        var o = new cn;
                        this._add("tapDragZoom", o);
                        var s = t.touchPitch = new rn;
                        this._add("touchPitch", s);
                        var l = new Wr(e)
                          , u = new Zr(e);
                        t.dragRotate = new pn(e,l,u),
                        this._add("mouseRotate", l, ["mousePitch"]),
                        this._add("mousePitch", u, ["mouseRotate"]);
                        var c = new qr(e)
                          , h = new Xr(e);
                        t.dragPan = new hn(i,c,h),
                        this._add("mousePan", c),
                        this._add("touchPan", h, ["touchZoom", "touchRotate"]);
                        var p = new en
                          , f = new Qr;
                        t.touchZoomRotate = new fn(i,f,p,o),
                        this._add("touchRotate", p, ["touchPan", "touchZoom"]),
                        this._add("touchZoom", f, ["touchPan", "touchRotate"]);
                        var d = t.scrollZoom = new sn(t,this);
                        this._add("scrollZoom", d, ["mousePan"]);
                        var m = t.keyboard = new an;
                        this._add("keyboard", m),
                        this._add("blockableMapEvent", new Br(t));
                        for (var v = 0, g = ["boxZoom", "doubleClickZoom", "tapDragZoom", "touchPitch", "dragRotate", "dragPan", "touchZoomRotate", "scrollZoom", "keyboard"]; v < g.length; v += 1) {
                            var y = g[v];
                            e.interactive && e[y] && t[y].enable(e[y])
                        }
                    }
                    ,
                    gn.prototype._add = function(e, t, i) {
                        this._handlers.push({
                            handlerName: e,
                            handler: t,
                            allowed: i
                        }),
                        this._handlersById[e] = t
                    }
                    ,
                    gn.prototype.stop = function(e) {
                        if (!this._updatingCamera) {
                            for (var t = 0, i = this._handlers; t < i.length; t += 1)
                                i[t].handler.reset();
                            this._inertia.clear(),
                            this._fireEvents({}, {}, e),
                            this._changes = []
                        }
                    }
                    ,
                    gn.prototype.isActive = function() {
                        for (var e = 0, t = this._handlers; e < t.length; e += 1)
                            if (t[e].handler.isActive())
                                return !0;
                        return !1
                    }
                    ,
                    gn.prototype.isZooming = function() {
                        return !!this._eventsInProgress.zoom || this._map.scrollZoom.isZooming()
                    }
                    ,
                    gn.prototype.isRotating = function() {
                        return !!this._eventsInProgress.rotate
                    }
                    ,
                    gn.prototype.isMoving = function() {
                        return Boolean(dn(this._eventsInProgress)) || this.isZooming()
                    }
                    ,
                    gn.prototype._blockedByActive = function(e, t, i) {
                        for (var r in e)
                            if (r !== i && (!t || t.indexOf(r) < 0))
                                return !0;
                        return !1
                    }
                    ,
                    gn.prototype.handleWindowEvent = function(e) {
                        this.handleEvent(e, e.type + "Window")
                    }
                    ,
                    gn.prototype._getMapTouches = function(e) {
                        for (var t = [], i = 0, r = e; i < r.length; i += 1) {
                            var n = r[i];
                            this._el.contains(n.target) && t.push(n)
                        }
                        return t
                    }
                    ,
                    gn.prototype.handleEvent = function(e, t) {
                        if ("blur" !== e.type) {
                            this._updatingCamera = !0;
                            for (var r = "renderFrame" === e.type ? void 0 : e, n = {
                                needsRenderFrame: !1
                            }, a = {}, o = {}, s = e.touches ? this._getMapTouches(e.touches) : void 0, l = s ? i.touchPos(this._el, s) : i.mousePos(this._el, e), u = 0, c = this._handlers; u < c.length; u += 1) {
                                var h = c[u]
                                  , p = h.handlerName
                                  , f = h.handler
                                  , d = h.allowed;
                                if (f.isEnabled()) {
                                    var m = void 0;
                                    this._blockedByActive(o, d, p) ? f.reset() : f[t || e.type] && (m = f[t || e.type](e, l, s),
                                    this.mergeHandlerResult(n, a, m, p, r),
                                    m && m.needsRenderFrame && this._triggerRenderFrame()),
                                    (m || f.isActive()) && (o[p] = f)
                                }
                            }
                            var v = {};
                            for (var g in this._previousActiveHandlers)
                                o[g] || (v[g] = r);
                            this._previousActiveHandlers = o,
                            (Object.keys(v).length || vn(n)) && (this._changes.push([n, a, v]),
                            this._triggerRenderFrame()),
                            (Object.keys(o).length || vn(n)) && this._map._stop(!0),
                            this._updatingCamera = !1;
                            var y = n.cameraAnimation;
                            y && (this._inertia.clear(),
                            this._fireEvents({}, {}, !0),
                            this._changes = [],
                            y(this._map))
                        } else
                            this.stop(!0)
                    }
                    ,
                    gn.prototype.mergeHandlerResult = function(t, i, r, n, a) {
                        if (r) {
                            e.extend(t, r);
                            var o = {
                                handlerName: n,
                                originalEvent: r.originalEvent || a
                            };
                            void 0 !== r.zoomDelta && (i.zoom = o),
                            void 0 !== r.panDelta && (i.drag = o),
                            void 0 !== r.pitchDelta && (i.pitch = o),
                            void 0 !== r.bearingDelta && (i.rotate = o)
                        }
                    }
                    ,
                    gn.prototype._applyChanges = function() {
                        for (var t = {}, i = {}, r = {}, n = 0, a = this._changes; n < a.length; n += 1) {
                            var o = a[n]
                              , s = o[0]
                              , l = o[1]
                              , u = o[2];
                            s.panDelta && (t.panDelta = (t.panDelta || new e.Point(0,0))._add(s.panDelta)),
                            s.zoomDelta && (t.zoomDelta = (t.zoomDelta || 0) + s.zoomDelta),
                            s.bearingDelta && (t.bearingDelta = (t.bearingDelta || 0) + s.bearingDelta),
                            s.pitchDelta && (t.pitchDelta = (t.pitchDelta || 0) + s.pitchDelta),
                            void 0 !== s.around && (t.around = s.around),
                            void 0 !== s.pinchAround && (t.pinchAround = s.pinchAround),
                            s.noInertia && (t.noInertia = s.noInertia),
                            e.extend(i, l),
                            e.extend(r, u)
                        }
                        this._updateMapTransform(t, i, r),
                        this._changes = []
                    }
                    ,
                    gn.prototype._updateMapTransform = function(e, t, i) {
                        var r = this._map
                          , n = r.transform;
                        if (!vn(e))
                            return this._fireEvents(t, i, !0);
                        var a = e.panDelta
                          , o = e.zoomDelta
                          , s = e.bearingDelta
                          , l = e.pitchDelta
                          , u = e.around
                          , c = e.pinchAround;
                        void 0 !== c && (u = c),
                        r._stop(!0),
                        u = u || r.transform.centerPoint;
                        var h = n.pointLocation(a ? u.sub(a) : u);
                        s && (n.bearing += s),
                        l && (n.pitch += l),
                        o && (n.zoom += o),
                        n.setLocationAtPoint(h, u),
                        this._map._update(),
                        e.noInertia || this._inertia.record(e),
                        this._fireEvents(t, i, !0)
                    }
                    ,
                    gn.prototype._fireEvents = function(t, i, r) {
                        var n = this
                          , a = dn(this._eventsInProgress)
                          , o = dn(t)
                          , s = {};
                        for (var l in t)
                            this._eventsInProgress[l] || (s[l + "start"] = t[l].originalEvent),
                            this._eventsInProgress[l] = t[l];
                        for (var u in !a && o && this._fireEvent("movestart", o.originalEvent),
                        s)
                            this._fireEvent(u, s[u]);
                        for (var c in o && this._fireEvent("move", o.originalEvent),
                        t)
                            this._fireEvent(c, t[c].originalEvent);
                        var h, p = {};
                        for (var f in this._eventsInProgress) {
                            var d = this._eventsInProgress[f]
                              , m = d.handlerName
                              , v = d.originalEvent;
                            this._handlersById[m].isActive() || (delete this._eventsInProgress[f],
                            p[f + "end"] = h = i[m] || v)
                        }
                        for (var g in p)
                            this._fireEvent(g, p[g]);
                        var y = dn(this._eventsInProgress);
                        if (r && (a || o) && !y) {
                            this._updatingCamera = !0;
                            var _ = this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions)
                              , x = function(e) {
                                return 0 !== e && -n._bearingSnap < e && e < n._bearingSnap
                            };
                            _ ? (x(_.bearing || this._map.getBearing()) && (_.bearing = 0),
                            this._map.easeTo(_, {
                                originalEvent: h
                            })) : (this._map.fire(new e.Event("moveend",{
                                originalEvent: h
                            })),
                            x(this._map.getBearing()) && this._map.resetNorth()),
                            this._updatingCamera = !1
                        }
                    }
                    ,
                    gn.prototype._fireEvent = function(t, i) {
                        this._map.fire(new e.Event(t,i ? {
                            originalEvent: i
                        } : {}))
                    }
                    ,
                    gn.prototype._requestFrame = function() {
                        var e = this;
                        return this._map.triggerRepaint(),
                        this._map._renderTaskQueue.add((function(t) {
                            delete e._frameId,
                            e.handleEvent(new mn("renderFrame",{
                                timeStamp: t
                            })),
                            e._applyChanges()
                        }
                        ))
                    }
                    ,
                    gn.prototype._triggerRenderFrame = function() {
                        void 0 === this._frameId && (this._frameId = this._requestFrame())
                    }
                    ;
                    var yn = function(t) {
                        function i(i, r) {
                            t.call(this),
                            this._moving = !1,
                            this._zooming = !1,
                            this.transform = i,
                            this._bearingSnap = r.bearingSnap,
                            e.bindAll(["_renderFrameCallback"], this)
                        }
                        return t && (i.__proto__ = t),
                        (i.prototype = Object.create(t && t.prototype)).constructor = i,
                        i.prototype.getCenter = function() {
                            return new e.LngLat(this.transform.center.lng,this.transform.center.lat)
                        }
                        ,
                        i.prototype.setCenter = function(e, t) {
                            return this.jumpTo({
                                center: e
                            }, t)
                        }
                        ,
                        i.prototype.panBy = function(t, i, r) {
                            return t = e.Point.convert(t).mult(-1),
                            this.panTo(this.transform.center, e.extend({
                                offset: t
                            }, i), r)
                        }
                        ,
                        i.prototype.panTo = function(t, i, r) {
                            return this.easeTo(e.extend({
                                center: t
                            }, i), r)
                        }
                        ,
                        i.prototype.getZoom = function() {
                            return this.transform.zoom
                        }
                        ,
                        i.prototype.setZoom = function(e, t) {
                            return this.jumpTo({
                                zoom: e
                            }, t),
                            this
                        }
                        ,
                        i.prototype.zoomTo = function(t, i, r) {
                            return this.easeTo(e.extend({
                                zoom: t
                            }, i), r)
                        }
                        ,
                        i.prototype.zoomIn = function(e, t) {
                            return this.zoomTo(this.getZoom() + 1, e, t),
                            this
                        }
                        ,
                        i.prototype.zoomOut = function(e, t) {
                            return this.zoomTo(this.getZoom() - 1, e, t),
                            this
                        }
                        ,
                        i.prototype.getBearing = function() {
                            return this.transform.bearing
                        }
                        ,
                        i.prototype.setBearing = function(e, t) {
                            return this.jumpTo({
                                bearing: e
                            }, t),
                            this
                        }
                        ,
                        i.prototype.getPadding = function() {
                            return this.transform.padding
                        }
                        ,
                        i.prototype.setPadding = function(e, t) {
                            return this.jumpTo({
                                padding: e
                            }, t),
                            this
                        }
                        ,
                        i.prototype.rotateTo = function(t, i, r) {
                            return this.easeTo(e.extend({
                                bearing: t
                            }, i), r)
                        }
                        ,
                        i.prototype.resetNorth = function(t, i) {
                            return this.rotateTo(0, e.extend({
                                duration: 1e3
                            }, t), i),
                            this
                        }
                        ,
                        i.prototype.resetNorthPitch = function(t, i) {
                            return this.easeTo(e.extend({
                                bearing: 0,
                                pitch: 0,
                                duration: 1e3
                            }, t), i),
                            this
                        }
                        ,
                        i.prototype.snapToNorth = function(e, t) {
                            return Math.abs(this.getBearing()) < this._bearingSnap ? this.resetNorth(e, t) : this
                        }
                        ,
                        i.prototype.getPitch = function() {
                            return this.transform.pitch
                        }
                        ,
                        i.prototype.setPitch = function(e, t) {
                            return this.jumpTo({
                                pitch: e
                            }, t),
                            this
                        }
                        ,
                        i.prototype.cameraForBounds = function(t, i) {
                            t = e.LngLatBounds.convert(t);
                            var r = i && i.bearing || 0;
                            return this._cameraForBoxAndBearing(t.getNorthWest(), t.getSouthEast(), r, i)
                        }
                        ,
                        i.prototype._cameraForBoxAndBearing = function(t, i, r, n) {
                            var a = {
                                top: 0,
                                bottom: 0,
                                right: 0,
                                left: 0
                            };
                            if ("number" == typeof (n = e.extend({
                                padding: a,
                                offset: [0, 0],
                                maxZoom: this.transform.maxZoom
                            }, n)).padding) {
                                var o = n.padding;
                                n.padding = {
                                    top: o,
                                    bottom: o,
                                    right: o,
                                    left: o
                                }
                            }
                            n.padding = e.extend(a, n.padding);
                            var s = this.transform
                              , l = s.padding
                              , u = s.project(e.LngLat.convert(t))
                              , c = s.project(e.LngLat.convert(i))
                              , h = u.rotate(-r * Math.PI / 180)
                              , p = c.rotate(-r * Math.PI / 180)
                              , f = new e.Point(Math.max(h.x, p.x),Math.max(h.y, p.y))
                              , d = new e.Point(Math.min(h.x, p.x),Math.min(h.y, p.y))
                              , m = f.sub(d)
                              , v = (s.width - (l.left + l.right + n.padding.left + n.padding.right)) / m.x
                              , g = (s.height - (l.top + l.bottom + n.padding.top + n.padding.bottom)) / m.y;
                            if (!(g < 0 || v < 0)) {
                                var y = Math.min(s.scaleZoom(s.scale * Math.min(v, g)), n.maxZoom)
                                  , _ = "number" == typeof n.offset.x ? new e.Point(n.offset.x,n.offset.y) : e.Point.convert(n.offset)
                                  , x = new e.Point((n.padding.left - n.padding.right) / 2,(n.padding.top - n.padding.bottom) / 2).rotate(r * Math.PI / 180)
                                  , b = _.add(x).mult(s.scale / s.zoomScale(y));
                                return {
                                    center: s.unproject(u.add(c).div(2).sub(b)),
                                    zoom: y,
                                    bearing: r
                                }
                            }
                            e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")
                        }
                        ,
                        i.prototype.fitBounds = function(e, t, i) {
                            return this._fitInternal(this.cameraForBounds(e, t), t, i)
                        }
                        ,
                        i.prototype.fitScreenCoordinates = function(t, i, r, n, a) {
                            return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(t)), this.transform.pointLocation(e.Point.convert(i)), r, n), n, a)
                        }
                        ,
                        i.prototype._fitInternal = function(t, i, r) {
                            return t ? (delete (i = e.extend(t, i)).padding,
                            i.linear ? this.easeTo(i, r) : this.flyTo(i, r)) : this
                        }
                        ,
                        i.prototype.jumpTo = function(t, i) {
                            this.stop();
                            var r = this.transform
                              , n = !1
                              , a = !1
                              , o = !1;
                            return "zoom"in t && r.zoom !== +t.zoom && (n = !0,
                            r.zoom = +t.zoom),
                            void 0 !== t.center && (r.center = e.LngLat.convert(t.center)),
                            "bearing"in t && r.bearing !== +t.bearing && (a = !0,
                            r.bearing = +t.bearing),
                            "pitch"in t && r.pitch !== +t.pitch && (o = !0,
                            r.pitch = +t.pitch),
                            null == t.padding || r.isPaddingEqual(t.padding) || (r.padding = t.padding),
                            this.fire(new e.Event("movestart",i)).fire(new e.Event("move",i)),
                            n && this.fire(new e.Event("zoomstart",i)).fire(new e.Event("zoom",i)).fire(new e.Event("zoomend",i)),
                            a && this.fire(new e.Event("rotatestart",i)).fire(new e.Event("rotate",i)).fire(new e.Event("rotateend",i)),
                            o && this.fire(new e.Event("pitchstart",i)).fire(new e.Event("pitch",i)).fire(new e.Event("pitchend",i)),
                            this.fire(new e.Event("moveend",i))
                        }
                        ,
                        i.prototype.easeTo = function(t, i) {
                            var r = this;
                            this._stop(!1, t.easeId),
                            (!1 === (t = e.extend({
                                offset: [0, 0],
                                duration: 500,
                                easing: e.ease
                            }, t)).animate || !t.essential && e.browser.prefersReducedMotion) && (t.duration = 0);
                            var n = this.transform
                              , a = this.getZoom()
                              , o = this.getBearing()
                              , s = this.getPitch()
                              , l = this.getPadding()
                              , u = "zoom"in t ? +t.zoom : a
                              , c = "bearing"in t ? this._normalizeBearing(t.bearing, o) : o
                              , h = "pitch"in t ? +t.pitch : s
                              , p = "padding"in t ? t.padding : n.padding
                              , f = e.Point.convert(t.offset)
                              , d = n.centerPoint.add(f)
                              , m = n.pointLocation(d)
                              , v = e.LngLat.convert(t.center || m);
                            this._normalizeCenter(v);
                            var g, y, _ = n.project(m), x = n.project(v).sub(_), b = n.zoomScale(u - a);
                            t.around && (g = e.LngLat.convert(t.around),
                            y = n.locationPoint(g));
                            var w = {
                                moving: this._moving,
                                zooming: this._zooming,
                                rotating: this._rotating,
                                pitching: this._pitching
                            };
                            return this._zooming = this._zooming || u !== a,
                            this._rotating = this._rotating || o !== c,
                            this._pitching = this._pitching || h !== s,
                            this._padding = !n.isPaddingEqual(p),
                            this._easeId = t.easeId,
                            this._prepareEase(i, t.noMoveStart, w),
                            this._ease((function(t) {
                                if (r._zooming && (n.zoom = e.number(a, u, t)),
                                r._rotating && (n.bearing = e.number(o, c, t)),
                                r._pitching && (n.pitch = e.number(s, h, t)),
                                r._padding && (n.interpolatePadding(l, p, t),
                                d = n.centerPoint.add(f)),
                                g)
                                    n.setLocationAtPoint(g, y);
                                else {
                                    var m = n.zoomScale(n.zoom - a)
                                      , v = u > a ? Math.min(2, b) : Math.max(.5, b)
                                      , w = Math.pow(v, 1 - t)
                                      , S = n.unproject(_.add(x.mult(t * w)).mult(m));
                                    n.setLocationAtPoint(n.renderWorldCopies ? S.wrap() : S, d)
                                }
                                r._fireMoveEvents(i)
                            }
                            ), (function(e) {
                                r._afterEase(i, e)
                            }
                            ), t),
                            this
                        }
                        ,
                        i.prototype._prepareEase = function(t, i, r) {
                            void 0 === r && (r = {}),
                            this._moving = !0,
                            i || r.moving || this.fire(new e.Event("movestart",t)),
                            this._zooming && !r.zooming && this.fire(new e.Event("zoomstart",t)),
                            this._rotating && !r.rotating && this.fire(new e.Event("rotatestart",t)),
                            this._pitching && !r.pitching && this.fire(new e.Event("pitchstart",t))
                        }
                        ,
                        i.prototype._fireMoveEvents = function(t) {
                            this.fire(new e.Event("move",t)),
                            this._zooming && this.fire(new e.Event("zoom",t)),
                            this._rotating && this.fire(new e.Event("rotate",t)),
                            this._pitching && this.fire(new e.Event("pitch",t))
                        }
                        ,
                        i.prototype._afterEase = function(t, i) {
                            if (!this._easeId || !i || this._easeId !== i) {
                                delete this._easeId;
                                var r = this._zooming
                                  , n = this._rotating
                                  , a = this._pitching;
                                this._moving = !1,
                                this._zooming = !1,
                                this._rotating = !1,
                                this._pitching = !1,
                                this._padding = !1,
                                r && this.fire(new e.Event("zoomend",t)),
                                n && this.fire(new e.Event("rotateend",t)),
                                a && this.fire(new e.Event("pitchend",t)),
                                this.fire(new e.Event("moveend",t))
                            }
                        }
                        ,
                        i.prototype.flyTo = function(t, i) {
                            var r = this;
                            if (!t.essential && e.browser.prefersReducedMotion) {
                                var n = e.pick(t, ["center", "zoom", "bearing", "pitch", "around"]);
                                return this.jumpTo(n, i)
                            }
                            this.stop(),
                            t = e.extend({
                                offset: [0, 0],
                                speed: 1.2,
                                curve: 1.42,
                                easing: e.ease
                            }, t);
                            var a = this.transform
                              , o = this.getZoom()
                              , s = this.getBearing()
                              , l = this.getPitch()
                              , u = this.getPadding()
                              , c = "zoom"in t ? e.clamp(+t.zoom, a.minZoom, a.maxZoom) : o
                              , h = "bearing"in t ? this._normalizeBearing(t.bearing, s) : s
                              , p = "pitch"in t ? +t.pitch : l
                              , f = "padding"in t ? t.padding : a.padding
                              , d = a.zoomScale(c - o)
                              , m = e.Point.convert(t.offset)
                              , v = a.centerPoint.add(m)
                              , g = a.pointLocation(v)
                              , y = e.LngLat.convert(t.center || g);
                            this._normalizeCenter(y);
                            var _ = a.project(g)
                              , x = a.project(y).sub(_)
                              , b = t.curve
                              , w = Math.max(a.width, a.height)
                              , S = w / d
                              , M = x.mag();
                            if ("minZoom"in t) {
                                var T = e.clamp(Math.min(t.minZoom, o, c), a.minZoom, a.maxZoom)
                                  , E = w / a.zoomScale(T - o);
                                b = Math.sqrt(E / M * 2)
                            }
                            var A = b * b;
                            function P(e) {
                                var t = (S * S - w * w + (e ? -1 : 1) * A * A * M * M) / (2 * (e ? S : w) * A * M);
                                return Math.log(Math.sqrt(t * t + 1) - t)
                            }
                            function C(e) {
                                return (Math.exp(e) - Math.exp(-e)) / 2
                            }
                            function L(e) {
                                return (Math.exp(e) + Math.exp(-e)) / 2
                            }
                            var I = P(0)
                              , k = function(e) {
                                return L(I) / L(I + b * e)
                            }
                              , z = function(e) {
                                return w * ((L(I) * (C(t = I + b * e) / L(t)) - C(I)) / A) / M;
                                var t
                            }
                              , D = (P(1) - I) / b;
                            if (Math.abs(M) < 1e-6 || !isFinite(D)) {
                                if (Math.abs(w - S) < 1e-6)
                                    return this.easeTo(t, i);
                                var R = S < w ? -1 : 1;
                                D = Math.abs(Math.log(S / w)) / b,
                                z = function() {
                                    return 0
                                }
                                ,
                                k = function(e) {
                                    return Math.exp(R * b * e)
                                }
                            }
                            return t.duration = "duration"in t ? +t.duration : 1e3 * D / ("screenSpeed"in t ? +t.screenSpeed / b : +t.speed),
                            t.maxDuration && t.duration > t.maxDuration && (t.duration = 0),
                            this._zooming = !0,
                            this._rotating = s !== h,
                            this._pitching = p !== l,
                            this._padding = !a.isPaddingEqual(f),
                            this._prepareEase(i, !1),
                            this._ease((function(t) {
                                var n = t * D
                                  , d = 1 / k(n);
                                a.zoom = 1 === t ? c : o + a.scaleZoom(d),
                                r._rotating && (a.bearing = e.number(s, h, t)),
                                r._pitching && (a.pitch = e.number(l, p, t)),
                                r._padding && (a.interpolatePadding(u, f, t),
                                v = a.centerPoint.add(m));
                                var g = 1 === t ? y : a.unproject(_.add(x.mult(z(n))).mult(d));
                                a.setLocationAtPoint(a.renderWorldCopies ? g.wrap() : g, v),
                                r._fireMoveEvents(i)
                            }
                            ), (function() {
                                return r._afterEase(i)
                            }
                            ), t),
                            this
                        }
                        ,
                        i.prototype.isEasing = function() {
                            return !!this._easeFrameId
                        }
                        ,
                        i.prototype.stop = function() {
                            return this._stop()
                        }
                        ,
                        i.prototype._stop = function(e, t) {
                            if (this._easeFrameId && (this._cancelRenderFrame(this._easeFrameId),
                            delete this._easeFrameId,
                            delete this._onEaseFrame),
                            this._onEaseEnd) {
                                var i = this._onEaseEnd;
                                delete this._onEaseEnd,
                                i.call(this, t)
                            }
                            if (!e) {
                                var r = this.handlers;
                                r && r.stop(!1)
                            }
                            return this
                        }
                        ,
                        i.prototype._ease = function(t, i, r) {
                            !1 === r.animate || 0 === r.duration ? (t(1),
                            i()) : (this._easeStart = e.browser.now(),
                            this._easeOptions = r,
                            this._onEaseFrame = t,
                            this._onEaseEnd = i,
                            this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback))
                        }
                        ,
                        i.prototype._renderFrameCallback = function() {
                            var t = Math.min((e.browser.now() - this._easeStart) / this._easeOptions.duration, 1);
                            this._onEaseFrame(this._easeOptions.easing(t)),
                            t < 1 ? this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback) : this.stop()
                        }
                        ,
                        i.prototype._normalizeBearing = function(t, i) {
                            t = e.wrap(t, -180, 180);
                            var r = Math.abs(t - i);
                            return Math.abs(t - 360 - i) < r && (t -= 360),
                            Math.abs(t + 360 - i) < r && (t += 360),
                            t
                        }
                        ,
                        i.prototype._normalizeCenter = function(e) {
                            var t = this.transform;
                            if (t.renderWorldCopies && !t.lngRange) {
                                var i = e.lng - t.center.lng;
                                e.lng += i > 180 ? -360 : i < -180 ? 360 : 0
                            }
                        }
                        ,
                        i
                    }(e.Evented)
                      , _n = function(t) {
                        void 0 === t && (t = {}),
                        this.options = t,
                        e.bindAll(["_toggleAttribution", "_updateEditLink", "_updateData", "_updateCompact"], this)
                    };
                    _n.prototype.getDefaultPosition = function() {
                        return "bottom-right"
                    }
                    ,
                    _n.prototype.onAdd = function(e) {
                        var t = this.options && this.options.compact;
                        return this._map = e,
                        this._container = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-attrib"),
                        this._compactButton = i.create("button", "mapboxgl-ctrl-attrib-button", this._container),
                        this._compactButton.addEventListener("click", this._toggleAttribution),
                        this._setElementTitle(this._compactButton, "ToggleAttribution"),
                        this._innerContainer = i.create("div", "mapboxgl-ctrl-attrib-inner", this._container),
                        this._innerContainer.setAttribute("role", "list"),
                        t && this._container.classList.add("mapboxgl-compact"),
                        this._updateAttributions(),
                        this._updateEditLink(),
                        this._map.on("styledata", this._updateData),
                        this._map.on("sourcedata", this._updateData),
                        this._map.on("moveend", this._updateEditLink),
                        void 0 === t && (this._map.on("resize", this._updateCompact),
                        this._updateCompact()),
                        this._container
                    }
                    ,
                    _n.prototype.onRemove = function() {
                        i.remove(this._container),
                        this._map.off("styledata", this._updateData),
                        this._map.off("sourcedata", this._updateData),
                        this._map.off("moveend", this._updateEditLink),
                        this._map.off("resize", this._updateCompact),
                        this._map = void 0,
                        this._attribHTML = void 0
                    }
                    ,
                    _n.prototype._setElementTitle = function(e, t) {
                        var i = this._map._getUIString("AttributionControl." + t);
                        e.title = i,
                        e.setAttribute("aria-label", i)
                    }
                    ,
                    _n.prototype._toggleAttribution = function() {
                        this._container.classList.contains("mapboxgl-compact-show") ? (this._container.classList.remove("mapboxgl-compact-show"),
                        this._compactButton.setAttribute("aria-pressed", "false")) : (this._container.classList.add("mapboxgl-compact-show"),
                        this._compactButton.setAttribute("aria-pressed", "true"))
                    }
                    ,
                    _n.prototype._updateEditLink = function() {
                        var t = this._editLink;
                        t || (t = this._editLink = this._container.querySelector(".mapbox-improve-map"));
                        var i = [{
                            key: "owner",
                            value: this.styleOwner
                        }, {
                            key: "id",
                            value: this.styleId
                        }, {
                            key: "access_token",
                            value: this._map._requestManager._customAccessToken || e.config.ACCESS_TOKEN
                        }];
                        if (t) {
                            var r = i.reduce((function(e, t, r) {
                                return t.value && (e += t.key + "=" + t.value + (r < i.length - 1 ? "&" : "")),
                                e
                            }
                            ), "?");
                            t.href = e.config.FEEDBACK_URL + "/" + r + (this._map._hash ? this._map._hash.getHashString(!0) : ""),
                            t.rel = "noopener nofollow",
                            this._setElementTitle(t, "MapFeedback")
                        }
                    }
                    ,
                    _n.prototype._updateData = function(e) {
                        !e || "metadata" !== e.sourceDataType && "visibility" !== e.sourceDataType && "style" !== e.dataType || (this._updateAttributions(),
                        this._updateEditLink())
                    }
                    ,
                    _n.prototype._updateAttributions = function() {
                        if (this._map.style) {
                            var e = [];
                            if (this.options.customAttribution && (Array.isArray(this.options.customAttribution) ? e = e.concat(this.options.customAttribution.map((function(e) {
                                return "string" != typeof e ? "" : e
                            }
                            ))) : "string" == typeof this.options.customAttribution && e.push(this.options.customAttribution)),
                            this._map.style.stylesheet) {
                                var t = this._map.style.stylesheet;
                                this.styleOwner = t.owner,
                                this.styleId = t.id
                            }
                            var i = this._map.style.sourceCaches;
                            for (var r in i) {
                                var n = i[r];
                                if (n.used) {
                                    var a = n.getSource();
                                    a.attribution && e.indexOf(a.attribution) < 0 && e.push(a.attribution)
                                }
                            }
                            e.sort((function(e, t) {
                                return e.length - t.length
                            }
                            ));
                            var o = (e = e.filter((function(t, i) {
                                for (var r = i + 1; r < e.length; r++)
                                    if (e[r].indexOf(t) >= 0)
                                        return !1;
                                return !0
                            }
                            ))).join(" | ");
                            o !== this._attribHTML && (this._attribHTML = o,
                            e.length ? (this._innerContainer.innerHTML = o,
                            this._container.classList.remove("mapboxgl-attrib-empty")) : this._container.classList.add("mapboxgl-attrib-empty"),
                            this._editLink = null)
                        }
                    }
                    ,
                    _n.prototype._updateCompact = function() {
                        this._map.getCanvasContainer().offsetWidth <= 640 ? this._container.classList.add("mapboxgl-compact") : this._container.classList.remove("mapboxgl-compact", "mapboxgl-compact-show")
                    }
                    ;
                    var xn = function() {
                        e.bindAll(["_updateLogo"], this),
                        e.bindAll(["_updateCompact"], this)
                    };
                    xn.prototype.onAdd = function(e) {
                        this._map = e,
                        this._container = i.create("div", "mapboxgl-ctrl");
                        var t = i.create("a", "mapboxgl-ctrl-logo");
                        return t.target = "_blank",
                        t.rel = "noopener nofollow",
                        t.href = "https://www.mapbox.com/",
                        t.setAttribute("aria-label", this._map._getUIString("LogoControl.Title")),
                        t.setAttribute("rel", "noopener nofollow"),
                        this._container.appendChild(t),
                        this._container.style.display = "none",
                        this._map.on("sourcedata", this._updateLogo),
                        this._updateLogo(),
                        this._map.on("resize", this._updateCompact),
                        this._updateCompact(),
                        this._container
                    }
                    ,
                    xn.prototype.onRemove = function() {
                        i.remove(this._container),
                        this._map.off("sourcedata", this._updateLogo),
                        this._map.off("resize", this._updateCompact)
                    }
                    ,
                    xn.prototype.getDefaultPosition = function() {
                        return "bottom-left"
                    }
                    ,
                    xn.prototype._updateLogo = function(e) {
                        e && "metadata" !== e.sourceDataType || (this._container.style.display = this._logoRequired() ? "block" : "none")
                    }
                    ,
                    xn.prototype._logoRequired = function() {
                        if (this._map.style) {
                            var e = this._map.style.sourceCaches;
                            for (var t in e)
                                if (e[t].getSource().mapbox_logo)
                                    return !0;
                            return !1
                        }
                    }
                    ,
                    xn.prototype._updateCompact = function() {
                        var e = this._container.children;
                        if (e.length) {
                            var t = e[0];
                            this._map.getCanvasContainer().offsetWidth < 250 ? t.classList.add("mapboxgl-compact") : t.classList.remove("mapboxgl-compact")
                        }
                    }
                    ;
                    var bn = function() {
                        this._queue = [],
                        this._id = 0,
                        this._cleared = !1,
                        this._currentlyRunning = !1
                    };
                    bn.prototype.add = function(e) {
                        var t = ++this._id;
                        return this._queue.push({
                            callback: e,
                            id: t,
                            cancelled: !1
                        }),
                        t
                    }
                    ,
                    bn.prototype.remove = function(e) {
                        for (var t = this._currentlyRunning, i = 0, r = t ? this._queue.concat(t) : this._queue; i < r.length; i += 1) {
                            var n = r[i];
                            if (n.id === e)
                                return void (n.cancelled = !0)
                        }
                    }
                    ,
                    bn.prototype.run = function(e) {
                        void 0 === e && (e = 0);
                        var t = this._currentlyRunning = this._queue;
                        this._queue = [];
                        for (var i = 0, r = t; i < r.length; i += 1) {
                            var n = r[i];
                            if (!n.cancelled && (n.callback(e),
                            this._cleared))
                                break
                        }
                        this._cleared = !1,
                        this._currentlyRunning = !1
                    }
                    ,
                    bn.prototype.clear = function() {
                        this._currentlyRunning && (this._cleared = !0),
                        this._queue = []
                    }
                    ;
                    var wn = {
                        "AttributionControl.ToggleAttribution": "Toggle attribution",
                        "AttributionControl.MapFeedback": "Map feedback",
                        "FullscreenControl.Enter": "Enter fullscreen",
                        "FullscreenControl.Exit": "Exit fullscreen",
                        "GeolocateControl.FindMyLocation": "Find my location",
                        "GeolocateControl.LocationNotAvailable": "Location not available",
                        "LogoControl.Title": "Mapbox logo",
                        "NavigationControl.ResetBearing": "Reset bearing to north",
                        "NavigationControl.ZoomIn": "Zoom in",
                        "NavigationControl.ZoomOut": "Zoom out",
                        "ScaleControl.Feet": "ft",
                        "ScaleControl.Meters": "m",
                        "ScaleControl.Kilometers": "km",
                        "ScaleControl.Miles": "mi",
                        "ScaleControl.NauticalMiles": "nm"
                    }
                      , Sn = e.window.HTMLImageElement
                      , Mn = e.window.HTMLElement
                      , Tn = e.window.ImageBitmap
                      , En = {
                        center: [0, 0],
                        zoom: 0,
                        bearing: 0,
                        pitch: 0,
                        minZoom: -2,
                        maxZoom: 22,
                        minPitch: 0,
                        maxPitch: 60,
                        interactive: !0,
                        scrollZoom: !0,
                        boxZoom: !0,
                        dragRotate: !0,
                        dragPan: !0,
                        keyboard: !0,
                        doubleClickZoom: !0,
                        touchZoomRotate: !0,
                        touchPitch: !0,
                        bearingSnap: 7,
                        clickTolerance: 3,
                        pitchWithRotate: !0,
                        hash: !1,
                        attributionControl: !0,
                        failIfMajorPerformanceCaveat: !1,
                        preserveDrawingBuffer: !1,
                        trackResize: !0,
                        renderWorldCopies: !0,
                        refreshExpiredTiles: !0,
                        maxTileCacheSize: null,
                        localIdeographFontFamily: "sans-serif",
                        transformRequest: null,
                        accessToken: null,
                        fadeDuration: 300,
                        crossSourceCollisions: !0
                    }
                      , An = function(r) {
                        function n(t) {
                            var i = this;
                            if (null != (t = e.extend({}, En, t)).minZoom && null != t.maxZoom && t.minZoom > t.maxZoom)
                                throw new Error("maxZoom must be greater than or equal to minZoom");
                            if (null != t.minPitch && null != t.maxPitch && t.minPitch > t.maxPitch)
                                throw new Error("maxPitch must be greater than or equal to minPitch");
                            if (null != t.minPitch && t.minPitch < 0)
                                throw new Error("minPitch must be greater than or equal to 0");
                            if (null != t.maxPitch && t.maxPitch > 60)
                                throw new Error("maxPitch must be less than or equal to 60");
                            var n = new wr(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies);
                            if (r.call(this, n, t),
                            this._interactive = t.interactive,
                            this._maxTileCacheSize = t.maxTileCacheSize,
                            this._failIfMajorPerformanceCaveat = t.failIfMajorPerformanceCaveat,
                            this._preserveDrawingBuffer = t.preserveDrawingBuffer,
                            this._antialias = t.antialias,
                            this._trackResize = t.trackResize,
                            this._bearingSnap = t.bearingSnap,
                            this._refreshExpiredTiles = t.refreshExpiredTiles,
                            this._fadeDuration = t.fadeDuration,
                            this._crossSourceCollisions = t.crossSourceCollisions,
                            this._crossFadingFactor = 1,
                            this._collectResourceTiming = t.collectResourceTiming,
                            this._renderTaskQueue = new bn,
                            this._controls = [],
                            this._mapId = e.uniqueId(),
                            this._locale = e.extend({}, wn, t.locale),
                            this._clickTolerance = t.clickTolerance,
                            this._requestManager = new e.RequestManager(t.transformRequest,t.accessToken),
                            "string" == typeof t.container) {
                                if (this._container = e.window.document.getElementById(t.container),
                                !this._container)
                                    throw new Error("Container '" + t.container + "' not found.")
                            } else {
                                if (!(t.container instanceof Mn))
                                    throw new Error("Invalid type: 'container' must be a String or HTMLElement.");
                                this._container = t.container
                            }
                            if (t.maxBounds && this.setMaxBounds(t.maxBounds),
                            e.bindAll(["_onWindowOnline", "_onWindowResize", "_onMapScroll", "_contextLost", "_contextRestored"], this),
                            this._setupContainer(),
                            this._setupPainter(),
                            void 0 === this.painter)
                                throw new Error("Failed to initialize WebGL.");
                            this.on("move", (function() {
                                return i._update(!1)
                            }
                            )),
                            this.on("moveend", (function() {
                                return i._update(!1)
                            }
                            )),
                            this.on("zoom", (function() {
                                return i._update(!0)
                            }
                            )),
                            void 0 !== e.window && (e.window.addEventListener("online", this._onWindowOnline, !1),
                            e.window.addEventListener("resize", this._onWindowResize, !1),
                            e.window.addEventListener("orientationchange", this._onWindowResize, !1)),
                            this.handlers = new gn(this,t),
                            this._hash = t.hash && new Mr("string" == typeof t.hash && t.hash || void 0).addTo(this),
                            this._hash && this._hash._onHashChange() || (this.jumpTo({
                                center: t.center,
                                zoom: t.zoom,
                                bearing: t.bearing,
                                pitch: t.pitch
                            }),
                            t.bounds && (this.resize(),
                            this.fitBounds(t.bounds, e.extend({}, t.fitBoundsOptions, {
                                duration: 0
                            })))),
                            this.resize(),
                            this._localIdeographFontFamily = t.localIdeographFontFamily,
                            t.style && this.setStyle(t.style, {
                                localIdeographFontFamily: t.localIdeographFontFamily
                            }),
                            t.attributionControl && this.addControl(new _n({
                                customAttribution: t.customAttribution
                            })),
                            this.addControl(new xn, t.logoPosition),
                            this.on("style.load", (function() {
                                i.transform.unmodified && i.jumpTo(i.style.stylesheet)
                            }
                            )),
                            this.on("data", (function(t) {
                                i._update("style" === t.dataType),
                                i.fire(new e.Event(t.dataType + "data",t))
                            }
                            )),
                            this.on("dataloading", (function(t) {
                                i.fire(new e.Event(t.dataType + "dataloading",t))
                            }
                            ))
                        }
                        r && (n.__proto__ = r),
                        (n.prototype = Object.create(r && r.prototype)).constructor = n;
                        var a = {
                            showTileBoundaries: {
                                configurable: !0
                            },
                            showPadding: {
                                configurable: !0
                            },
                            showCollisionBoxes: {
                                configurable: !0
                            },
                            showOverdrawInspector: {
                                configurable: !0
                            },
                            repaint: {
                                configurable: !0
                            },
                            vertices: {
                                configurable: !0
                            },
                            version: {
                                configurable: !0
                            }
                        };
                        return n.prototype._getMapId = function() {
                            return this._mapId
                        }
                        ,
                        n.prototype.addControl = function(t, i) {
                            if (void 0 === i && (i = t.getDefaultPosition ? t.getDefaultPosition() : "top-right"),
                            !t || !t.onAdd)
                                return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));
                            var r = t.onAdd(this);
                            this._controls.push(t);
                            var n = this._controlPositions[i];
                            return -1 !== i.indexOf("bottom") ? n.insertBefore(r, n.firstChild) : n.appendChild(r),
                            this
                        }
                        ,
                        n.prototype.removeControl = function(t) {
                            if (!t || !t.onRemove)
                                return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));
                            var i = this._controls.indexOf(t);
                            return i > -1 && this._controls.splice(i, 1),
                            t.onRemove(this),
                            this
                        }
                        ,
                        n.prototype.hasControl = function(e) {
                            return this._controls.indexOf(e) > -1
                        }
                        ,
                        n.prototype.resize = function(t) {
                            var i = this._containerDimensions()
                              , r = i[0]
                              , n = i[1];
                            this._resizeCanvas(r, n),
                            this.transform.resize(r, n),
                            this.painter.resize(r, n);
                            var a = !this._moving;
                            return a && (this.stop(),
                            this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t))),
                            this.fire(new e.Event("resize",t)),
                            a && this.fire(new e.Event("moveend",t)),
                            this
                        }
                        ,
                        n.prototype.getBounds = function() {
                            return this.transform.getBounds()
                        }
                        ,
                        n.prototype.getMaxBounds = function() {
                            return this.transform.getMaxBounds()
                        }
                        ,
                        n.prototype.setMaxBounds = function(t) {
                            return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),
                            this._update()
                        }
                        ,
                        n.prototype.setMinZoom = function(e) {
                            if ((e = null == e ? -2 : e) >= -2 && e <= this.transform.maxZoom)
                                return this.transform.minZoom = e,
                                this._update(),
                                this.getZoom() < e && this.setZoom(e),
                                this;
                            throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")
                        }
                        ,
                        n.prototype.getMinZoom = function() {
                            return this.transform.minZoom
                        }
                        ,
                        n.prototype.setMaxZoom = function(e) {
                            if ((e = null == e ? 22 : e) >= this.transform.minZoom)
                                return this.transform.maxZoom = e,
                                this._update(),
                                this.getZoom() > e && this.setZoom(e),
                                this;
                            throw new Error("maxZoom must be greater than the current minZoom")
                        }
                        ,
                        n.prototype.getMaxZoom = function() {
                            return this.transform.maxZoom
                        }
                        ,
                        n.prototype.setMinPitch = function(e) {
                            if ((e = null == e ? 0 : e) < 0)
                                throw new Error("minPitch must be greater than or equal to 0");
                            if (e >= 0 && e <= this.transform.maxPitch)
                                return this.transform.minPitch = e,
                                this._update(),
                                this.getPitch() < e && this.setPitch(e),
                                this;
                            throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")
                        }
                        ,
                        n.prototype.getMinPitch = function() {
                            return this.transform.minPitch
                        }
                        ,
                        n.prototype.setMaxPitch = function(e) {
                            if ((e = null == e ? 60 : e) > 60)
                                throw new Error("maxPitch must be less than or equal to 60");
                            if (e >= this.transform.minPitch)
                                return this.transform.maxPitch = e,
                                this._update(),
                                this.getPitch() > e && this.setPitch(e),
                                this;
                            throw new Error("maxPitch must be greater than the current minPitch")
                        }
                        ,
                        n.prototype.getMaxPitch = function() {
                            return this.transform.maxPitch
                        }
                        ,
                        n.prototype.getRenderWorldCopies = function() {
                            return this.transform.renderWorldCopies
                        }
                        ,
                        n.prototype.setRenderWorldCopies = function(e) {
                            return this.transform.renderWorldCopies = e,
                            this._update()
                        }
                        ,
                        n.prototype.project = function(t) {
                            return this.transform.locationPoint(e.LngLat.convert(t))
                        }
                        ,
                        n.prototype.unproject = function(t) {
                            return this.transform.pointLocation(e.Point.convert(t))
                        }
                        ,
                        n.prototype.isMoving = function() {
                            return this._moving || this.handlers.isMoving()
                        }
                        ,
                        n.prototype.isZooming = function() {
                            return this._zooming || this.handlers.isZooming()
                        }
                        ,
                        n.prototype.isRotating = function() {
                            return this._rotating || this.handlers.isRotating()
                        }
                        ,
                        n.prototype._createDelegatedListener = function(e, t, i) {
                            var r, n = this;
                            if ("mouseenter" === e || "mouseover" === e) {
                                var a = !1;
                                return {
                                    layer: t,
                                    listener: i,
                                    delegates: {
                                        mousemove: function(r) {
                                            var o = n.getLayer(t) ? n.queryRenderedFeatures(r.point, {
                                                layers: [t]
                                            }) : [];
                                            o.length ? a || (a = !0,
                                            i.call(n, new zr(e,n,r.originalEvent,{
                                                features: o
                                            }))) : a = !1
                                        },
                                        mouseout: function() {
                                            a = !1
                                        }
                                    }
                                }
                            }
                            if ("mouseleave" === e || "mouseout" === e) {
                                var o = !1;
                                return {
                                    layer: t,
                                    listener: i,
                                    delegates: {
                                        mousemove: function(r) {
                                            (n.getLayer(t) ? n.queryRenderedFeatures(r.point, {
                                                layers: [t]
                                            }) : []).length ? o = !0 : o && (o = !1,
                                            i.call(n, new zr(e,n,r.originalEvent)))
                                        },
                                        mouseout: function(t) {
                                            o && (o = !1,
                                            i.call(n, new zr(e,n,t.originalEvent)))
                                        }
                                    }
                                }
                            }
                            return {
                                layer: t,
                                listener: i,
                                delegates: (r = {},
                                r[e] = function(e) {
                                    var r = n.getLayer(t) ? n.queryRenderedFeatures(e.point, {
                                        layers: [t]
                                    }) : [];
                                    r.length && (e.features = r,
                                    i.call(n, e),
                                    delete e.features)
                                }
                                ,
                                r)
                            }
                        }
                        ,
                        n.prototype.on = function(e, t, i) {
                            if (void 0 === i)
                                return r.prototype.on.call(this, e, t);
                            var n = this._createDelegatedListener(e, t, i);
                            for (var a in this._delegatedListeners = this._delegatedListeners || {},
                            this._delegatedListeners[e] = this._delegatedListeners[e] || [],
                            this._delegatedListeners[e].push(n),
                            n.delegates)
                                this.on(a, n.delegates[a]);
                            return this
                        }
                        ,
                        n.prototype.once = function(e, t, i) {
                            if (void 0 === i)
                                return r.prototype.once.call(this, e, t);
                            var n = this._createDelegatedListener(e, t, i);
                            for (var a in n.delegates)
                                this.once(a, n.delegates[a]);
                            return this
                        }
                        ,
                        n.prototype.off = function(e, t, i) {
                            var n = this;
                            return void 0 === i ? r.prototype.off.call(this, e, t) : (this._delegatedListeners && this._delegatedListeners[e] && function(r) {
                                for (var a = r[e], o = 0; o < a.length; o++) {
                                    var s = a[o];
                                    if (s.layer === t && s.listener === i) {
                                        for (var l in s.delegates)
                                            n.off(l, s.delegates[l]);
                                        return a.splice(o, 1),
                                        n
                                    }
                                }
                            }(this._delegatedListeners),
                            this)
                        }
                        ,
                        n.prototype.queryRenderedFeatures = function(t, i) {
                            if (!this.style)
                                return [];
                            var r;
                            if (void 0 !== i || void 0 === t || t instanceof e.Point || Array.isArray(t) || (i = t,
                            t = void 0),
                            i = i || {},
                            (t = t || [[0, 0], [this.transform.width, this.transform.height]])instanceof e.Point || "number" == typeof t[0])
                                r = [e.Point.convert(t)];
                            else {
                                var n = e.Point.convert(t[0])
                                  , a = e.Point.convert(t[1]);
                                r = [n, new e.Point(a.x,n.y), a, new e.Point(n.x,a.y), n]
                            }
                            return this.style.queryRenderedFeatures(r, i, this.transform)
                        }
                        ,
                        n.prototype.querySourceFeatures = function(e, t) {
                            return this.style.querySourceFeatures(e, t)
                        }
                        ,
                        n.prototype.setStyle = function(t, i) {
                            return !1 !== (i = e.extend({}, {
                                localIdeographFontFamily: this._localIdeographFontFamily
                            }, i)).diff && i.localIdeographFontFamily === this._localIdeographFontFamily && this.style && t ? (this._diffStyle(t, i),
                            this) : (this._localIdeographFontFamily = i.localIdeographFontFamily,
                            this._updateStyle(t, i))
                        }
                        ,
                        n.prototype._getUIString = function(e) {
                            var t = this._locale[e];
                            if (null == t)
                                throw new Error("Missing UI string '" + e + "'");
                            return t
                        }
                        ,
                        n.prototype._updateStyle = function(e, t) {
                            return this.style && (this.style.setEventedParent(null),
                            this.style._remove()),
                            e ? (this.style = new jt(this,t || {}),
                            this.style.setEventedParent(this, {
                                style: this.style
                            }),
                            "string" == typeof e ? this.style.loadURL(e) : this.style.loadJSON(e),
                            this) : (delete this.style,
                            this)
                        }
                        ,
                        n.prototype._lazyInitEmptyStyle = function() {
                            this.style || (this.style = new jt(this,{}),
                            this.style.setEventedParent(this, {
                                style: this.style
                            }),
                            this.style.loadEmpty())
                        }
                        ,
                        n.prototype._diffStyle = function(t, i) {
                            var r = this;
                            if ("string" == typeof t) {
                                var n = this._requestManager.normalizeStyleURL(t)
                                  , a = this._requestManager.transformRequest(n, e.ResourceType.Style);
                                e.getJSON(a, (function(t, n) {
                                    t ? r.fire(new e.ErrorEvent(t)) : n && r._updateDiff(n, i)
                                }
                                ))
                            } else
                                "object" == typeof t && this._updateDiff(t, i)
                        }
                        ,
                        n.prototype._updateDiff = function(t, i) {
                            try {
                                this.style.setState(t) && this._update(!0)
                            } catch (r) {
                                e.warnOnce("Unable to perform style diff: " + (r.message || r.error || r) + ".  Rebuilding the style from scratch."),
                                this._updateStyle(t, i)
                            }
                        }
                        ,
                        n.prototype.getStyle = function() {
                            if (this.style)
                                return this.style.serialize()
                        }
                        ,
                        n.prototype.isStyleLoaded = function() {
                            return this.style ? this.style.loaded() : e.warnOnce("There is no style added to the map.")
                        }
                        ,
                        n.prototype.addSource = function(e, t) {
                            return this._lazyInitEmptyStyle(),
                            this.style.addSource(e, t),
                            this._update(!0)
                        }
                        ,
                        n.prototype.isSourceLoaded = function(t) {
                            var i = this.style && this.style.sourceCaches[t];
                            if (void 0 !== i)
                                return i.loaded();
                            this.fire(new e.ErrorEvent(new Error("There is no source with ID '" + t + "'")))
                        }
                        ,
                        n.prototype.areTilesLoaded = function() {
                            var e = this.style && this.style.sourceCaches;
                            for (var t in e) {
                                var i = e[t]._tiles;
                                for (var r in i) {
                                    var n = i[r];
                                    if ("loaded" !== n.state && "errored" !== n.state)
                                        return !1
                                }
                            }
                            return !0
                        }
                        ,
                        n.prototype.addSourceType = function(e, t, i) {
                            return this._lazyInitEmptyStyle(),
                            this.style.addSourceType(e, t, i)
                        }
                        ,
                        n.prototype.removeSource = function(e) {
                            return this.style.removeSource(e),
                            this._update(!0)
                        }
                        ,
                        n.prototype.getSource = function(e) {
                            return this.style.getSource(e)
                        }
                        ,
                        n.prototype.addImage = function(t, i, r) {
                            void 0 === r && (r = {});
                            var n = r.pixelRatio;
                            void 0 === n && (n = 1);
                            var a = r.sdf;
                            void 0 === a && (a = !1);
                            var o = r.stretchX
                              , s = r.stretchY
                              , l = r.content;
                            if (this._lazyInitEmptyStyle(),
                            i instanceof Sn || Tn && i instanceof Tn) {
                                var u = e.browser.getImageData(i);
                                this.style.addImage(t, {
                                    data: new e.RGBAImage({
                                        width: u.width,
                                        height: u.height
                                    },u.data),
                                    pixelRatio: n,
                                    stretchX: o,
                                    stretchY: s,
                                    content: l,
                                    sdf: a,
                                    version: 0
                                })
                            } else {
                                if (void 0 === i.width || void 0 === i.height)
                                    return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
                                var c = i;
                                this.style.addImage(t, {
                                    data: new e.RGBAImage({
                                        width: i.width,
                                        height: i.height
                                    },new Uint8Array(i.data)),
                                    pixelRatio: n,
                                    stretchX: o,
                                    stretchY: s,
                                    content: l,
                                    sdf: a,
                                    version: 0,
                                    userImage: c
                                }),
                                c.onAdd && c.onAdd(this, t)
                            }
                        }
                        ,
                        n.prototype.updateImage = function(t, i) {
                            var r = this.style.getImage(t);
                            if (!r)
                                return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));
                            var n = i instanceof Sn || Tn && i instanceof Tn ? e.browser.getImageData(i) : i
                              , a = n.width
                              , o = n.height
                              , s = n.data;
                            return void 0 === a || void 0 === o ? this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))) : a !== r.data.width || o !== r.data.height ? this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))) : (r.data.replace(s, !(i instanceof Sn || Tn && i instanceof Tn)),
                            void this.style.updateImage(t, r))
                        }
                        ,
                        n.prototype.hasImage = function(t) {
                            return t ? !!this.style.getImage(t) : (this.fire(new e.ErrorEvent(new Error("Missing required image id"))),
                            !1)
                        }
                        ,
                        n.prototype.removeImage = function(e) {
                            this.style.removeImage(e)
                        }
                        ,
                        n.prototype.loadImage = function(t, i) {
                            e.getImage(this._requestManager.transformRequest(t, e.ResourceType.Image), i)
                        }
                        ,
                        n.prototype.listImages = function() {
                            return this.style.listImages()
                        }
                        ,
                        n.prototype.addLayer = function(e, t) {
                            return this._lazyInitEmptyStyle(),
                            this.style.addLayer(e, t),
                            this._update(!0)
                        }
                        ,
                        n.prototype.moveLayer = function(e, t) {
                            return this.style.moveLayer(e, t),
                            this._update(!0)
                        }
                        ,
                        n.prototype.removeLayer = function(e) {
                            return this.style.removeLayer(e),
                            this._update(!0)
                        }
                        ,
                        n.prototype.getLayer = function(e) {
                            return this.style.getLayer(e)
                        }
                        ,
                        n.prototype.setLayerZoomRange = function(e, t, i) {
                            return this.style.setLayerZoomRange(e, t, i),
                            this._update(!0)
                        }
                        ,
                        n.prototype.setFilter = function(e, t, i) {
                            return void 0 === i && (i = {}),
                            this.style.setFilter(e, t, i),
                            this._update(!0)
                        }
                        ,
                        n.prototype.getFilter = function(e) {
                            return this.style.getFilter(e)
                        }
                        ,
                        n.prototype.setPaintProperty = function(e, t, i, r) {
                            return void 0 === r && (r = {}),
                            this.style.setPaintProperty(e, t, i, r),
                            this._update(!0)
                        }
                        ,
                        n.prototype.getPaintProperty = function(e, t) {
                            return this.style.getPaintProperty(e, t)
                        }
                        ,
                        n.prototype.setLayoutProperty = function(e, t, i, r) {
                            return void 0 === r && (r = {}),
                            this.style.setLayoutProperty(e, t, i, r),
                            this._update(!0)
                        }
                        ,
                        n.prototype.getLayoutProperty = function(e, t) {
                            return this.style.getLayoutProperty(e, t)
                        }
                        ,
                        n.prototype.setLight = function(e, t) {
                            return void 0 === t && (t = {}),
                            this._lazyInitEmptyStyle(),
                            this.style.setLight(e, t),
                            this._update(!0)
                        }
                        ,
                        n.prototype.getLight = function() {
                            return this.style.getLight()
                        }
                        ,
                        n.prototype.setFeatureState = function(e, t) {
                            return this.style.setFeatureState(e, t),
                            this._update()
                        }
                        ,
                        n.prototype.removeFeatureState = function(e, t) {
                            return this.style.removeFeatureState(e, t),
                            this._update()
                        }
                        ,
                        n.prototype.getFeatureState = function(e) {
                            return this.style.getFeatureState(e)
                        }
                        ,
                        n.prototype.getContainer = function() {
                            return this._container
                        }
                        ,
                        n.prototype.getCanvasContainer = function() {
                            return this._canvasContainer
                        }
                        ,
                        n.prototype.getCanvas = function() {
                            return this._canvas
                        }
                        ,
                        n.prototype._containerDimensions = function() {
                            var e = 0
                              , t = 0;
                            return this._container && (e = this._container.clientWidth || 400,
                            t = this._container.clientHeight || 300),
                            [e, t]
                        }
                        ,
                        n.prototype._detectMissingCSS = function() {
                            "rgb(250, 128, 114)" !== e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color") && e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")
                        }
                        ,
                        n.prototype._setupContainer = function() {
                            var e = this._container;
                            e.classList.add("mapboxgl-map"),
                            (this._missingCSSCanary = i.create("div", "mapboxgl-canary", e)).style.visibility = "hidden",
                            this._detectMissingCSS();
                            var t = this._canvasContainer = i.create("div", "mapboxgl-canvas-container", e);
                            this._interactive && t.classList.add("mapboxgl-interactive"),
                            this._canvas = i.create("canvas", "mapboxgl-canvas", t),
                            this._canvas.addEventListener("webglcontextlost", this._contextLost, !1),
                            this._canvas.addEventListener("webglcontextrestored", this._contextRestored, !1),
                            this._canvas.setAttribute("tabindex", "0"),
                            this._canvas.setAttribute("aria-label", "Map"),
                            this._canvas.setAttribute("role", "region");
                            var r = this._containerDimensions();
                            this._resizeCanvas(r[0], r[1]);
                            var n = this._controlContainer = i.create("div", "mapboxgl-control-container", e)
                              , a = this._controlPositions = {};
                            ["top-left", "top-right", "bottom-left", "bottom-right"].forEach((function(e) {
                                a[e] = i.create("div", "mapboxgl-ctrl-" + e, n)
                            }
                            )),
                            this._container.addEventListener("scroll", this._onMapScroll, !1)
                        }
                        ,
                        n.prototype._resizeCanvas = function(t, i) {
                            var r = e.browser.devicePixelRatio || 1;
                            this._canvas.width = r * t,
                            this._canvas.height = r * i,
                            this._canvas.style.width = t + "px",
                            this._canvas.style.height = i + "px"
                        }
                        ,
                        n.prototype._setupPainter = function() {
                            var i = e.extend({}, t.webGLContextAttributes, {
                                failIfMajorPerformanceCaveat: this._failIfMajorPerformanceCaveat,
                                preserveDrawingBuffer: this._preserveDrawingBuffer,
                                antialias: this._antialias || !1
                            })
                              , r = this._canvas.getContext("webgl", i) || this._canvas.getContext("experimental-webgl", i);
                            r ? (this.painter = new yr(r,this.transform),
                            e.webpSupported.testSupport(r)) : this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))
                        }
                        ,
                        n.prototype._contextLost = function(t) {
                            t.preventDefault(),
                            this._frame && (this._frame.cancel(),
                            this._frame = null),
                            this.fire(new e.Event("webglcontextlost",{
                                originalEvent: t
                            }))
                        }
                        ,
                        n.prototype._contextRestored = function(t) {
                            this._setupPainter(),
                            this.resize(),
                            this._update(),
                            this.fire(new e.Event("webglcontextrestored",{
                                originalEvent: t
                            }))
                        }
                        ,
                        n.prototype._onMapScroll = function(e) {
                            if (e.target === this._container)
                                return this._container.scrollTop = 0,
                                this._container.scrollLeft = 0,
                                !1
                        }
                        ,
                        n.prototype.loaded = function() {
                            return !this._styleDirty && !this._sourcesDirty && !!this.style && this.style.loaded()
                        }
                        ,
                        n.prototype._update = function(e) {
                            return this.style ? (this._styleDirty = this._styleDirty || e,
                            this._sourcesDirty = !0,
                            this.triggerRepaint(),
                            this) : this
                        }
                        ,
                        n.prototype._requestRenderFrame = function(e) {
                            return this._update(),
                            this._renderTaskQueue.add(e)
                        }
                        ,
                        n.prototype._cancelRenderFrame = function(e) {
                            this._renderTaskQueue.remove(e)
                        }
                        ,
                        n.prototype._render = function(t) {
                            var i, r = this, n = 0, a = this.painter.context.extTimerQuery;
                            if (this.listens("gpu-timing-frame") && (i = a.createQueryEXT(),
                            a.beginQueryEXT(a.TIME_ELAPSED_EXT, i),
                            n = e.browser.now()),
                            this.painter.context.setDirty(),
                            this.painter.setBaseState(),
                            this._renderTaskQueue.run(t),
                            !this._removed) {
                                var o = !1;
                                if (this.style && this._styleDirty) {
                                    this._styleDirty = !1;
                                    var s = this.transform.zoom
                                      , l = e.browser.now();
                                    this.style.zoomHistory.update(s, l);
                                    var u = new e.EvaluationParameters(s,{
                                        now: l,
                                        fadeDuration: this._fadeDuration,
                                        zoomHistory: this.style.zoomHistory,
                                        transition: this.style.getTransition()
                                    })
                                      , c = u.crossFadingFactor();
                                    1 === c && c === this._crossFadingFactor || (o = !0,
                                    this._crossFadingFactor = c),
                                    this.style.update(u)
                                }
                                if (this.style && this._sourcesDirty && (this._sourcesDirty = !1,
                                this.style._updateSources(this.transform)),
                                this._placementDirty = this.style && this.style._updatePlacement(this.painter.transform, this.showCollisionBoxes, this._fadeDuration, this._crossSourceCollisions),
                                this.painter.render(this.style, {
                                    showTileBoundaries: this.showTileBoundaries,
                                    showOverdrawInspector: this._showOverdrawInspector,
                                    rotating: this.isRotating(),
                                    zooming: this.isZooming(),
                                    moving: this.isMoving(),
                                    fadeDuration: this._fadeDuration,
                                    showPadding: this.showPadding,
                                    gpuTiming: !!this.listens("gpu-timing-layer")
                                }),
                                this.fire(new e.Event("render")),
                                this.loaded() && !this._loaded && (this._loaded = !0,
                                this.fire(new e.Event("load"))),
                                this.style && (this.style.hasTransitions() || o) && (this._styleDirty = !0),
                                this.style && !this._placementDirty && this.style._releaseSymbolFadeTiles(),
                                this.listens("gpu-timing-frame")) {
                                    var h = e.browser.now() - n;
                                    a.endQueryEXT(a.TIME_ELAPSED_EXT, i),
                                    setTimeout((function() {
                                        var t = a.getQueryObjectEXT(i, a.QUERY_RESULT_EXT) / 1e6;
                                        a.deleteQueryEXT(i),
                                        r.fire(new e.Event("gpu-timing-frame",{
                                            cpuTime: h,
                                            gpuTime: t
                                        }))
                                    }
                                    ), 50)
                                }
                                if (this.listens("gpu-timing-layer")) {
                                    var p = this.painter.collectGpuTimers();
                                    setTimeout((function() {
                                        var t = r.painter.queryGpuTimers(p);
                                        r.fire(new e.Event("gpu-timing-layer",{
                                            layerTimes: t
                                        }))
                                    }
                                    ), 50)
                                }
                                var f = this._sourcesDirty || this._styleDirty || this._placementDirty;
                                return f || this._repaint ? this.triggerRepaint() : !this.isMoving() && this.loaded() && this.fire(new e.Event("idle")),
                                !this._loaded || this._fullyLoaded || f || (this._fullyLoaded = !0),
                                this
                            }
                        }
                        ,
                        n.prototype.remove = function() {
                            this._hash && this._hash.remove();
                            for (var t = 0, i = this._controls; t < i.length; t += 1)
                                i[t].onRemove(this);
                            this._controls = [],
                            this._frame && (this._frame.cancel(),
                            this._frame = null),
                            this._renderTaskQueue.clear(),
                            this.painter.destroy(),
                            this.handlers.destroy(),
                            delete this.handlers,
                            this.setStyle(null),
                            void 0 !== e.window && (e.window.removeEventListener("resize", this._onWindowResize, !1),
                            e.window.removeEventListener("orientationchange", this._onWindowResize, !1),
                            e.window.removeEventListener("online", this._onWindowOnline, !1));
                            var r = this.painter.context.gl.getExtension("WEBGL_lose_context");
                            r && r.loseContext(),
                            Pn(this._canvasContainer),
                            Pn(this._controlContainer),
                            Pn(this._missingCSSCanary),
                            this._container.classList.remove("mapboxgl-map"),
                            this._removed = !0,
                            this.fire(new e.Event("remove"))
                        }
                        ,
                        n.prototype.triggerRepaint = function() {
                            var t = this;
                            this.style && !this._frame && (this._frame = e.browser.frame((function(e) {
                                t._frame = null,
                                t._render(e)
                            }
                            )))
                        }
                        ,
                        n.prototype._onWindowOnline = function() {
                            this._update()
                        }
                        ,
                        n.prototype._onWindowResize = function(e) {
                            this._trackResize && this.resize({
                                originalEvent: e
                            })._update()
                        }
                        ,
                        a.showTileBoundaries.get = function() {
                            return !!this._showTileBoundaries
                        }
                        ,
                        a.showTileBoundaries.set = function(e) {
                            this._showTileBoundaries !== e && (this._showTileBoundaries = e,
                            this._update())
                        }
                        ,
                        a.showPadding.get = function() {
                            return !!this._showPadding
                        }
                        ,
                        a.showPadding.set = function(e) {
                            this._showPadding !== e && (this._showPadding = e,
                            this._update())
                        }
                        ,
                        a.showCollisionBoxes.get = function() {
                            return !!this._showCollisionBoxes
                        }
                        ,
                        a.showCollisionBoxes.set = function(e) {
                            this._showCollisionBoxes !== e && (this._showCollisionBoxes = e,
                            e ? this.style._generateCollisionBoxes() : this._update())
                        }
                        ,
                        a.showOverdrawInspector.get = function() {
                            return !!this._showOverdrawInspector
                        }
                        ,
                        a.showOverdrawInspector.set = function(e) {
                            this._showOverdrawInspector !== e && (this._showOverdrawInspector = e,
                            this._update())
                        }
                        ,
                        a.repaint.get = function() {
                            return !!this._repaint
                        }
                        ,
                        a.repaint.set = function(e) {
                            this._repaint !== e && (this._repaint = e,
                            this.triggerRepaint())
                        }
                        ,
                        a.vertices.get = function() {
                            return !!this._vertices
                        }
                        ,
                        a.vertices.set = function(e) {
                            this._vertices = e,
                            this._update()
                        }
                        ,
                        n.prototype._setCacheLimits = function(t, i) {
                            e.setCacheLimits(t, i)
                        }
                        ,
                        a.version.get = function() {
                            return e.version
                        }
                        ,
                        Object.defineProperties(n.prototype, a),
                        n
                    }(yn);
                    function Pn(e) {
                        e.parentNode && e.parentNode.removeChild(e)
                    }
                    var Cn = {
                        showCompass: !0,
                        showZoom: !0,
                        visualizePitch: !1
                    }
                      , Ln = function(t) {
                        var r = this;
                        this.options = e.extend({}, Cn, t),
                        this._container = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"),
                        this._container.addEventListener("contextmenu", (function(e) {
                            return e.preventDefault()
                        }
                        )),
                        this.options.showZoom && (e.bindAll(["_setButtonTitle", "_updateZoomButtons"], this),
                        this._zoomInButton = this._createButton("mapboxgl-ctrl-zoom-in", (function(e) {
                            return r._map.zoomIn({}, {
                                originalEvent: e
                            })
                        }
                        )),
                        i.create("span", "mapboxgl-ctrl-icon", this._zoomInButton).setAttribute("aria-hidden", !0),
                        this._zoomOutButton = this._createButton("mapboxgl-ctrl-zoom-out", (function(e) {
                            return r._map.zoomOut({}, {
                                originalEvent: e
                            })
                        }
                        )),
                        i.create("span", "mapboxgl-ctrl-icon", this._zoomOutButton).setAttribute("aria-hidden", !0)),
                        this.options.showCompass && (e.bindAll(["_rotateCompassArrow"], this),
                        this._compass = this._createButton("mapboxgl-ctrl-compass", (function(e) {
                            r.options.visualizePitch ? r._map.resetNorthPitch({}, {
                                originalEvent: e
                            }) : r._map.resetNorth({}, {
                                originalEvent: e
                            })
                        }
                        )),
                        this._compassIcon = i.create("span", "mapboxgl-ctrl-icon", this._compass),
                        this._compassIcon.setAttribute("aria-hidden", !0))
                    };
                    Ln.prototype._updateZoomButtons = function() {
                        var e = this._map.getZoom()
                          , t = e === this._map.getMaxZoom()
                          , i = e === this._map.getMinZoom();
                        this._zoomInButton.disabled = t,
                        this._zoomOutButton.disabled = i,
                        this._zoomInButton.setAttribute("aria-disabled", t.toString()),
                        this._zoomOutButton.setAttribute("aria-disabled", i.toString())
                    }
                    ,
                    Ln.prototype._rotateCompassArrow = function() {
                        var e = this.options.visualizePitch ? "scale(" + 1 / Math.pow(Math.cos(this._map.transform.pitch * (Math.PI / 180)), .5) + ") rotateX(" + this._map.transform.pitch + "deg) rotateZ(" + this._map.transform.angle * (180 / Math.PI) + "deg)" : "rotate(" + this._map.transform.angle * (180 / Math.PI) + "deg)";
                        this._compassIcon.style.transform = e
                    }
                    ,
                    Ln.prototype.onAdd = function(e) {
                        return this._map = e,
                        this.options.showZoom && (this._setButtonTitle(this._zoomInButton, "ZoomIn"),
                        this._setButtonTitle(this._zoomOutButton, "ZoomOut"),
                        this._map.on("zoom", this._updateZoomButtons),
                        this._updateZoomButtons()),
                        this.options.showCompass && (this._setButtonTitle(this._compass, "ResetBearing"),
                        this.options.visualizePitch && this._map.on("pitch", this._rotateCompassArrow),
                        this._map.on("rotate", this._rotateCompassArrow),
                        this._rotateCompassArrow(),
                        this._handler = new In(this._map,this._compass,this.options.visualizePitch)),
                        this._container
                    }
                    ,
                    Ln.prototype.onRemove = function() {
                        i.remove(this._container),
                        this.options.showZoom && this._map.off("zoom", this._updateZoomButtons),
                        this.options.showCompass && (this.options.visualizePitch && this._map.off("pitch", this._rotateCompassArrow),
                        this._map.off("rotate", this._rotateCompassArrow),
                        this._handler.off(),
                        delete this._handler),
                        delete this._map
                    }
                    ,
                    Ln.prototype._createButton = function(e, t) {
                        var r = i.create("button", e, this._container);
                        return r.type = "button",
                        r.addEventListener("click", t),
                        r
                    }
                    ,
                    Ln.prototype._setButtonTitle = function(e, t) {
                        var i = this._map._getUIString("NavigationControl." + t);
                        e.title = i,
                        e.setAttribute("aria-label", i)
                    }
                    ;
                    var In = function(t, r, n) {
                        void 0 === n && (n = !1),
                        this._clickTolerance = 10,
                        this.element = r,
                        this.mouseRotate = new Wr({
                            clickTolerance: t.dragRotate._mouseRotate._clickTolerance
                        }),
                        this.map = t,
                        n && (this.mousePitch = new Zr({
                            clickTolerance: t.dragRotate._mousePitch._clickTolerance
                        })),
                        e.bindAll(["mousedown", "mousemove", "mouseup", "touchstart", "touchmove", "touchend", "reset"], this),
                        i.addEventListener(r, "mousedown", this.mousedown),
                        i.addEventListener(r, "touchstart", this.touchstart, {
                            passive: !1
                        }),
                        i.addEventListener(r, "touchmove", this.touchmove),
                        i.addEventListener(r, "touchend", this.touchend),
                        i.addEventListener(r, "touchcancel", this.reset)
                    };
                    function kn(t, i, r) {
                        if (t = new e.LngLat(t.lng,t.lat),
                        i) {
                            var n = new e.LngLat(t.lng - 360,t.lat)
                              , a = new e.LngLat(t.lng + 360,t.lat)
                              , o = r.locationPoint(t).distSqr(i);
                            r.locationPoint(n).distSqr(i) < o ? t = n : r.locationPoint(a).distSqr(i) < o && (t = a)
                        }
                        for (; Math.abs(t.lng - r.center.lng) > 180; ) {
                            var s = r.locationPoint(t);
                            if (s.x >= 0 && s.y >= 0 && s.x <= r.width && s.y <= r.height)
                                break;
                            t.lng > r.center.lng ? t.lng -= 360 : t.lng += 360
                        }
                        return t
                    }
                    In.prototype.down = function(e, t) {
                        this.mouseRotate.mousedown(e, t),
                        this.mousePitch && this.mousePitch.mousedown(e, t),
                        i.disableDrag()
                    }
                    ,
                    In.prototype.move = function(e, t) {
                        var i = this.map
                          , r = this.mouseRotate.mousemoveWindow(e, t);
                        if (r && r.bearingDelta && i.setBearing(i.getBearing() + r.bearingDelta),
                        this.mousePitch) {
                            var n = this.mousePitch.mousemoveWindow(e, t);
                            n && n.pitchDelta && i.setPitch(i.getPitch() + n.pitchDelta)
                        }
                    }
                    ,
                    In.prototype.off = function() {
                        var e = this.element;
                        i.removeEventListener(e, "mousedown", this.mousedown),
                        i.removeEventListener(e, "touchstart", this.touchstart, {
                            passive: !1
                        }),
                        i.removeEventListener(e, "touchmove", this.touchmove),
                        i.removeEventListener(e, "touchend", this.touchend),
                        i.removeEventListener(e, "touchcancel", this.reset),
                        this.offTemp()
                    }
                    ,
                    In.prototype.offTemp = function() {
                        i.enableDrag(),
                        i.removeEventListener(e.window, "mousemove", this.mousemove),
                        i.removeEventListener(e.window, "mouseup", this.mouseup)
                    }
                    ,
                    In.prototype.mousedown = function(t) {
                        this.down(e.extend({}, t, {
                            ctrlKey: !0,
                            preventDefault: function() {
                                return t.preventDefault()
                            }
                        }), i.mousePos(this.element, t)),
                        i.addEventListener(e.window, "mousemove", this.mousemove),
                        i.addEventListener(e.window, "mouseup", this.mouseup)
                    }
                    ,
                    In.prototype.mousemove = function(e) {
                        this.move(e, i.mousePos(this.element, e))
                    }
                    ,
                    In.prototype.mouseup = function(e) {
                        this.mouseRotate.mouseupWindow(e),
                        this.mousePitch && this.mousePitch.mouseupWindow(e),
                        this.offTemp()
                    }
                    ,
                    In.prototype.touchstart = function(e) {
                        1 !== e.targetTouches.length ? this.reset() : (this._startPos = this._lastPos = i.touchPos(this.element, e.targetTouches)[0],
                        this.down({
                            type: "mousedown",
                            button: 0,
                            ctrlKey: !0,
                            preventDefault: function() {
                                return e.preventDefault()
                            }
                        }, this._startPos))
                    }
                    ,
                    In.prototype.touchmove = function(e) {
                        1 !== e.targetTouches.length ? this.reset() : (this._lastPos = i.touchPos(this.element, e.targetTouches)[0],
                        this.move({
                            preventDefault: function() {
                                return e.preventDefault()
                            }
                        }, this._lastPos))
                    }
                    ,
                    In.prototype.touchend = function(e) {
                        0 === e.targetTouches.length && this._startPos && this._lastPos && this._startPos.dist(this._lastPos) < this._clickTolerance && this.element.click(),
                        this.reset()
                    }
                    ,
                    In.prototype.reset = function() {
                        this.mouseRotate.reset(),
                        this.mousePitch && this.mousePitch.reset(),
                        delete this._startPos,
                        delete this._lastPos,
                        this.offTemp()
                    }
                    ;
                    var zn = {
                        center: "translate(-50%,-50%)",
                        top: "translate(-50%,0)",
                        "top-left": "translate(0,0)",
                        "top-right": "translate(-100%,0)",
                        bottom: "translate(-50%,-100%)",
                        "bottom-left": "translate(0,-100%)",
                        "bottom-right": "translate(-100%,-100%)",
                        left: "translate(0,-50%)",
                        right: "translate(-100%,-50%)"
                    };
                    function Dn(e, t, i) {
                        var r = e.classList;
                        for (var n in zn)
                            r.remove("mapboxgl-" + i + "-anchor-" + n);
                        r.add("mapboxgl-" + i + "-anchor-" + t)
                    }
                    var Rn, On = function(t) {
                        function r(r, n) {
                            if (t.call(this),
                            (r instanceof e.window.HTMLElement || n) && (r = e.extend({
                                element: r
                            }, n)),
                            e.bindAll(["_update", "_onMove", "_onUp", "_addDragHandler", "_onMapClick", "_onKeyPress"], this),
                            this._anchor = r && r.anchor || "center",
                            this._color = r && r.color || "#3FB1CE",
                            this._scale = r && r.scale || 1,
                            this._draggable = r && r.draggable || !1,
                            this._clickTolerance = r && r.clickTolerance || 0,
                            this._isDragging = !1,
                            this._state = "inactive",
                            this._rotation = r && r.rotation || 0,
                            this._rotationAlignment = r && r.rotationAlignment || "auto",
                            this._pitchAlignment = r && r.pitchAlignment && "auto" !== r.pitchAlignment ? r.pitchAlignment : this._rotationAlignment,
                            r && r.element)
                                this._element = r.element,
                                this._offset = e.Point.convert(r && r.offset || [0, 0]);
                            else {
                                this._defaultMarker = !0,
                                this._element = i.create("div"),
                                this._element.setAttribute("aria-label", "Map marker");
                                var a = i.createNS("http://www.w3.org/2000/svg", "svg");
                                a.setAttributeNS(null, "display", "block"),
                                a.setAttributeNS(null, "height", "41px"),
                                a.setAttributeNS(null, "width", "27px"),
                                a.setAttributeNS(null, "viewBox", "0 0 27 41");
                                var o = i.createNS("http://www.w3.org/2000/svg", "g");
                                o.setAttributeNS(null, "stroke", "none"),
                                o.setAttributeNS(null, "stroke-width", "1"),
                                o.setAttributeNS(null, "fill", "none"),
                                o.setAttributeNS(null, "fill-rule", "evenodd");
                                var s = i.createNS("http://www.w3.org/2000/svg", "g");
                                s.setAttributeNS(null, "fill-rule", "nonzero");
                                var l = i.createNS("http://www.w3.org/2000/svg", "g");
                                l.setAttributeNS(null, "transform", "translate(3.0, 29.0)"),
                                l.setAttributeNS(null, "fill", "#000000");
                                for (var u = 0, c = [{
                                    rx: "10.5",
                                    ry: "5.25002273"
                                }, {
                                    rx: "10.5",
                                    ry: "5.25002273"
                                }, {
                                    rx: "9.5",
                                    ry: "4.77275007"
                                }, {
                                    rx: "8.5",
                                    ry: "4.29549936"
                                }, {
                                    rx: "7.5",
                                    ry: "3.81822308"
                                }, {
                                    rx: "6.5",
                                    ry: "3.34094679"
                                }, {
                                    rx: "5.5",
                                    ry: "2.86367051"
                                }, {
                                    rx: "4.5",
                                    ry: "2.38636864"
                                }]; u < c.length; u += 1) {
                                    var h = c[u]
                                      , p = i.createNS("http://www.w3.org/2000/svg", "ellipse");
                                    p.setAttributeNS(null, "opacity", "0.04"),
                                    p.setAttributeNS(null, "cx", "10.5"),
                                    p.setAttributeNS(null, "cy", "5.80029008"),
                                    p.setAttributeNS(null, "rx", h.rx),
                                    p.setAttributeNS(null, "ry", h.ry),
                                    l.appendChild(p)
                                }
                                var f = i.createNS("http://www.w3.org/2000/svg", "g");
                                f.setAttributeNS(null, "fill", this._color);
                                var d = i.createNS("http://www.w3.org/2000/svg", "path");
                                d.setAttributeNS(null, "d", "M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),
                                f.appendChild(d);
                                var m = i.createNS("http://www.w3.org/2000/svg", "g");
                                m.setAttributeNS(null, "opacity", "0.25"),
                                m.setAttributeNS(null, "fill", "#000000");
                                var v = i.createNS("http://www.w3.org/2000/svg", "path");
                                v.setAttributeNS(null, "d", "M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),
                                m.appendChild(v);
                                var g = i.createNS("http://www.w3.org/2000/svg", "g");
                                g.setAttributeNS(null, "transform", "translate(6.0, 7.0)"),
                                g.setAttributeNS(null, "fill", "#FFFFFF");
                                var y = i.createNS("http://www.w3.org/2000/svg", "g");
                                y.setAttributeNS(null, "transform", "translate(8.0, 8.0)");
                                var _ = i.createNS("http://www.w3.org/2000/svg", "circle");
                                _.setAttributeNS(null, "fill", "#000000"),
                                _.setAttributeNS(null, "opacity", "0.25"),
                                _.setAttributeNS(null, "cx", "5.5"),
                                _.setAttributeNS(null, "cy", "5.5"),
                                _.setAttributeNS(null, "r", "5.4999962");
                                var x = i.createNS("http://www.w3.org/2000/svg", "circle");
                                x.setAttributeNS(null, "fill", "#FFFFFF"),
                                x.setAttributeNS(null, "cx", "5.5"),
                                x.setAttributeNS(null, "cy", "5.5"),
                                x.setAttributeNS(null, "r", "5.4999962"),
                                y.appendChild(_),
                                y.appendChild(x),
                                s.appendChild(l),
                                s.appendChild(f),
                                s.appendChild(m),
                                s.appendChild(g),
                                s.appendChild(y),
                                a.appendChild(s),
                                a.setAttributeNS(null, "height", 41 * this._scale + "px"),
                                a.setAttributeNS(null, "width", 27 * this._scale + "px"),
                                this._element.appendChild(a),
                                this._offset = e.Point.convert(r && r.offset || [0, -14])
                            }
                            this._element.classList.add("mapboxgl-marker"),
                            this._element.addEventListener("dragstart", (function(e) {
                                e.preventDefault()
                            }
                            )),
                            this._element.addEventListener("mousedown", (function(e) {
                                e.preventDefault()
                            }
                            )),
                            Dn(this._element, this._anchor, "marker"),
                            this._popup = null
                        }
                        return t && (r.__proto__ = t),
                        (r.prototype = Object.create(t && t.prototype)).constructor = r,
                        r.prototype.addTo = function(e) {
                            return this.remove(),
                            this._map = e,
                            e.getCanvasContainer().appendChild(this._element),
                            e.on("move", this._update),
                            e.on("moveend", this._update),
                            this.setDraggable(this._draggable),
                            this._update(),
                            this._map.on("click", this._onMapClick),
                            this
                        }
                        ,
                        r.prototype.remove = function() {
                            return this._map && (this._map.off("click", this._onMapClick),
                            this._map.off("move", this._update),
                            this._map.off("moveend", this._update),
                            this._map.off("mousedown", this._addDragHandler),
                            this._map.off("touchstart", this._addDragHandler),
                            this._map.off("mouseup", this._onUp),
                            this._map.off("touchend", this._onUp),
                            this._map.off("mousemove", this._onMove),
                            this._map.off("touchmove", this._onMove),
                            delete this._map),
                            i.remove(this._element),
                            this._popup && this._popup.remove(),
                            this
                        }
                        ,
                        r.prototype.getLngLat = function() {
                            return this._lngLat
                        }
                        ,
                        r.prototype.setLngLat = function(t) {
                            return this._lngLat = e.LngLat.convert(t),
                            this._pos = null,
                            this._popup && this._popup.setLngLat(this._lngLat),
                            this._update(),
                            this
                        }
                        ,
                        r.prototype.getElement = function() {
                            return this._element
                        }
                        ,
                        r.prototype.setPopup = function(e) {
                            if (this._popup && (this._popup.remove(),
                            this._popup = null,
                            this._element.removeEventListener("keypress", this._onKeyPress),
                            this._originalTabIndex || this._element.removeAttribute("tabindex")),
                            e) {
                                if (!("offset"in e.options)) {
                                    var t = Math.sqrt(Math.pow(13.5, 2) / 2);
                                    e.options.offset = this._defaultMarker ? {
                                        top: [0, 0],
                                        "top-left": [0, 0],
                                        "top-right": [0, 0],
                                        bottom: [0, -38.1],
                                        "bottom-left": [t, -1 * (24.6 + t)],
                                        "bottom-right": [-t, -1 * (24.6 + t)],
                                        left: [13.5, -24.6],
                                        right: [-13.5, -24.6]
                                    } : this._offset
                                }
                                this._popup = e,
                                this._lngLat && this._popup.setLngLat(this._lngLat),
                                this._originalTabIndex = this._element.getAttribute("tabindex"),
                                this._originalTabIndex || this._element.setAttribute("tabindex", "0"),
                                this._element.addEventListener("keypress", this._onKeyPress)
                            }
                            return this
                        }
                        ,
                        r.prototype._onKeyPress = function(e) {
                            var t = e.code
                              , i = e.charCode || e.keyCode;
                            "Space" !== t && "Enter" !== t && 32 !== i && 13 !== i || this.togglePopup()
                        }
                        ,
                        r.prototype._onMapClick = function(e) {
                            var t = e.originalEvent.target
                              , i = this._element;
                            this._popup && (t === i || i.contains(t)) && this.togglePopup()
                        }
                        ,
                        r.prototype.getPopup = function() {
                            return this._popup
                        }
                        ,
                        r.prototype.togglePopup = function() {
                            var e = this._popup;
                            return e ? (e.isOpen() ? e.remove() : e.addTo(this._map),
                            this) : this
                        }
                        ,
                        r.prototype._update = function(e) {
                            if (this._map) {
                                this._map.transform.renderWorldCopies && (this._lngLat = kn(this._lngLat, this._pos, this._map.transform)),
                                this._pos = this._map.project(this._lngLat)._add(this._offset);
                                var t = "";
                                "viewport" === this._rotationAlignment || "auto" === this._rotationAlignment ? t = "rotateZ(" + this._rotation + "deg)" : "map" === this._rotationAlignment && (t = "rotateZ(" + (this._rotation - this._map.getBearing()) + "deg)");
                                var r = "";
                                "viewport" === this._pitchAlignment || "auto" === this._pitchAlignment ? r = "rotateX(0deg)" : "map" === this._pitchAlignment && (r = "rotateX(" + this._map.getPitch() + "deg)"),
                                e && "moveend" !== e.type || (this._pos = this._pos.round()),
                                i.setTransform(this._element, zn[this._anchor] + " translate(" + this._pos.x + "px, " + this._pos.y + "px) " + r + " " + t)
                            }
                        }
                        ,
                        r.prototype.getOffset = function() {
                            return this._offset
                        }
                        ,
                        r.prototype.setOffset = function(t) {
                            return this._offset = e.Point.convert(t),
                            this._update(),
                            this
                        }
                        ,
                        r.prototype._onMove = function(t) {
                            if (!this._isDragging) {
                                var i = this._clickTolerance || this._map._clickTolerance;
                                this._isDragging = t.point.dist(this._pointerdownPos) >= i
                            }
                            this._isDragging && (this._pos = t.point.sub(this._positionDelta),
                            this._lngLat = this._map.unproject(this._pos),
                            this.setLngLat(this._lngLat),
                            this._element.style.pointerEvents = "none",
                            "pending" === this._state && (this._state = "active",
                            this.fire(new e.Event("dragstart"))),
                            this.fire(new e.Event("drag")))
                        }
                        ,
                        r.prototype._onUp = function() {
                            this._element.style.pointerEvents = "auto",
                            this._positionDelta = null,
                            this._pointerdownPos = null,
                            this._isDragging = !1,
                            this._map.off("mousemove", this._onMove),
                            this._map.off("touchmove", this._onMove),
                            "active" === this._state && this.fire(new e.Event("dragend")),
                            this._state = "inactive"
                        }
                        ,
                        r.prototype._addDragHandler = function(e) {
                            this._element.contains(e.originalEvent.target) && (e.preventDefault(),
                            this._positionDelta = e.point.sub(this._pos).add(this._offset),
                            this._pointerdownPos = e.point,
                            this._state = "pending",
                            this._map.on("mousemove", this._onMove),
                            this._map.on("touchmove", this._onMove),
                            this._map.once("mouseup", this._onUp),
                            this._map.once("touchend", this._onUp))
                        }
                        ,
                        r.prototype.setDraggable = function(e) {
                            return this._draggable = !!e,
                            this._map && (e ? (this._map.on("mousedown", this._addDragHandler),
                            this._map.on("touchstart", this._addDragHandler)) : (this._map.off("mousedown", this._addDragHandler),
                            this._map.off("touchstart", this._addDragHandler))),
                            this
                        }
                        ,
                        r.prototype.isDraggable = function() {
                            return this._draggable
                        }
                        ,
                        r.prototype.setRotation = function(e) {
                            return this._rotation = e || 0,
                            this._update(),
                            this
                        }
                        ,
                        r.prototype.getRotation = function() {
                            return this._rotation
                        }
                        ,
                        r.prototype.setRotationAlignment = function(e) {
                            return this._rotationAlignment = e || "auto",
                            this._update(),
                            this
                        }
                        ,
                        r.prototype.getRotationAlignment = function() {
                            return this._rotationAlignment
                        }
                        ,
                        r.prototype.setPitchAlignment = function(e) {
                            return this._pitchAlignment = e && "auto" !== e ? e : this._rotationAlignment,
                            this._update(),
                            this
                        }
                        ,
                        r.prototype.getPitchAlignment = function() {
                            return this._pitchAlignment
                        }
                        ,
                        r
                    }(e.Evented), Bn = {
                        positionOptions: {
                            enableHighAccuracy: !1,
                            maximumAge: 0,
                            timeout: 6e3
                        },
                        fitBoundsOptions: {
                            maxZoom: 15
                        },
                        trackUserLocation: !1,
                        showAccuracyCircle: !0,
                        showUserLocation: !0
                    }, Fn = 0, Nn = !1, Un = function(t) {
                        function r(i) {
                            t.call(this),
                            this.options = e.extend({}, Bn, i),
                            e.bindAll(["_onSuccess", "_onError", "_onZoom", "_finish", "_setupUI", "_updateCamera", "_updateMarker"], this)
                        }
                        return t && (r.__proto__ = t),
                        (r.prototype = Object.create(t && t.prototype)).constructor = r,
                        r.prototype.onAdd = function(t) {
                            var r;
                            return this._map = t,
                            this._container = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"),
                            r = this._setupUI,
                            void 0 !== Rn ? r(Rn) : void 0 !== e.window.navigator.permissions ? e.window.navigator.permissions.query({
                                name: "geolocation"
                            }).then((function(e) {
                                r(Rn = "denied" !== e.state)
                            }
                            )) : r(Rn = !!e.window.navigator.geolocation),
                            this._container
                        }
                        ,
                        r.prototype.onRemove = function() {
                            void 0 !== this._geolocationWatchID && (e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),
                            this._geolocationWatchID = void 0),
                            this.options.showUserLocation && this._userLocationDotMarker && this._userLocationDotMarker.remove(),
                            this.options.showAccuracyCircle && this._accuracyCircleMarker && this._accuracyCircleMarker.remove(),
                            i.remove(this._container),
                            this._map.off("zoom", this._onZoom),
                            this._map = void 0,
                            Fn = 0,
                            Nn = !1
                        }
                        ,
                        r.prototype._isOutOfMapMaxBounds = function(e) {
                            var t = this._map.getMaxBounds()
                              , i = e.coords;
                            return t && (i.longitude < t.getWest() || i.longitude > t.getEast() || i.latitude < t.getSouth() || i.latitude > t.getNorth())
                        }
                        ,
                        r.prototype._setErrorState = function() {
                            switch (this._watchState) {
                            case "WAITING_ACTIVE":
                                this._watchState = "ACTIVE_ERROR",
                                this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),
                                this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                                break;
                            case "ACTIVE_LOCK":
                                this._watchState = "ACTIVE_ERROR",
                                this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),
                                this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),
                                this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");
                                break;
                            case "BACKGROUND":
                                this._watchState = "BACKGROUND_ERROR",
                                this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),
                                this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),
                                this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")
                            }
                        }
                        ,
                        r.prototype._onSuccess = function(t) {
                            if (this._map) {
                                if (this._isOutOfMapMaxBounds(t))
                                    return this._setErrorState(),
                                    this.fire(new e.Event("outofmaxbounds",t)),
                                    this._updateMarker(),
                                    void this._finish();
                                if (this.options.trackUserLocation)
                                    switch (this._lastKnownPosition = t,
                                    this._watchState) {
                                    case "WAITING_ACTIVE":
                                    case "ACTIVE_LOCK":
                                    case "ACTIVE_ERROR":
                                        this._watchState = "ACTIVE_LOCK",
                                        this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),
                                        this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),
                                        this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                                        break;
                                    case "BACKGROUND":
                                    case "BACKGROUND_ERROR":
                                        this._watchState = "BACKGROUND",
                                        this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),
                                        this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),
                                        this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")
                                    }
                                this.options.showUserLocation && "OFF" !== this._watchState && this._updateMarker(t),
                                this.options.trackUserLocation && "ACTIVE_LOCK" !== this._watchState || this._updateCamera(t),
                                this.options.showUserLocation && this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),
                                this.fire(new e.Event("geolocate",t)),
                                this._finish()
                            }
                        }
                        ,
                        r.prototype._updateCamera = function(t) {
                            var i = new e.LngLat(t.coords.longitude,t.coords.latitude)
                              , r = t.coords.accuracy
                              , n = this._map.getBearing()
                              , a = e.extend({
                                bearing: n
                            }, this.options.fitBoundsOptions);
                            this._map.fitBounds(i.toBounds(r), a, {
                                geolocateSource: !0
                            })
                        }
                        ,
                        r.prototype._updateMarker = function(t) {
                            if (t) {
                                var i = new e.LngLat(t.coords.longitude,t.coords.latitude);
                                this._accuracyCircleMarker.setLngLat(i).addTo(this._map),
                                this._userLocationDotMarker.setLngLat(i).addTo(this._map),
                                this._accuracy = t.coords.accuracy,
                                this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius()
                            } else
                                this._userLocationDotMarker.remove(),
                                this._accuracyCircleMarker.remove()
                        }
                        ,
                        r.prototype._updateCircleRadius = function() {
                            var e = this._map._container.clientHeight / 2
                              , t = this._map.unproject([0, e])
                              , i = this._map.unproject([1, e])
                              , r = t.distanceTo(i)
                              , n = Math.ceil(2 * this._accuracy / r);
                            this._circleElement.style.width = n + "px",
                            this._circleElement.style.height = n + "px"
                        }
                        ,
                        r.prototype._onZoom = function() {
                            this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius()
                        }
                        ,
                        r.prototype._onError = function(t) {
                            if (this._map) {
                                if (this.options.trackUserLocation)
                                    if (1 === t.code) {
                                        this._watchState = "OFF",
                                        this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),
                                        this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),
                                        this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),
                                        this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),
                                        this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),
                                        this._geolocateButton.disabled = !0;
                                        var i = this._map._getUIString("GeolocateControl.LocationNotAvailable");
                                        this._geolocateButton.title = i,
                                        this._geolocateButton.setAttribute("aria-label", i),
                                        void 0 !== this._geolocationWatchID && this._clearWatch()
                                    } else {
                                        if (3 === t.code && Nn)
                                            return;
                                        this._setErrorState()
                                    }
                                "OFF" !== this._watchState && this.options.showUserLocation && this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),
                                this.fire(new e.Event("error",t)),
                                this._finish()
                            }
                        }
                        ,
                        r.prototype._finish = function() {
                            this._timeoutId && clearTimeout(this._timeoutId),
                            this._timeoutId = void 0
                        }
                        ,
                        r.prototype._setupUI = function(t) {
                            var r = this;
                            if (this._container.addEventListener("contextmenu", (function(e) {
                                return e.preventDefault()
                            }
                            )),
                            this._geolocateButton = i.create("button", "mapboxgl-ctrl-geolocate", this._container),
                            i.create("span", "mapboxgl-ctrl-icon", this._geolocateButton).setAttribute("aria-hidden", !0),
                            this._geolocateButton.type = "button",
                            !1 === t) {
                                e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");
                                var n = this._map._getUIString("GeolocateControl.LocationNotAvailable");
                                this._geolocateButton.disabled = !0,
                                this._geolocateButton.title = n,
                                this._geolocateButton.setAttribute("aria-label", n)
                            } else {
                                var a = this._map._getUIString("GeolocateControl.FindMyLocation");
                                this._geolocateButton.title = a,
                                this._geolocateButton.setAttribute("aria-label", a)
                            }
                            this.options.trackUserLocation && (this._geolocateButton.setAttribute("aria-pressed", "false"),
                            this._watchState = "OFF"),
                            this.options.showUserLocation && (this._dotElement = i.create("div", "mapboxgl-user-location-dot"),
                            this._userLocationDotMarker = new On(this._dotElement),
                            this._circleElement = i.create("div", "mapboxgl-user-location-accuracy-circle"),
                            this._accuracyCircleMarker = new On({
                                element: this._circleElement,
                                pitchAlignment: "map"
                            }),
                            this.options.trackUserLocation && (this._watchState = "OFF"),
                            this._map.on("zoom", this._onZoom)),
                            this._geolocateButton.addEventListener("click", this.trigger.bind(this)),
                            this._setup = !0,
                            this.options.trackUserLocation && this._map.on("movestart", (function(t) {
                                t.geolocateSource || "ACTIVE_LOCK" !== r._watchState || t.originalEvent && "resize" === t.originalEvent.type || (r._watchState = "BACKGROUND",
                                r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),
                                r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),
                                r.fire(new e.Event("trackuserlocationend")))
                            }
                            ))
                        }
                        ,
                        r.prototype.trigger = function() {
                            if (!this._setup)
                                return e.warnOnce("Geolocate control triggered before added to a map"),
                                !1;
                            if (this.options.trackUserLocation) {
                                switch (this._watchState) {
                                case "OFF":
                                    this._watchState = "WAITING_ACTIVE",
                                    this.fire(new e.Event("trackuserlocationstart"));
                                    break;
                                case "WAITING_ACTIVE":
                                case "ACTIVE_LOCK":
                                case "ACTIVE_ERROR":
                                case "BACKGROUND_ERROR":
                                    Fn--,
                                    Nn = !1,
                                    this._watchState = "OFF",
                                    this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),
                                    this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),
                                    this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),
                                    this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),
                                    this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),
                                    this.fire(new e.Event("trackuserlocationend"));
                                    break;
                                case "BACKGROUND":
                                    this._watchState = "ACTIVE_LOCK",
                                    this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),
                                    this._lastKnownPosition && this._updateCamera(this._lastKnownPosition),
                                    this.fire(new e.Event("trackuserlocationstart"))
                                }
                                switch (this._watchState) {
                                case "WAITING_ACTIVE":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                                    break;
                                case "ACTIVE_LOCK":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                                    break;
                                case "ACTIVE_ERROR":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                                    break;
                                case "BACKGROUND":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");
                                    break;
                                case "BACKGROUND_ERROR":
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")
                                }
                                if ("OFF" === this._watchState && void 0 !== this._geolocationWatchID)
                                    this._clearWatch();
                                else if (void 0 === this._geolocationWatchID) {
                                    var t;
                                    this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),
                                    this._geolocateButton.setAttribute("aria-pressed", "true"),
                                    ++Fn > 1 ? (t = {
                                        maximumAge: 6e5,
                                        timeout: 0
                                    },
                                    Nn = !0) : (t = this.options.positionOptions,
                                    Nn = !1),
                                    this._geolocationWatchID = e.window.navigator.geolocation.watchPosition(this._onSuccess, this._onError, t)
                                }
                            } else
                                e.window.navigator.geolocation.getCurrentPosition(this._onSuccess, this._onError, this.options.positionOptions),
                                this._timeoutId = setTimeout(this._finish, 1e4);
                            return !0
                        }
                        ,
                        r.prototype._clearWatch = function() {
                            e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),
                            this._geolocationWatchID = void 0,
                            this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),
                            this._geolocateButton.setAttribute("aria-pressed", "false"),
                            this.options.showUserLocation && this._updateMarker(null)
                        }
                        ,
                        r
                    }(e.Evented), Vn = {
                        maxWidth: 100,
                        unit: "metric"
                    }, Gn = function(t) {
                        this.options = e.extend({}, Vn, t),
                        e.bindAll(["_onMove", "setUnit"], this)
                    };
                    function jn(e, t, i) {
                        var r = i && i.maxWidth || 100
                          , n = e._container.clientHeight / 2
                          , a = e.unproject([0, n])
                          , o = e.unproject([r, n])
                          , s = a.distanceTo(o);
                        if (i && "imperial" === i.unit) {
                            var l = 3.2808 * s;
                            l > 5280 ? Hn(t, r, l / 5280, e._getUIString("ScaleControl.Miles")) : Hn(t, r, l, e._getUIString("ScaleControl.Feet"))
                        } else
                            i && "nautical" === i.unit ? Hn(t, r, s / 1852, e._getUIString("ScaleControl.NauticalMiles")) : s >= 1e3 ? Hn(t, r, s / 1e3, e._getUIString("ScaleControl.Kilometers")) : Hn(t, r, s, e._getUIString("ScaleControl.Meters"))
                    }
                    function Hn(e, t, i, r) {
                        var n, a, o, s = (n = i,
                        (a = Math.pow(10, ("" + Math.floor(n)).length - 1)) * (o = (o = n / a) >= 10 ? 10 : o >= 5 ? 5 : o >= 3 ? 3 : o >= 2 ? 2 : o >= 1 ? 1 : function(e) {
                            var t = Math.pow(10, Math.ceil(-Math.log(e) / Math.LN10));
                            return Math.round(e * t) / t
                        }(o)));
                        e.style.width = t * (s / i) + "px",
                        e.innerHTML = s + "&nbsp;" + r
                    }
                    Gn.prototype.getDefaultPosition = function() {
                        return "bottom-left"
                    }
                    ,
                    Gn.prototype._onMove = function() {
                        jn(this._map, this._container, this.options)
                    }
                    ,
                    Gn.prototype.onAdd = function(e) {
                        return this._map = e,
                        this._container = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-scale", e.getContainer()),
                        this._map.on("move", this._onMove),
                        this._onMove(),
                        this._container
                    }
                    ,
                    Gn.prototype.onRemove = function() {
                        i.remove(this._container),
                        this._map.off("move", this._onMove),
                        this._map = void 0
                    }
                    ,
                    Gn.prototype.setUnit = function(e) {
                        this.options.unit = e,
                        jn(this._map, this._container, this.options)
                    }
                    ;
                    var qn = function(t) {
                        this._fullscreen = !1,
                        t && t.container && (t.container instanceof e.window.HTMLElement ? this._container = t.container : e.warnOnce("Full screen control 'container' must be a DOM element.")),
                        e.bindAll(["_onClickFullscreen", "_changeIcon"], this),
                        "onfullscreenchange"in e.window.document ? this._fullscreenchange = "fullscreenchange" : "onmozfullscreenchange"in e.window.document ? this._fullscreenchange = "mozfullscreenchange" : "onwebkitfullscreenchange"in e.window.document ? this._fullscreenchange = "webkitfullscreenchange" : "onmsfullscreenchange"in e.window.document && (this._fullscreenchange = "MSFullscreenChange")
                    };
                    qn.prototype.onAdd = function(t) {
                        return this._map = t,
                        this._container || (this._container = this._map.getContainer()),
                        this._controlContainer = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"),
                        this._checkFullscreenSupport() ? this._setupUI() : (this._controlContainer.style.display = "none",
                        e.warnOnce("This device does not support fullscreen mode.")),
                        this._controlContainer
                    }
                    ,
                    qn.prototype.onRemove = function() {
                        i.remove(this._controlContainer),
                        this._map = null,
                        e.window.document.removeEventListener(this._fullscreenchange, this._changeIcon)
                    }
                    ,
                    qn.prototype._checkFullscreenSupport = function() {
                        return !!(e.window.document.fullscreenEnabled || e.window.document.mozFullScreenEnabled || e.window.document.msFullscreenEnabled || e.window.document.webkitFullscreenEnabled)
                    }
                    ,
                    qn.prototype._setupUI = function() {
                        var t = this._fullscreenButton = i.create("button", "mapboxgl-ctrl-fullscreen", this._controlContainer);
                        i.create("span", "mapboxgl-ctrl-icon", t).setAttribute("aria-hidden", !0),
                        t.type = "button",
                        this._updateTitle(),
                        this._fullscreenButton.addEventListener("click", this._onClickFullscreen),
                        e.window.document.addEventListener(this._fullscreenchange, this._changeIcon)
                    }
                    ,
                    qn.prototype._updateTitle = function() {
                        var e = this._getTitle();
                        this._fullscreenButton.setAttribute("aria-label", e),
                        this._fullscreenButton.title = e
                    }
                    ,
                    qn.prototype._getTitle = function() {
                        return this._map._getUIString(this._isFullscreen() ? "FullscreenControl.Exit" : "FullscreenControl.Enter")
                    }
                    ,
                    qn.prototype._isFullscreen = function() {
                        return this._fullscreen
                    }
                    ,
                    qn.prototype._changeIcon = function() {
                        (e.window.document.fullscreenElement || e.window.document.mozFullScreenElement || e.window.document.webkitFullscreenElement || e.window.document.msFullscreenElement) === this._container !== this._fullscreen && (this._fullscreen = !this._fullscreen,
                        this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),
                        this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),
                        this._updateTitle())
                    }
                    ,
                    qn.prototype._onClickFullscreen = function() {
                        this._isFullscreen() ? e.window.document.exitFullscreen ? e.window.document.exitFullscreen() : e.window.document.mozCancelFullScreen ? e.window.document.mozCancelFullScreen() : e.window.document.msExitFullscreen ? e.window.document.msExitFullscreen() : e.window.document.webkitCancelFullScreen && e.window.document.webkitCancelFullScreen() : this._container.requestFullscreen ? this._container.requestFullscreen() : this._container.mozRequestFullScreen ? this._container.mozRequestFullScreen() : this._container.msRequestFullscreen ? this._container.msRequestFullscreen() : this._container.webkitRequestFullscreen && this._container.webkitRequestFullscreen()
                    }
                    ;
                    var Wn = {
                        closeButton: !0,
                        closeOnClick: !0,
                        focusAfterOpen: !0,
                        className: "",
                        maxWidth: "240px"
                    }
                      , Zn = ["a[href]", "[tabindex]:not([tabindex='-1'])", "[contenteditable]:not([contenteditable='false'])", "button:not([disabled])", "input:not([disabled])", "select:not([disabled])", "textarea:not([disabled])"].join(", ")
                      , Xn = function(t) {
                        function r(i) {
                            t.call(this),
                            this.options = e.extend(Object.create(Wn), i),
                            e.bindAll(["_update", "_onClose", "remove", "_onMouseMove", "_onMouseUp", "_onDrag"], this)
                        }
                        return t && (r.__proto__ = t),
                        (r.prototype = Object.create(t && t.prototype)).constructor = r,
                        r.prototype.addTo = function(t) {
                            return this._map && this.remove(),
                            this._map = t,
                            this.options.closeOnClick && this._map.on("click", this._onClose),
                            this.options.closeOnMove && this._map.on("move", this._onClose),
                            this._map.on("remove", this.remove),
                            this._update(),
                            this._focusFirstElement(),
                            this._trackPointer ? (this._map.on("mousemove", this._onMouseMove),
                            this._map.on("mouseup", this._onMouseUp),
                            this._container && this._container.classList.add("mapboxgl-popup-track-pointer"),
                            this._map._canvasContainer.classList.add("mapboxgl-track-pointer")) : this._map.on("move", this._update),
                            this.fire(new e.Event("open")),
                            this
                        }
                        ,
                        r.prototype.isOpen = function() {
                            return !!this._map
                        }
                        ,
                        r.prototype.remove = function() {
                            return this._content && i.remove(this._content),
                            this._container && (i.remove(this._container),
                            delete this._container),
                            this._map && (this._map.off("move", this._update),
                            this._map.off("move", this._onClose),
                            this._map.off("click", this._onClose),
                            this._map.off("remove", this.remove),
                            this._map.off("mousemove", this._onMouseMove),
                            this._map.off("mouseup", this._onMouseUp),
                            this._map.off("drag", this._onDrag),
                            delete this._map),
                            this.fire(new e.Event("close")),
                            this
                        }
                        ,
                        r.prototype.getLngLat = function() {
                            return this._lngLat
                        }
                        ,
                        r.prototype.setLngLat = function(t) {
                            return this._lngLat = e.LngLat.convert(t),
                            this._pos = null,
                            this._trackPointer = !1,
                            this._update(),
                            this._map && (this._map.on("move", this._update),
                            this._map.off("mousemove", this._onMouseMove),
                            this._container && this._container.classList.remove("mapboxgl-popup-track-pointer"),
                            this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),
                            this
                        }
                        ,
                        r.prototype.trackPointer = function() {
                            return this._trackPointer = !0,
                            this._pos = null,
                            this._update(),
                            this._map && (this._map.off("move", this._update),
                            this._map.on("mousemove", this._onMouseMove),
                            this._map.on("drag", this._onDrag),
                            this._container && this._container.classList.add("mapboxgl-popup-track-pointer"),
                            this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),
                            this
                        }
                        ,
                        r.prototype.getElement = function() {
                            return this._container
                        }
                        ,
                        r.prototype.setText = function(t) {
                            return this.setDOMContent(e.window.document.createTextNode(t))
                        }
                        ,
                        r.prototype.setHTML = function(t) {
                            var i, r = e.window.document.createDocumentFragment(), n = e.window.document.createElement("body");
                            for (n.innerHTML = t; i = n.firstChild; )
                                r.appendChild(i);
                            return this.setDOMContent(r)
                        }
                        ,
                        r.prototype.getMaxWidth = function() {
                            return this._container && this._container.style.maxWidth
                        }
                        ,
                        r.prototype.setMaxWidth = function(e) {
                            return this.options.maxWidth = e,
                            this._update(),
                            this
                        }
                        ,
                        r.prototype.setDOMContent = function(e) {
                            if (this._content)
                                for (; this._content.hasChildNodes(); )
                                    this._content.firstChild && this._content.removeChild(this._content.firstChild);
                            else
                                this._content = i.create("div", "mapboxgl-popup-content", this._container);
                            return this._content.appendChild(e),
                            this._createCloseButton(),
                            this._update(),
                            this._focusFirstElement(),
                            this
                        }
                        ,
                        r.prototype.addClassName = function(e) {
                            this._container && this._container.classList.add(e)
                        }
                        ,
                        r.prototype.removeClassName = function(e) {
                            this._container && this._container.classList.remove(e)
                        }
                        ,
                        r.prototype.setOffset = function(e) {
                            return this.options.offset = e,
                            this._update(),
                            this
                        }
                        ,
                        r.prototype.toggleClassName = function(e) {
                            if (this._container)
                                return this._container.classList.toggle(e)
                        }
                        ,
                        r.prototype._createCloseButton = function() {
                            this.options.closeButton && (this._closeButton = i.create("button", "mapboxgl-popup-close-button", this._content),
                            this._closeButton.type = "button",
                            this._closeButton.setAttribute("aria-label", "Close popup"),
                            this._closeButton.innerHTML = "&#215;",
                            this._closeButton.addEventListener("click", this._onClose))
                        }
                        ,
                        r.prototype._onMouseUp = function(e) {
                            this._update(e.point)
                        }
                        ,
                        r.prototype._onMouseMove = function(e) {
                            this._update(e.point)
                        }
                        ,
                        r.prototype._onDrag = function(e) {
                            this._update(e.point)
                        }
                        ,
                        r.prototype._update = function(t) {
                            var r = this;
                            if (this._map && (this._lngLat || this._trackPointer) && this._content && (this._container || (this._container = i.create("div", "mapboxgl-popup", this._map.getContainer()),
                            this._tip = i.create("div", "mapboxgl-popup-tip", this._container),
                            this._container.appendChild(this._content),
                            this.options.className && this.options.className.split(" ").forEach((function(e) {
                                return r._container.classList.add(e)
                            }
                            )),
                            this._trackPointer && this._container.classList.add("mapboxgl-popup-track-pointer")),
                            this.options.maxWidth && this._container.style.maxWidth !== this.options.maxWidth && (this._container.style.maxWidth = this.options.maxWidth),
                            this._map.transform.renderWorldCopies && !this._trackPointer && (this._lngLat = kn(this._lngLat, this._pos, this._map.transform)),
                            !this._trackPointer || t)) {
                                var n = this._pos = this._trackPointer && t ? t : this._map.project(this._lngLat)
                                  , a = this.options.anchor
                                  , o = function t(i) {
                                    if (i) {
                                        if ("number" == typeof i) {
                                            var r = Math.round(Math.sqrt(.5 * Math.pow(i, 2)));
                                            return {
                                                center: new e.Point(0,0),
                                                top: new e.Point(0,i),
                                                "top-left": new e.Point(r,r),
                                                "top-right": new e.Point(-r,r),
                                                bottom: new e.Point(0,-i),
                                                "bottom-left": new e.Point(r,-r),
                                                "bottom-right": new e.Point(-r,-r),
                                                left: new e.Point(i,0),
                                                right: new e.Point(-i,0)
                                            }
                                        }
                                        if (i instanceof e.Point || Array.isArray(i)) {
                                            var n = e.Point.convert(i);
                                            return {
                                                center: n,
                                                top: n,
                                                "top-left": n,
                                                "top-right": n,
                                                bottom: n,
                                                "bottom-left": n,
                                                "bottom-right": n,
                                                left: n,
                                                right: n
                                            }
                                        }
                                        return {
                                            center: e.Point.convert(i.center || [0, 0]),
                                            top: e.Point.convert(i.top || [0, 0]),
                                            "top-left": e.Point.convert(i["top-left"] || [0, 0]),
                                            "top-right": e.Point.convert(i["top-right"] || [0, 0]),
                                            bottom: e.Point.convert(i.bottom || [0, 0]),
                                            "bottom-left": e.Point.convert(i["bottom-left"] || [0, 0]),
                                            "bottom-right": e.Point.convert(i["bottom-right"] || [0, 0]),
                                            left: e.Point.convert(i.left || [0, 0]),
                                            right: e.Point.convert(i.right || [0, 0])
                                        }
                                    }
                                    return t(new e.Point(0,0))
                                }(this.options.offset);
                                if (!a) {
                                    var s, l = this._container.offsetWidth, u = this._container.offsetHeight;
                                    s = n.y + o.bottom.y < u ? ["top"] : n.y > this._map.transform.height - u ? ["bottom"] : [],
                                    n.x < l / 2 ? s.push("left") : n.x > this._map.transform.width - l / 2 && s.push("right"),
                                    a = 0 === s.length ? "bottom" : s.join("-")
                                }
                                var c = n.add(o[a]).round();
                                i.setTransform(this._container, zn[a] + " translate(" + c.x + "px," + c.y + "px)"),
                                Dn(this._container, a, "popup")
                            }
                        }
                        ,
                        r.prototype._focusFirstElement = function() {
                            if (this.options.focusAfterOpen && this._container) {
                                var e = this._container.querySelector(Zn);
                                e && e.focus()
                            }
                        }
                        ,
                        r.prototype._onClose = function() {
                            this.remove()
                        }
                        ,
                        r
                    }(e.Evented)
                      , Yn = {
                        version: e.version,
                        supported: t,
                        setRTLTextPlugin: e.setRTLTextPlugin,
                        getRTLTextPluginStatus: e.getRTLTextPluginStatus,
                        Map: An,
                        NavigationControl: Ln,
                        GeolocateControl: Un,
                        AttributionControl: _n,
                        ScaleControl: Gn,
                        FullscreenControl: qn,
                        Popup: Xn,
                        Marker: On,
                        Style: jt,
                        LngLat: e.LngLat,
                        LngLatBounds: e.LngLatBounds,
                        Point: e.Point,
                        MercatorCoordinate: e.MercatorCoordinate,
                        Evented: e.Evented,
                        config: e.config,
                        prewarm: function() {
                            Fe().acquire(De)
                        },
                        clearPrewarmedResources: function() {
                            var e = Oe;
                            e && (e.isPreloaded() && 1 === e.numActive() ? (e.release(De),
                            Oe = null) : console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))
                        },
                        get accessToken() {
                            return e.config.ACCESS_TOKEN
                        },
                        set accessToken(t) {
                            e.config.ACCESS_TOKEN = t
                        },
                        get baseApiUrl() {
                            return e.config.API_URL
                        },
                        set baseApiUrl(t) {
                            e.config.API_URL = t
                        },
                        get workerCount() {
                            return Re.workerCount
                        },
                        set workerCount(e) {
                            Re.workerCount = e
                        },
                        get maxParallelImageRequests() {
                            return e.config.MAX_PARALLEL_IMAGE_REQUESTS
                        },
                        set maxParallelImageRequests(t) {
                            e.config.MAX_PARALLEL_IMAGE_REQUESTS = t
                        },
                        clearStorage: function(t) {
                            e.clearTileCache(t)
                        },
                        workerUrl: ""
                    };
                    return Yn
                }
                )),
                i
            }()
        }
    }
      , t = {};
    function i(r) {
        var n = t[r];
        if (void 0 !== n)
            return n.exports;
        var a = t[r] = {
            exports: {}
        };
        return e[r].call(a.exports, a, a.exports, i),
        a.exports
    }
    i.n = e=>{
        var t = e && e.__esModule ? ()=>e.default : ()=>e;
        return i.d(t, {
            a: t
        }),
        t
    }
    ,
    i.d = (e,t)=>{
        for (var r in t)
            i.o(t, r) && !i.o(e, r) && Object.defineProperty(e, r, {
                enumerable: !0,
                get: t[r]
            })
    }
    ,
    i.o = (e,t)=>Object.prototype.hasOwnProperty.call(e, t);
    var r = {};
    (()=>{
        "use strict";
        i.d(r, {
            default: ()=>n
        });
        var e = i(637)
          , t = i(247);
        function n() {
            var i = new e.Map({
                container: "map",
                hash: !0,
                zoom: 8,
                center: [56.2647, 22.2272],
                bearing: -31,
                pitch: 60,
                style: "https://api.maptiler.com/maps/f2dec56a-c7d2-47ea-80ad-04c85b3c701b/style.json?key=OLgSUjCtwIUZp1o1vPQv",
                attributionControl: !1,
                antialias: !0
            });
            function r(e) {
                var t = "/pages/tools/weather/3d/data/" + e + ".jpg";
                a.addSource(function(e) {
                    var t = parseInt(e.substr(0, 2), 10)
                      , i = parseInt(e.substr(2, 2), 10)
                      , r = parseInt(e.substr(4, 2), 10);
                    return +new Date(15582276e5 + 1e3 * (60 * (60 * t + i) + r))
                }(e), t)
            }
            window.map = i;
            var n = parseFloat(new URL(window.location.toString()).searchParams.get("opacityfactor") || "10")
              , a = new t.VolumeLayer("3d",{
                performance: {
                    reuseCanvas: !!new URL(window.location.toString()).searchParams.get("reuse") || !1,
                    dataScale: parseFloat(new URL(window.location.toString()).searchParams.get("datascale")) || 1,
                    renderScale: 1 / window.devicePixelRatio,
                    renderSteps: 32
                },
                bounds: [48.8179164, 20.6179175, 57.0511174, 26.7678189],
                boundsColor: "#ddd",
                altitudeMin: 500,
                altitudeMax: 17500,
                textureSteps: 34,
                textureTiling: [3, 4]
            },new t.GradientColoringFragment({
                decode: {
                    min: 0,
                    max: 64,
                    channel: "r"
                },
                stops: [{
                    value: 0,
                    color: [0, 0, 0, 0]
                }, {
                    value: 5,
                    color: [56, 0, 112, 20]
                }, {
                    value: 10,
                    color: [6, 0, 240, 40]
                }, {
                    value: 15,
                    color: [0, 108, 192, 60]
                }, {
                    value: 20,
                    color: [0, 160, 0, 80]
                }, {
                    value: 25,
                    color: [0, 190, 0, 110]
                }, {
                    value: 30,
                    color: [50, 216, 0, 130]
                }, {
                    value: 35,
                    color: [220, 220, 0, 150]
                }, {
                    value: 40,
                    color: [255, 176, 0, 170]
                }, {
                    value: 45,
                    color: [255, 132, 0, 190]
                }, {
                    value: 50,
                    color: [255, 50, 0, 210]
                }, {
                    value: 55,
                    color: [170, 0, 0, 240]
                }, {
                    value: 60,
                    color: [255, 255, 255, 255]
                }],
                opacity: n,
                smooth: !0
            }));
            return a.on("tick", (function(e) {
                window.document.getElementById("radarLayer-time").innerHTML = new Date(e.time).toUTCString()
            }
            )),
            r("090000"),
            r("090600"),
            setTimeout((function() {
                r("091200"),
                r("091800"),
                r("092400"),
                r("093000"),
                setTimeout((function() {
                    r("093600"),
                    r("094200"),
                    r("094800"),
                    r("095400")
                }
                ), 4e3)
            }
            ), 2e3),
            a.animate(18e4),
            i.on("load", (function() {
                i.addLayer(a, "admin_sub"),
                i.addControl(new e.NavigationControl({
                    visualizePitch: !0
                }))
            }
            )),
            a
        }
    }
    )(),
    window.weather3d = r.default
}
)();
